Editing this script from the BRCA1_SGE2_X_all_ggplot_removed_20170801.Rmd script.
  Goals:
  -X Replace all references to correct variant count files in new folder
  -X Replace all variable names that are r1/r2 with the equivalent variable names for SGE1 (i.e. r1/r2)
      -X take heed with exons that used different replicate names in final VC script
          reassigned from variant count files --> [X15r2 -> r1, X15r3 -> r2][X20r2 -> r1, X20r3 -> X20r2][X21r3 -> r1, X21r4 -> r2]
  -- find a way to run this on local memory without crashing the R session.

```{r}
library(plyr)
library(ggplot2)
editing_info <- read.table("/mount/SGE/BRCA1/BRCA1_editing_data.txt",header=TRUE, sep="\t")
experiment_dir_171011 = "/mount/SGE/BRCA1/20171011_BRCA1_SGE1_all/sam/variant_counts_no_thresh/final/"

named_conseq_colors_clinvar_path.lp_benign = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

named_conseq_colors = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#3885DB", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000")

named_conseq_colors_full = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#013DD3","Conflicting interpretations of pathogenicity" = "#FFCB00","Likely benign" = "#2360F9","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#00A54D" )

named_conseq_colors_full_simple = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#013DD3","Conflicting interpretations of pathogenicity" = "#FFC927","Likely benign" = "#2360F9","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#31947B","Gray" = "#000000" )

named_conseq_colors_final = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#6793F8", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#002372", "SYNONYMOUS" = "#0C4EE5","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000")

named_missense_colors_by_polyphen = c("possibly_damaging" = "#00925B","probably_damaging" = "#007549", "benign" = "#00BA74")

named_conseq_colors_hide_missense = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#FFFFFF", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#47A300", "REF" = "#000000")

named_conseq_colors_highlight_mis = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#B0B2B3", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#B0B2B3", "SYNONYMOUS" = "#B0B2B3","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )

named_conseq_colors_highlight_syn_int = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#B0B2B3", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )

named_conseq_colors_clinvar_gray = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#EBEAEA","Pathogenic" = "#EBEAEA","Uncertain significance" = "#EBEAEA" )

named_conseq_colors_clinvar_path.lp = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

named_conseq_colors_clinvar_path.lp_benign.lb_confl.vus = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#FFB400","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#FFB400" )

named_conseq_colors_clinvar_path.lp_benign.lb = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#BFBCBC","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

#changed these to be +1 due to 0-indexing vs. 1 indexing...
X2_cut_pos <- 41276033.5+1
X3_cut_pos <- 41267763.5+1
X4_cut_pos <- 41258518.5+1 
X5_cut_pos <- 41256892.5+1
X15_cut_pos <- 41222951.5+1
X16_cut_pos <- 41219676.5+1
X17_cut_pos <- 41215950.5+1
X18_cut_pos <- 41215377.5+1
X19_cut_pos <- 41209129.5+1
X20_cut_pos <- 41203127.5+1
X21_cut_pos <- 41201207.5+1
X22_cut_pos <- 41199706.5+1
X23_cut_pos <- 41197794.5+1

###CODE ABOVE HERE APPLIES TO ALL SGE REGIONS IN EXP.

#Current working analysis (expects rna-pre samples for each exon) -- generalized and applied to all Ligase-4 KO SGE exon experiments

X2r1_file <- paste(experiment_dir_171011,'X2r1','_annotated.txt',sep='')
X2r2_file <- paste(experiment_dir_171011,'X2r2','_annotated.txt',sep='')
X2r1 <- read.table(X2r1_file, header=TRUE, sep="\t")
X2r2 <- read.table(X2r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X2 <- editing_info[which(editing_info$amplicon == 'X2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X2_HDR_5_SNV = as.character(editing_info_X2$HDR_5_SNV)
X2_HDR_3_SNV = as.character(editing_info_X2$HDR_3_SNV)
#X2_cut_pos = as.character(editing_info_X2$cut_pos)
X2_cut_end = as.character(editing_info_X2$cut_end)
X2_mut_start = as.character(editing_info_X2$mut_start)
X2_mut_end = as.character(editing_info_X2$mut_end)
### Replicate 1
X2r1_cSNV_all <- which(X2r1[,'c_hdr_snv']=='True')
X2r1_cSNV_all_df = X2r1[X2r1_cSNV_all,]
X2r1_prog_var_all <- which(X2r1[,'all_hdr_variant']=='True' & X2r1[,'edit_string']!='-WT')
X2r1_prog_var_all_df = X2r1[X2r1_prog_var_all,]
X2r1_prog_map_all = which(X2r1_prog_var_all_df[,'pos']!='REF')
X2r1_prog_map_all_df = X2r1_prog_var_all_df[X2r1_prog_map_all,]
X2r1_prog_map_exon_all = which(X2r1_prog_map_all_df[,'cDNApos']!='REF' & X2r1_prog_map_all_df[,'cDNApos']!='NA')
X2r1_prog_map_exon_all_df = X2r1_prog_map_all_df[X2r1_prog_map_exon_all,]
X2r1_prog_map_CADD = which(X2r1_prog_map_all_df[,'CADD.phred']!='NA')
X2r1_prog_map_CADD_df = X2r1_prog_map_all_df[X2r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X2r1_prog_var_thresh5 <- which(as.numeric(as.character(X2r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X2r1_prog_var_thresh5_df = X2r1_prog_var_all_df[X2r1_prog_var_thresh5,]
X2r1_prog_map_thresh5 <- which(as.numeric(as.character(X2r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X2r1_prog_map_thresh5_df = X2r1_prog_map_all_df[X2r1_prog_map_thresh5,]
X2r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X2r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X2r1_prog_map_exon_thresh5_df = X2r1_prog_map_exon_all_df[X2r1_prog_map_exon_thresh5,]
X2r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X2r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X2r1_prog_map_CADD_thresh5_df = X2r1_prog_map_CADD_df[X2r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X2r1_prog_var_all_lib_count = length(X2r1_prog_var_all_df$lib)
X2r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X2r1_prog_var_all_min_lib_counts = min(X2r1_prog_var_all_df$lib)
X2r1_prog_var_all_min_lib_counts
X2r1_prog_var_all_max_lib_counts = max(X2r1_prog_var_all_df$lib)
X2r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X2r1_prog_map_all_lib_count = length(X2r1_prog_map_all_df$lib)
X2r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X2r1_prog_map_all_min_lib_counts = min(X2r1_prog_map_all_df$lib)
X2r1_prog_map_all_min_lib_counts
X2r1_prog_map_all_max_lib_counts = max(X2r1_prog_map_all_df$lib)
X2r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X2r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X2r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X2r1_prog_var_all_pre_count = length(X2r1_prog_var_all_df$pre)
X2r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X2r1_prog_var_all_min_pre_counts = min(X2r1_prog_var_all_df$pre)
X2r1_prog_var_all_min_pre_counts
X2r1_prog_var_all_max_pre_counts = max(X2r1_prog_var_all_df$pre)
X2r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X2r1_prog_map_all_pre_count = length(X2r1_prog_map_all_df$pre)
X2r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X2r1_prog_map_all_min_pre_counts = min(X2r1_prog_map_all_df$pre)
X2r1_prog_map_all_min_pre_counts
X2r1_prog_map_all_max_pre_counts = max(X2r1_prog_map_all_df$pre)
X2r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X2r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X2r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X2r1_prog_map_all_post_count = length(X2r1_prog_map_all_df$post)
X2r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X2r1_prog_map_all_min_post_counts = min(X2r1_prog_map_all_df$post)
X2r1_prog_map_all_min_post_counts
X2r1_prog_map_all_max_post_counts = max(X2r1_prog_map_all_df$post)
X2r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X2r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X2r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X2r1_prog_map_all_syn_df <- X2r1_prog_map_all_df[which(X2r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X2r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X2r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X2r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X2r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X2r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X2r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X2r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X2r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X2r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X2r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X2r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X2r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X2r1_prog_map_all_min_rna_counts = min(X2r1_prog_map_exon_all_df$tHDR_rna)
X2r1_prog_map_all_min_rna_counts
X2r1_prog_map_all_max_rna_counts = max(X2r1_prog_map_exon_all_df$tHDR_rna)
X2r1_prog_map_all_max_rna_counts
X2r1_prog_map_all_min_rna_pseudo_freq = min(X2r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2r1_prog_map_all_min_rna_pseudo_freq
X2r1_prog_map_all_max_rna_pseudo_freq = max(X2r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2r1_prog_map_all_max_rna_pseudo_freq
X2r1_prog_map_all_min_rna_pre_ratio = min(X2r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2r1_prog_map_all_min_rna_pre_ratio
X2r1_prog_map_all_max_rna_pre_ratio = max(X2r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2r1_prog_map_all_max_rna_pre_ratio
X2r1_prog_map_all_min_rna_post_ratio = min(X2r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2r1_prog_map_all_min_rna_post_ratio
X2r1_prog_map_all_max_rna_post_ratio = max(X2r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X2r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X2r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X2r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X2r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X2r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X2r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X2r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X2r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X2r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X2r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X2r1_prog_map_all_df$post_pre_ratio),log2(X2r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X2r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X2r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X2r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X2r1_cSNV_all_corr_pre_count = length(X2r1_cSNV_all_df$corr_pre)
X2r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X2r1_cSNV_all_min_corr_pre_counts = min(X2r1_cSNV_all_df$corr_pre)
X2r1_cSNV_all_min_corr_pre_counts
X2r1_cSNV_all_max_corr_pre_counts = max(X2r1_cSNV_all_df$corr_pre)
X2r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X2r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X2r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X2r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X2r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X2r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_cSNV_all_corr_post_count = length(X2r1_cSNV_all_df$corr_post)
X2r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X2r1_cSNV_all_min_corr_post_counts = min(X2r1_cSNV_all_df$corr_post)
X2r1_cSNV_all_min_corr_post_counts
X2r1_cSNV_all_max_corr_post_counts = max(X2r1_cSNV_all_df$corr_post)
X2r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X2r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X2r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X2r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X2r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X2r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X2r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X2_p_hdr_snv = paste('p_hdr_',X2_cut_end,'_snv',sep='')
X2r1_pSNV_all <- which(X2r1[,X2_p_hdr_snv]=='True')
X2r1_pSNV_all_df = X2r1[X2r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_pSNV_all_lib_count = length(X2r1_pSNV_all_df$lib)
X2r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X2r1_pSNV_all_min_lib_counts = min(X2r1_pSNV_all_df$lib)
X2r1_pSNV_all_min_lib_counts
X2r1_pSNV_all_max_lib_counts = max(X2r1_pSNV_all_df$lib)
X2r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X2r1_pSNV_all_pre_count = length(X2r1_pSNV_all_df$pre)
X2r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X2r1_pSNV_all_min_pre_counts = min(X2r1_pSNV_all_df$pre)
X2r1_pSNV_all_min_pre_counts
X2r1_pSNV_all_max_pre_counts = max(X2r1_pSNV_all_df$pre)
X2r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X2r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X2r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_pSNV_all_post_count = length(X2r1_pSNV_all_df$post)
X2r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X2r1_pSNV_all_min_post_counts = min(X2r1_pSNV_all_df$post)
X2r1_pSNV_all_min_post_counts
X2r1_pSNV_all_max_post_counts = max(X2r1_pSNV_all_df$post)
X2r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X2r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X2r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_prog_map_thresh5_lib_count = length(X2r1_prog_map_thresh5_df$lib)
X2r1_prog_map_thresh5_lib_count
X2r1_prog_map_thresh5_min_lib_counts = min(X2r1_prog_map_thresh5_df$lib)
X2r1_prog_map_thresh5_min_lib_counts
X2r1_prog_map_thresh5_max_lib_counts = max(X2r1_prog_map_thresh5_df$lib)
X2r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X2r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X2r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_prog_map_thresh5_pre_count = length(X2r1_prog_map_thresh5_df$pre)
X2r1_prog_map_thresh5_pre_count
X2r1_prog_map_thresh5_min_pre_counts = min(X2r1_prog_map_thresh5_df$pre)
X2r1_prog_map_thresh5_min_pre_counts
X2r1_prog_map_thresh5_max_pre_counts = max(X2r1_prog_map_thresh5_df$pre)
X2r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r1_prog_map_thresh5_post_count = length(X2r1_prog_map_thresh5_df$post)
X2r1_prog_map_thresh5_post_count
X2r1_prog_map_thresh5_min_post_counts = min(X2r1_prog_map_thresh5_df$post)
X2r1_prog_map_thresh5_min_post_counts
X2r1_prog_map_thresh5_max_post_counts = max(X2r1_prog_map_thresh5_df$post)
X2r1_prog_map_thresh5_max_post_counts
X2r1_prog_map_thresh5_corr_post_count = length(X2r1_cSNV_all_df$corr_post)
X2r1_prog_map_thresh5_corr_post_count
X2r1_prog_map_thresh5_min_corr_post_counts = min(X2r1_cSNV_all_df$corr_post)
X2r1_prog_map_thresh5_min_corr_post_counts
X2r1_prog_map_thresh5_max_corr_post_counts = max(X2r1_cSNV_all_df$corr_post)
X2r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X2r1_pSNV_thresh5 <- which(X2r1[,X2_p_hdr_snv]=='True' & as.numeric(as.character(X2r1[,'pre_freq']))>=0.00001)
X2r1_pSNV_thresh5_df = X2r1[X2r1_pSNV_thresh5,]
X2r1_pSNV_thresh5_lib_count = length(X2r1_pSNV_thresh5_df$lib)
X2r1_pSNV_thresh5_lib_count
X2r1_pSNV_thresh5_min_lib_counts = min(X2r1_pSNV_thresh5_df$lib)
X2r1_pSNV_thresh5_min_lib_counts
X2r1_pSNV_thresh5_max_lib_counts = max(X2r1_pSNV_thresh5_df$lib)
X2r1_pSNV_thresh5_max_lib_counts
X2r1_pSNV_thresh5_pre_count = length(X2r1_pSNV_thresh5_df$pre)
X2r1_pSNV_thresh5_pre_count
X2r1_pSNV_thresh5_min_pre_counts = min(X2r1_pSNV_thresh5_df$pre)
X2r1_pSNV_thresh5_min_pre_counts
X2r1_pSNV_thresh5_max_pre_counts = max(X2r1_pSNV_thresh5_df$pre)
X2r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X2r1_pSNV_thresh5_post_count = length(X2r1_pSNV_thresh5_df$post)
X2r1_pSNV_thresh5_post_count
X2r1_pSNV_thresh5_min_post_counts = min(X2r1_pSNV_thresh5_df$post)
X2r1_pSNV_thresh5_min_post_counts
X2r1_pSNV_thresh5_max_post_counts = max(X2r1_pSNV_thresh5_df$post)
X2r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X2r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X2r1_pSNV_thresh5_post_pos

### Replicate 2
X2r2_cSNV_all <- which(X2r2[,'c_hdr_snv']=='True')
X2r2_cSNV_all_df = X2r2[X2r2_cSNV_all,]
X2r2_prog_var_all <- which(X2r2[,'all_hdr_variant']=='True' & X2r2[,'edit_string']!='-WT')
X2r2_prog_var_all_df = X2r2[X2r2_prog_var_all,]
X2r2_prog_map_all = which(X2r2_prog_var_all_df[,'pos']!='REF')
X2r2_prog_map_all_df = X2r2_prog_var_all_df[X2r2_prog_map_all,]
X2r2_prog_map_exon_all = which(X2r2_prog_map_all_df[,'cDNApos']!='REF' & X2r2_prog_map_all_df[,'cDNApos']!='NA')
X2r2_prog_map_exon_all_df = X2r2_prog_map_all_df[X2r2_prog_map_exon_all,]
X2r2_prog_map_CADD = which(X2r2_prog_map_all_df[,'CADD.phred']!='NA')
X2r2_prog_map_CADD_df = X2r2_prog_map_all_df[X2r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X2r2_prog_var_thresh5 <- which(as.numeric(as.character(X2r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X2r2_prog_var_thresh5_df = X2r2_prog_var_all_df[X2r2_prog_var_thresh5,]
X2r2_prog_map_thresh5 <- which(as.numeric(as.character(X2r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X2r2_prog_map_thresh5_df = X2r2_prog_map_all_df[X2r2_prog_map_thresh5,]
X2r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X2r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X2r2_prog_map_exon_thresh5_df = X2r2_prog_map_exon_all_df[X2r2_prog_map_exon_thresh5,]
X2r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X2r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X2r2_prog_map_CADD_thresh5_df = X2r2_prog_map_CADD_df[X2r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X2r2_prog_var_all_lib_count = length(X2r2_prog_var_all_df$lib)
X2r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X2r2_prog_var_all_min_lib_counts = min(X2r2_prog_var_all_df$lib)
X2r2_prog_var_all_min_lib_counts
X2r2_prog_var_all_max_lib_counts = max(X2r2_prog_var_all_df$lib)
X2r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X2r2_prog_map_all_lib_count = length(X2r2_prog_map_all_df$lib)
X2r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X2r2_prog_map_all_min_lib_counts = min(X2r2_prog_map_all_df$lib)
X2r2_prog_map_all_min_lib_counts
X2r2_prog_map_all_max_lib_counts = max(X2r2_prog_map_all_df$lib)
X2r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X2r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X2r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X2r2_prog_var_all_pre_count = length(X2r2_prog_var_all_df$pre)
X2r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X2r2_prog_var_all_min_pre_counts = min(X2r2_prog_var_all_df$pre)
X2r2_prog_var_all_min_pre_counts
X2r2_prog_var_all_max_pre_counts = max(X2r2_prog_var_all_df$pre)
X2r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X2r2_prog_map_all_pre_count = length(X2r2_prog_map_all_df$pre)
X2r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X2r2_prog_map_all_min_pre_counts = min(X2r2_prog_map_all_df$pre)
X2r2_prog_map_all_min_pre_counts
X2r2_prog_map_all_max_pre_counts = max(X2r2_prog_map_all_df$pre)
X2r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X2r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X2r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X2r2_prog_map_all_post_count = length(X2r2_prog_map_all_df$post)
X2r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X2r2_prog_map_all_min_post_counts = min(X2r2_prog_map_all_df$post)
X2r2_prog_map_all_min_post_counts
X2r2_prog_map_all_max_post_counts = max(X2r2_prog_map_all_df$post)
X2r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X2r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X2r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X2r2_prog_map_all_syn_df <- X2r2_prog_map_all_df[which(X2r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X2r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X2r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X2r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X2r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X2r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X2r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X2r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X2r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X2r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X2r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X2r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X2r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X2r2_prog_map_all_min_rna_counts = min(X2r2_prog_map_exon_all_df$tHDR_rna)
X2r2_prog_map_all_min_rna_counts
X2r2_prog_map_all_max_rna_counts = max(X2r2_prog_map_exon_all_df$tHDR_rna)
X2r2_prog_map_all_max_rna_counts
X2r2_prog_map_all_min_rna_pseudo_freq = min(X2r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2r2_prog_map_all_min_rna_pseudo_freq
X2r2_prog_map_all_max_rna_pseudo_freq = max(X2r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2r2_prog_map_all_max_rna_pseudo_freq
X2r2_prog_map_all_min_rna_pre_ratio = min(X2r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2r2_prog_map_all_min_rna_pre_ratio
X2r2_prog_map_all_max_rna_pre_ratio = max(X2r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2r2_prog_map_all_max_rna_pre_ratio
X2r2_prog_map_all_min_rna_post_ratio = min(X2r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2r2_prog_map_all_min_rna_post_ratio
X2r2_prog_map_all_max_rna_post_ratio = max(X2r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X2r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X2r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X2r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X2r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X2r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X2r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X2r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X2r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X2r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X2r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X2r2_prog_map_all_df$post_pre_ratio),log2(X2r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X2r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X2r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X2r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X2r2_cSNV_all_corr_pre_count = length(X2r2_cSNV_all_df$corr_pre)
X2r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X2r2_cSNV_all_min_corr_pre_counts = min(X2r2_cSNV_all_df$corr_pre)
X2r2_cSNV_all_min_corr_pre_counts
X2r2_cSNV_all_max_corr_pre_counts = max(X2r2_cSNV_all_df$corr_pre)
X2r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X2r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X2r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X2r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X2r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X2r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_cSNV_all_corr_post_count = length(X2r2_cSNV_all_df$corr_post)
X2r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X2r2_cSNV_all_min_corr_post_counts = min(X2r2_cSNV_all_df$corr_post)
X2r2_cSNV_all_min_corr_post_counts
X2r2_cSNV_all_max_corr_post_counts = max(X2r2_cSNV_all_df$corr_post)
X2r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X2r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X2r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X2r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X2r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X2r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X2r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X2_p_hdr_snv = paste('p_hdr_',X2_cut_end,'_snv',sep='')
X2r2_pSNV_all <- which(X2r2[,X2_p_hdr_snv]=='True')
X2r2_pSNV_all_df = X2r2[X2r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_pSNV_all_lib_count = length(X2r2_pSNV_all_df$lib)
X2r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X2r2_pSNV_all_min_lib_counts = min(X2r2_pSNV_all_df$lib)
X2r2_pSNV_all_min_lib_counts
X2r2_pSNV_all_max_lib_counts = max(X2r2_pSNV_all_df$lib)
X2r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X2r2_pSNV_all_pre_count = length(X2r2_pSNV_all_df$pre)
X2r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X2r2_pSNV_all_min_pre_counts = min(X2r2_pSNV_all_df$pre)
X2r2_pSNV_all_min_pre_counts
X2r2_pSNV_all_max_pre_counts = max(X2r2_pSNV_all_df$pre)
X2r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X2r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X2r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_pSNV_all_post_count = length(X2r2_pSNV_all_df$post)
X2r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X2r2_pSNV_all_min_post_counts = min(X2r2_pSNV_all_df$post)
X2r2_pSNV_all_min_post_counts
X2r2_pSNV_all_max_post_counts = max(X2r2_pSNV_all_df$post)
X2r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X2r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X2r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_prog_map_thresh5_lib_count = length(X2r2_prog_map_thresh5_df$lib)
X2r2_prog_map_thresh5_lib_count
X2r2_prog_map_thresh5_min_lib_counts = min(X2r2_prog_map_thresh5_df$lib)
X2r2_prog_map_thresh5_min_lib_counts
X2r2_prog_map_thresh5_max_lib_counts = max(X2r2_prog_map_thresh5_df$lib)
X2r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X2r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X2r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_prog_map_thresh5_pre_count = length(X2r2_prog_map_thresh5_df$pre)
X2r2_prog_map_thresh5_pre_count
X2r2_prog_map_thresh5_min_pre_counts = min(X2r2_prog_map_thresh5_df$pre)
X2r2_prog_map_thresh5_min_pre_counts
X2r2_prog_map_thresh5_max_pre_counts = max(X2r2_prog_map_thresh5_df$pre)
X2r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2r2_prog_map_thresh5_post_count = length(X2r2_prog_map_thresh5_df$post)
X2r2_prog_map_thresh5_post_count
X2r2_prog_map_thresh5_min_post_counts = min(X2r2_prog_map_thresh5_df$post)
X2r2_prog_map_thresh5_min_post_counts
X2r2_prog_map_thresh5_max_post_counts = max(X2r2_prog_map_thresh5_df$post)
X2r2_prog_map_thresh5_max_post_counts
X2r2_prog_map_thresh5_corr_post_count = length(X2r2_prog_map_thresh5_df$corr_post)
X2r2_prog_map_thresh5_corr_post_count
X2r2_prog_map_thresh5_min_corr_post_counts = min(X2r2_prog_map_thresh5_df$corr_post)
X2r2_prog_map_thresh5_min_corr_post_counts
X2r2_prog_map_thresh5_max_corr_post_counts = max(X2r2_prog_map_thresh5_df$corr_post)
X2r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X2r2_pSNV_thresh5 <- which(X2r2[,X2_p_hdr_snv]=='True' & as.numeric(as.character(X2r2[,'pre_freq']))>=0.00001)
X2r2_pSNV_thresh5_df = X2r2[X2r2_pSNV_thresh5,]
X2r2_pSNV_thresh5_lib_count = length(X2r2_pSNV_thresh5_df$lib)
X2r2_pSNV_thresh5_lib_count
X2r2_pSNV_thresh5_min_lib_counts = min(X2r2_pSNV_thresh5_df$lib)
X2r2_pSNV_thresh5_min_lib_counts
X2r2_pSNV_thresh5_max_lib_counts = max(X2r2_pSNV_thresh5_df$lib)
X2r2_pSNV_thresh5_max_lib_counts
X2r2_pSNV_thresh5_pre_count = length(X2r2_pSNV_thresh5_df$pre)
X2r2_pSNV_thresh5_pre_count
X2r2_pSNV_thresh5_min_pre_counts = min(X2r2_pSNV_thresh5_df$pre)
X2r2_pSNV_thresh5_min_pre_counts
X2r2_pSNV_thresh5_max_pre_counts = max(X2r2_pSNV_thresh5_df$pre)
X2r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X2r2_pSNV_thresh5_post_count = length(X2r2_pSNV_thresh5_df$post)
X2r2_pSNV_thresh5_post_count
X2r2_pSNV_thresh5_min_post_counts = min(X2r2_pSNV_thresh5_df$post)
X2r2_pSNV_thresh5_min_post_counts
X2r2_pSNV_thresh5_max_post_counts = max(X2r2_pSNV_thresh5_df$post)
X2r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X2r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X2r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X2r1_prog_var_thresh5_df:
X2r1_prog_var_thresh5_df_r2_int <- X2r1_prog_var_thresh5_df[which(X2r1_prog_var_thresh5_df$variant %in% X2r2_prog_var_thresh5_df$variant),]
#Intersection variants of X2r2_prog_var_thresh5_df:
X2r2_prog_var_thresh5_df_r1_int <- X2r2_prog_var_thresh5_df[which(X2r2_prog_var_thresh5_df$variant %in% X2r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X2r1_prog_var_thresh5_df_r2_int_ord <- X2r1_prog_var_thresh5_df_r2_int[order(X2r1_prog_var_thresh5_df_r2_int$variant),]
X2r2_prog_var_thresh5_df_r1_int_ord <- X2r2_prog_var_thresh5_df_r1_int[order(X2r2_prog_var_thresh5_df_r1_int$variant),]

dim(X2r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X2r1r2int_prog_var_thresh5_pre_count <- dim(X2r1_prog_var_thresh5_df_r2_int)[1] 
X2r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X2r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X2r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X2r2_prog_var_thresh5_df_r1_int_ord$pre
X2r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X2r2_prog_var_thresh5_df_r1_int_ord$lib
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X2r2_prog_var_thresh5_df_r1_int_ord$post
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X2r2_prog_var_thresh5_df_r1_int_ord$rna
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X2r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X2r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X2r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$post_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X2r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X2r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X2r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X2r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X2r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X2r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X2r2_prog_var_thresh5_df_r1_int_ord$corr_post
X2r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X2r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X2r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X2r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X2r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X2r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X2r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X2r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X2r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X2r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X2r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X2r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X2r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X2r1_cSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X2r1_cSNV_missense_post_pre_med <- unname(X2r1_cSNV_missense_post_pre_quarts[3])
X2r1_cSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X2r1_cSNV_syn_post_pre_med <- unname(X2r1_cSNV_syn_post_pre_quarts[3])
X2r1_cSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X2r1_cSNV_nonsense_post_pre_med <- unname(X2r1_cSNV_nonsense_post_pre_quarts[3])
X2r1_cSNV_syn_to_non_post_pre_spread <- X2r1_cSNV_syn_post_pre_med - X2r1_cSNV_nonsense_post_pre_med

X2r2_cSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X2r2_cSNV_missense_post_pre_med <- unname(X2r2_cSNV_missense_post_pre_quarts[3])
X2r2_cSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X2r2_cSNV_syn_post_pre_med <- unname(X2r2_cSNV_syn_post_pre_quarts[3])
X2r2_cSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X2r2_cSNV_nonsense_post_pre_med <- unname(X2r2_cSNV_nonsense_post_pre_quarts[3])
X2r2_cSNV_syn_to_non_post_pre_spread <- X2r2_cSNV_syn_post_pre_med - X2r2_cSNV_nonsense_post_pre_med

X2r1r2a_cSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X2r1r2a_cSNV_missense_post_pre_med <- unname(X2r1r2a_cSNV_missense_post_pre_quarts[3])
X2r1r2a_cSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X2r1r2a_cSNV_syn_post_pre_med <- unname(X2r1r2a_cSNV_syn_post_pre_quarts[3])
X2r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X2r1r2a_cSNV_nonsense_post_pre_med <- unname(X2r1r2a_cSNV_nonsense_post_pre_quarts[3])
X2r1r2a_cSNV_syn_to_non_post_pre_spread <- X2r1r2a_cSNV_syn_post_pre_med - X2r1r2a_cSNV_nonsense_post_pre_med

X2r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_cSNV_missense_post_pre_med <- unname(X2r1r2pw_cSNV_missense_post_pre_quarts[3])
X2r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_cSNV_syn_post_pre_med <- unname(X2r1r2pw_cSNV_syn_post_pre_quarts[3])
X2r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_cSNV_nonsense_post_pre_med <- unname(X2r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X2r1r2pw_cSNV_syn_to_non_post_pre_spread <- X2r1r2pw_cSNV_syn_post_pre_med - X2r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X2r1_tSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X2r1_tSNV_missense_post_pre_med <- unname(X2r1_tSNV_missense_post_pre_quarts[3])
X2r1_tSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X2r1_tSNV_syn_post_pre_med <- unname(X2r1_tSNV_syn_post_pre_quarts[3])
X2r1_tSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X2r1_tSNV_nonsense_post_pre_med <- unname(X2r1_tSNV_nonsense_post_pre_quarts[3])
X2r1_tSNV_syn_to_non_post_pre_spread <- X2r1_tSNV_syn_post_pre_med - X2r1_tSNV_nonsense_post_pre_med

X2r2_tSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X2r2_tSNV_missense_post_pre_med <- unname(X2r2_tSNV_missense_post_pre_quarts[3])
X2r2_tSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X2r2_tSNV_syn_post_pre_med <- unname(X2r2_tSNV_syn_post_pre_quarts[3])
X2r2_tSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X2r2_tSNV_nonsense_post_pre_med <- unname(X2r2_tSNV_nonsense_post_pre_quarts[3])
X2r2_tSNV_syn_to_non_post_pre_spread <- X2r2_tSNV_syn_post_pre_med - X2r2_tSNV_nonsense_post_pre_med

X2r1r2a_tSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X2r1r2a_tSNV_missense_post_pre_med <- unname(X2r1r2a_tSNV_missense_post_pre_quarts[3])
X2r1r2a_tSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X2r1r2a_tSNV_syn_post_pre_med <- unname(X2r1r2a_tSNV_syn_post_pre_quarts[3])
X2r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X2r1r2a_tSNV_nonsense_post_pre_med <- unname(X2r1r2a_tSNV_nonsense_post_pre_quarts[3])
X2r1r2a_tSNV_syn_to_non_post_pre_spread <- X2r1r2a_tSNV_syn_post_pre_med - X2r1r2a_tSNV_nonsense_post_pre_med

X2r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_tSNV_missense_post_pre_med <- unname(X2r1r2pw_tSNV_missense_post_pre_quarts[3])
X2r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_tSNV_syn_post_pre_med <- unname(X2r1r2pw_tSNV_syn_post_pre_quarts[3])
X2r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X2r1r2pw_tSNV_nonsense_post_pre_med <- unname(X2r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X2r1r2pw_tSNV_syn_to_non_post_pre_spread <- X2r1r2pw_tSNV_syn_post_pre_med - X2r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X2r1_cSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X2r1_cSNV_missense_post_lib_med <- unname(X2r1_cSNV_missense_post_lib_quarts[3])
X2r1_cSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X2r1_cSNV_syn_post_lib_med <- unname(X2r1_cSNV_syn_post_lib_quarts[3])
X2r1_cSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X2r1_cSNV_nonsense_post_lib_med <- unname(X2r1_cSNV_nonsense_post_lib_quarts[3])
X2r1_cSNV_syn_to_non_post_lib_spread <- X2r1_cSNV_syn_post_lib_med - X2r1_cSNV_nonsense_post_lib_med

X2r2_cSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X2r2_cSNV_missense_post_lib_med <- unname(X2r2_cSNV_missense_post_lib_quarts[3])
X2r2_cSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X2r2_cSNV_syn_post_lib_med <- unname(X2r2_cSNV_syn_post_lib_quarts[3])
X2r2_cSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X2r2_cSNV_nonsense_post_lib_med <- unname(X2r2_cSNV_nonsense_post_lib_quarts[3])
X2r2_cSNV_syn_to_non_post_lib_spread <- X2r2_cSNV_syn_post_lib_med - X2r2_cSNV_nonsense_post_lib_med

X2r1r2a_cSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_missense_post_lib_med <- unname(X2r1r2a_cSNV_missense_post_lib_quarts[3])
X2r1r2a_cSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_syn_post_lib_med <- unname(X2r1r2a_cSNV_syn_post_lib_quarts[3])
X2r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_nonsense_post_lib_med <- unname(X2r1r2a_cSNV_nonsense_post_lib_quarts[3])
X2r1r2a_cSNV_syn_to_non_post_lib_spread <- X2r1r2a_cSNV_syn_post_lib_med - X2r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X2r1_tSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X2r1_tSNV_missense_post_lib_med <- unname(X2r1_tSNV_missense_post_lib_quarts[3])
X2r1_tSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X2r1_tSNV_syn_post_lib_med <- unname(X2r1_tSNV_syn_post_lib_quarts[3])
X2r1_tSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X2r1_tSNV_nonsense_post_lib_med <- unname(X2r1_tSNV_nonsense_post_lib_quarts[3])
X2r1_tSNV_syn_to_non_post_lib_spread <- X2r1_tSNV_syn_post_lib_med - X2r1_tSNV_nonsense_post_lib_med

X2r2_tSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X2r2_tSNV_missense_post_lib_med <- unname(X2r2_tSNV_missense_post_lib_quarts[3])
X2r2_tSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X2r2_tSNV_syn_post_lib_med <- unname(X2r2_tSNV_syn_post_lib_quarts[3])
X2r2_tSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X2r2_tSNV_nonsense_post_lib_med <- unname(X2r2_tSNV_nonsense_post_lib_quarts[3])
X2r2_tSNV_syn_to_non_post_lib_spread <- X2r2_tSNV_syn_post_lib_med - X2r2_tSNV_nonsense_post_lib_med

X2r1r2a_tSNV_missense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_missense_post_lib_med <- unname(X2r1r2a_tSNV_missense_post_lib_quarts[3])
X2r1r2a_tSNV_syn_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_syn_post_lib_med <- unname(X2r1r2a_tSNV_syn_post_lib_quarts[3])
X2r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_nonsense_post_lib_med <- unname(X2r1r2a_tSNV_nonsense_post_lib_quarts[3])
X2r1r2a_tSNV_syn_to_non_post_lib_spread <- X2r1r2a_tSNV_syn_post_lib_med - X2r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X2r1_cSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X2r1_cSNV_missense_pre_lib_med <- unname(X2r1_cSNV_missense_pre_lib_quarts[3])
X2r1_cSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X2r1_cSNV_syn_pre_lib_med <- unname(X2r1_cSNV_syn_pre_lib_quarts[3])
X2r1_cSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X2r1_cSNV_nonsense_pre_lib_med <- unname(X2r1_cSNV_nonsense_pre_lib_quarts[3])
X2r1_cSNV_syn_to_non_pre_lib_spread <- X2r1_cSNV_syn_pre_lib_med - X2r1_cSNV_nonsense_pre_lib_med

X2r2_cSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X2r2_cSNV_missense_pre_lib_med <- unname(X2r2_cSNV_missense_pre_lib_quarts[3])
X2r2_cSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X2r2_cSNV_syn_pre_lib_med <- unname(X2r2_cSNV_syn_pre_lib_quarts[3])
X2r2_cSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X2r2_cSNV_nonsense_pre_lib_med <- unname(X2r2_cSNV_nonsense_pre_lib_quarts[3])
X2r2_cSNV_syn_to_non_pre_lib_spread <- X2r2_cSNV_syn_pre_lib_med - X2r2_cSNV_nonsense_pre_lib_med

X2r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_missense_pre_lib_med <- unname(X2r1r2a_cSNV_missense_pre_lib_quarts[3])
X2r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_syn_pre_lib_med <- unname(X2r1r2a_cSNV_syn_pre_lib_quarts[3])
X2r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X2r1r2a_cSNV_nonsense_pre_lib_med <- unname(X2r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X2r1r2a_cSNV_syn_to_non_pre_lib_spread <- X2r1r2a_cSNV_syn_pre_lib_med - X2r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X2r1_tSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X2r1_tSNV_missense_pre_lib_med <- unname(X2r1_tSNV_missense_pre_lib_quarts[3])
X2r1_tSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X2r1_tSNV_syn_pre_lib_med <- unname(X2r1_tSNV_syn_pre_lib_quarts[3])
X2r1_tSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X2r1_tSNV_nonsense_pre_lib_med <- unname(X2r1_tSNV_nonsense_pre_lib_quarts[3])
X2r1_tSNV_syn_to_non_pre_lib_spread <- X2r1_tSNV_syn_pre_lib_med - X2r1_tSNV_nonsense_pre_lib_med

X2r2_tSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X2r2_tSNV_missense_pre_lib_med <- unname(X2r2_tSNV_missense_pre_lib_quarts[3])
X2r2_tSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X2r2_tSNV_syn_pre_lib_med <- unname(X2r2_tSNV_syn_pre_lib_quarts[3])
X2r2_tSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X2r2_tSNV_nonsense_pre_lib_med <- unname(X2r2_tSNV_nonsense_pre_lib_quarts[3])
X2r2_tSNV_syn_to_non_pre_lib_spread <- X2r2_tSNV_syn_pre_lib_med - X2r2_tSNV_nonsense_pre_lib_med

X2r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_missense_pre_lib_med <- unname(X2r1r2a_tSNV_missense_pre_lib_quarts[3])
X2r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_syn_pre_lib_med <- unname(X2r1r2a_tSNV_syn_pre_lib_quarts[3])
X2r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X2r1r2a_tSNV_nonsense_pre_lib_med <- unname(X2r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X2r1r2a_tSNV_syn_to_non_pre_lib_spread <- X2r1r2a_tSNV_syn_pre_lib_med - X2r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X2r1_tSNV_syn_rna_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X2r1_tSNV_syn_rna_pre_med <- unname(X2r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X2r1_tSNV_syn_rna_post_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X2r1_tSNV_syn_rna_post_med <- unname(X2r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X2r2_tSNV_syn_rna_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X2r2_tSNV_syn_rna_pre_med <- unname(X2r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X2r2_tSNV_syn_rna_post_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X2r2_tSNV_syn_rna_post_med <- unname(X2r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X2r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X2r1r2a_tSNV_syn_rna_pre_med <- unname(X2r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X2r1r2a_tSNV_syn_rna_post_quarts <- quantile(X2r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X2r1r2a_tSNV_syn_rna_post_med <- unname(X2r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X2r1_cSNV_syn_pre_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X2r1_cSNV_syn_post_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X2r1_cSNV_syn_post_lib_med
# tHDR
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X2r1_tSNV_syn_pre_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X2r1_tSNV_syn_post_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X2r1_tSNV_syn_post_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X2r1_tSNV_syn_rna_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X2r1_tSNV_syn_rna_post_med

#r2
X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X2r2_cSNV_syn_pre_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X2r2_cSNV_syn_post_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X2r2_cSNV_syn_post_lib_med
# tHDR
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X2r2_tSNV_syn_pre_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X2r2_tSNV_syn_post_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X2r2_tSNV_syn_post_lib_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X2r2_tSNV_syn_rna_pre_med
X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X2r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X2r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X2r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X2r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X2r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X2r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X2r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X2r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X2r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X2r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X2r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X2r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X2r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X2r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X2r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X2r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X2r1_prog_var_thresh5_df_r2_int_ord[which(X2r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X2r1_prog_var_thresh5_df_r2_int_ord
X2r1_prog_map_thresh5_df_r2_int_ord = which(X2r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X2r1_prog_map_thresh5_df_r2_int_ord_df = X2r1_prog_var_thresh5_df_r2_int_ord[X2r1_prog_map_thresh5_df_r2_int_ord,]
X2r1_prog_map_exon_thresh5_df_r2_int_ord = which(X2r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X2r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X2r1_prog_map_exon_thresh5_df_r2_int_ord_df = X2r1_prog_map_thresh5_df_r2_int_ord_df[X2r1_prog_map_exon_thresh5_df_r2_int_ord,]
X2r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X2r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X2r1_prog_map_thresh5_df_r2_int_ord_df[X2r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X2r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X2r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X2r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X2r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X2r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X2r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X2r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X2r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X2r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X2r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X2r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X2r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X2r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X2r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X2r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X2r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X2r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X2r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X2r1r2_cSNV_r1_post_by_r2_post_cor_s
X2r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X2r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X2r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X2r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X2r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X2r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X2r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X2r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X2r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X2r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X2r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X2r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X2r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X2r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X2r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X2r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X2r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X2r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1_cSNV_post_pre_by_cadd_cor_s
#X2r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X2r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r2_cSNV_post_pre_by_cadd_cor_s

#X2r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X2r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1_cSNV_post_lib_by_cadd_cor_s
#X2r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X2r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X2r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X2r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1_tSNV_post_pre_by_cadd_cor_s
#X2r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X2r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r2_tSNV_post_pre_by_cadd_cor_s

#X2r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X2r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1_tSNV_post_lib_by_cadd_cor_s
#X2r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X2r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X2r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X2r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X2r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X2r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X2r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X2r1_prog_var_all_lib_count
X2r1_prog_var_all_pre_count
X2r2_prog_var_all_pre_count
X2r1_prog_map_thresh5_lib_count
X2r1_prog_map_thresh5_pre_count
X2r2_prog_map_thresh5_pre_count
X2r1_prog_map_thresh5_post_count
X2r2_prog_map_thresh5_post_count
X2r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X2r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X2r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X2r1r2_cSNV_r1_post_by_r2_post_cor_s
X2r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X2r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X2r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X2r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X2r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X2r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X2r1_cSNV_post_pre_by_cadd_cor_s
X2r2_cSNV_post_pre_by_cadd_cor_s
X2r1_cSNV_post_lib_by_cadd_cor_s
X2r2_cSNV_post_lib_by_cadd_cor_s
X2r1_tSNV_post_pre_by_cadd_cor_s
X2r2_tSNV_post_pre_by_cadd_cor_s
X2r1_tSNV_post_lib_by_cadd_cor_s
X2r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X2r1r2a_cSNV_post_pre_by_cadd_cor_s
X2r1r2w_cSNV_post_pre_by_cadd_cor_s
X2r1r2a_cSNV_post_lib_by_cadd_cor_s
X2r1r2w_cSNV_post_lib_by_cadd_cor_s
X2r1r2a_tSNV_post_pre_by_cadd_cor_s
X2r1r2w_tSNV_post_pre_by_cadd_cor_s
X2r1r2a_tSNV_post_lib_by_cadd_cor_s
X2r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X2r1_cSNV_syn_to_non_post_pre_spread
X2r2_cSNV_syn_to_non_post_pre_spread
X2r1r2a_cSNV_syn_to_non_post_pre_spread
X2r1_cSNV_syn_to_non_post_lib_spread
X2r2_cSNV_syn_to_non_post_lib_spread
X2r1r2a_cSNV_syn_to_non_post_lib_spread
X2r1_tSNV_syn_to_non_post_pre_spread
X2r2_tSNV_syn_to_non_post_pre_spread
X2r1r2a_tSNV_syn_to_non_post_pre_spread
X2r1_tSNV_syn_to_non_post_lib_spread
X2r2_tSNV_syn_to_non_post_lib_spread
X2r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X2r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X2r1_prog_map_thresh5_df_r2_int_ord_df[which(X2r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X2r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df[which(X2r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df[which(X2r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df[which(X2r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X2r1_cSNV_pre_lib_cors = cor(log2(X2r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X2r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2r1_tSNV_pre_lib_cors = cor(log2(X2r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2r1_cSNV_post_lib_cors = cor(log2(X2r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X2r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X2r1_tSNV_post_lib_cors = cor(log2(X2r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X2r1_cSNV_post_pre_cors = cor(log2(X2r1_prog_map_thresh5_df$post_pseudo_freq),log2(X2r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2r1_tSNV_post_pre_cors = cor(log2(X2r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X2r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2r1_cSNV_rna_lib_cors = cor(log2(X2r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X2r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2r1_tSNV_rna_lib_cors = cor(log2(X2r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X2r1_cSNV_rna_pre_cors = cor(log2(X2r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X2r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2r1_tSNV_rna_pre_cors = cor(log2(X2r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X2r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2r1r2_cSNV_pre_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X2r1r2_tSNV_pre_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X2r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X2r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X2r1r2_cSNV_post_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X2r1r2_tSNV_post_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X2r1r2_cSNV_post_lib_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X2r1r2_tSNV_post_lib_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X2r1r2_cSNV_post_pre_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X2r1r2_tSNV_post_pre_ratio_cors = cor(log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X2r1r2_cSNV_rna_cors = cor(log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X2r1r2_tSNV_rna_cors = cor(log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X2r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X2r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X2r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X2r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X2r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X2r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X2r1_cors <- c("X2r1",X2r1_cSNV_pre_lib_cors,X2r1_tSNV_pre_lib_cors,X2r1_cSNV_post_lib_cors,X2r1_tSNV_post_lib_cors,X2r1_cSNV_post_pre_cors,X2r1_tSNV_post_pre_cors,X2r1_cSNV_rna_lib_cors,X2r1_tSNV_rna_lib_cors,X2r1_cSNV_rna_pre_cors,X2r1_tSNV_rna_pre_cors,X2r1r2_cSNV_pre_cors,X2r1r2_tSNV_pre_cors,X2r1r2_cSNV_pre_lib_ratio_cors,X2r1r2_tSNV_pre_lib_ratio_cors,X2r1r2_cSNV_post_cors,X2r1r2_tSNV_post_cors,X2r1r2_cSNV_post_lib_ratio_cors,X2r1r2_tSNV_post_lib_ratio_cors,X2r1r2_cSNV_post_pre_ratio_cors,X2r1r2_tSNV_post_pre_ratio_cors,X2r1r2_cSNV_rna_cors,X2r1r2_tSNV_rna_cors,X2r1r2_tSNV_rna_pre_ratio_cors,X2r1_cSNV_pre_lib_ratio_cadd_cors,X2r1_tSNV_pre_lib_ratio_cadd_cors,X2r1_cSNV_post_lib_ratio_cadd_cors,X2r1_tSNV_post_lib_ratio_cadd_cors,X2r1_cSNV_post_pre_ratio_cadd_cors,X2r1_tSNV_post_pre_ratio_cadd_cors,X2r1_cSNV_post_pre_ratio_cadd_missense_cors,X2r1_tSNV_post_pre_ratio_cadd_missense_cors,X2r1_cSNV_post_pre_ratio_polyphen_missense_cors,X2r1_tSNV_post_pre_ratio_polyphen_missense_cors,X2r1_cSNV_post_pre_ratio_grantham_missense_cors,X2r1_tSNV_post_pre_ratio_grantham_missense_cors,X2r1r2a_cSNV_pre_lib_ratio_cadd_cors,X2r1r2a_tSNV_pre_lib_ratio_cadd_cors,X2r1r2a_cSNV_post_lib_ratio_cadd_cors,X2r1r2a_tSNV_post_lib_ratio_cadd_cors,X2r1r2a_cSNV_post_pre_ratio_cadd_cors,X2r1r2a_tSNV_post_pre_ratio_cadd_cors,X2r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X2r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X2r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X2r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X2r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X2r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X2r1r2w_cSNV_pre_lib_ratio_cadd_cors,X2r1r2w_cSNV_post_lib_ratio_cadd_cors,X2r1r2w_cSNV_post_pre_ratio_cadd_cors,X2r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X2r2_cSNV_pre_lib_cors = cor(log2(X2r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X2r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2r2_tSNV_pre_lib_cors = cor(log2(X2r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2r2_cSNV_post_lib_cors = cor(log2(X2r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X2r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X2r2_tSNV_post_lib_cors = cor(log2(X2r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X2r2_cSNV_post_pre_cors = cor(log2(X2r2_prog_map_thresh5_df$post_pseudo_freq),log2(X2r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2r2_tSNV_post_pre_cors = cor(log2(X2r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X2r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2r2_cSNV_rna_lib_cors = cor(log2(X2r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X2r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2r2_tSNV_rna_lib_cors = cor(log2(X2r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X2r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X2r2_cSNV_rna_pre_cors = cor(log2(X2r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X2r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2r2_tSNV_rna_pre_cors = cor(log2(X2r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X2r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X2r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X2r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X2r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X2r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X2r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X2r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X2r2_cors <- c("X2r2",X2r2_cSNV_pre_lib_cors,X2r2_tSNV_pre_lib_cors,X2r2_cSNV_post_lib_cors,X2r2_tSNV_post_lib_cors,X2r2_cSNV_post_pre_cors,X2r2_tSNV_post_pre_cors,X2r2_cSNV_rna_lib_cors,X2r2_tSNV_rna_lib_cors,X2r2_cSNV_rna_pre_cors,X2r2_tSNV_rna_pre_cors,X2r1r2_cSNV_pre_cors,X2r1r2_tSNV_pre_cors,X2r1r2_cSNV_pre_lib_ratio_cors,X2r1r2_tSNV_pre_lib_ratio_cors,X2r1r2_cSNV_post_cors,X2r1r2_tSNV_post_cors,X2r1r2_cSNV_post_lib_ratio_cors,X2r1r2_tSNV_post_lib_ratio_cors,X2r1r2_cSNV_post_pre_ratio_cors,X2r1r2_tSNV_post_pre_ratio_cors,X2r1r2_cSNV_rna_cors,X2r1r2_tSNV_rna_cors,X2r1r2_tSNV_rna_pre_ratio_cors,X2r2_cSNV_pre_lib_ratio_cadd_cors,X2r2_tSNV_pre_lib_ratio_cadd_cors,X2r2_cSNV_post_lib_ratio_cadd_cors,X2r2_tSNV_post_lib_ratio_cadd_cors,X2r2_cSNV_post_pre_ratio_cadd_cors,X2r2_tSNV_post_pre_ratio_cadd_cors,X2r2_cSNV_post_pre_ratio_cadd_missense_cors,X2r2_tSNV_post_pre_ratio_cadd_missense_cors,X2r2_cSNV_post_pre_ratio_polyphen_missense_cors,X2r2_tSNV_post_pre_ratio_polyphen_missense_cors,X2r2_cSNV_post_pre_ratio_grantham_missense_cors,X2r2_tSNV_post_pre_ratio_grantham_missense_cors,X2r1r2a_cSNV_pre_lib_ratio_cadd_cors,X2r1r2a_tSNV_pre_lib_ratio_cadd_cors,X2r1r2a_cSNV_post_lib_ratio_cadd_cors,X2r1r2a_tSNV_post_lib_ratio_cadd_cors,X2r1r2a_cSNV_post_pre_ratio_cadd_cors,X2r1r2a_tSNV_post_pre_ratio_cadd_cors,X2r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X2r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X2r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X2r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X2r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X2r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X2r1r2w_cSNV_pre_lib_ratio_cadd_cors,X2r1r2w_cSNV_post_lib_ratio_cadd_cors,X2r1r2w_cSNV_post_pre_ratio_cadd_cors,X2r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X2r1)
rm(X2r2)
gc()

X3r1_file <- paste(experiment_dir_171011,'X3r1','_annotated.txt',sep='')
X3r2_file <- paste(experiment_dir_171011,'X3r2','_annotated.txt',sep='')
X3r1 <- read.table(X3r1_file, header=TRUE, sep="\t")
X3r2 <- read.table(X3r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X3 <- editing_info[which(editing_info$amplicon == 'X3'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X3_HDR_5_SNV = as.character(editing_info_X3$HDR_5_SNV)
X3_HDR_3_SNV = as.character(editing_info_X3$HDR_3_SNV)
#X3_cut_pos = as.character(editing_info_X3$cut_pos)
X3_cut_end = as.character(editing_info_X3$cut_end)
X3_mut_start = as.character(editing_info_X3$mut_start)
X3_mut_end = as.character(editing_info_X3$mut_end)
### Replicate 1
X3r1_cSNV_all <- which(X3r1[,'c_hdr_snv']=='True')
X3r1_cSNV_all_df = X3r1[X3r1_cSNV_all,]
X3r1_prog_var_all <- which(X3r1[,'all_hdr_variant']=='True' & X3r1[,'edit_string']!='-WT')
X3r1_prog_var_all_df = X3r1[X3r1_prog_var_all,]
X3r1_prog_map_all = which(X3r1_prog_var_all_df[,'pos']!='REF')
X3r1_prog_map_all_df = X3r1_prog_var_all_df[X3r1_prog_map_all,]
X3r1_prog_map_exon_all = which(X3r1_prog_map_all_df[,'cDNApos']!='REF' & X3r1_prog_map_all_df[,'cDNApos']!='NA')
X3r1_prog_map_exon_all_df = X3r1_prog_map_all_df[X3r1_prog_map_exon_all,]
X3r1_prog_map_CADD = which(X3r1_prog_map_all_df[,'CADD.phred']!='NA')
X3r1_prog_map_CADD_df = X3r1_prog_map_all_df[X3r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X3r1_prog_var_thresh5 <- which(as.numeric(as.character(X3r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X3r1_prog_var_thresh5_df = X3r1_prog_var_all_df[X3r1_prog_var_thresh5,]
X3r1_prog_map_thresh5 <- which(as.numeric(as.character(X3r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X3r1_prog_map_thresh5_df = X3r1_prog_map_all_df[X3r1_prog_map_thresh5,]
X3r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X3r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X3r1_prog_map_exon_thresh5_df = X3r1_prog_map_exon_all_df[X3r1_prog_map_exon_thresh5,]
X3r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X3r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X3r1_prog_map_CADD_thresh5_df = X3r1_prog_map_CADD_df[X3r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X3r1_prog_var_all_lib_count = length(X3r1_prog_var_all_df$lib)
X3r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X3r1_prog_var_all_min_lib_counts = min(X3r1_prog_var_all_df$lib)
X3r1_prog_var_all_min_lib_counts
X3r1_prog_var_all_max_lib_counts = max(X3r1_prog_var_all_df$lib)
X3r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X3r1_prog_map_all_lib_count = length(X3r1_prog_map_all_df$lib)
X3r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X3r1_prog_map_all_min_lib_counts = min(X3r1_prog_map_all_df$lib)
X3r1_prog_map_all_min_lib_counts
X3r1_prog_map_all_max_lib_counts = max(X3r1_prog_map_all_df$lib)
X3r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X3r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X3r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X3r1_prog_var_all_pre_count = length(X3r1_prog_var_all_df$pre)
X3r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X3r1_prog_var_all_min_pre_counts = min(X3r1_prog_var_all_df$pre)
X3r1_prog_var_all_min_pre_counts
X3r1_prog_var_all_max_pre_counts = max(X3r1_prog_var_all_df$pre)
X3r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X3r1_prog_map_all_pre_count = length(X3r1_prog_map_all_df$pre)
X3r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X3r1_prog_map_all_min_pre_counts = min(X3r1_prog_map_all_df$pre)
X3r1_prog_map_all_min_pre_counts
X3r1_prog_map_all_max_pre_counts = max(X3r1_prog_map_all_df$pre)
X3r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X3r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X3r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X3r1_prog_map_all_post_count = length(X3r1_prog_map_all_df$post)
X3r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X3r1_prog_map_all_min_post_counts = min(X3r1_prog_map_all_df$post)
X3r1_prog_map_all_min_post_counts
X3r1_prog_map_all_max_post_counts = max(X3r1_prog_map_all_df$post)
X3r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X3r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X3r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X3r1_prog_map_all_syn_df <- X3r1_prog_map_all_df[which(X3r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X3r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X3r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X3r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X3r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X3r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X3r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X3r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X3r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X3r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X3r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X3r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X3r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X3r1_prog_map_all_min_rna_counts = min(X3r1_prog_map_exon_all_df$tHDR_rna)
X3r1_prog_map_all_min_rna_counts
X3r1_prog_map_all_max_rna_counts = max(X3r1_prog_map_exon_all_df$tHDR_rna)
X3r1_prog_map_all_max_rna_counts
X3r1_prog_map_all_min_rna_pseudo_freq = min(X3r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3r1_prog_map_all_min_rna_pseudo_freq
X3r1_prog_map_all_max_rna_pseudo_freq = max(X3r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3r1_prog_map_all_max_rna_pseudo_freq
X3r1_prog_map_all_min_rna_pre_ratio = min(X3r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3r1_prog_map_all_min_rna_pre_ratio
X3r1_prog_map_all_max_rna_pre_ratio = max(X3r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3r1_prog_map_all_max_rna_pre_ratio
X3r1_prog_map_all_min_rna_post_ratio = min(X3r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3r1_prog_map_all_min_rna_post_ratio
X3r1_prog_map_all_max_rna_post_ratio = max(X3r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X3r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X3r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X3r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X3r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X3r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X3r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X3r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X3r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X3r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X3r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X3r1_prog_map_all_df$post_pre_ratio),log2(X3r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X3r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X3r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X3r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X3r1_cSNV_all_corr_pre_count = length(X3r1_cSNV_all_df$corr_pre)
X3r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X3r1_cSNV_all_min_corr_pre_counts = min(X3r1_cSNV_all_df$corr_pre)
X3r1_cSNV_all_min_corr_pre_counts
X3r1_cSNV_all_max_corr_pre_counts = max(X3r1_cSNV_all_df$corr_pre)
X3r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X3r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X3r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X3r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X3r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X3r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_cSNV_all_corr_post_count = length(X3r1_cSNV_all_df$corr_post)
X3r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X3r1_cSNV_all_min_corr_post_counts = min(X3r1_cSNV_all_df$corr_post)
X3r1_cSNV_all_min_corr_post_counts
X3r1_cSNV_all_max_corr_post_counts = max(X3r1_cSNV_all_df$corr_post)
X3r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X3r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X3r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X3r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X3r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X3r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X3r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X3_p_hdr_snv = paste('p_hdr_',X3_cut_end,'_snv',sep='')
X3r1_pSNV_all <- which(X3r1[,X3_p_hdr_snv]=='True')
X3r1_pSNV_all_df = X3r1[X3r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_pSNV_all_lib_count = length(X3r1_pSNV_all_df$lib)
X3r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X3r1_pSNV_all_min_lib_counts = min(X3r1_pSNV_all_df$lib)
X3r1_pSNV_all_min_lib_counts
X3r1_pSNV_all_max_lib_counts = max(X3r1_pSNV_all_df$lib)
X3r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X3r1_pSNV_all_pre_count = length(X3r1_pSNV_all_df$pre)
X3r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X3r1_pSNV_all_min_pre_counts = min(X3r1_pSNV_all_df$pre)
X3r1_pSNV_all_min_pre_counts
X3r1_pSNV_all_max_pre_counts = max(X3r1_pSNV_all_df$pre)
X3r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X3r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X3r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_pSNV_all_post_count = length(X3r1_pSNV_all_df$post)
X3r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X3r1_pSNV_all_min_post_counts = min(X3r1_pSNV_all_df$post)
X3r1_pSNV_all_min_post_counts
X3r1_pSNV_all_max_post_counts = max(X3r1_pSNV_all_df$post)
X3r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X3r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X3r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_prog_map_thresh5_lib_count = length(X3r1_prog_map_thresh5_df$lib)
X3r1_prog_map_thresh5_lib_count
X3r1_prog_map_thresh5_min_lib_counts = min(X3r1_prog_map_thresh5_df$lib)
X3r1_prog_map_thresh5_min_lib_counts
X3r1_prog_map_thresh5_max_lib_counts = max(X3r1_prog_map_thresh5_df$lib)
X3r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X3r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X3r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_prog_map_thresh5_pre_count = length(X3r1_prog_map_thresh5_df$pre)
X3r1_prog_map_thresh5_pre_count
X3r1_prog_map_thresh5_min_pre_counts = min(X3r1_prog_map_thresh5_df$pre)
X3r1_prog_map_thresh5_min_pre_counts
X3r1_prog_map_thresh5_max_pre_counts = max(X3r1_prog_map_thresh5_df$pre)
X3r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r1_prog_map_thresh5_post_count = length(X3r1_prog_map_thresh5_df$post)
X3r1_prog_map_thresh5_post_count
X3r1_prog_map_thresh5_min_post_counts = min(X3r1_prog_map_thresh5_df$post)
X3r1_prog_map_thresh5_min_post_counts
X3r1_prog_map_thresh5_max_post_counts = max(X3r1_prog_map_thresh5_df$post)
X3r1_prog_map_thresh5_max_post_counts
X3r1_prog_map_thresh5_corr_post_count = length(X3r1_cSNV_all_df$corr_post)
X3r1_prog_map_thresh5_corr_post_count
X3r1_prog_map_thresh5_min_corr_post_counts = min(X3r1_cSNV_all_df$corr_post)
X3r1_prog_map_thresh5_min_corr_post_counts
X3r1_prog_map_thresh5_max_corr_post_counts = max(X3r1_cSNV_all_df$corr_post)
X3r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X3r1_pSNV_thresh5 <- which(X3r1[,X3_p_hdr_snv]=='True' & as.numeric(as.character(X3r1[,'pre_freq']))>=0.00001)
X3r1_pSNV_thresh5_df = X3r1[X3r1_pSNV_thresh5,]
X3r1_pSNV_thresh5_lib_count = length(X3r1_pSNV_thresh5_df$lib)
X3r1_pSNV_thresh5_lib_count
X3r1_pSNV_thresh5_min_lib_counts = min(X3r1_pSNV_thresh5_df$lib)
X3r1_pSNV_thresh5_min_lib_counts
X3r1_pSNV_thresh5_max_lib_counts = max(X3r1_pSNV_thresh5_df$lib)
X3r1_pSNV_thresh5_max_lib_counts
X3r1_pSNV_thresh5_pre_count = length(X3r1_pSNV_thresh5_df$pre)
X3r1_pSNV_thresh5_pre_count
X3r1_pSNV_thresh5_min_pre_counts = min(X3r1_pSNV_thresh5_df$pre)
X3r1_pSNV_thresh5_min_pre_counts
X3r1_pSNV_thresh5_max_pre_counts = max(X3r1_pSNV_thresh5_df$pre)
X3r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X3r1_pSNV_thresh5_post_count = length(X3r1_pSNV_thresh5_df$post)
X3r1_pSNV_thresh5_post_count
X3r1_pSNV_thresh5_min_post_counts = min(X3r1_pSNV_thresh5_df$post)
X3r1_pSNV_thresh5_min_post_counts
X3r1_pSNV_thresh5_max_post_counts = max(X3r1_pSNV_thresh5_df$post)
X3r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X3r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X3r1_pSNV_thresh5_post_pos

### Replicate 2
X3r2_cSNV_all <- which(X3r2[,'c_hdr_snv']=='True')
X3r2_cSNV_all_df = X3r2[X3r2_cSNV_all,]
X3r2_prog_var_all <- which(X3r2[,'all_hdr_variant']=='True' & X3r2[,'edit_string']!='-WT')
X3r2_prog_var_all_df = X3r2[X3r2_prog_var_all,]
X3r2_prog_map_all = which(X3r2_prog_var_all_df[,'pos']!='REF')
X3r2_prog_map_all_df = X3r2_prog_var_all_df[X3r2_prog_map_all,]
X3r2_prog_map_exon_all = which(X3r2_prog_map_all_df[,'cDNApos']!='REF' & X3r2_prog_map_all_df[,'cDNApos']!='NA')
X3r2_prog_map_exon_all_df = X3r2_prog_map_all_df[X3r2_prog_map_exon_all,]
X3r2_prog_map_CADD = which(X3r2_prog_map_all_df[,'CADD.phred']!='NA')
X3r2_prog_map_CADD_df = X3r2_prog_map_all_df[X3r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X3r2_prog_var_thresh5 <- which(as.numeric(as.character(X3r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X3r2_prog_var_thresh5_df = X3r2_prog_var_all_df[X3r2_prog_var_thresh5,]
X3r2_prog_map_thresh5 <- which(as.numeric(as.character(X3r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X3r2_prog_map_thresh5_df = X3r2_prog_map_all_df[X3r2_prog_map_thresh5,]
X3r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X3r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X3r2_prog_map_exon_thresh5_df = X3r2_prog_map_exon_all_df[X3r2_prog_map_exon_thresh5,]
X3r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X3r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X3r2_prog_map_CADD_thresh5_df = X3r2_prog_map_CADD_df[X3r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X3r2_prog_var_all_lib_count = length(X3r2_prog_var_all_df$lib)
X3r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X3r2_prog_var_all_min_lib_counts = min(X3r2_prog_var_all_df$lib)
X3r2_prog_var_all_min_lib_counts
X3r2_prog_var_all_max_lib_counts = max(X3r2_prog_var_all_df$lib)
X3r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X3r2_prog_map_all_lib_count = length(X3r2_prog_map_all_df$lib)
X3r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X3r2_prog_map_all_min_lib_counts = min(X3r2_prog_map_all_df$lib)
X3r2_prog_map_all_min_lib_counts
X3r2_prog_map_all_max_lib_counts = max(X3r2_prog_map_all_df$lib)
X3r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X3r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X3r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X3r2_prog_var_all_pre_count = length(X3r2_prog_var_all_df$pre)
X3r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X3r2_prog_var_all_min_pre_counts = min(X3r2_prog_var_all_df$pre)
X3r2_prog_var_all_min_pre_counts
X3r2_prog_var_all_max_pre_counts = max(X3r2_prog_var_all_df$pre)
X3r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X3r2_prog_map_all_pre_count = length(X3r2_prog_map_all_df$pre)
X3r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X3r2_prog_map_all_min_pre_counts = min(X3r2_prog_map_all_df$pre)
X3r2_prog_map_all_min_pre_counts
X3r2_prog_map_all_max_pre_counts = max(X3r2_prog_map_all_df$pre)
X3r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X3r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X3r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X3r2_prog_map_all_post_count = length(X3r2_prog_map_all_df$post)
X3r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X3r2_prog_map_all_min_post_counts = min(X3r2_prog_map_all_df$post)
X3r2_prog_map_all_min_post_counts
X3r2_prog_map_all_max_post_counts = max(X3r2_prog_map_all_df$post)
X3r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X3r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X3r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X3r2_prog_map_all_syn_df <- X3r2_prog_map_all_df[which(X3r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X3r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X3r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X3r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X3r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X3r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X3r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X3r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X3r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X3r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X3r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X3r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X3r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X3r2_prog_map_all_min_rna_counts = min(X3r2_prog_map_exon_all_df$tHDR_rna)
X3r2_prog_map_all_min_rna_counts
X3r2_prog_map_all_max_rna_counts = max(X3r2_prog_map_exon_all_df$tHDR_rna)
X3r2_prog_map_all_max_rna_counts
X3r2_prog_map_all_min_rna_pseudo_freq = min(X3r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3r2_prog_map_all_min_rna_pseudo_freq
X3r2_prog_map_all_max_rna_pseudo_freq = max(X3r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3r2_prog_map_all_max_rna_pseudo_freq
X3r2_prog_map_all_min_rna_pre_ratio = min(X3r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3r2_prog_map_all_min_rna_pre_ratio
X3r2_prog_map_all_max_rna_pre_ratio = max(X3r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3r2_prog_map_all_max_rna_pre_ratio
X3r2_prog_map_all_min_rna_post_ratio = min(X3r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3r2_prog_map_all_min_rna_post_ratio
X3r2_prog_map_all_max_rna_post_ratio = max(X3r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X3r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X3r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X3r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X3r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X3r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X3r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X3r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X3r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X3r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X3r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X3r2_prog_map_all_df$post_pre_ratio),log2(X3r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X3r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X3r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X3r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X3r2_cSNV_all_corr_pre_count = length(X3r2_cSNV_all_df$corr_pre)
X3r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X3r2_cSNV_all_min_corr_pre_counts = min(X3r2_cSNV_all_df$corr_pre)
X3r2_cSNV_all_min_corr_pre_counts
X3r2_cSNV_all_max_corr_pre_counts = max(X3r2_cSNV_all_df$corr_pre)
X3r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X3r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X3r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X3r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X3r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X3r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_cSNV_all_corr_post_count = length(X3r2_cSNV_all_df$corr_post)
X3r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X3r2_cSNV_all_min_corr_post_counts = min(X3r2_cSNV_all_df$corr_post)
X3r2_cSNV_all_min_corr_post_counts
X3r2_cSNV_all_max_corr_post_counts = max(X3r2_cSNV_all_df$corr_post)
X3r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X3r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X3r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X3r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X3r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X3r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X3r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X3_p_hdr_snv = paste('p_hdr_',X3_cut_end,'_snv',sep='')
X3r2_pSNV_all <- which(X3r2[,X3_p_hdr_snv]=='True')
X3r2_pSNV_all_df = X3r2[X3r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_pSNV_all_lib_count = length(X3r2_pSNV_all_df$lib)
X3r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X3r2_pSNV_all_min_lib_counts = min(X3r2_pSNV_all_df$lib)
X3r2_pSNV_all_min_lib_counts
X3r2_pSNV_all_max_lib_counts = max(X3r2_pSNV_all_df$lib)
X3r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X3r2_pSNV_all_pre_count = length(X3r2_pSNV_all_df$pre)
X3r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X3r2_pSNV_all_min_pre_counts = min(X3r2_pSNV_all_df$pre)
X3r2_pSNV_all_min_pre_counts
X3r2_pSNV_all_max_pre_counts = max(X3r2_pSNV_all_df$pre)
X3r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X3r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X3r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_pSNV_all_post_count = length(X3r2_pSNV_all_df$post)
X3r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X3r2_pSNV_all_min_post_counts = min(X3r2_pSNV_all_df$post)
X3r2_pSNV_all_min_post_counts
X3r2_pSNV_all_max_post_counts = max(X3r2_pSNV_all_df$post)
X3r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X3r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X3r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_prog_map_thresh5_lib_count = length(X3r2_prog_map_thresh5_df$lib)
X3r2_prog_map_thresh5_lib_count
X3r2_prog_map_thresh5_min_lib_counts = min(X3r2_prog_map_thresh5_df$lib)
X3r2_prog_map_thresh5_min_lib_counts
X3r2_prog_map_thresh5_max_lib_counts = max(X3r2_prog_map_thresh5_df$lib)
X3r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X3r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X3r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_prog_map_thresh5_pre_count = length(X3r2_prog_map_thresh5_df$pre)
X3r2_prog_map_thresh5_pre_count
X3r2_prog_map_thresh5_min_pre_counts = min(X3r2_prog_map_thresh5_df$pre)
X3r2_prog_map_thresh5_min_pre_counts
X3r2_prog_map_thresh5_max_pre_counts = max(X3r2_prog_map_thresh5_df$pre)
X3r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3r2_prog_map_thresh5_post_count = length(X3r2_prog_map_thresh5_df$post)
X3r2_prog_map_thresh5_post_count
X3r2_prog_map_thresh5_min_post_counts = min(X3r2_prog_map_thresh5_df$post)
X3r2_prog_map_thresh5_min_post_counts
X3r2_prog_map_thresh5_max_post_counts = max(X3r2_prog_map_thresh5_df$post)
X3r2_prog_map_thresh5_max_post_counts
X3r2_prog_map_thresh5_corr_post_count = length(X3r2_prog_map_thresh5_df$corr_post)
X3r2_prog_map_thresh5_corr_post_count
X3r2_prog_map_thresh5_min_corr_post_counts = min(X3r2_prog_map_thresh5_df$corr_post)
X3r2_prog_map_thresh5_min_corr_post_counts
X3r2_prog_map_thresh5_max_corr_post_counts = max(X3r2_prog_map_thresh5_df$corr_post)
X3r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X3r2_pSNV_thresh5 <- which(X3r2[,X3_p_hdr_snv]=='True' & as.numeric(as.character(X3r2[,'pre_freq']))>=0.00001)
X3r2_pSNV_thresh5_df = X3r2[X3r2_pSNV_thresh5,]
X3r2_pSNV_thresh5_lib_count = length(X3r2_pSNV_thresh5_df$lib)
X3r2_pSNV_thresh5_lib_count
X3r2_pSNV_thresh5_min_lib_counts = min(X3r2_pSNV_thresh5_df$lib)
X3r2_pSNV_thresh5_min_lib_counts
X3r2_pSNV_thresh5_max_lib_counts = max(X3r2_pSNV_thresh5_df$lib)
X3r2_pSNV_thresh5_max_lib_counts
X3r2_pSNV_thresh5_pre_count = length(X3r2_pSNV_thresh5_df$pre)
X3r2_pSNV_thresh5_pre_count
X3r2_pSNV_thresh5_min_pre_counts = min(X3r2_pSNV_thresh5_df$pre)
X3r2_pSNV_thresh5_min_pre_counts
X3r2_pSNV_thresh5_max_pre_counts = max(X3r2_pSNV_thresh5_df$pre)
X3r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X3r2_pSNV_thresh5_post_count = length(X3r2_pSNV_thresh5_df$post)
X3r2_pSNV_thresh5_post_count
X3r2_pSNV_thresh5_min_post_counts = min(X3r2_pSNV_thresh5_df$post)
X3r2_pSNV_thresh5_min_post_counts
X3r2_pSNV_thresh5_max_post_counts = max(X3r2_pSNV_thresh5_df$post)
X3r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X3r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X3r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X3r1_prog_var_thresh5_df:
X3r1_prog_var_thresh5_df_r2_int <- X3r1_prog_var_thresh5_df[which(X3r1_prog_var_thresh5_df$variant %in% X3r2_prog_var_thresh5_df$variant),]
#Intersection variants of X3r2_prog_var_thresh5_df:
X3r2_prog_var_thresh5_df_r1_int <- X3r2_prog_var_thresh5_df[which(X3r2_prog_var_thresh5_df$variant %in% X3r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X3r1_prog_var_thresh5_df_r2_int_ord <- X3r1_prog_var_thresh5_df_r2_int[order(X3r1_prog_var_thresh5_df_r2_int$variant),]
X3r2_prog_var_thresh5_df_r1_int_ord <- X3r2_prog_var_thresh5_df_r1_int[order(X3r2_prog_var_thresh5_df_r1_int$variant),]

dim(X3r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X3r1r2int_prog_var_thresh5_pre_count <- dim(X3r1_prog_var_thresh5_df_r2_int)[1] 
X3r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X3r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X3r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X3r2_prog_var_thresh5_df_r1_int_ord$pre
X3r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X3r2_prog_var_thresh5_df_r1_int_ord$lib
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X3r2_prog_var_thresh5_df_r1_int_ord$post
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X3r2_prog_var_thresh5_df_r1_int_ord$rna
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X3r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X3r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X3r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$post_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X3r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X3r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X3r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X3r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X3r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X3r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X3r2_prog_var_thresh5_df_r1_int_ord$corr_post
X3r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X3r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X3r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X3r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X3r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X3r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X3r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X3r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X3r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X3r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X3r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X3r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X3r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X3r1_cSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X3r1_cSNV_missense_post_pre_med <- unname(X3r1_cSNV_missense_post_pre_quarts[3])
X3r1_cSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X3r1_cSNV_syn_post_pre_med <- unname(X3r1_cSNV_syn_post_pre_quarts[3])
X3r1_cSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X3r1_cSNV_nonsense_post_pre_med <- unname(X3r1_cSNV_nonsense_post_pre_quarts[3])
X3r1_cSNV_syn_to_non_post_pre_spread <- X3r1_cSNV_syn_post_pre_med - X3r1_cSNV_nonsense_post_pre_med

X3r2_cSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X3r2_cSNV_missense_post_pre_med <- unname(X3r2_cSNV_missense_post_pre_quarts[3])
X3r2_cSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X3r2_cSNV_syn_post_pre_med <- unname(X3r2_cSNV_syn_post_pre_quarts[3])
X3r2_cSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X3r2_cSNV_nonsense_post_pre_med <- unname(X3r2_cSNV_nonsense_post_pre_quarts[3])
X3r2_cSNV_syn_to_non_post_pre_spread <- X3r2_cSNV_syn_post_pre_med - X3r2_cSNV_nonsense_post_pre_med

X3r1r2a_cSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X3r1r2a_cSNV_missense_post_pre_med <- unname(X3r1r2a_cSNV_missense_post_pre_quarts[3])
X3r1r2a_cSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X3r1r2a_cSNV_syn_post_pre_med <- unname(X3r1r2a_cSNV_syn_post_pre_quarts[3])
X3r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X3r1r2a_cSNV_nonsense_post_pre_med <- unname(X3r1r2a_cSNV_nonsense_post_pre_quarts[3])
X3r1r2a_cSNV_syn_to_non_post_pre_spread <- X3r1r2a_cSNV_syn_post_pre_med - X3r1r2a_cSNV_nonsense_post_pre_med

X3r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_cSNV_missense_post_pre_med <- unname(X3r1r2pw_cSNV_missense_post_pre_quarts[3])
X3r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_cSNV_syn_post_pre_med <- unname(X3r1r2pw_cSNV_syn_post_pre_quarts[3])
X3r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_cSNV_nonsense_post_pre_med <- unname(X3r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X3r1r2pw_cSNV_syn_to_non_post_pre_spread <- X3r1r2pw_cSNV_syn_post_pre_med - X3r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X3r1_tSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X3r1_tSNV_missense_post_pre_med <- unname(X3r1_tSNV_missense_post_pre_quarts[3])
X3r1_tSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X3r1_tSNV_syn_post_pre_med <- unname(X3r1_tSNV_syn_post_pre_quarts[3])
X3r1_tSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X3r1_tSNV_nonsense_post_pre_med <- unname(X3r1_tSNV_nonsense_post_pre_quarts[3])
X3r1_tSNV_syn_to_non_post_pre_spread <- X3r1_tSNV_syn_post_pre_med - X3r1_tSNV_nonsense_post_pre_med

X3r2_tSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X3r2_tSNV_missense_post_pre_med <- unname(X3r2_tSNV_missense_post_pre_quarts[3])
X3r2_tSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X3r2_tSNV_syn_post_pre_med <- unname(X3r2_tSNV_syn_post_pre_quarts[3])
X3r2_tSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X3r2_tSNV_nonsense_post_pre_med <- unname(X3r2_tSNV_nonsense_post_pre_quarts[3])
X3r2_tSNV_syn_to_non_post_pre_spread <- X3r2_tSNV_syn_post_pre_med - X3r2_tSNV_nonsense_post_pre_med

X3r1r2a_tSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X3r1r2a_tSNV_missense_post_pre_med <- unname(X3r1r2a_tSNV_missense_post_pre_quarts[3])
X3r1r2a_tSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X3r1r2a_tSNV_syn_post_pre_med <- unname(X3r1r2a_tSNV_syn_post_pre_quarts[3])
X3r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X3r1r2a_tSNV_nonsense_post_pre_med <- unname(X3r1r2a_tSNV_nonsense_post_pre_quarts[3])
X3r1r2a_tSNV_syn_to_non_post_pre_spread <- X3r1r2a_tSNV_syn_post_pre_med - X3r1r2a_tSNV_nonsense_post_pre_med

X3r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_tSNV_missense_post_pre_med <- unname(X3r1r2pw_tSNV_missense_post_pre_quarts[3])
X3r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_tSNV_syn_post_pre_med <- unname(X3r1r2pw_tSNV_syn_post_pre_quarts[3])
X3r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X3r1r2pw_tSNV_nonsense_post_pre_med <- unname(X3r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X3r1r2pw_tSNV_syn_to_non_post_pre_spread <- X3r1r2pw_tSNV_syn_post_pre_med - X3r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X3r1_cSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X3r1_cSNV_missense_post_lib_med <- unname(X3r1_cSNV_missense_post_lib_quarts[3])
X3r1_cSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X3r1_cSNV_syn_post_lib_med <- unname(X3r1_cSNV_syn_post_lib_quarts[3])
X3r1_cSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X3r1_cSNV_nonsense_post_lib_med <- unname(X3r1_cSNV_nonsense_post_lib_quarts[3])
X3r1_cSNV_syn_to_non_post_lib_spread <- X3r1_cSNV_syn_post_lib_med - X3r1_cSNV_nonsense_post_lib_med

X3r2_cSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X3r2_cSNV_missense_post_lib_med <- unname(X3r2_cSNV_missense_post_lib_quarts[3])
X3r2_cSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X3r2_cSNV_syn_post_lib_med <- unname(X3r2_cSNV_syn_post_lib_quarts[3])
X3r2_cSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X3r2_cSNV_nonsense_post_lib_med <- unname(X3r2_cSNV_nonsense_post_lib_quarts[3])
X3r2_cSNV_syn_to_non_post_lib_spread <- X3r2_cSNV_syn_post_lib_med - X3r2_cSNV_nonsense_post_lib_med

X3r1r2a_cSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_missense_post_lib_med <- unname(X3r1r2a_cSNV_missense_post_lib_quarts[3])
X3r1r2a_cSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_syn_post_lib_med <- unname(X3r1r2a_cSNV_syn_post_lib_quarts[3])
X3r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_nonsense_post_lib_med <- unname(X3r1r2a_cSNV_nonsense_post_lib_quarts[3])
X3r1r2a_cSNV_syn_to_non_post_lib_spread <- X3r1r2a_cSNV_syn_post_lib_med - X3r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X3r1_tSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X3r1_tSNV_missense_post_lib_med <- unname(X3r1_tSNV_missense_post_lib_quarts[3])
X3r1_tSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X3r1_tSNV_syn_post_lib_med <- unname(X3r1_tSNV_syn_post_lib_quarts[3])
X3r1_tSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X3r1_tSNV_nonsense_post_lib_med <- unname(X3r1_tSNV_nonsense_post_lib_quarts[3])
X3r1_tSNV_syn_to_non_post_lib_spread <- X3r1_tSNV_syn_post_lib_med - X3r1_tSNV_nonsense_post_lib_med

X3r2_tSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X3r2_tSNV_missense_post_lib_med <- unname(X3r2_tSNV_missense_post_lib_quarts[3])
X3r2_tSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X3r2_tSNV_syn_post_lib_med <- unname(X3r2_tSNV_syn_post_lib_quarts[3])
X3r2_tSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X3r2_tSNV_nonsense_post_lib_med <- unname(X3r2_tSNV_nonsense_post_lib_quarts[3])
X3r2_tSNV_syn_to_non_post_lib_spread <- X3r2_tSNV_syn_post_lib_med - X3r2_tSNV_nonsense_post_lib_med

X3r1r2a_tSNV_missense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_missense_post_lib_med <- unname(X3r1r2a_tSNV_missense_post_lib_quarts[3])
X3r1r2a_tSNV_syn_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_syn_post_lib_med <- unname(X3r1r2a_tSNV_syn_post_lib_quarts[3])
X3r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_nonsense_post_lib_med <- unname(X3r1r2a_tSNV_nonsense_post_lib_quarts[3])
X3r1r2a_tSNV_syn_to_non_post_lib_spread <- X3r1r2a_tSNV_syn_post_lib_med - X3r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X3r1_cSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X3r1_cSNV_missense_pre_lib_med <- unname(X3r1_cSNV_missense_pre_lib_quarts[3])
X3r1_cSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X3r1_cSNV_syn_pre_lib_med <- unname(X3r1_cSNV_syn_pre_lib_quarts[3])
X3r1_cSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X3r1_cSNV_nonsense_pre_lib_med <- unname(X3r1_cSNV_nonsense_pre_lib_quarts[3])
X3r1_cSNV_syn_to_non_pre_lib_spread <- X3r1_cSNV_syn_pre_lib_med - X3r1_cSNV_nonsense_pre_lib_med

X3r2_cSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X3r2_cSNV_missense_pre_lib_med <- unname(X3r2_cSNV_missense_pre_lib_quarts[3])
X3r2_cSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X3r2_cSNV_syn_pre_lib_med <- unname(X3r2_cSNV_syn_pre_lib_quarts[3])
X3r2_cSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X3r2_cSNV_nonsense_pre_lib_med <- unname(X3r2_cSNV_nonsense_pre_lib_quarts[3])
X3r2_cSNV_syn_to_non_pre_lib_spread <- X3r2_cSNV_syn_pre_lib_med - X3r2_cSNV_nonsense_pre_lib_med

X3r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_missense_pre_lib_med <- unname(X3r1r2a_cSNV_missense_pre_lib_quarts[3])
X3r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_syn_pre_lib_med <- unname(X3r1r2a_cSNV_syn_pre_lib_quarts[3])
X3r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X3r1r2a_cSNV_nonsense_pre_lib_med <- unname(X3r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X3r1r2a_cSNV_syn_to_non_pre_lib_spread <- X3r1r2a_cSNV_syn_pre_lib_med - X3r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X3r1_tSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X3r1_tSNV_missense_pre_lib_med <- unname(X3r1_tSNV_missense_pre_lib_quarts[3])
X3r1_tSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X3r1_tSNV_syn_pre_lib_med <- unname(X3r1_tSNV_syn_pre_lib_quarts[3])
X3r1_tSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X3r1_tSNV_nonsense_pre_lib_med <- unname(X3r1_tSNV_nonsense_pre_lib_quarts[3])
X3r1_tSNV_syn_to_non_pre_lib_spread <- X3r1_tSNV_syn_pre_lib_med - X3r1_tSNV_nonsense_pre_lib_med

X3r2_tSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X3r2_tSNV_missense_pre_lib_med <- unname(X3r2_tSNV_missense_pre_lib_quarts[3])
X3r2_tSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X3r2_tSNV_syn_pre_lib_med <- unname(X3r2_tSNV_syn_pre_lib_quarts[3])
X3r2_tSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X3r2_tSNV_nonsense_pre_lib_med <- unname(X3r2_tSNV_nonsense_pre_lib_quarts[3])
X3r2_tSNV_syn_to_non_pre_lib_spread <- X3r2_tSNV_syn_pre_lib_med - X3r2_tSNV_nonsense_pre_lib_med

X3r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_missense_pre_lib_med <- unname(X3r1r2a_tSNV_missense_pre_lib_quarts[3])
X3r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_syn_pre_lib_med <- unname(X3r1r2a_tSNV_syn_pre_lib_quarts[3])
X3r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X3r1r2a_tSNV_nonsense_pre_lib_med <- unname(X3r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X3r1r2a_tSNV_syn_to_non_pre_lib_spread <- X3r1r2a_tSNV_syn_pre_lib_med - X3r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X3r1_tSNV_syn_rna_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X3r1_tSNV_syn_rna_pre_med <- unname(X3r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X3r1_tSNV_syn_rna_post_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X3r1_tSNV_syn_rna_post_med <- unname(X3r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X3r2_tSNV_syn_rna_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X3r2_tSNV_syn_rna_pre_med <- unname(X3r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X3r2_tSNV_syn_rna_post_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X3r2_tSNV_syn_rna_post_med <- unname(X3r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X3r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X3r1r2a_tSNV_syn_rna_pre_med <- unname(X3r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X3r1r2a_tSNV_syn_rna_post_quarts <- quantile(X3r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X3r1r2a_tSNV_syn_rna_post_med <- unname(X3r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X3r1_cSNV_syn_pre_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X3r1_cSNV_syn_post_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X3r1_cSNV_syn_post_lib_med
# tHDR
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X3r1_tSNV_syn_pre_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X3r1_tSNV_syn_post_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X3r1_tSNV_syn_post_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X3r1_tSNV_syn_rna_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X3r1_tSNV_syn_rna_post_med

#r2
X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X3r2_cSNV_syn_pre_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X3r2_cSNV_syn_post_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X3r2_cSNV_syn_post_lib_med
# tHDR
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X3r2_tSNV_syn_pre_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X3r2_tSNV_syn_post_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X3r2_tSNV_syn_post_lib_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X3r2_tSNV_syn_rna_pre_med
X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X3r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X3r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X3r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X3r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X3r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X3r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X3r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X3r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X3r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X3r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X3r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X3r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X3r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X3r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X3r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X3r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X3r1_prog_var_thresh5_df_r2_int_ord[which(X3r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X3r1_prog_var_thresh5_df_r2_int_ord
X3r1_prog_map_thresh5_df_r2_int_ord = which(X3r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X3r1_prog_map_thresh5_df_r2_int_ord_df = X3r1_prog_var_thresh5_df_r2_int_ord[X3r1_prog_map_thresh5_df_r2_int_ord,]
X3r1_prog_map_exon_thresh5_df_r2_int_ord = which(X3r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X3r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X3r1_prog_map_exon_thresh5_df_r2_int_ord_df = X3r1_prog_map_thresh5_df_r2_int_ord_df[X3r1_prog_map_exon_thresh5_df_r2_int_ord,]
X3r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X3r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X3r1_prog_map_thresh5_df_r2_int_ord_df[X3r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X3r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X3r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X3r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X3r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X3r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X3r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X3r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X3r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X3r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X3r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X3r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X3r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X3r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X3r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X3r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X3r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X3r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X3r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X3r1r2_cSNV_r1_post_by_r2_post_cor_s
X3r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X3r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X3r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X3r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X3r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X3r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X3r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X3r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X3r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X3r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X3r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X3r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X3r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X3r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X3r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X3r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X3r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X3r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1_cSNV_post_pre_by_cadd_cor_s
#X3r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X3r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r2_cSNV_post_pre_by_cadd_cor_s

#X3r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X3r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1_cSNV_post_lib_by_cadd_cor_s
#X3r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X3r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X3r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X3r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1_tSNV_post_pre_by_cadd_cor_s
#X3r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X3r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r2_tSNV_post_pre_by_cadd_cor_s

#X3r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X3r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1_tSNV_post_lib_by_cadd_cor_s
#X3r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X3r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X3r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X3r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X3r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X3r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X3r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X3r1_prog_var_all_lib_count
X3r1_prog_var_all_pre_count
X3r2_prog_var_all_pre_count
X3r1_prog_map_thresh5_lib_count
X3r1_prog_map_thresh5_pre_count
X3r2_prog_map_thresh5_pre_count
X3r1_prog_map_thresh5_post_count
X3r2_prog_map_thresh5_post_count
X3r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X3r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X3r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X3r1r2_cSNV_r1_post_by_r2_post_cor_s
X3r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X3r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X3r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X3r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X3r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X3r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X3r1_cSNV_post_pre_by_cadd_cor_s
X3r2_cSNV_post_pre_by_cadd_cor_s
X3r1_cSNV_post_lib_by_cadd_cor_s
X3r2_cSNV_post_lib_by_cadd_cor_s
X3r1_tSNV_post_pre_by_cadd_cor_s
X3r2_tSNV_post_pre_by_cadd_cor_s
X3r1_tSNV_post_lib_by_cadd_cor_s
X3r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X3r1r2a_cSNV_post_pre_by_cadd_cor_s
X3r1r2w_cSNV_post_pre_by_cadd_cor_s
X3r1r2a_cSNV_post_lib_by_cadd_cor_s
X3r1r2w_cSNV_post_lib_by_cadd_cor_s
X3r1r2a_tSNV_post_pre_by_cadd_cor_s
X3r1r2w_tSNV_post_pre_by_cadd_cor_s
X3r1r2a_tSNV_post_lib_by_cadd_cor_s
X3r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X3r1_cSNV_syn_to_non_post_pre_spread
X3r2_cSNV_syn_to_non_post_pre_spread
X3r1r2a_cSNV_syn_to_non_post_pre_spread
X3r1_cSNV_syn_to_non_post_lib_spread
X3r2_cSNV_syn_to_non_post_lib_spread
X3r1r2a_cSNV_syn_to_non_post_lib_spread
X3r1_tSNV_syn_to_non_post_pre_spread
X3r2_tSNV_syn_to_non_post_pre_spread
X3r1r2a_tSNV_syn_to_non_post_pre_spread
X3r1_tSNV_syn_to_non_post_lib_spread
X3r2_tSNV_syn_to_non_post_lib_spread
X3r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X3r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X3r1_prog_map_thresh5_df_r2_int_ord_df[which(X3r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X3r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df[which(X3r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df[which(X3r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df[which(X3r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X3r1_cSNV_pre_lib_cors = cor(log2(X3r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X3r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3r1_tSNV_pre_lib_cors = cor(log2(X3r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3r1_cSNV_post_lib_cors = cor(log2(X3r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X3r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X3r1_tSNV_post_lib_cors = cor(log2(X3r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X3r1_cSNV_post_pre_cors = cor(log2(X3r1_prog_map_thresh5_df$post_pseudo_freq),log2(X3r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3r1_tSNV_post_pre_cors = cor(log2(X3r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X3r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3r1_cSNV_rna_lib_cors = cor(log2(X3r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X3r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3r1_tSNV_rna_lib_cors = cor(log2(X3r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X3r1_cSNV_rna_pre_cors = cor(log2(X3r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X3r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3r1_tSNV_rna_pre_cors = cor(log2(X3r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X3r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3r1r2_cSNV_pre_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X3r1r2_tSNV_pre_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X3r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X3r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X3r1r2_cSNV_post_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X3r1r2_tSNV_post_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X3r1r2_cSNV_post_lib_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X3r1r2_tSNV_post_lib_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X3r1r2_cSNV_post_pre_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X3r1r2_tSNV_post_pre_ratio_cors = cor(log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X3r1r2_cSNV_rna_cors = cor(log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X3r1r2_tSNV_rna_cors = cor(log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X3r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X3r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X3r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X3r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X3r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X3r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X3r1_cors <- c("X3r1",X3r1_cSNV_pre_lib_cors,X3r1_tSNV_pre_lib_cors,X3r1_cSNV_post_lib_cors,X3r1_tSNV_post_lib_cors,X3r1_cSNV_post_pre_cors,X3r1_tSNV_post_pre_cors,X3r1_cSNV_rna_lib_cors,X3r1_tSNV_rna_lib_cors,X3r1_cSNV_rna_pre_cors,X3r1_tSNV_rna_pre_cors,X3r1r2_cSNV_pre_cors,X3r1r2_tSNV_pre_cors,X3r1r2_cSNV_pre_lib_ratio_cors,X3r1r2_tSNV_pre_lib_ratio_cors,X3r1r2_cSNV_post_cors,X3r1r2_tSNV_post_cors,X3r1r2_cSNV_post_lib_ratio_cors,X3r1r2_tSNV_post_lib_ratio_cors,X3r1r2_cSNV_post_pre_ratio_cors,X3r1r2_tSNV_post_pre_ratio_cors,X3r1r2_cSNV_rna_cors,X3r1r2_tSNV_rna_cors,X3r1r2_tSNV_rna_pre_ratio_cors,X3r1_cSNV_pre_lib_ratio_cadd_cors,X3r1_tSNV_pre_lib_ratio_cadd_cors,X3r1_cSNV_post_lib_ratio_cadd_cors,X3r1_tSNV_post_lib_ratio_cadd_cors,X3r1_cSNV_post_pre_ratio_cadd_cors,X3r1_tSNV_post_pre_ratio_cadd_cors,X3r1_cSNV_post_pre_ratio_cadd_missense_cors,X3r1_tSNV_post_pre_ratio_cadd_missense_cors,X3r1_cSNV_post_pre_ratio_polyphen_missense_cors,X3r1_tSNV_post_pre_ratio_polyphen_missense_cors,X3r1_cSNV_post_pre_ratio_grantham_missense_cors,X3r1_tSNV_post_pre_ratio_grantham_missense_cors,X3r1r2a_cSNV_pre_lib_ratio_cadd_cors,X3r1r2a_tSNV_pre_lib_ratio_cadd_cors,X3r1r2a_cSNV_post_lib_ratio_cadd_cors,X3r1r2a_tSNV_post_lib_ratio_cadd_cors,X3r1r2a_cSNV_post_pre_ratio_cadd_cors,X3r1r2a_tSNV_post_pre_ratio_cadd_cors,X3r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X3r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X3r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X3r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X3r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X3r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X3r1r2w_cSNV_pre_lib_ratio_cadd_cors,X3r1r2w_cSNV_post_lib_ratio_cadd_cors,X3r1r2w_cSNV_post_pre_ratio_cadd_cors,X3r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X3r2_cSNV_pre_lib_cors = cor(log2(X3r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X3r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3r2_tSNV_pre_lib_cors = cor(log2(X3r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3r2_cSNV_post_lib_cors = cor(log2(X3r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X3r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X3r2_tSNV_post_lib_cors = cor(log2(X3r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X3r2_cSNV_post_pre_cors = cor(log2(X3r2_prog_map_thresh5_df$post_pseudo_freq),log2(X3r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3r2_tSNV_post_pre_cors = cor(log2(X3r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X3r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3r2_cSNV_rna_lib_cors = cor(log2(X3r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X3r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3r2_tSNV_rna_lib_cors = cor(log2(X3r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X3r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X3r2_cSNV_rna_pre_cors = cor(log2(X3r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X3r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3r2_tSNV_rna_pre_cors = cor(log2(X3r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X3r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X3r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X3r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X3r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X3r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X3r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X3r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X3r2_cors <- c("X3r2",X3r2_cSNV_pre_lib_cors,X3r2_tSNV_pre_lib_cors,X3r2_cSNV_post_lib_cors,X3r2_tSNV_post_lib_cors,X3r2_cSNV_post_pre_cors,X3r2_tSNV_post_pre_cors,X3r2_cSNV_rna_lib_cors,X3r2_tSNV_rna_lib_cors,X3r2_cSNV_rna_pre_cors,X3r2_tSNV_rna_pre_cors,X3r1r2_cSNV_pre_cors,X3r1r2_tSNV_pre_cors,X3r1r2_cSNV_pre_lib_ratio_cors,X3r1r2_tSNV_pre_lib_ratio_cors,X3r1r2_cSNV_post_cors,X3r1r2_tSNV_post_cors,X3r1r2_cSNV_post_lib_ratio_cors,X3r1r2_tSNV_post_lib_ratio_cors,X3r1r2_cSNV_post_pre_ratio_cors,X3r1r2_tSNV_post_pre_ratio_cors,X3r1r2_cSNV_rna_cors,X3r1r2_tSNV_rna_cors,X3r1r2_tSNV_rna_pre_ratio_cors,X3r2_cSNV_pre_lib_ratio_cadd_cors,X3r2_tSNV_pre_lib_ratio_cadd_cors,X3r2_cSNV_post_lib_ratio_cadd_cors,X3r2_tSNV_post_lib_ratio_cadd_cors,X3r2_cSNV_post_pre_ratio_cadd_cors,X3r2_tSNV_post_pre_ratio_cadd_cors,X3r2_cSNV_post_pre_ratio_cadd_missense_cors,X3r2_tSNV_post_pre_ratio_cadd_missense_cors,X3r2_cSNV_post_pre_ratio_polyphen_missense_cors,X3r2_tSNV_post_pre_ratio_polyphen_missense_cors,X3r2_cSNV_post_pre_ratio_grantham_missense_cors,X3r2_tSNV_post_pre_ratio_grantham_missense_cors,X3r1r2a_cSNV_pre_lib_ratio_cadd_cors,X3r1r2a_tSNV_pre_lib_ratio_cadd_cors,X3r1r2a_cSNV_post_lib_ratio_cadd_cors,X3r1r2a_tSNV_post_lib_ratio_cadd_cors,X3r1r2a_cSNV_post_pre_ratio_cadd_cors,X3r1r2a_tSNV_post_pre_ratio_cadd_cors,X3r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X3r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X3r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X3r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X3r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X3r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X3r1r2w_cSNV_pre_lib_ratio_cadd_cors,X3r1r2w_cSNV_post_lib_ratio_cadd_cors,X3r1r2w_cSNV_post_pre_ratio_cadd_cors,X3r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X3r1)
rm(X3r2)
gc()

X4r1_file <- paste(experiment_dir_171011,'X4r1','_annotated.txt',sep='')
X4r2_file <- paste(experiment_dir_171011,'X4r2','_annotated.txt',sep='')
X4r1 <- read.table(X4r1_file, header=TRUE, sep="\t")
X4r2 <- read.table(X4r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X4 <- editing_info[which(editing_info$amplicon == 'X4'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X4_HDR_5_SNV = as.character(editing_info_X4$HDR_5_SNV)
X4_HDR_3_SNV = as.character(editing_info_X4$HDR_3_SNV)
#X4_cut_pos = as.character(editing_info_X4$cut_pos)
X4_cut_end = as.character(editing_info_X4$cut_end)
X4_mut_start = as.character(editing_info_X4$mut_start)
X4_mut_end = as.character(editing_info_X4$mut_end)
### Replicate 1
X4r1_cSNV_all <- which(X4r1[,'c_hdr_snv']=='True')
X4r1_cSNV_all_df = X4r1[X4r1_cSNV_all,]
X4r1_prog_var_all <- which(X4r1[,'all_hdr_variant']=='True' & X4r1[,'edit_string']!='-WT')
X4r1_prog_var_all_df = X4r1[X4r1_prog_var_all,]
X4r1_prog_map_all = which(X4r1_prog_var_all_df[,'pos']!='REF')
X4r1_prog_map_all_df = X4r1_prog_var_all_df[X4r1_prog_map_all,]
X4r1_prog_map_exon_all = which(X4r1_prog_map_all_df[,'cDNApos']!='REF' & X4r1_prog_map_all_df[,'cDNApos']!='NA')
X4r1_prog_map_exon_all_df = X4r1_prog_map_all_df[X4r1_prog_map_exon_all,]
X4r1_prog_map_CADD = which(X4r1_prog_map_all_df[,'CADD.phred']!='NA')
X4r1_prog_map_CADD_df = X4r1_prog_map_all_df[X4r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X4r1_prog_var_thresh5 <- which(as.numeric(as.character(X4r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X4r1_prog_var_thresh5_df = X4r1_prog_var_all_df[X4r1_prog_var_thresh5,]
X4r1_prog_map_thresh5 <- which(as.numeric(as.character(X4r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X4r1_prog_map_thresh5_df = X4r1_prog_map_all_df[X4r1_prog_map_thresh5,]
X4r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X4r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X4r1_prog_map_exon_thresh5_df = X4r1_prog_map_exon_all_df[X4r1_prog_map_exon_thresh5,]
X4r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X4r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X4r1_prog_map_CADD_thresh5_df = X4r1_prog_map_CADD_df[X4r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X4r1_prog_var_all_lib_count = length(X4r1_prog_var_all_df$lib)
X4r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X4r1_prog_var_all_min_lib_counts = min(X4r1_prog_var_all_df$lib)
X4r1_prog_var_all_min_lib_counts
X4r1_prog_var_all_max_lib_counts = max(X4r1_prog_var_all_df$lib)
X4r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X4r1_prog_map_all_lib_count = length(X4r1_prog_map_all_df$lib)
X4r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X4r1_prog_map_all_min_lib_counts = min(X4r1_prog_map_all_df$lib)
X4r1_prog_map_all_min_lib_counts
X4r1_prog_map_all_max_lib_counts = max(X4r1_prog_map_all_df$lib)
X4r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X4r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X4r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X4r1_prog_var_all_pre_count = length(X4r1_prog_var_all_df$pre)
X4r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X4r1_prog_var_all_min_pre_counts = min(X4r1_prog_var_all_df$pre)
X4r1_prog_var_all_min_pre_counts
X4r1_prog_var_all_max_pre_counts = max(X4r1_prog_var_all_df$pre)
X4r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X4r1_prog_map_all_pre_count = length(X4r1_prog_map_all_df$pre)
X4r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X4r1_prog_map_all_min_pre_counts = min(X4r1_prog_map_all_df$pre)
X4r1_prog_map_all_min_pre_counts
X4r1_prog_map_all_max_pre_counts = max(X4r1_prog_map_all_df$pre)
X4r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X4r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X4r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X4r1_prog_map_all_post_count = length(X4r1_prog_map_all_df$post)
X4r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X4r1_prog_map_all_min_post_counts = min(X4r1_prog_map_all_df$post)
X4r1_prog_map_all_min_post_counts
X4r1_prog_map_all_max_post_counts = max(X4r1_prog_map_all_df$post)
X4r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X4r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X4r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X4r1_prog_map_all_syn_df <- X4r1_prog_map_all_df[which(X4r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X4r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X4r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X4r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X4r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X4r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X4r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X4r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X4r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X4r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X4r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X4r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X4r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X4r1_prog_map_all_min_rna_counts = min(X4r1_prog_map_exon_all_df$tHDR_rna)
X4r1_prog_map_all_min_rna_counts
X4r1_prog_map_all_max_rna_counts = max(X4r1_prog_map_exon_all_df$tHDR_rna)
X4r1_prog_map_all_max_rna_counts
X4r1_prog_map_all_min_rna_pseudo_freq = min(X4r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4r1_prog_map_all_min_rna_pseudo_freq
X4r1_prog_map_all_max_rna_pseudo_freq = max(X4r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4r1_prog_map_all_max_rna_pseudo_freq
X4r1_prog_map_all_min_rna_pre_ratio = min(X4r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4r1_prog_map_all_min_rna_pre_ratio
X4r1_prog_map_all_max_rna_pre_ratio = max(X4r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4r1_prog_map_all_max_rna_pre_ratio
X4r1_prog_map_all_min_rna_post_ratio = min(X4r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4r1_prog_map_all_min_rna_post_ratio
X4r1_prog_map_all_max_rna_post_ratio = max(X4r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X4r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X4r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X4r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X4r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X4r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X4r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X4r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X4r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X4r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X4r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X4r1_prog_map_all_df$post_pre_ratio),log2(X4r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X4r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X4r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X4r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X4r1_cSNV_all_corr_pre_count = length(X4r1_cSNV_all_df$corr_pre)
X4r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X4r1_cSNV_all_min_corr_pre_counts = min(X4r1_cSNV_all_df$corr_pre)
X4r1_cSNV_all_min_corr_pre_counts
X4r1_cSNV_all_max_corr_pre_counts = max(X4r1_cSNV_all_df$corr_pre)
X4r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X4r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X4r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X4r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X4r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X4r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_cSNV_all_corr_post_count = length(X4r1_cSNV_all_df$corr_post)
X4r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X4r1_cSNV_all_min_corr_post_counts = min(X4r1_cSNV_all_df$corr_post)
X4r1_cSNV_all_min_corr_post_counts
X4r1_cSNV_all_max_corr_post_counts = max(X4r1_cSNV_all_df$corr_post)
X4r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X4r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X4r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X4r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X4r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X4r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X4r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X4_p_hdr_snv = paste('p_hdr_',X4_cut_end,'_snv',sep='')
X4r1_pSNV_all <- which(X4r1[,X4_p_hdr_snv]=='True')
X4r1_pSNV_all_df = X4r1[X4r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_pSNV_all_lib_count = length(X4r1_pSNV_all_df$lib)
X4r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X4r1_pSNV_all_min_lib_counts = min(X4r1_pSNV_all_df$lib)
X4r1_pSNV_all_min_lib_counts
X4r1_pSNV_all_max_lib_counts = max(X4r1_pSNV_all_df$lib)
X4r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X4r1_pSNV_all_pre_count = length(X4r1_pSNV_all_df$pre)
X4r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X4r1_pSNV_all_min_pre_counts = min(X4r1_pSNV_all_df$pre)
X4r1_pSNV_all_min_pre_counts
X4r1_pSNV_all_max_pre_counts = max(X4r1_pSNV_all_df$pre)
X4r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X4r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X4r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_pSNV_all_post_count = length(X4r1_pSNV_all_df$post)
X4r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X4r1_pSNV_all_min_post_counts = min(X4r1_pSNV_all_df$post)
X4r1_pSNV_all_min_post_counts
X4r1_pSNV_all_max_post_counts = max(X4r1_pSNV_all_df$post)
X4r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X4r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X4r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_prog_map_thresh5_lib_count = length(X4r1_prog_map_thresh5_df$lib)
X4r1_prog_map_thresh5_lib_count
X4r1_prog_map_thresh5_min_lib_counts = min(X4r1_prog_map_thresh5_df$lib)
X4r1_prog_map_thresh5_min_lib_counts
X4r1_prog_map_thresh5_max_lib_counts = max(X4r1_prog_map_thresh5_df$lib)
X4r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X4r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X4r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_prog_map_thresh5_pre_count = length(X4r1_prog_map_thresh5_df$pre)
X4r1_prog_map_thresh5_pre_count
X4r1_prog_map_thresh5_min_pre_counts = min(X4r1_prog_map_thresh5_df$pre)
X4r1_prog_map_thresh5_min_pre_counts
X4r1_prog_map_thresh5_max_pre_counts = max(X4r1_prog_map_thresh5_df$pre)
X4r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r1_prog_map_thresh5_post_count = length(X4r1_prog_map_thresh5_df$post)
X4r1_prog_map_thresh5_post_count
X4r1_prog_map_thresh5_min_post_counts = min(X4r1_prog_map_thresh5_df$post)
X4r1_prog_map_thresh5_min_post_counts
X4r1_prog_map_thresh5_max_post_counts = max(X4r1_prog_map_thresh5_df$post)
X4r1_prog_map_thresh5_max_post_counts
X4r1_prog_map_thresh5_corr_post_count = length(X4r1_cSNV_all_df$corr_post)
X4r1_prog_map_thresh5_corr_post_count
X4r1_prog_map_thresh5_min_corr_post_counts = min(X4r1_cSNV_all_df$corr_post)
X4r1_prog_map_thresh5_min_corr_post_counts
X4r1_prog_map_thresh5_max_corr_post_counts = max(X4r1_cSNV_all_df$corr_post)
X4r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X4r1_pSNV_thresh5 <- which(X4r1[,X4_p_hdr_snv]=='True' & as.numeric(as.character(X4r1[,'pre_freq']))>=0.00001)
X4r1_pSNV_thresh5_df = X4r1[X4r1_pSNV_thresh5,]
X4r1_pSNV_thresh5_lib_count = length(X4r1_pSNV_thresh5_df$lib)
X4r1_pSNV_thresh5_lib_count
X4r1_pSNV_thresh5_min_lib_counts = min(X4r1_pSNV_thresh5_df$lib)
X4r1_pSNV_thresh5_min_lib_counts
X4r1_pSNV_thresh5_max_lib_counts = max(X4r1_pSNV_thresh5_df$lib)
X4r1_pSNV_thresh5_max_lib_counts
X4r1_pSNV_thresh5_pre_count = length(X4r1_pSNV_thresh5_df$pre)
X4r1_pSNV_thresh5_pre_count
X4r1_pSNV_thresh5_min_pre_counts = min(X4r1_pSNV_thresh5_df$pre)
X4r1_pSNV_thresh5_min_pre_counts
X4r1_pSNV_thresh5_max_pre_counts = max(X4r1_pSNV_thresh5_df$pre)
X4r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X4r1_pSNV_thresh5_post_count = length(X4r1_pSNV_thresh5_df$post)
X4r1_pSNV_thresh5_post_count
X4r1_pSNV_thresh5_min_post_counts = min(X4r1_pSNV_thresh5_df$post)
X4r1_pSNV_thresh5_min_post_counts
X4r1_pSNV_thresh5_max_post_counts = max(X4r1_pSNV_thresh5_df$post)
X4r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X4r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X4r1_pSNV_thresh5_post_pos

### Replicate 2
X4r2_cSNV_all <- which(X4r2[,'c_hdr_snv']=='True')
X4r2_cSNV_all_df = X4r2[X4r2_cSNV_all,]
X4r2_prog_var_all <- which(X4r2[,'all_hdr_variant']=='True' & X4r2[,'edit_string']!='-WT')
X4r2_prog_var_all_df = X4r2[X4r2_prog_var_all,]
X4r2_prog_map_all = which(X4r2_prog_var_all_df[,'pos']!='REF')
X4r2_prog_map_all_df = X4r2_prog_var_all_df[X4r2_prog_map_all,]
X4r2_prog_map_exon_all = which(X4r2_prog_map_all_df[,'cDNApos']!='REF' & X4r2_prog_map_all_df[,'cDNApos']!='NA')
X4r2_prog_map_exon_all_df = X4r2_prog_map_all_df[X4r2_prog_map_exon_all,]
X4r2_prog_map_CADD = which(X4r2_prog_map_all_df[,'CADD.phred']!='NA')
X4r2_prog_map_CADD_df = X4r2_prog_map_all_df[X4r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X4r2_prog_var_thresh5 <- which(as.numeric(as.character(X4r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X4r2_prog_var_thresh5_df = X4r2_prog_var_all_df[X4r2_prog_var_thresh5,]
X4r2_prog_map_thresh5 <- which(as.numeric(as.character(X4r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X4r2_prog_map_thresh5_df = X4r2_prog_map_all_df[X4r2_prog_map_thresh5,]
X4r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X4r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X4r2_prog_map_exon_thresh5_df = X4r2_prog_map_exon_all_df[X4r2_prog_map_exon_thresh5,]
X4r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X4r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X4r2_prog_map_CADD_thresh5_df = X4r2_prog_map_CADD_df[X4r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X4r2_prog_var_all_lib_count = length(X4r2_prog_var_all_df$lib)
X4r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X4r2_prog_var_all_min_lib_counts = min(X4r2_prog_var_all_df$lib)
X4r2_prog_var_all_min_lib_counts
X4r2_prog_var_all_max_lib_counts = max(X4r2_prog_var_all_df$lib)
X4r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X4r2_prog_map_all_lib_count = length(X4r2_prog_map_all_df$lib)
X4r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X4r2_prog_map_all_min_lib_counts = min(X4r2_prog_map_all_df$lib)
X4r2_prog_map_all_min_lib_counts
X4r2_prog_map_all_max_lib_counts = max(X4r2_prog_map_all_df$lib)
X4r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X4r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X4r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X4r2_prog_var_all_pre_count = length(X4r2_prog_var_all_df$pre)
X4r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X4r2_prog_var_all_min_pre_counts = min(X4r2_prog_var_all_df$pre)
X4r2_prog_var_all_min_pre_counts
X4r2_prog_var_all_max_pre_counts = max(X4r2_prog_var_all_df$pre)
X4r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X4r2_prog_map_all_pre_count = length(X4r2_prog_map_all_df$pre)
X4r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X4r2_prog_map_all_min_pre_counts = min(X4r2_prog_map_all_df$pre)
X4r2_prog_map_all_min_pre_counts
X4r2_prog_map_all_max_pre_counts = max(X4r2_prog_map_all_df$pre)
X4r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X4r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X4r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X4r2_prog_map_all_post_count = length(X4r2_prog_map_all_df$post)
X4r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X4r2_prog_map_all_min_post_counts = min(X4r2_prog_map_all_df$post)
X4r2_prog_map_all_min_post_counts
X4r2_prog_map_all_max_post_counts = max(X4r2_prog_map_all_df$post)
X4r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X4r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X4r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X4r2_prog_map_all_syn_df <- X4r2_prog_map_all_df[which(X4r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X4r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X4r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X4r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X4r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X4r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X4r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X4r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X4r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X4r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X4r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X4r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X4r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X4r2_prog_map_all_min_rna_counts = min(X4r2_prog_map_exon_all_df$tHDR_rna)
X4r2_prog_map_all_min_rna_counts
X4r2_prog_map_all_max_rna_counts = max(X4r2_prog_map_exon_all_df$tHDR_rna)
X4r2_prog_map_all_max_rna_counts
X4r2_prog_map_all_min_rna_pseudo_freq = min(X4r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4r2_prog_map_all_min_rna_pseudo_freq
X4r2_prog_map_all_max_rna_pseudo_freq = max(X4r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4r2_prog_map_all_max_rna_pseudo_freq
X4r2_prog_map_all_min_rna_pre_ratio = min(X4r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4r2_prog_map_all_min_rna_pre_ratio
X4r2_prog_map_all_max_rna_pre_ratio = max(X4r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4r2_prog_map_all_max_rna_pre_ratio
X4r2_prog_map_all_min_rna_post_ratio = min(X4r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4r2_prog_map_all_min_rna_post_ratio
X4r2_prog_map_all_max_rna_post_ratio = max(X4r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X4r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X4r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X4r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X4r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X4r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X4r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X4r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X4r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X4r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X4r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X4r2_prog_map_all_df$post_pre_ratio),log2(X4r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X4r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X4r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X4r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X4r2_cSNV_all_corr_pre_count = length(X4r2_cSNV_all_df$corr_pre)
X4r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X4r2_cSNV_all_min_corr_pre_counts = min(X4r2_cSNV_all_df$corr_pre)
X4r2_cSNV_all_min_corr_pre_counts
X4r2_cSNV_all_max_corr_pre_counts = max(X4r2_cSNV_all_df$corr_pre)
X4r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X4r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X4r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X4r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X4r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X4r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_cSNV_all_corr_post_count = length(X4r2_cSNV_all_df$corr_post)
X4r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X4r2_cSNV_all_min_corr_post_counts = min(X4r2_cSNV_all_df$corr_post)
X4r2_cSNV_all_min_corr_post_counts
X4r2_cSNV_all_max_corr_post_counts = max(X4r2_cSNV_all_df$corr_post)
X4r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X4r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X4r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X4r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X4r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X4r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X4r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X4_p_hdr_snv = paste('p_hdr_',X4_cut_end,'_snv',sep='')
X4r2_pSNV_all <- which(X4r2[,X4_p_hdr_snv]=='True')
X4r2_pSNV_all_df = X4r2[X4r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_pSNV_all_lib_count = length(X4r2_pSNV_all_df$lib)
X4r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X4r2_pSNV_all_min_lib_counts = min(X4r2_pSNV_all_df$lib)
X4r2_pSNV_all_min_lib_counts
X4r2_pSNV_all_max_lib_counts = max(X4r2_pSNV_all_df$lib)
X4r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X4r2_pSNV_all_pre_count = length(X4r2_pSNV_all_df$pre)
X4r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X4r2_pSNV_all_min_pre_counts = min(X4r2_pSNV_all_df$pre)
X4r2_pSNV_all_min_pre_counts
X4r2_pSNV_all_max_pre_counts = max(X4r2_pSNV_all_df$pre)
X4r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X4r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X4r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_pSNV_all_post_count = length(X4r2_pSNV_all_df$post)
X4r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X4r2_pSNV_all_min_post_counts = min(X4r2_pSNV_all_df$post)
X4r2_pSNV_all_min_post_counts
X4r2_pSNV_all_max_post_counts = max(X4r2_pSNV_all_df$post)
X4r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X4r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X4r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_prog_map_thresh5_lib_count = length(X4r2_prog_map_thresh5_df$lib)
X4r2_prog_map_thresh5_lib_count
X4r2_prog_map_thresh5_min_lib_counts = min(X4r2_prog_map_thresh5_df$lib)
X4r2_prog_map_thresh5_min_lib_counts
X4r2_prog_map_thresh5_max_lib_counts = max(X4r2_prog_map_thresh5_df$lib)
X4r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X4r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X4r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_prog_map_thresh5_pre_count = length(X4r2_prog_map_thresh5_df$pre)
X4r2_prog_map_thresh5_pre_count
X4r2_prog_map_thresh5_min_pre_counts = min(X4r2_prog_map_thresh5_df$pre)
X4r2_prog_map_thresh5_min_pre_counts
X4r2_prog_map_thresh5_max_pre_counts = max(X4r2_prog_map_thresh5_df$pre)
X4r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4r2_prog_map_thresh5_post_count = length(X4r2_prog_map_thresh5_df$post)
X4r2_prog_map_thresh5_post_count
X4r2_prog_map_thresh5_min_post_counts = min(X4r2_prog_map_thresh5_df$post)
X4r2_prog_map_thresh5_min_post_counts
X4r2_prog_map_thresh5_max_post_counts = max(X4r2_prog_map_thresh5_df$post)
X4r2_prog_map_thresh5_max_post_counts
X4r2_prog_map_thresh5_corr_post_count = length(X4r2_prog_map_thresh5_df$corr_post)
X4r2_prog_map_thresh5_corr_post_count
X4r2_prog_map_thresh5_min_corr_post_counts = min(X4r2_prog_map_thresh5_df$corr_post)
X4r2_prog_map_thresh5_min_corr_post_counts
X4r2_prog_map_thresh5_max_corr_post_counts = max(X4r2_prog_map_thresh5_df$corr_post)
X4r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X4r2_pSNV_thresh5 <- which(X4r2[,X4_p_hdr_snv]=='True' & as.numeric(as.character(X4r2[,'pre_freq']))>=0.00001)
X4r2_pSNV_thresh5_df = X4r2[X4r2_pSNV_thresh5,]
X4r2_pSNV_thresh5_lib_count = length(X4r2_pSNV_thresh5_df$lib)
X4r2_pSNV_thresh5_lib_count
X4r2_pSNV_thresh5_min_lib_counts = min(X4r2_pSNV_thresh5_df$lib)
X4r2_pSNV_thresh5_min_lib_counts
X4r2_pSNV_thresh5_max_lib_counts = max(X4r2_pSNV_thresh5_df$lib)
X4r2_pSNV_thresh5_max_lib_counts
X4r2_pSNV_thresh5_pre_count = length(X4r2_pSNV_thresh5_df$pre)
X4r2_pSNV_thresh5_pre_count
X4r2_pSNV_thresh5_min_pre_counts = min(X4r2_pSNV_thresh5_df$pre)
X4r2_pSNV_thresh5_min_pre_counts
X4r2_pSNV_thresh5_max_pre_counts = max(X4r2_pSNV_thresh5_df$pre)
X4r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X4r2_pSNV_thresh5_post_count = length(X4r2_pSNV_thresh5_df$post)
X4r2_pSNV_thresh5_post_count
X4r2_pSNV_thresh5_min_post_counts = min(X4r2_pSNV_thresh5_df$post)
X4r2_pSNV_thresh5_min_post_counts
X4r2_pSNV_thresh5_max_post_counts = max(X4r2_pSNV_thresh5_df$post)
X4r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X4r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X4r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X4r1_prog_var_thresh5_df:
X4r1_prog_var_thresh5_df_r2_int <- X4r1_prog_var_thresh5_df[which(X4r1_prog_var_thresh5_df$variant %in% X4r2_prog_var_thresh5_df$variant),]
#Intersection variants of X4r2_prog_var_thresh5_df:
X4r2_prog_var_thresh5_df_r1_int <- X4r2_prog_var_thresh5_df[which(X4r2_prog_var_thresh5_df$variant %in% X4r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X4r1_prog_var_thresh5_df_r2_int_ord <- X4r1_prog_var_thresh5_df_r2_int[order(X4r1_prog_var_thresh5_df_r2_int$variant),]
X4r2_prog_var_thresh5_df_r1_int_ord <- X4r2_prog_var_thresh5_df_r1_int[order(X4r2_prog_var_thresh5_df_r1_int$variant),]

dim(X4r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X4r1r2int_prog_var_thresh5_pre_count <- dim(X4r1_prog_var_thresh5_df_r2_int)[1] 
X4r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X4r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X4r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X4r2_prog_var_thresh5_df_r1_int_ord$pre
X4r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X4r2_prog_var_thresh5_df_r1_int_ord$lib
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X4r2_prog_var_thresh5_df_r1_int_ord$post
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X4r2_prog_var_thresh5_df_r1_int_ord$rna
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X4r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X4r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X4r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$post_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X4r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X4r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X4r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X4r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X4r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X4r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X4r2_prog_var_thresh5_df_r1_int_ord$corr_post
X4r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X4r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X4r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X4r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X4r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X4r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X4r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X4r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X4r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X4r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X4r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X4r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X4r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X4r1_cSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X4r1_cSNV_missense_post_pre_med <- unname(X4r1_cSNV_missense_post_pre_quarts[3])
X4r1_cSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X4r1_cSNV_syn_post_pre_med <- unname(X4r1_cSNV_syn_post_pre_quarts[3])
X4r1_cSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X4r1_cSNV_nonsense_post_pre_med <- unname(X4r1_cSNV_nonsense_post_pre_quarts[3])
X4r1_cSNV_syn_to_non_post_pre_spread <- X4r1_cSNV_syn_post_pre_med - X4r1_cSNV_nonsense_post_pre_med

X4r2_cSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X4r2_cSNV_missense_post_pre_med <- unname(X4r2_cSNV_missense_post_pre_quarts[3])
X4r2_cSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X4r2_cSNV_syn_post_pre_med <- unname(X4r2_cSNV_syn_post_pre_quarts[3])
X4r2_cSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X4r2_cSNV_nonsense_post_pre_med <- unname(X4r2_cSNV_nonsense_post_pre_quarts[3])
X4r2_cSNV_syn_to_non_post_pre_spread <- X4r2_cSNV_syn_post_pre_med - X4r2_cSNV_nonsense_post_pre_med

X4r1r2a_cSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X4r1r2a_cSNV_missense_post_pre_med <- unname(X4r1r2a_cSNV_missense_post_pre_quarts[3])
X4r1r2a_cSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X4r1r2a_cSNV_syn_post_pre_med <- unname(X4r1r2a_cSNV_syn_post_pre_quarts[3])
X4r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X4r1r2a_cSNV_nonsense_post_pre_med <- unname(X4r1r2a_cSNV_nonsense_post_pre_quarts[3])
X4r1r2a_cSNV_syn_to_non_post_pre_spread <- X4r1r2a_cSNV_syn_post_pre_med - X4r1r2a_cSNV_nonsense_post_pre_med

X4r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_cSNV_missense_post_pre_med <- unname(X4r1r2pw_cSNV_missense_post_pre_quarts[3])
X4r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_cSNV_syn_post_pre_med <- unname(X4r1r2pw_cSNV_syn_post_pre_quarts[3])
X4r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_cSNV_nonsense_post_pre_med <- unname(X4r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X4r1r2pw_cSNV_syn_to_non_post_pre_spread <- X4r1r2pw_cSNV_syn_post_pre_med - X4r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X4r1_tSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X4r1_tSNV_missense_post_pre_med <- unname(X4r1_tSNV_missense_post_pre_quarts[3])
X4r1_tSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X4r1_tSNV_syn_post_pre_med <- unname(X4r1_tSNV_syn_post_pre_quarts[3])
X4r1_tSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X4r1_tSNV_nonsense_post_pre_med <- unname(X4r1_tSNV_nonsense_post_pre_quarts[3])
X4r1_tSNV_syn_to_non_post_pre_spread <- X4r1_tSNV_syn_post_pre_med - X4r1_tSNV_nonsense_post_pre_med

X4r2_tSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X4r2_tSNV_missense_post_pre_med <- unname(X4r2_tSNV_missense_post_pre_quarts[3])
X4r2_tSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X4r2_tSNV_syn_post_pre_med <- unname(X4r2_tSNV_syn_post_pre_quarts[3])
X4r2_tSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X4r2_tSNV_nonsense_post_pre_med <- unname(X4r2_tSNV_nonsense_post_pre_quarts[3])
X4r2_tSNV_syn_to_non_post_pre_spread <- X4r2_tSNV_syn_post_pre_med - X4r2_tSNV_nonsense_post_pre_med

X4r1r2a_tSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X4r1r2a_tSNV_missense_post_pre_med <- unname(X4r1r2a_tSNV_missense_post_pre_quarts[3])
X4r1r2a_tSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X4r1r2a_tSNV_syn_post_pre_med <- unname(X4r1r2a_tSNV_syn_post_pre_quarts[3])
X4r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X4r1r2a_tSNV_nonsense_post_pre_med <- unname(X4r1r2a_tSNV_nonsense_post_pre_quarts[3])
X4r1r2a_tSNV_syn_to_non_post_pre_spread <- X4r1r2a_tSNV_syn_post_pre_med - X4r1r2a_tSNV_nonsense_post_pre_med

X4r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_tSNV_missense_post_pre_med <- unname(X4r1r2pw_tSNV_missense_post_pre_quarts[3])
X4r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_tSNV_syn_post_pre_med <- unname(X4r1r2pw_tSNV_syn_post_pre_quarts[3])
X4r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X4r1r2pw_tSNV_nonsense_post_pre_med <- unname(X4r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X4r1r2pw_tSNV_syn_to_non_post_pre_spread <- X4r1r2pw_tSNV_syn_post_pre_med - X4r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X4r1_cSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X4r1_cSNV_missense_post_lib_med <- unname(X4r1_cSNV_missense_post_lib_quarts[3])
X4r1_cSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X4r1_cSNV_syn_post_lib_med <- unname(X4r1_cSNV_syn_post_lib_quarts[3])
X4r1_cSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X4r1_cSNV_nonsense_post_lib_med <- unname(X4r1_cSNV_nonsense_post_lib_quarts[3])
X4r1_cSNV_syn_to_non_post_lib_spread <- X4r1_cSNV_syn_post_lib_med - X4r1_cSNV_nonsense_post_lib_med

X4r2_cSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X4r2_cSNV_missense_post_lib_med <- unname(X4r2_cSNV_missense_post_lib_quarts[3])
X4r2_cSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X4r2_cSNV_syn_post_lib_med <- unname(X4r2_cSNV_syn_post_lib_quarts[3])
X4r2_cSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X4r2_cSNV_nonsense_post_lib_med <- unname(X4r2_cSNV_nonsense_post_lib_quarts[3])
X4r2_cSNV_syn_to_non_post_lib_spread <- X4r2_cSNV_syn_post_lib_med - X4r2_cSNV_nonsense_post_lib_med

X4r1r2a_cSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_missense_post_lib_med <- unname(X4r1r2a_cSNV_missense_post_lib_quarts[3])
X4r1r2a_cSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_syn_post_lib_med <- unname(X4r1r2a_cSNV_syn_post_lib_quarts[3])
X4r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_nonsense_post_lib_med <- unname(X4r1r2a_cSNV_nonsense_post_lib_quarts[3])
X4r1r2a_cSNV_syn_to_non_post_lib_spread <- X4r1r2a_cSNV_syn_post_lib_med - X4r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X4r1_tSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X4r1_tSNV_missense_post_lib_med <- unname(X4r1_tSNV_missense_post_lib_quarts[3])
X4r1_tSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X4r1_tSNV_syn_post_lib_med <- unname(X4r1_tSNV_syn_post_lib_quarts[3])
X4r1_tSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X4r1_tSNV_nonsense_post_lib_med <- unname(X4r1_tSNV_nonsense_post_lib_quarts[3])
X4r1_tSNV_syn_to_non_post_lib_spread <- X4r1_tSNV_syn_post_lib_med - X4r1_tSNV_nonsense_post_lib_med

X4r2_tSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X4r2_tSNV_missense_post_lib_med <- unname(X4r2_tSNV_missense_post_lib_quarts[3])
X4r2_tSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X4r2_tSNV_syn_post_lib_med <- unname(X4r2_tSNV_syn_post_lib_quarts[3])
X4r2_tSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X4r2_tSNV_nonsense_post_lib_med <- unname(X4r2_tSNV_nonsense_post_lib_quarts[3])
X4r2_tSNV_syn_to_non_post_lib_spread <- X4r2_tSNV_syn_post_lib_med - X4r2_tSNV_nonsense_post_lib_med

X4r1r2a_tSNV_missense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_missense_post_lib_med <- unname(X4r1r2a_tSNV_missense_post_lib_quarts[3])
X4r1r2a_tSNV_syn_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_syn_post_lib_med <- unname(X4r1r2a_tSNV_syn_post_lib_quarts[3])
X4r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_nonsense_post_lib_med <- unname(X4r1r2a_tSNV_nonsense_post_lib_quarts[3])
X4r1r2a_tSNV_syn_to_non_post_lib_spread <- X4r1r2a_tSNV_syn_post_lib_med - X4r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X4r1_cSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X4r1_cSNV_missense_pre_lib_med <- unname(X4r1_cSNV_missense_pre_lib_quarts[3])
X4r1_cSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X4r1_cSNV_syn_pre_lib_med <- unname(X4r1_cSNV_syn_pre_lib_quarts[3])
X4r1_cSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X4r1_cSNV_nonsense_pre_lib_med <- unname(X4r1_cSNV_nonsense_pre_lib_quarts[3])
X4r1_cSNV_syn_to_non_pre_lib_spread <- X4r1_cSNV_syn_pre_lib_med - X4r1_cSNV_nonsense_pre_lib_med

X4r2_cSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X4r2_cSNV_missense_pre_lib_med <- unname(X4r2_cSNV_missense_pre_lib_quarts[3])
X4r2_cSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X4r2_cSNV_syn_pre_lib_med <- unname(X4r2_cSNV_syn_pre_lib_quarts[3])
X4r2_cSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X4r2_cSNV_nonsense_pre_lib_med <- unname(X4r2_cSNV_nonsense_pre_lib_quarts[3])
X4r2_cSNV_syn_to_non_pre_lib_spread <- X4r2_cSNV_syn_pre_lib_med - X4r2_cSNV_nonsense_pre_lib_med

X4r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_missense_pre_lib_med <- unname(X4r1r2a_cSNV_missense_pre_lib_quarts[3])
X4r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_syn_pre_lib_med <- unname(X4r1r2a_cSNV_syn_pre_lib_quarts[3])
X4r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X4r1r2a_cSNV_nonsense_pre_lib_med <- unname(X4r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X4r1r2a_cSNV_syn_to_non_pre_lib_spread <- X4r1r2a_cSNV_syn_pre_lib_med - X4r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X4r1_tSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X4r1_tSNV_missense_pre_lib_med <- unname(X4r1_tSNV_missense_pre_lib_quarts[3])
X4r1_tSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X4r1_tSNV_syn_pre_lib_med <- unname(X4r1_tSNV_syn_pre_lib_quarts[3])
X4r1_tSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X4r1_tSNV_nonsense_pre_lib_med <- unname(X4r1_tSNV_nonsense_pre_lib_quarts[3])
X4r1_tSNV_syn_to_non_pre_lib_spread <- X4r1_tSNV_syn_pre_lib_med - X4r1_tSNV_nonsense_pre_lib_med

X4r2_tSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X4r2_tSNV_missense_pre_lib_med <- unname(X4r2_tSNV_missense_pre_lib_quarts[3])
X4r2_tSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X4r2_tSNV_syn_pre_lib_med <- unname(X4r2_tSNV_syn_pre_lib_quarts[3])
X4r2_tSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X4r2_tSNV_nonsense_pre_lib_med <- unname(X4r2_tSNV_nonsense_pre_lib_quarts[3])
X4r2_tSNV_syn_to_non_pre_lib_spread <- X4r2_tSNV_syn_pre_lib_med - X4r2_tSNV_nonsense_pre_lib_med

X4r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_missense_pre_lib_med <- unname(X4r1r2a_tSNV_missense_pre_lib_quarts[3])
X4r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_syn_pre_lib_med <- unname(X4r1r2a_tSNV_syn_pre_lib_quarts[3])
X4r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X4r1r2a_tSNV_nonsense_pre_lib_med <- unname(X4r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X4r1r2a_tSNV_syn_to_non_pre_lib_spread <- X4r1r2a_tSNV_syn_pre_lib_med - X4r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X4r1_tSNV_syn_rna_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X4r1_tSNV_syn_rna_pre_med <- unname(X4r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X4r1_tSNV_syn_rna_post_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X4r1_tSNV_syn_rna_post_med <- unname(X4r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X4r2_tSNV_syn_rna_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X4r2_tSNV_syn_rna_pre_med <- unname(X4r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X4r2_tSNV_syn_rna_post_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X4r2_tSNV_syn_rna_post_med <- unname(X4r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X4r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X4r1r2a_tSNV_syn_rna_pre_med <- unname(X4r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X4r1r2a_tSNV_syn_rna_post_quarts <- quantile(X4r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X4r1r2a_tSNV_syn_rna_post_med <- unname(X4r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X4r1_cSNV_syn_pre_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X4r1_cSNV_syn_post_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X4r1_cSNV_syn_post_lib_med
# tHDR
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X4r1_tSNV_syn_pre_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X4r1_tSNV_syn_post_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X4r1_tSNV_syn_post_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X4r1_tSNV_syn_rna_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X4r1_tSNV_syn_rna_post_med

#r2
X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X4r2_cSNV_syn_pre_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X4r2_cSNV_syn_post_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X4r2_cSNV_syn_post_lib_med
# tHDR
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X4r2_tSNV_syn_pre_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X4r2_tSNV_syn_post_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X4r2_tSNV_syn_post_lib_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X4r2_tSNV_syn_rna_pre_med
X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X4r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X4r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X4r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X4r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X4r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X4r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X4r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X4r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X4r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X4r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X4r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X4r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X4r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X4r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X4r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X4r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X4r1_prog_var_thresh5_df_r2_int_ord[which(X4r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X4r1_prog_var_thresh5_df_r2_int_ord
X4r1_prog_map_thresh5_df_r2_int_ord = which(X4r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X4r1_prog_map_thresh5_df_r2_int_ord_df = X4r1_prog_var_thresh5_df_r2_int_ord[X4r1_prog_map_thresh5_df_r2_int_ord,]
X4r1_prog_map_exon_thresh5_df_r2_int_ord = which(X4r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X4r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X4r1_prog_map_exon_thresh5_df_r2_int_ord_df = X4r1_prog_map_thresh5_df_r2_int_ord_df[X4r1_prog_map_exon_thresh5_df_r2_int_ord,]
X4r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X4r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X4r1_prog_map_thresh5_df_r2_int_ord_df[X4r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X4r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X4r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X4r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X4r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X4r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X4r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X4r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X4r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X4r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X4r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X4r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X4r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X4r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X4r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X4r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X4r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X4r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X4r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X4r1r2_cSNV_r1_post_by_r2_post_cor_s
X4r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X4r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X4r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X4r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X4r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X4r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X4r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X4r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X4r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X4r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X4r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X4r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X4r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X4r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X4r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X4r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X4r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X4r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1_cSNV_post_pre_by_cadd_cor_s
#X4r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X4r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r2_cSNV_post_pre_by_cadd_cor_s

#X4r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X4r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1_cSNV_post_lib_by_cadd_cor_s
#X4r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X4r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X4r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X4r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1_tSNV_post_pre_by_cadd_cor_s
#X4r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X4r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r2_tSNV_post_pre_by_cadd_cor_s

#X4r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X4r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1_tSNV_post_lib_by_cadd_cor_s
#X4r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X4r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X4r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X4r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X4r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X4r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X4r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X4r1_prog_var_all_lib_count
X4r1_prog_var_all_pre_count
X4r2_prog_var_all_pre_count
X4r1_prog_map_thresh5_lib_count
X4r1_prog_map_thresh5_pre_count
X4r2_prog_map_thresh5_pre_count
X4r1_prog_map_thresh5_post_count
X4r2_prog_map_thresh5_post_count
X4r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X4r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X4r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X4r1r2_cSNV_r1_post_by_r2_post_cor_s
X4r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X4r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X4r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X4r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X4r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X4r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X4r1_cSNV_post_pre_by_cadd_cor_s
X4r2_cSNV_post_pre_by_cadd_cor_s
X4r1_cSNV_post_lib_by_cadd_cor_s
X4r2_cSNV_post_lib_by_cadd_cor_s
X4r1_tSNV_post_pre_by_cadd_cor_s
X4r2_tSNV_post_pre_by_cadd_cor_s
X4r1_tSNV_post_lib_by_cadd_cor_s
X4r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X4r1r2a_cSNV_post_pre_by_cadd_cor_s
X4r1r2w_cSNV_post_pre_by_cadd_cor_s
X4r1r2a_cSNV_post_lib_by_cadd_cor_s
X4r1r2w_cSNV_post_lib_by_cadd_cor_s
X4r1r2a_tSNV_post_pre_by_cadd_cor_s
X4r1r2w_tSNV_post_pre_by_cadd_cor_s
X4r1r2a_tSNV_post_lib_by_cadd_cor_s
X4r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X4r1_cSNV_syn_to_non_post_pre_spread
X4r2_cSNV_syn_to_non_post_pre_spread
X4r1r2a_cSNV_syn_to_non_post_pre_spread
X4r1_cSNV_syn_to_non_post_lib_spread
X4r2_cSNV_syn_to_non_post_lib_spread
X4r1r2a_cSNV_syn_to_non_post_lib_spread
X4r1_tSNV_syn_to_non_post_pre_spread
X4r2_tSNV_syn_to_non_post_pre_spread
X4r1r2a_tSNV_syn_to_non_post_pre_spread
X4r1_tSNV_syn_to_non_post_lib_spread
X4r2_tSNV_syn_to_non_post_lib_spread
X4r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X4r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X4r1_prog_map_thresh5_df_r2_int_ord_df[which(X4r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X4r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df[which(X4r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df[which(X4r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df[which(X4r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X4r1_cSNV_pre_lib_cors = cor(log2(X4r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X4r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4r1_tSNV_pre_lib_cors = cor(log2(X4r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4r1_cSNV_post_lib_cors = cor(log2(X4r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X4r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X4r1_tSNV_post_lib_cors = cor(log2(X4r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X4r1_cSNV_post_pre_cors = cor(log2(X4r1_prog_map_thresh5_df$post_pseudo_freq),log2(X4r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4r1_tSNV_post_pre_cors = cor(log2(X4r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X4r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4r1_cSNV_rna_lib_cors = cor(log2(X4r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X4r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4r1_tSNV_rna_lib_cors = cor(log2(X4r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X4r1_cSNV_rna_pre_cors = cor(log2(X4r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X4r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4r1_tSNV_rna_pre_cors = cor(log2(X4r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X4r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4r1r2_cSNV_pre_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X4r1r2_tSNV_pre_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X4r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X4r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X4r1r2_cSNV_post_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X4r1r2_tSNV_post_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X4r1r2_cSNV_post_lib_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X4r1r2_tSNV_post_lib_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X4r1r2_cSNV_post_pre_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X4r1r2_tSNV_post_pre_ratio_cors = cor(log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X4r1r2_cSNV_rna_cors = cor(log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X4r1r2_tSNV_rna_cors = cor(log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X4r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X4r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X4r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X4r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X4r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X4r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X4r1_cors <- c("X4r1",X4r1_cSNV_pre_lib_cors,X4r1_tSNV_pre_lib_cors,X4r1_cSNV_post_lib_cors,X4r1_tSNV_post_lib_cors,X4r1_cSNV_post_pre_cors,X4r1_tSNV_post_pre_cors,X4r1_cSNV_rna_lib_cors,X4r1_tSNV_rna_lib_cors,X4r1_cSNV_rna_pre_cors,X4r1_tSNV_rna_pre_cors,X4r1r2_cSNV_pre_cors,X4r1r2_tSNV_pre_cors,X4r1r2_cSNV_pre_lib_ratio_cors,X4r1r2_tSNV_pre_lib_ratio_cors,X4r1r2_cSNV_post_cors,X4r1r2_tSNV_post_cors,X4r1r2_cSNV_post_lib_ratio_cors,X4r1r2_tSNV_post_lib_ratio_cors,X4r1r2_cSNV_post_pre_ratio_cors,X4r1r2_tSNV_post_pre_ratio_cors,X4r1r2_cSNV_rna_cors,X4r1r2_tSNV_rna_cors,X4r1r2_tSNV_rna_pre_ratio_cors,X4r1_cSNV_pre_lib_ratio_cadd_cors,X4r1_tSNV_pre_lib_ratio_cadd_cors,X4r1_cSNV_post_lib_ratio_cadd_cors,X4r1_tSNV_post_lib_ratio_cadd_cors,X4r1_cSNV_post_pre_ratio_cadd_cors,X4r1_tSNV_post_pre_ratio_cadd_cors,X4r1_cSNV_post_pre_ratio_cadd_missense_cors,X4r1_tSNV_post_pre_ratio_cadd_missense_cors,X4r1_cSNV_post_pre_ratio_polyphen_missense_cors,X4r1_tSNV_post_pre_ratio_polyphen_missense_cors,X4r1_cSNV_post_pre_ratio_grantham_missense_cors,X4r1_tSNV_post_pre_ratio_grantham_missense_cors,X4r1r2a_cSNV_pre_lib_ratio_cadd_cors,X4r1r2a_tSNV_pre_lib_ratio_cadd_cors,X4r1r2a_cSNV_post_lib_ratio_cadd_cors,X4r1r2a_tSNV_post_lib_ratio_cadd_cors,X4r1r2a_cSNV_post_pre_ratio_cadd_cors,X4r1r2a_tSNV_post_pre_ratio_cadd_cors,X4r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X4r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X4r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X4r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X4r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X4r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X4r1r2w_cSNV_pre_lib_ratio_cadd_cors,X4r1r2w_cSNV_post_lib_ratio_cadd_cors,X4r1r2w_cSNV_post_pre_ratio_cadd_cors,X4r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X4r2_cSNV_pre_lib_cors = cor(log2(X4r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X4r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4r2_tSNV_pre_lib_cors = cor(log2(X4r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4r2_cSNV_post_lib_cors = cor(log2(X4r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X4r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X4r2_tSNV_post_lib_cors = cor(log2(X4r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X4r2_cSNV_post_pre_cors = cor(log2(X4r2_prog_map_thresh5_df$post_pseudo_freq),log2(X4r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4r2_tSNV_post_pre_cors = cor(log2(X4r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X4r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4r2_cSNV_rna_lib_cors = cor(log2(X4r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X4r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4r2_tSNV_rna_lib_cors = cor(log2(X4r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X4r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X4r2_cSNV_rna_pre_cors = cor(log2(X4r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X4r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4r2_tSNV_rna_pre_cors = cor(log2(X4r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X4r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X4r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X4r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X4r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X4r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X4r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X4r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X4r2_cors <- c("X4r2",X4r2_cSNV_pre_lib_cors,X4r2_tSNV_pre_lib_cors,X4r2_cSNV_post_lib_cors,X4r2_tSNV_post_lib_cors,X4r2_cSNV_post_pre_cors,X4r2_tSNV_post_pre_cors,X4r2_cSNV_rna_lib_cors,X4r2_tSNV_rna_lib_cors,X4r2_cSNV_rna_pre_cors,X4r2_tSNV_rna_pre_cors,X4r1r2_cSNV_pre_cors,X4r1r2_tSNV_pre_cors,X4r1r2_cSNV_pre_lib_ratio_cors,X4r1r2_tSNV_pre_lib_ratio_cors,X4r1r2_cSNV_post_cors,X4r1r2_tSNV_post_cors,X4r1r2_cSNV_post_lib_ratio_cors,X4r1r2_tSNV_post_lib_ratio_cors,X4r1r2_cSNV_post_pre_ratio_cors,X4r1r2_tSNV_post_pre_ratio_cors,X4r1r2_cSNV_rna_cors,X4r1r2_tSNV_rna_cors,X4r1r2_tSNV_rna_pre_ratio_cors,X4r2_cSNV_pre_lib_ratio_cadd_cors,X4r2_tSNV_pre_lib_ratio_cadd_cors,X4r2_cSNV_post_lib_ratio_cadd_cors,X4r2_tSNV_post_lib_ratio_cadd_cors,X4r2_cSNV_post_pre_ratio_cadd_cors,X4r2_tSNV_post_pre_ratio_cadd_cors,X4r2_cSNV_post_pre_ratio_cadd_missense_cors,X4r2_tSNV_post_pre_ratio_cadd_missense_cors,X4r2_cSNV_post_pre_ratio_polyphen_missense_cors,X4r2_tSNV_post_pre_ratio_polyphen_missense_cors,X4r2_cSNV_post_pre_ratio_grantham_missense_cors,X4r2_tSNV_post_pre_ratio_grantham_missense_cors,X4r1r2a_cSNV_pre_lib_ratio_cadd_cors,X4r1r2a_tSNV_pre_lib_ratio_cadd_cors,X4r1r2a_cSNV_post_lib_ratio_cadd_cors,X4r1r2a_tSNV_post_lib_ratio_cadd_cors,X4r1r2a_cSNV_post_pre_ratio_cadd_cors,X4r1r2a_tSNV_post_pre_ratio_cadd_cors,X4r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X4r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X4r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X4r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X4r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X4r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X4r1r2w_cSNV_pre_lib_ratio_cadd_cors,X4r1r2w_cSNV_post_lib_ratio_cadd_cors,X4r1r2w_cSNV_post_pre_ratio_cadd_cors,X4r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X4r1)
rm(X4r2)
gc()
X5r1_file <- paste(experiment_dir_171011,'X5r1','_annotated.txt',sep='')
X5r2_file <- paste(experiment_dir_171011,'X5r2','_annotated.txt',sep='')
X5r1 <- read.table(X5r1_file, header=TRUE, sep="\t")
X5r2 <- read.table(X5r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X5 <- editing_info[which(editing_info$amplicon == 'X5'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X5_HDR_5_SNV = as.character(editing_info_X5$HDR_5_SNV)
X5_HDR_3_SNV = as.character(editing_info_X5$HDR_3_SNV)
#X5_cut_pos = as.character(editing_info_X5$cut_pos)
X5_cut_end = as.character(editing_info_X5$cut_end)
X5_mut_start = as.character(editing_info_X5$mut_start)
X5_mut_end = as.character(editing_info_X5$mut_end)
### Replicate 1
X5r1_cSNV_all <- which(X5r1[,'c_hdr_snv']=='True')
X5r1_cSNV_all_df = X5r1[X5r1_cSNV_all,]
X5r1_prog_var_all <- which(X5r1[,'all_hdr_variant']=='True' & X5r1[,'edit_string']!='-WT')
X5r1_prog_var_all_df = X5r1[X5r1_prog_var_all,]
X5r1_prog_map_all = which(X5r1_prog_var_all_df[,'pos']!='REF')
X5r1_prog_map_all_df = X5r1_prog_var_all_df[X5r1_prog_map_all,]
X5r1_prog_map_exon_all = which(X5r1_prog_map_all_df[,'cDNApos']!='REF' & X5r1_prog_map_all_df[,'cDNApos']!='NA')
X5r1_prog_map_exon_all_df = X5r1_prog_map_all_df[X5r1_prog_map_exon_all,]
X5r1_prog_map_CADD = which(X5r1_prog_map_all_df[,'CADD.phred']!='NA')
X5r1_prog_map_CADD_df = X5r1_prog_map_all_df[X5r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X5r1_prog_var_thresh5 <- which(as.numeric(as.character(X5r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X5r1_prog_var_thresh5_df = X5r1_prog_var_all_df[X5r1_prog_var_thresh5,]
X5r1_prog_map_thresh5 <- which(as.numeric(as.character(X5r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X5r1_prog_map_thresh5_df = X5r1_prog_map_all_df[X5r1_prog_map_thresh5,]
X5r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X5r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X5r1_prog_map_exon_thresh5_df = X5r1_prog_map_exon_all_df[X5r1_prog_map_exon_thresh5,]
X5r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X5r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X5r1_prog_map_CADD_thresh5_df = X5r1_prog_map_CADD_df[X5r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X5r1_prog_var_all_lib_count = length(X5r1_prog_var_all_df$lib)
X5r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X5r1_prog_var_all_min_lib_counts = min(X5r1_prog_var_all_df$lib)
X5r1_prog_var_all_min_lib_counts
X5r1_prog_var_all_max_lib_counts = max(X5r1_prog_var_all_df$lib)
X5r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X5r1_prog_map_all_lib_count = length(X5r1_prog_map_all_df$lib)
X5r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X5r1_prog_map_all_min_lib_counts = min(X5r1_prog_map_all_df$lib)
X5r1_prog_map_all_min_lib_counts
X5r1_prog_map_all_max_lib_counts = max(X5r1_prog_map_all_df$lib)
X5r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X5r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X5r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X5r1_prog_var_all_pre_count = length(X5r1_prog_var_all_df$pre)
X5r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X5r1_prog_var_all_min_pre_counts = min(X5r1_prog_var_all_df$pre)
X5r1_prog_var_all_min_pre_counts
X5r1_prog_var_all_max_pre_counts = max(X5r1_prog_var_all_df$pre)
X5r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X5r1_prog_map_all_pre_count = length(X5r1_prog_map_all_df$pre)
X5r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X5r1_prog_map_all_min_pre_counts = min(X5r1_prog_map_all_df$pre)
X5r1_prog_map_all_min_pre_counts
X5r1_prog_map_all_max_pre_counts = max(X5r1_prog_map_all_df$pre)
X5r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X5r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X5r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X5r1_prog_map_all_post_count = length(X5r1_prog_map_all_df$post)
X5r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X5r1_prog_map_all_min_post_counts = min(X5r1_prog_map_all_df$post)
X5r1_prog_map_all_min_post_counts
X5r1_prog_map_all_max_post_counts = max(X5r1_prog_map_all_df$post)
X5r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X5r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X5r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X5r1_prog_map_all_syn_df <- X5r1_prog_map_all_df[which(X5r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X5r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X5r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X5r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X5r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X5r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X5r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X5r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X5r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X5r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X5r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X5r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X5r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X5r1_prog_map_all_min_rna_counts = min(X5r1_prog_map_exon_all_df$tHDR_rna)
X5r1_prog_map_all_min_rna_counts
X5r1_prog_map_all_max_rna_counts = max(X5r1_prog_map_exon_all_df$tHDR_rna)
X5r1_prog_map_all_max_rna_counts
X5r1_prog_map_all_min_rna_pseudo_freq = min(X5r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5r1_prog_map_all_min_rna_pseudo_freq
X5r1_prog_map_all_max_rna_pseudo_freq = max(X5r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5r1_prog_map_all_max_rna_pseudo_freq
X5r1_prog_map_all_min_rna_pre_ratio = min(X5r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5r1_prog_map_all_min_rna_pre_ratio
X5r1_prog_map_all_max_rna_pre_ratio = max(X5r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5r1_prog_map_all_max_rna_pre_ratio
X5r1_prog_map_all_min_rna_post_ratio = min(X5r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5r1_prog_map_all_min_rna_post_ratio
X5r1_prog_map_all_max_rna_post_ratio = max(X5r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X5r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X5r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X5r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X5r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X5r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X5r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X5r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X5r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X5r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X5r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X5r1_prog_map_all_df$post_pre_ratio),log2(X5r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X5r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X5r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X5r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X5r1_cSNV_all_corr_pre_count = length(X5r1_cSNV_all_df$corr_pre)
X5r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X5r1_cSNV_all_min_corr_pre_counts = min(X5r1_cSNV_all_df$corr_pre)
X5r1_cSNV_all_min_corr_pre_counts
X5r1_cSNV_all_max_corr_pre_counts = max(X5r1_cSNV_all_df$corr_pre)
X5r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X5r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X5r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X5r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X5r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X5r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_cSNV_all_corr_post_count = length(X5r1_cSNV_all_df$corr_post)
X5r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X5r1_cSNV_all_min_corr_post_counts = min(X5r1_cSNV_all_df$corr_post)
X5r1_cSNV_all_min_corr_post_counts
X5r1_cSNV_all_max_corr_post_counts = max(X5r1_cSNV_all_df$corr_post)
X5r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X5r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X5r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X5r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X5r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X5r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X5r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X5_p_hdr_snv = paste('p_hdr_',X5_cut_end,'_snv',sep='')
X5r1_pSNV_all <- which(X5r1[,X5_p_hdr_snv]=='True')
X5r1_pSNV_all_df = X5r1[X5r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_pSNV_all_lib_count = length(X5r1_pSNV_all_df$lib)
X5r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X5r1_pSNV_all_min_lib_counts = min(X5r1_pSNV_all_df$lib)
X5r1_pSNV_all_min_lib_counts
X5r1_pSNV_all_max_lib_counts = max(X5r1_pSNV_all_df$lib)
X5r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X5r1_pSNV_all_pre_count = length(X5r1_pSNV_all_df$pre)
X5r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X5r1_pSNV_all_min_pre_counts = min(X5r1_pSNV_all_df$pre)
X5r1_pSNV_all_min_pre_counts
X5r1_pSNV_all_max_pre_counts = max(X5r1_pSNV_all_df$pre)
X5r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X5r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X5r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_pSNV_all_post_count = length(X5r1_pSNV_all_df$post)
X5r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X5r1_pSNV_all_min_post_counts = min(X5r1_pSNV_all_df$post)
X5r1_pSNV_all_min_post_counts
X5r1_pSNV_all_max_post_counts = max(X5r1_pSNV_all_df$post)
X5r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X5r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X5r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_prog_map_thresh5_lib_count = length(X5r1_prog_map_thresh5_df$lib)
X5r1_prog_map_thresh5_lib_count
X5r1_prog_map_thresh5_min_lib_counts = min(X5r1_prog_map_thresh5_df$lib)
X5r1_prog_map_thresh5_min_lib_counts
X5r1_prog_map_thresh5_max_lib_counts = max(X5r1_prog_map_thresh5_df$lib)
X5r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X5r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X5r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_prog_map_thresh5_pre_count = length(X5r1_prog_map_thresh5_df$pre)
X5r1_prog_map_thresh5_pre_count
X5r1_prog_map_thresh5_min_pre_counts = min(X5r1_prog_map_thresh5_df$pre)
X5r1_prog_map_thresh5_min_pre_counts
X5r1_prog_map_thresh5_max_pre_counts = max(X5r1_prog_map_thresh5_df$pre)
X5r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r1_prog_map_thresh5_post_count = length(X5r1_prog_map_thresh5_df$post)
X5r1_prog_map_thresh5_post_count
X5r1_prog_map_thresh5_min_post_counts = min(X5r1_prog_map_thresh5_df$post)
X5r1_prog_map_thresh5_min_post_counts
X5r1_prog_map_thresh5_max_post_counts = max(X5r1_prog_map_thresh5_df$post)
X5r1_prog_map_thresh5_max_post_counts
X5r1_prog_map_thresh5_corr_post_count = length(X5r1_cSNV_all_df$corr_post)
X5r1_prog_map_thresh5_corr_post_count
X5r1_prog_map_thresh5_min_corr_post_counts = min(X5r1_cSNV_all_df$corr_post)
X5r1_prog_map_thresh5_min_corr_post_counts
X5r1_prog_map_thresh5_max_corr_post_counts = max(X5r1_cSNV_all_df$corr_post)
X5r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X5r1_pSNV_thresh5 <- which(X5r1[,X5_p_hdr_snv]=='True' & as.numeric(as.character(X5r1[,'pre_freq']))>=0.00001)
X5r1_pSNV_thresh5_df = X5r1[X5r1_pSNV_thresh5,]
X5r1_pSNV_thresh5_lib_count = length(X5r1_pSNV_thresh5_df$lib)
X5r1_pSNV_thresh5_lib_count
X5r1_pSNV_thresh5_min_lib_counts = min(X5r1_pSNV_thresh5_df$lib)
X5r1_pSNV_thresh5_min_lib_counts
X5r1_pSNV_thresh5_max_lib_counts = max(X5r1_pSNV_thresh5_df$lib)
X5r1_pSNV_thresh5_max_lib_counts
X5r1_pSNV_thresh5_pre_count = length(X5r1_pSNV_thresh5_df$pre)
X5r1_pSNV_thresh5_pre_count
X5r1_pSNV_thresh5_min_pre_counts = min(X5r1_pSNV_thresh5_df$pre)
X5r1_pSNV_thresh5_min_pre_counts
X5r1_pSNV_thresh5_max_pre_counts = max(X5r1_pSNV_thresh5_df$pre)
X5r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X5r1_pSNV_thresh5_post_count = length(X5r1_pSNV_thresh5_df$post)
X5r1_pSNV_thresh5_post_count
X5r1_pSNV_thresh5_min_post_counts = min(X5r1_pSNV_thresh5_df$post)
X5r1_pSNV_thresh5_min_post_counts
X5r1_pSNV_thresh5_max_post_counts = max(X5r1_pSNV_thresh5_df$post)
X5r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X5r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X5r1_pSNV_thresh5_post_pos

### Replicate 2
X5r2_cSNV_all <- which(X5r2[,'c_hdr_snv']=='True')
X5r2_cSNV_all_df = X5r2[X5r2_cSNV_all,]
X5r2_prog_var_all <- which(X5r2[,'all_hdr_variant']=='True' & X5r2[,'edit_string']!='-WT')
X5r2_prog_var_all_df = X5r2[X5r2_prog_var_all,]
X5r2_prog_map_all = which(X5r2_prog_var_all_df[,'pos']!='REF')
X5r2_prog_map_all_df = X5r2_prog_var_all_df[X5r2_prog_map_all,]
X5r2_prog_map_exon_all = which(X5r2_prog_map_all_df[,'cDNApos']!='REF' & X5r2_prog_map_all_df[,'cDNApos']!='NA')
X5r2_prog_map_exon_all_df = X5r2_prog_map_all_df[X5r2_prog_map_exon_all,]
X5r2_prog_map_CADD = which(X5r2_prog_map_all_df[,'CADD.phred']!='NA')
X5r2_prog_map_CADD_df = X5r2_prog_map_all_df[X5r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X5r2_prog_var_thresh5 <- which(as.numeric(as.character(X5r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X5r2_prog_var_thresh5_df = X5r2_prog_var_all_df[X5r2_prog_var_thresh5,]
X5r2_prog_map_thresh5 <- which(as.numeric(as.character(X5r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X5r2_prog_map_thresh5_df = X5r2_prog_map_all_df[X5r2_prog_map_thresh5,]
X5r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X5r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X5r2_prog_map_exon_thresh5_df = X5r2_prog_map_exon_all_df[X5r2_prog_map_exon_thresh5,]
X5r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X5r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X5r2_prog_map_CADD_thresh5_df = X5r2_prog_map_CADD_df[X5r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X5r2_prog_var_all_lib_count = length(X5r2_prog_var_all_df$lib)
X5r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X5r2_prog_var_all_min_lib_counts = min(X5r2_prog_var_all_df$lib)
X5r2_prog_var_all_min_lib_counts
X5r2_prog_var_all_max_lib_counts = max(X5r2_prog_var_all_df$lib)
X5r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X5r2_prog_map_all_lib_count = length(X5r2_prog_map_all_df$lib)
X5r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X5r2_prog_map_all_min_lib_counts = min(X5r2_prog_map_all_df$lib)
X5r2_prog_map_all_min_lib_counts
X5r2_prog_map_all_max_lib_counts = max(X5r2_prog_map_all_df$lib)
X5r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X5r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X5r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X5r2_prog_var_all_pre_count = length(X5r2_prog_var_all_df$pre)
X5r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X5r2_prog_var_all_min_pre_counts = min(X5r2_prog_var_all_df$pre)
X5r2_prog_var_all_min_pre_counts
X5r2_prog_var_all_max_pre_counts = max(X5r2_prog_var_all_df$pre)
X5r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X5r2_prog_map_all_pre_count = length(X5r2_prog_map_all_df$pre)
X5r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X5r2_prog_map_all_min_pre_counts = min(X5r2_prog_map_all_df$pre)
X5r2_prog_map_all_min_pre_counts
X5r2_prog_map_all_max_pre_counts = max(X5r2_prog_map_all_df$pre)
X5r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X5r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X5r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X5r2_prog_map_all_post_count = length(X5r2_prog_map_all_df$post)
X5r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X5r2_prog_map_all_min_post_counts = min(X5r2_prog_map_all_df$post)
X5r2_prog_map_all_min_post_counts
X5r2_prog_map_all_max_post_counts = max(X5r2_prog_map_all_df$post)
X5r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X5r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X5r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X5r2_prog_map_all_syn_df <- X5r2_prog_map_all_df[which(X5r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X5r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X5r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X5r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X5r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X5r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X5r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X5r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X5r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X5r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X5r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X5r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X5r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X5r2_prog_map_all_min_rna_counts = min(X5r2_prog_map_exon_all_df$tHDR_rna)
X5r2_prog_map_all_min_rna_counts
X5r2_prog_map_all_max_rna_counts = max(X5r2_prog_map_exon_all_df$tHDR_rna)
X5r2_prog_map_all_max_rna_counts
X5r2_prog_map_all_min_rna_pseudo_freq = min(X5r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5r2_prog_map_all_min_rna_pseudo_freq
X5r2_prog_map_all_max_rna_pseudo_freq = max(X5r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5r2_prog_map_all_max_rna_pseudo_freq
X5r2_prog_map_all_min_rna_pre_ratio = min(X5r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5r2_prog_map_all_min_rna_pre_ratio
X5r2_prog_map_all_max_rna_pre_ratio = max(X5r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5r2_prog_map_all_max_rna_pre_ratio
X5r2_prog_map_all_min_rna_post_ratio = min(X5r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5r2_prog_map_all_min_rna_post_ratio
X5r2_prog_map_all_max_rna_post_ratio = max(X5r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X5r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X5r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X5r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X5r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X5r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X5r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X5r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X5r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X5r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X5r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X5r2_prog_map_all_df$post_pre_ratio),log2(X5r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X5r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X5r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X5r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X5r2_cSNV_all_corr_pre_count = length(X5r2_cSNV_all_df$corr_pre)
X5r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X5r2_cSNV_all_min_corr_pre_counts = min(X5r2_cSNV_all_df$corr_pre)
X5r2_cSNV_all_min_corr_pre_counts
X5r2_cSNV_all_max_corr_pre_counts = max(X5r2_cSNV_all_df$corr_pre)
X5r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X5r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X5r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X5r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X5r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X5r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_cSNV_all_corr_post_count = length(X5r2_cSNV_all_df$corr_post)
X5r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X5r2_cSNV_all_min_corr_post_counts = min(X5r2_cSNV_all_df$corr_post)
X5r2_cSNV_all_min_corr_post_counts
X5r2_cSNV_all_max_corr_post_counts = max(X5r2_cSNV_all_df$corr_post)
X5r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X5r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X5r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X5r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X5r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X5r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X5r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X5_p_hdr_snv = paste('p_hdr_',X5_cut_end,'_snv',sep='')
X5r2_pSNV_all <- which(X5r2[,X5_p_hdr_snv]=='True')
X5r2_pSNV_all_df = X5r2[X5r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_pSNV_all_lib_count = length(X5r2_pSNV_all_df$lib)
X5r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X5r2_pSNV_all_min_lib_counts = min(X5r2_pSNV_all_df$lib)
X5r2_pSNV_all_min_lib_counts
X5r2_pSNV_all_max_lib_counts = max(X5r2_pSNV_all_df$lib)
X5r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X5r2_pSNV_all_pre_count = length(X5r2_pSNV_all_df$pre)
X5r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X5r2_pSNV_all_min_pre_counts = min(X5r2_pSNV_all_df$pre)
X5r2_pSNV_all_min_pre_counts
X5r2_pSNV_all_max_pre_counts = max(X5r2_pSNV_all_df$pre)
X5r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X5r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X5r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_pSNV_all_post_count = length(X5r2_pSNV_all_df$post)
X5r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X5r2_pSNV_all_min_post_counts = min(X5r2_pSNV_all_df$post)
X5r2_pSNV_all_min_post_counts
X5r2_pSNV_all_max_post_counts = max(X5r2_pSNV_all_df$post)
X5r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X5r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X5r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_prog_map_thresh5_lib_count = length(X5r2_prog_map_thresh5_df$lib)
X5r2_prog_map_thresh5_lib_count
X5r2_prog_map_thresh5_min_lib_counts = min(X5r2_prog_map_thresh5_df$lib)
X5r2_prog_map_thresh5_min_lib_counts
X5r2_prog_map_thresh5_max_lib_counts = max(X5r2_prog_map_thresh5_df$lib)
X5r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X5r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X5r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_prog_map_thresh5_pre_count = length(X5r2_prog_map_thresh5_df$pre)
X5r2_prog_map_thresh5_pre_count
X5r2_prog_map_thresh5_min_pre_counts = min(X5r2_prog_map_thresh5_df$pre)
X5r2_prog_map_thresh5_min_pre_counts
X5r2_prog_map_thresh5_max_pre_counts = max(X5r2_prog_map_thresh5_df$pre)
X5r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5r2_prog_map_thresh5_post_count = length(X5r2_prog_map_thresh5_df$post)
X5r2_prog_map_thresh5_post_count
X5r2_prog_map_thresh5_min_post_counts = min(X5r2_prog_map_thresh5_df$post)
X5r2_prog_map_thresh5_min_post_counts
X5r2_prog_map_thresh5_max_post_counts = max(X5r2_prog_map_thresh5_df$post)
X5r2_prog_map_thresh5_max_post_counts
X5r2_prog_map_thresh5_corr_post_count = length(X5r2_prog_map_thresh5_df$corr_post)
X5r2_prog_map_thresh5_corr_post_count
X5r2_prog_map_thresh5_min_corr_post_counts = min(X5r2_prog_map_thresh5_df$corr_post)
X5r2_prog_map_thresh5_min_corr_post_counts
X5r2_prog_map_thresh5_max_corr_post_counts = max(X5r2_prog_map_thresh5_df$corr_post)
X5r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X5r2_pSNV_thresh5 <- which(X5r2[,X5_p_hdr_snv]=='True' & as.numeric(as.character(X5r2[,'pre_freq']))>=0.00001)
X5r2_pSNV_thresh5_df = X5r2[X5r2_pSNV_thresh5,]
X5r2_pSNV_thresh5_lib_count = length(X5r2_pSNV_thresh5_df$lib)
X5r2_pSNV_thresh5_lib_count
X5r2_pSNV_thresh5_min_lib_counts = min(X5r2_pSNV_thresh5_df$lib)
X5r2_pSNV_thresh5_min_lib_counts
X5r2_pSNV_thresh5_max_lib_counts = max(X5r2_pSNV_thresh5_df$lib)
X5r2_pSNV_thresh5_max_lib_counts
X5r2_pSNV_thresh5_pre_count = length(X5r2_pSNV_thresh5_df$pre)
X5r2_pSNV_thresh5_pre_count
X5r2_pSNV_thresh5_min_pre_counts = min(X5r2_pSNV_thresh5_df$pre)
X5r2_pSNV_thresh5_min_pre_counts
X5r2_pSNV_thresh5_max_pre_counts = max(X5r2_pSNV_thresh5_df$pre)
X5r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X5r2_pSNV_thresh5_post_count = length(X5r2_pSNV_thresh5_df$post)
X5r2_pSNV_thresh5_post_count
X5r2_pSNV_thresh5_min_post_counts = min(X5r2_pSNV_thresh5_df$post)
X5r2_pSNV_thresh5_min_post_counts
X5r2_pSNV_thresh5_max_post_counts = max(X5r2_pSNV_thresh5_df$post)
X5r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X5r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X5r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X5r1_prog_var_thresh5_df:
X5r1_prog_var_thresh5_df_r2_int <- X5r1_prog_var_thresh5_df[which(X5r1_prog_var_thresh5_df$variant %in% X5r2_prog_var_thresh5_df$variant),]
#Intersection variants of X5r2_prog_var_thresh5_df:
X5r2_prog_var_thresh5_df_r1_int <- X5r2_prog_var_thresh5_df[which(X5r2_prog_var_thresh5_df$variant %in% X5r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X5r1_prog_var_thresh5_df_r2_int_ord <- X5r1_prog_var_thresh5_df_r2_int[order(X5r1_prog_var_thresh5_df_r2_int$variant),]
X5r2_prog_var_thresh5_df_r1_int_ord <- X5r2_prog_var_thresh5_df_r1_int[order(X5r2_prog_var_thresh5_df_r1_int$variant),]

dim(X5r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X5r1r2int_prog_var_thresh5_pre_count <- dim(X5r1_prog_var_thresh5_df_r2_int)[1] 
X5r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X5r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X5r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X5r2_prog_var_thresh5_df_r1_int_ord$pre
X5r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X5r2_prog_var_thresh5_df_r1_int_ord$lib
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X5r2_prog_var_thresh5_df_r1_int_ord$post
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X5r2_prog_var_thresh5_df_r1_int_ord$rna
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X5r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X5r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X5r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$post_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X5r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X5r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X5r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X5r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X5r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X5r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X5r2_prog_var_thresh5_df_r1_int_ord$corr_post
X5r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X5r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X5r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X5r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X5r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X5r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X5r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X5r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X5r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X5r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X5r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X5r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X5r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X5r1_cSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X5r1_cSNV_missense_post_pre_med <- unname(X5r1_cSNV_missense_post_pre_quarts[3])
X5r1_cSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X5r1_cSNV_syn_post_pre_med <- unname(X5r1_cSNV_syn_post_pre_quarts[3])
X5r1_cSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X5r1_cSNV_nonsense_post_pre_med <- unname(X5r1_cSNV_nonsense_post_pre_quarts[3])
X5r1_cSNV_syn_to_non_post_pre_spread <- X5r1_cSNV_syn_post_pre_med - X5r1_cSNV_nonsense_post_pre_med

X5r2_cSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X5r2_cSNV_missense_post_pre_med <- unname(X5r2_cSNV_missense_post_pre_quarts[3])
X5r2_cSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X5r2_cSNV_syn_post_pre_med <- unname(X5r2_cSNV_syn_post_pre_quarts[3])
X5r2_cSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X5r2_cSNV_nonsense_post_pre_med <- unname(X5r2_cSNV_nonsense_post_pre_quarts[3])
X5r2_cSNV_syn_to_non_post_pre_spread <- X5r2_cSNV_syn_post_pre_med - X5r2_cSNV_nonsense_post_pre_med

X5r1r2a_cSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X5r1r2a_cSNV_missense_post_pre_med <- unname(X5r1r2a_cSNV_missense_post_pre_quarts[3])
X5r1r2a_cSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X5r1r2a_cSNV_syn_post_pre_med <- unname(X5r1r2a_cSNV_syn_post_pre_quarts[3])
X5r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X5r1r2a_cSNV_nonsense_post_pre_med <- unname(X5r1r2a_cSNV_nonsense_post_pre_quarts[3])
X5r1r2a_cSNV_syn_to_non_post_pre_spread <- X5r1r2a_cSNV_syn_post_pre_med - X5r1r2a_cSNV_nonsense_post_pre_med

X5r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_cSNV_missense_post_pre_med <- unname(X5r1r2pw_cSNV_missense_post_pre_quarts[3])
X5r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_cSNV_syn_post_pre_med <- unname(X5r1r2pw_cSNV_syn_post_pre_quarts[3])
X5r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_cSNV_nonsense_post_pre_med <- unname(X5r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X5r1r2pw_cSNV_syn_to_non_post_pre_spread <- X5r1r2pw_cSNV_syn_post_pre_med - X5r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X5r1_tSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X5r1_tSNV_missense_post_pre_med <- unname(X5r1_tSNV_missense_post_pre_quarts[3])
X5r1_tSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X5r1_tSNV_syn_post_pre_med <- unname(X5r1_tSNV_syn_post_pre_quarts[3])
X5r1_tSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X5r1_tSNV_nonsense_post_pre_med <- unname(X5r1_tSNV_nonsense_post_pre_quarts[3])
X5r1_tSNV_syn_to_non_post_pre_spread <- X5r1_tSNV_syn_post_pre_med - X5r1_tSNV_nonsense_post_pre_med

X5r2_tSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X5r2_tSNV_missense_post_pre_med <- unname(X5r2_tSNV_missense_post_pre_quarts[3])
X5r2_tSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X5r2_tSNV_syn_post_pre_med <- unname(X5r2_tSNV_syn_post_pre_quarts[3])
X5r2_tSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X5r2_tSNV_nonsense_post_pre_med <- unname(X5r2_tSNV_nonsense_post_pre_quarts[3])
X5r2_tSNV_syn_to_non_post_pre_spread <- X5r2_tSNV_syn_post_pre_med - X5r2_tSNV_nonsense_post_pre_med

X5r1r2a_tSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X5r1r2a_tSNV_missense_post_pre_med <- unname(X5r1r2a_tSNV_missense_post_pre_quarts[3])
X5r1r2a_tSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X5r1r2a_tSNV_syn_post_pre_med <- unname(X5r1r2a_tSNV_syn_post_pre_quarts[3])
X5r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X5r1r2a_tSNV_nonsense_post_pre_med <- unname(X5r1r2a_tSNV_nonsense_post_pre_quarts[3])
X5r1r2a_tSNV_syn_to_non_post_pre_spread <- X5r1r2a_tSNV_syn_post_pre_med - X5r1r2a_tSNV_nonsense_post_pre_med

X5r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_tSNV_missense_post_pre_med <- unname(X5r1r2pw_tSNV_missense_post_pre_quarts[3])
X5r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_tSNV_syn_post_pre_med <- unname(X5r1r2pw_tSNV_syn_post_pre_quarts[3])
X5r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X5r1r2pw_tSNV_nonsense_post_pre_med <- unname(X5r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X5r1r2pw_tSNV_syn_to_non_post_pre_spread <- X5r1r2pw_tSNV_syn_post_pre_med - X5r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X5r1_cSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X5r1_cSNV_missense_post_lib_med <- unname(X5r1_cSNV_missense_post_lib_quarts[3])
X5r1_cSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X5r1_cSNV_syn_post_lib_med <- unname(X5r1_cSNV_syn_post_lib_quarts[3])
X5r1_cSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X5r1_cSNV_nonsense_post_lib_med <- unname(X5r1_cSNV_nonsense_post_lib_quarts[3])
X5r1_cSNV_syn_to_non_post_lib_spread <- X5r1_cSNV_syn_post_lib_med - X5r1_cSNV_nonsense_post_lib_med

X5r2_cSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X5r2_cSNV_missense_post_lib_med <- unname(X5r2_cSNV_missense_post_lib_quarts[3])
X5r2_cSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X5r2_cSNV_syn_post_lib_med <- unname(X5r2_cSNV_syn_post_lib_quarts[3])
X5r2_cSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X5r2_cSNV_nonsense_post_lib_med <- unname(X5r2_cSNV_nonsense_post_lib_quarts[3])
X5r2_cSNV_syn_to_non_post_lib_spread <- X5r2_cSNV_syn_post_lib_med - X5r2_cSNV_nonsense_post_lib_med

X5r1r2a_cSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_missense_post_lib_med <- unname(X5r1r2a_cSNV_missense_post_lib_quarts[3])
X5r1r2a_cSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_syn_post_lib_med <- unname(X5r1r2a_cSNV_syn_post_lib_quarts[3])
X5r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_nonsense_post_lib_med <- unname(X5r1r2a_cSNV_nonsense_post_lib_quarts[3])
X5r1r2a_cSNV_syn_to_non_post_lib_spread <- X5r1r2a_cSNV_syn_post_lib_med - X5r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X5r1_tSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X5r1_tSNV_missense_post_lib_med <- unname(X5r1_tSNV_missense_post_lib_quarts[3])
X5r1_tSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X5r1_tSNV_syn_post_lib_med <- unname(X5r1_tSNV_syn_post_lib_quarts[3])
X5r1_tSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X5r1_tSNV_nonsense_post_lib_med <- unname(X5r1_tSNV_nonsense_post_lib_quarts[3])
X5r1_tSNV_syn_to_non_post_lib_spread <- X5r1_tSNV_syn_post_lib_med - X5r1_tSNV_nonsense_post_lib_med

X5r2_tSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X5r2_tSNV_missense_post_lib_med <- unname(X5r2_tSNV_missense_post_lib_quarts[3])
X5r2_tSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X5r2_tSNV_syn_post_lib_med <- unname(X5r2_tSNV_syn_post_lib_quarts[3])
X5r2_tSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X5r2_tSNV_nonsense_post_lib_med <- unname(X5r2_tSNV_nonsense_post_lib_quarts[3])
X5r2_tSNV_syn_to_non_post_lib_spread <- X5r2_tSNV_syn_post_lib_med - X5r2_tSNV_nonsense_post_lib_med

X5r1r2a_tSNV_missense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_missense_post_lib_med <- unname(X5r1r2a_tSNV_missense_post_lib_quarts[3])
X5r1r2a_tSNV_syn_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_syn_post_lib_med <- unname(X5r1r2a_tSNV_syn_post_lib_quarts[3])
X5r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_nonsense_post_lib_med <- unname(X5r1r2a_tSNV_nonsense_post_lib_quarts[3])
X5r1r2a_tSNV_syn_to_non_post_lib_spread <- X5r1r2a_tSNV_syn_post_lib_med - X5r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X5r1_cSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X5r1_cSNV_missense_pre_lib_med <- unname(X5r1_cSNV_missense_pre_lib_quarts[3])
X5r1_cSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X5r1_cSNV_syn_pre_lib_med <- unname(X5r1_cSNV_syn_pre_lib_quarts[3])
X5r1_cSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X5r1_cSNV_nonsense_pre_lib_med <- unname(X5r1_cSNV_nonsense_pre_lib_quarts[3])
X5r1_cSNV_syn_to_non_pre_lib_spread <- X5r1_cSNV_syn_pre_lib_med - X5r1_cSNV_nonsense_pre_lib_med

X5r2_cSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X5r2_cSNV_missense_pre_lib_med <- unname(X5r2_cSNV_missense_pre_lib_quarts[3])
X5r2_cSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X5r2_cSNV_syn_pre_lib_med <- unname(X5r2_cSNV_syn_pre_lib_quarts[3])
X5r2_cSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X5r2_cSNV_nonsense_pre_lib_med <- unname(X5r2_cSNV_nonsense_pre_lib_quarts[3])
X5r2_cSNV_syn_to_non_pre_lib_spread <- X5r2_cSNV_syn_pre_lib_med - X5r2_cSNV_nonsense_pre_lib_med

X5r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_missense_pre_lib_med <- unname(X5r1r2a_cSNV_missense_pre_lib_quarts[3])
X5r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_syn_pre_lib_med <- unname(X5r1r2a_cSNV_syn_pre_lib_quarts[3])
X5r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X5r1r2a_cSNV_nonsense_pre_lib_med <- unname(X5r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X5r1r2a_cSNV_syn_to_non_pre_lib_spread <- X5r1r2a_cSNV_syn_pre_lib_med - X5r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X5r1_tSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X5r1_tSNV_missense_pre_lib_med <- unname(X5r1_tSNV_missense_pre_lib_quarts[3])
X5r1_tSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X5r1_tSNV_syn_pre_lib_med <- unname(X5r1_tSNV_syn_pre_lib_quarts[3])
X5r1_tSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X5r1_tSNV_nonsense_pre_lib_med <- unname(X5r1_tSNV_nonsense_pre_lib_quarts[3])
X5r1_tSNV_syn_to_non_pre_lib_spread <- X5r1_tSNV_syn_pre_lib_med - X5r1_tSNV_nonsense_pre_lib_med

X5r2_tSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X5r2_tSNV_missense_pre_lib_med <- unname(X5r2_tSNV_missense_pre_lib_quarts[3])
X5r2_tSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X5r2_tSNV_syn_pre_lib_med <- unname(X5r2_tSNV_syn_pre_lib_quarts[3])
X5r2_tSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X5r2_tSNV_nonsense_pre_lib_med <- unname(X5r2_tSNV_nonsense_pre_lib_quarts[3])
X5r2_tSNV_syn_to_non_pre_lib_spread <- X5r2_tSNV_syn_pre_lib_med - X5r2_tSNV_nonsense_pre_lib_med

X5r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_missense_pre_lib_med <- unname(X5r1r2a_tSNV_missense_pre_lib_quarts[3])
X5r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_syn_pre_lib_med <- unname(X5r1r2a_tSNV_syn_pre_lib_quarts[3])
X5r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X5r1r2a_tSNV_nonsense_pre_lib_med <- unname(X5r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X5r1r2a_tSNV_syn_to_non_pre_lib_spread <- X5r1r2a_tSNV_syn_pre_lib_med - X5r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X5r1_tSNV_syn_rna_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X5r1_tSNV_syn_rna_pre_med <- unname(X5r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X5r1_tSNV_syn_rna_post_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X5r1_tSNV_syn_rna_post_med <- unname(X5r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X5r2_tSNV_syn_rna_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X5r2_tSNV_syn_rna_pre_med <- unname(X5r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X5r2_tSNV_syn_rna_post_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X5r2_tSNV_syn_rna_post_med <- unname(X5r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X5r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X5r1r2a_tSNV_syn_rna_pre_med <- unname(X5r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X5r1r2a_tSNV_syn_rna_post_quarts <- quantile(X5r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X5r1r2a_tSNV_syn_rna_post_med <- unname(X5r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X5r1_cSNV_syn_pre_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X5r1_cSNV_syn_post_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X5r1_cSNV_syn_post_lib_med
# tHDR
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X5r1_tSNV_syn_pre_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X5r1_tSNV_syn_post_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X5r1_tSNV_syn_post_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X5r1_tSNV_syn_rna_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X5r1_tSNV_syn_rna_post_med

#r2
X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X5r2_cSNV_syn_pre_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X5r2_cSNV_syn_post_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X5r2_cSNV_syn_post_lib_med
# tHDR
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X5r2_tSNV_syn_pre_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X5r2_tSNV_syn_post_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X5r2_tSNV_syn_post_lib_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X5r2_tSNV_syn_rna_pre_med
X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X5r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X5r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X5r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X5r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X5r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X5r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X5r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X5r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X5r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X5r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X5r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X5r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X5r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X5r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X5r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X5r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X5r1_prog_var_thresh5_df_r2_int_ord[which(X5r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X5r1_prog_var_thresh5_df_r2_int_ord
X5r1_prog_map_thresh5_df_r2_int_ord = which(X5r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X5r1_prog_map_thresh5_df_r2_int_ord_df = X5r1_prog_var_thresh5_df_r2_int_ord[X5r1_prog_map_thresh5_df_r2_int_ord,]
X5r1_prog_map_exon_thresh5_df_r2_int_ord = which(X5r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X5r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X5r1_prog_map_exon_thresh5_df_r2_int_ord_df = X5r1_prog_map_thresh5_df_r2_int_ord_df[X5r1_prog_map_exon_thresh5_df_r2_int_ord,]
X5r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X5r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X5r1_prog_map_thresh5_df_r2_int_ord_df[X5r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X5r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X5r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X5r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X5r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X5r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X5r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X5r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X5r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X5r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X5r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X5r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X5r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X5r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X5r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X5r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X5r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X5r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X5r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X5r1r2_cSNV_r1_post_by_r2_post_cor_s
X5r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X5r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X5r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X5r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X5r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X5r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X5r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X5r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X5r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X5r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X5r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X5r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X5r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X5r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X5r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X5r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X5r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X5r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1_cSNV_post_pre_by_cadd_cor_s
#X5r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X5r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r2_cSNV_post_pre_by_cadd_cor_s

#X5r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X5r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1_cSNV_post_lib_by_cadd_cor_s
#X5r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X5r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X5r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X5r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1_tSNV_post_pre_by_cadd_cor_s
#X5r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X5r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r2_tSNV_post_pre_by_cadd_cor_s

#X5r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X5r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1_tSNV_post_lib_by_cadd_cor_s
#X5r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X5r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X5r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X5r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X5r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X5r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X5r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X5r1_prog_var_all_lib_count
X5r1_prog_var_all_pre_count
X5r2_prog_var_all_pre_count
X5r1_prog_map_thresh5_lib_count
X5r1_prog_map_thresh5_pre_count
X5r2_prog_map_thresh5_pre_count
X5r1_prog_map_thresh5_post_count
X5r2_prog_map_thresh5_post_count
X5r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X5r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X5r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X5r1r2_cSNV_r1_post_by_r2_post_cor_s
X5r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X5r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X5r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X5r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X5r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X5r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X5r1_cSNV_post_pre_by_cadd_cor_s
X5r2_cSNV_post_pre_by_cadd_cor_s
X5r1_cSNV_post_lib_by_cadd_cor_s
X5r2_cSNV_post_lib_by_cadd_cor_s
X5r1_tSNV_post_pre_by_cadd_cor_s
X5r2_tSNV_post_pre_by_cadd_cor_s
X5r1_tSNV_post_lib_by_cadd_cor_s
X5r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X5r1r2a_cSNV_post_pre_by_cadd_cor_s
X5r1r2w_cSNV_post_pre_by_cadd_cor_s
X5r1r2a_cSNV_post_lib_by_cadd_cor_s
X5r1r2w_cSNV_post_lib_by_cadd_cor_s
X5r1r2a_tSNV_post_pre_by_cadd_cor_s
X5r1r2w_tSNV_post_pre_by_cadd_cor_s
X5r1r2a_tSNV_post_lib_by_cadd_cor_s
X5r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X5r1_cSNV_syn_to_non_post_pre_spread
X5r2_cSNV_syn_to_non_post_pre_spread
X5r1r2a_cSNV_syn_to_non_post_pre_spread
X5r1_cSNV_syn_to_non_post_lib_spread
X5r2_cSNV_syn_to_non_post_lib_spread
X5r1r2a_cSNV_syn_to_non_post_lib_spread
X5r1_tSNV_syn_to_non_post_pre_spread
X5r2_tSNV_syn_to_non_post_pre_spread
X5r1r2a_tSNV_syn_to_non_post_pre_spread
X5r1_tSNV_syn_to_non_post_lib_spread
X5r2_tSNV_syn_to_non_post_lib_spread
X5r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X5r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X5r1_prog_map_thresh5_df_r2_int_ord_df[which(X5r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X5r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df[which(X5r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df[which(X5r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df[which(X5r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X5r1_cSNV_pre_lib_cors = cor(log2(X5r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X5r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5r1_tSNV_pre_lib_cors = cor(log2(X5r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5r1_cSNV_post_lib_cors = cor(log2(X5r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X5r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X5r1_tSNV_post_lib_cors = cor(log2(X5r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X5r1_cSNV_post_pre_cors = cor(log2(X5r1_prog_map_thresh5_df$post_pseudo_freq),log2(X5r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5r1_tSNV_post_pre_cors = cor(log2(X5r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X5r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5r1_cSNV_rna_lib_cors = cor(log2(X5r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X5r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5r1_tSNV_rna_lib_cors = cor(log2(X5r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X5r1_cSNV_rna_pre_cors = cor(log2(X5r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X5r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5r1_tSNV_rna_pre_cors = cor(log2(X5r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X5r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5r1r2_cSNV_pre_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X5r1r2_tSNV_pre_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X5r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X5r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X5r1r2_cSNV_post_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X5r1r2_tSNV_post_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X5r1r2_cSNV_post_lib_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X5r1r2_tSNV_post_lib_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X5r1r2_cSNV_post_pre_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X5r1r2_tSNV_post_pre_ratio_cors = cor(log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X5r1r2_cSNV_rna_cors = cor(log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X5r1r2_tSNV_rna_cors = cor(log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X5r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X5r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X5r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X5r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X5r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X5r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X5r1_cors <- c("X5r1",X5r1_cSNV_pre_lib_cors,X5r1_tSNV_pre_lib_cors,X5r1_cSNV_post_lib_cors,X5r1_tSNV_post_lib_cors,X5r1_cSNV_post_pre_cors,X5r1_tSNV_post_pre_cors,X5r1_cSNV_rna_lib_cors,X5r1_tSNV_rna_lib_cors,X5r1_cSNV_rna_pre_cors,X5r1_tSNV_rna_pre_cors,X5r1r2_cSNV_pre_cors,X5r1r2_tSNV_pre_cors,X5r1r2_cSNV_pre_lib_ratio_cors,X5r1r2_tSNV_pre_lib_ratio_cors,X5r1r2_cSNV_post_cors,X5r1r2_tSNV_post_cors,X5r1r2_cSNV_post_lib_ratio_cors,X5r1r2_tSNV_post_lib_ratio_cors,X5r1r2_cSNV_post_pre_ratio_cors,X5r1r2_tSNV_post_pre_ratio_cors,X5r1r2_cSNV_rna_cors,X5r1r2_tSNV_rna_cors,X5r1r2_tSNV_rna_pre_ratio_cors,X5r1_cSNV_pre_lib_ratio_cadd_cors,X5r1_tSNV_pre_lib_ratio_cadd_cors,X5r1_cSNV_post_lib_ratio_cadd_cors,X5r1_tSNV_post_lib_ratio_cadd_cors,X5r1_cSNV_post_pre_ratio_cadd_cors,X5r1_tSNV_post_pre_ratio_cadd_cors,X5r1_cSNV_post_pre_ratio_cadd_missense_cors,X5r1_tSNV_post_pre_ratio_cadd_missense_cors,X5r1_cSNV_post_pre_ratio_polyphen_missense_cors,X5r1_tSNV_post_pre_ratio_polyphen_missense_cors,X5r1_cSNV_post_pre_ratio_grantham_missense_cors,X5r1_tSNV_post_pre_ratio_grantham_missense_cors,X5r1r2a_cSNV_pre_lib_ratio_cadd_cors,X5r1r2a_tSNV_pre_lib_ratio_cadd_cors,X5r1r2a_cSNV_post_lib_ratio_cadd_cors,X5r1r2a_tSNV_post_lib_ratio_cadd_cors,X5r1r2a_cSNV_post_pre_ratio_cadd_cors,X5r1r2a_tSNV_post_pre_ratio_cadd_cors,X5r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X5r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X5r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X5r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X5r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X5r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X5r1r2w_cSNV_pre_lib_ratio_cadd_cors,X5r1r2w_cSNV_post_lib_ratio_cadd_cors,X5r1r2w_cSNV_post_pre_ratio_cadd_cors,X5r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X5r2_cSNV_pre_lib_cors = cor(log2(X5r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X5r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5r2_tSNV_pre_lib_cors = cor(log2(X5r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5r2_cSNV_post_lib_cors = cor(log2(X5r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X5r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X5r2_tSNV_post_lib_cors = cor(log2(X5r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X5r2_cSNV_post_pre_cors = cor(log2(X5r2_prog_map_thresh5_df$post_pseudo_freq),log2(X5r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5r2_tSNV_post_pre_cors = cor(log2(X5r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X5r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5r2_cSNV_rna_lib_cors = cor(log2(X5r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X5r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5r2_tSNV_rna_lib_cors = cor(log2(X5r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X5r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X5r2_cSNV_rna_pre_cors = cor(log2(X5r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X5r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5r2_tSNV_rna_pre_cors = cor(log2(X5r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X5r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X5r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X5r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X5r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X5r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X5r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X5r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X5r2_cors <- c("X5r2",X5r2_cSNV_pre_lib_cors,X5r2_tSNV_pre_lib_cors,X5r2_cSNV_post_lib_cors,X5r2_tSNV_post_lib_cors,X5r2_cSNV_post_pre_cors,X5r2_tSNV_post_pre_cors,X5r2_cSNV_rna_lib_cors,X5r2_tSNV_rna_lib_cors,X5r2_cSNV_rna_pre_cors,X5r2_tSNV_rna_pre_cors,X5r1r2_cSNV_pre_cors,X5r1r2_tSNV_pre_cors,X5r1r2_cSNV_pre_lib_ratio_cors,X5r1r2_tSNV_pre_lib_ratio_cors,X5r1r2_cSNV_post_cors,X5r1r2_tSNV_post_cors,X5r1r2_cSNV_post_lib_ratio_cors,X5r1r2_tSNV_post_lib_ratio_cors,X5r1r2_cSNV_post_pre_ratio_cors,X5r1r2_tSNV_post_pre_ratio_cors,X5r1r2_cSNV_rna_cors,X5r1r2_tSNV_rna_cors,X5r1r2_tSNV_rna_pre_ratio_cors,X5r2_cSNV_pre_lib_ratio_cadd_cors,X5r2_tSNV_pre_lib_ratio_cadd_cors,X5r2_cSNV_post_lib_ratio_cadd_cors,X5r2_tSNV_post_lib_ratio_cadd_cors,X5r2_cSNV_post_pre_ratio_cadd_cors,X5r2_tSNV_post_pre_ratio_cadd_cors,X5r2_cSNV_post_pre_ratio_cadd_missense_cors,X5r2_tSNV_post_pre_ratio_cadd_missense_cors,X5r2_cSNV_post_pre_ratio_polyphen_missense_cors,X5r2_tSNV_post_pre_ratio_polyphen_missense_cors,X5r2_cSNV_post_pre_ratio_grantham_missense_cors,X5r2_tSNV_post_pre_ratio_grantham_missense_cors,X5r1r2a_cSNV_pre_lib_ratio_cadd_cors,X5r1r2a_tSNV_pre_lib_ratio_cadd_cors,X5r1r2a_cSNV_post_lib_ratio_cadd_cors,X5r1r2a_tSNV_post_lib_ratio_cadd_cors,X5r1r2a_cSNV_post_pre_ratio_cadd_cors,X5r1r2a_tSNV_post_pre_ratio_cadd_cors,X5r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X5r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X5r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X5r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X5r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X5r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X5r1r2w_cSNV_pre_lib_ratio_cadd_cors,X5r1r2w_cSNV_post_lib_ratio_cadd_cors,X5r1r2w_cSNV_post_pre_ratio_cadd_cors,X5r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X5r1)
rm(X5r2)
gc()
X15r1_file <- paste(experiment_dir_171011,'X15r2','_annotated.txt',sep='')
X15r2_file <- paste(experiment_dir_171011,'X15r3','_annotated.txt',sep='')
X15r1 <- read.table(X15r1_file, header=TRUE, sep="\t")
X15r2 <- read.table(X15r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X15 <- editing_info[which(editing_info$amplicon == 'X15'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X15_HDR_5_SNV = as.character(editing_info_X15$HDR_5_SNV)
X15_HDR_3_SNV = as.character(editing_info_X15$HDR_3_SNV)
#X15_cut_pos = as.character(editing_info_X15$cut_pos)
X15_cut_end = as.character(editing_info_X15$cut_end)
X15_mut_start = as.character(editing_info_X15$mut_start)
X15_mut_end = as.character(editing_info_X15$mut_end)
### Replicate 1
X15r1_cSNV_all <- which(X15r1[,'c_hdr_snv']=='True')
X15r1_cSNV_all_df = X15r1[X15r1_cSNV_all,]
X15r1_prog_var_all <- which(X15r1[,'all_hdr_variant']=='True' & X15r1[,'edit_string']!='-WT')
X15r1_prog_var_all_df = X15r1[X15r1_prog_var_all,]
X15r1_prog_map_all = which(X15r1_prog_var_all_df[,'pos']!='REF')
X15r1_prog_map_all_df = X15r1_prog_var_all_df[X15r1_prog_map_all,]
X15r1_prog_map_exon_all = which(X15r1_prog_map_all_df[,'cDNApos']!='REF' & X15r1_prog_map_all_df[,'cDNApos']!='NA')
X15r1_prog_map_exon_all_df = X15r1_prog_map_all_df[X15r1_prog_map_exon_all,]
X15r1_prog_map_CADD = which(X15r1_prog_map_all_df[,'CADD.phred']!='NA')
X15r1_prog_map_CADD_df = X15r1_prog_map_all_df[X15r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X15r1_prog_var_thresh5 <- which(as.numeric(as.character(X15r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X15r1_prog_var_thresh5_df = X15r1_prog_var_all_df[X15r1_prog_var_thresh5,]
X15r1_prog_map_thresh5 <- which(as.numeric(as.character(X15r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X15r1_prog_map_thresh5_df = X15r1_prog_map_all_df[X15r1_prog_map_thresh5,]
X15r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X15r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X15r1_prog_map_exon_thresh5_df = X15r1_prog_map_exon_all_df[X15r1_prog_map_exon_thresh5,]
X15r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X15r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X15r1_prog_map_CADD_thresh5_df = X15r1_prog_map_CADD_df[X15r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X15r1_prog_var_all_lib_count = length(X15r1_prog_var_all_df$lib)
X15r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X15r1_prog_var_all_min_lib_counts = min(X15r1_prog_var_all_df$lib)
X15r1_prog_var_all_min_lib_counts
X15r1_prog_var_all_max_lib_counts = max(X15r1_prog_var_all_df$lib)
X15r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X15r1_prog_map_all_lib_count = length(X15r1_prog_map_all_df$lib)
X15r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X15r1_prog_map_all_min_lib_counts = min(X15r1_prog_map_all_df$lib)
X15r1_prog_map_all_min_lib_counts
X15r1_prog_map_all_max_lib_counts = max(X15r1_prog_map_all_df$lib)
X15r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X15r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X15r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X15r1_prog_var_all_pre_count = length(X15r1_prog_var_all_df$pre)
X15r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X15r1_prog_var_all_min_pre_counts = min(X15r1_prog_var_all_df$pre)
X15r1_prog_var_all_min_pre_counts
X15r1_prog_var_all_max_pre_counts = max(X15r1_prog_var_all_df$pre)
X15r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X15r1_prog_map_all_pre_count = length(X15r1_prog_map_all_df$pre)
X15r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X15r1_prog_map_all_min_pre_counts = min(X15r1_prog_map_all_df$pre)
X15r1_prog_map_all_min_pre_counts
X15r1_prog_map_all_max_pre_counts = max(X15r1_prog_map_all_df$pre)
X15r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X15r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X15r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X15r1_prog_map_all_post_count = length(X15r1_prog_map_all_df$post)
X15r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X15r1_prog_map_all_min_post_counts = min(X15r1_prog_map_all_df$post)
X15r1_prog_map_all_min_post_counts
X15r1_prog_map_all_max_post_counts = max(X15r1_prog_map_all_df$post)
X15r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X15r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X15r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X15r1_prog_map_all_syn_df <- X15r1_prog_map_all_df[which(X15r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X15r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X15r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X15r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X15r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X15r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X15r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X15r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X15r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X15r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X15r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X15r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X15r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X15r1_prog_map_all_min_rna_counts = min(X15r1_prog_map_exon_all_df$tHDR_rna)
X15r1_prog_map_all_min_rna_counts
X15r1_prog_map_all_max_rna_counts = max(X15r1_prog_map_exon_all_df$tHDR_rna)
X15r1_prog_map_all_max_rna_counts
X15r1_prog_map_all_min_rna_pseudo_freq = min(X15r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15r1_prog_map_all_min_rna_pseudo_freq
X15r1_prog_map_all_max_rna_pseudo_freq = max(X15r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15r1_prog_map_all_max_rna_pseudo_freq
X15r1_prog_map_all_min_rna_pre_ratio = min(X15r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15r1_prog_map_all_min_rna_pre_ratio
X15r1_prog_map_all_max_rna_pre_ratio = max(X15r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15r1_prog_map_all_max_rna_pre_ratio
X15r1_prog_map_all_min_rna_post_ratio = min(X15r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15r1_prog_map_all_min_rna_post_ratio
X15r1_prog_map_all_max_rna_post_ratio = max(X15r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X15r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X15r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X15r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X15r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X15r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X15r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X15r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X15r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X15r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X15r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X15r1_prog_map_all_df$post_pre_ratio),log2(X15r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X15r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X15r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X15r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X15r1_cSNV_all_corr_pre_count = length(X15r1_cSNV_all_df$corr_pre)
X15r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X15r1_cSNV_all_min_corr_pre_counts = min(X15r1_cSNV_all_df$corr_pre)
X15r1_cSNV_all_min_corr_pre_counts
X15r1_cSNV_all_max_corr_pre_counts = max(X15r1_cSNV_all_df$corr_pre)
X15r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X15r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X15r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X15r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X15r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X15r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_cSNV_all_corr_post_count = length(X15r1_cSNV_all_df$corr_post)
X15r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X15r1_cSNV_all_min_corr_post_counts = min(X15r1_cSNV_all_df$corr_post)
X15r1_cSNV_all_min_corr_post_counts
X15r1_cSNV_all_max_corr_post_counts = max(X15r1_cSNV_all_df$corr_post)
X15r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X15r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X15r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X15r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X15r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X15r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X15r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X15_p_hdr_snv = paste('p_hdr_',X15_cut_end,'_snv',sep='')
X15r1_pSNV_all <- which(X15r1[,X15_p_hdr_snv]=='True')
X15r1_pSNV_all_df = X15r1[X15r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_pSNV_all_lib_count = length(X15r1_pSNV_all_df$lib)
X15r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X15r1_pSNV_all_min_lib_counts = min(X15r1_pSNV_all_df$lib)
X15r1_pSNV_all_min_lib_counts
X15r1_pSNV_all_max_lib_counts = max(X15r1_pSNV_all_df$lib)
X15r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X15r1_pSNV_all_pre_count = length(X15r1_pSNV_all_df$pre)
X15r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X15r1_pSNV_all_min_pre_counts = min(X15r1_pSNV_all_df$pre)
X15r1_pSNV_all_min_pre_counts
X15r1_pSNV_all_max_pre_counts = max(X15r1_pSNV_all_df$pre)
X15r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X15r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X15r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_pSNV_all_post_count = length(X15r1_pSNV_all_df$post)
X15r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X15r1_pSNV_all_min_post_counts = min(X15r1_pSNV_all_df$post)
X15r1_pSNV_all_min_post_counts
X15r1_pSNV_all_max_post_counts = max(X15r1_pSNV_all_df$post)
X15r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X15r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X15r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_prog_map_thresh5_lib_count = length(X15r1_prog_map_thresh5_df$lib)
X15r1_prog_map_thresh5_lib_count
X15r1_prog_map_thresh5_min_lib_counts = min(X15r1_prog_map_thresh5_df$lib)
X15r1_prog_map_thresh5_min_lib_counts
X15r1_prog_map_thresh5_max_lib_counts = max(X15r1_prog_map_thresh5_df$lib)
X15r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X15r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X15r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_prog_map_thresh5_pre_count = length(X15r1_prog_map_thresh5_df$pre)
X15r1_prog_map_thresh5_pre_count
X15r1_prog_map_thresh5_min_pre_counts = min(X15r1_prog_map_thresh5_df$pre)
X15r1_prog_map_thresh5_min_pre_counts
X15r1_prog_map_thresh5_max_pre_counts = max(X15r1_prog_map_thresh5_df$pre)
X15r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r1_prog_map_thresh5_post_count = length(X15r1_prog_map_thresh5_df$post)
X15r1_prog_map_thresh5_post_count
X15r1_prog_map_thresh5_min_post_counts = min(X15r1_prog_map_thresh5_df$post)
X15r1_prog_map_thresh5_min_post_counts
X15r1_prog_map_thresh5_max_post_counts = max(X15r1_prog_map_thresh5_df$post)
X15r1_prog_map_thresh5_max_post_counts
X15r1_prog_map_thresh5_corr_post_count = length(X15r1_cSNV_all_df$corr_post)
X15r1_prog_map_thresh5_corr_post_count
X15r1_prog_map_thresh5_min_corr_post_counts = min(X15r1_cSNV_all_df$corr_post)
X15r1_prog_map_thresh5_min_corr_post_counts
X15r1_prog_map_thresh5_max_corr_post_counts = max(X15r1_cSNV_all_df$corr_post)
X15r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X15r1_pSNV_thresh5 <- which(X15r1[,X15_p_hdr_snv]=='True' & as.numeric(as.character(X15r1[,'pre_freq']))>=0.00001)
X15r1_pSNV_thresh5_df = X15r1[X15r1_pSNV_thresh5,]
X15r1_pSNV_thresh5_lib_count = length(X15r1_pSNV_thresh5_df$lib)
X15r1_pSNV_thresh5_lib_count
X15r1_pSNV_thresh5_min_lib_counts = min(X15r1_pSNV_thresh5_df$lib)
X15r1_pSNV_thresh5_min_lib_counts
X15r1_pSNV_thresh5_max_lib_counts = max(X15r1_pSNV_thresh5_df$lib)
X15r1_pSNV_thresh5_max_lib_counts
X15r1_pSNV_thresh5_pre_count = length(X15r1_pSNV_thresh5_df$pre)
X15r1_pSNV_thresh5_pre_count
X15r1_pSNV_thresh5_min_pre_counts = min(X15r1_pSNV_thresh5_df$pre)
X15r1_pSNV_thresh5_min_pre_counts
X15r1_pSNV_thresh5_max_pre_counts = max(X15r1_pSNV_thresh5_df$pre)
X15r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X15r1_pSNV_thresh5_post_count = length(X15r1_pSNV_thresh5_df$post)
X15r1_pSNV_thresh5_post_count
X15r1_pSNV_thresh5_min_post_counts = min(X15r1_pSNV_thresh5_df$post)
X15r1_pSNV_thresh5_min_post_counts
X15r1_pSNV_thresh5_max_post_counts = max(X15r1_pSNV_thresh5_df$post)
X15r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X15r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X15r1_pSNV_thresh5_post_pos

### Replicate 2
X15r2_cSNV_all <- which(X15r2[,'c_hdr_snv']=='True')
X15r2_cSNV_all_df = X15r2[X15r2_cSNV_all,]
X15r2_prog_var_all <- which(X15r2[,'all_hdr_variant']=='True' & X15r2[,'edit_string']!='-WT')
X15r2_prog_var_all_df = X15r2[X15r2_prog_var_all,]
X15r2_prog_map_all = which(X15r2_prog_var_all_df[,'pos']!='REF')
X15r2_prog_map_all_df = X15r2_prog_var_all_df[X15r2_prog_map_all,]
X15r2_prog_map_exon_all = which(X15r2_prog_map_all_df[,'cDNApos']!='REF' & X15r2_prog_map_all_df[,'cDNApos']!='NA')
X15r2_prog_map_exon_all_df = X15r2_prog_map_all_df[X15r2_prog_map_exon_all,]
X15r2_prog_map_CADD = which(X15r2_prog_map_all_df[,'CADD.phred']!='NA')
X15r2_prog_map_CADD_df = X15r2_prog_map_all_df[X15r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X15r2_prog_var_thresh5 <- which(as.numeric(as.character(X15r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X15r2_prog_var_thresh5_df = X15r2_prog_var_all_df[X15r2_prog_var_thresh5,]
X15r2_prog_map_thresh5 <- which(as.numeric(as.character(X15r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X15r2_prog_map_thresh5_df = X15r2_prog_map_all_df[X15r2_prog_map_thresh5,]
X15r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X15r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X15r2_prog_map_exon_thresh5_df = X15r2_prog_map_exon_all_df[X15r2_prog_map_exon_thresh5,]
X15r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X15r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X15r2_prog_map_CADD_thresh5_df = X15r2_prog_map_CADD_df[X15r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X15r2_prog_var_all_lib_count = length(X15r2_prog_var_all_df$lib)
X15r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X15r2_prog_var_all_min_lib_counts = min(X15r2_prog_var_all_df$lib)
X15r2_prog_var_all_min_lib_counts
X15r2_prog_var_all_max_lib_counts = max(X15r2_prog_var_all_df$lib)
X15r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X15r2_prog_map_all_lib_count = length(X15r2_prog_map_all_df$lib)
X15r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X15r2_prog_map_all_min_lib_counts = min(X15r2_prog_map_all_df$lib)
X15r2_prog_map_all_min_lib_counts
X15r2_prog_map_all_max_lib_counts = max(X15r2_prog_map_all_df$lib)
X15r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X15r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X15r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X15r2_prog_var_all_pre_count = length(X15r2_prog_var_all_df$pre)
X15r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X15r2_prog_var_all_min_pre_counts = min(X15r2_prog_var_all_df$pre)
X15r2_prog_var_all_min_pre_counts
X15r2_prog_var_all_max_pre_counts = max(X15r2_prog_var_all_df$pre)
X15r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X15r2_prog_map_all_pre_count = length(X15r2_prog_map_all_df$pre)
X15r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X15r2_prog_map_all_min_pre_counts = min(X15r2_prog_map_all_df$pre)
X15r2_prog_map_all_min_pre_counts
X15r2_prog_map_all_max_pre_counts = max(X15r2_prog_map_all_df$pre)
X15r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X15r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X15r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X15r2_prog_map_all_post_count = length(X15r2_prog_map_all_df$post)
X15r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X15r2_prog_map_all_min_post_counts = min(X15r2_prog_map_all_df$post)
X15r2_prog_map_all_min_post_counts
X15r2_prog_map_all_max_post_counts = max(X15r2_prog_map_all_df$post)
X15r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X15r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X15r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X15r2_prog_map_all_syn_df <- X15r2_prog_map_all_df[which(X15r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X15r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X15r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X15r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X15r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X15r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X15r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X15r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X15r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X15r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X15r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X15r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X15r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X15r2_prog_map_all_min_rna_counts = min(X15r2_prog_map_exon_all_df$tHDR_rna)
X15r2_prog_map_all_min_rna_counts
X15r2_prog_map_all_max_rna_counts = max(X15r2_prog_map_exon_all_df$tHDR_rna)
X15r2_prog_map_all_max_rna_counts
X15r2_prog_map_all_min_rna_pseudo_freq = min(X15r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15r2_prog_map_all_min_rna_pseudo_freq
X15r2_prog_map_all_max_rna_pseudo_freq = max(X15r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15r2_prog_map_all_max_rna_pseudo_freq
X15r2_prog_map_all_min_rna_pre_ratio = min(X15r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15r2_prog_map_all_min_rna_pre_ratio
X15r2_prog_map_all_max_rna_pre_ratio = max(X15r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15r2_prog_map_all_max_rna_pre_ratio
X15r2_prog_map_all_min_rna_post_ratio = min(X15r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15r2_prog_map_all_min_rna_post_ratio
X15r2_prog_map_all_max_rna_post_ratio = max(X15r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X15r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X15r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X15r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X15r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X15r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X15r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X15r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X15r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X15r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X15r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X15r2_prog_map_all_df$post_pre_ratio),log2(X15r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X15r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X15r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X15r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X15r2_cSNV_all_corr_pre_count = length(X15r2_cSNV_all_df$corr_pre)
X15r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X15r2_cSNV_all_min_corr_pre_counts = min(X15r2_cSNV_all_df$corr_pre)
X15r2_cSNV_all_min_corr_pre_counts
X15r2_cSNV_all_max_corr_pre_counts = max(X15r2_cSNV_all_df$corr_pre)
X15r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X15r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X15r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X15r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X15r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X15r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_cSNV_all_corr_post_count = length(X15r2_cSNV_all_df$corr_post)
X15r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X15r2_cSNV_all_min_corr_post_counts = min(X15r2_cSNV_all_df$corr_post)
X15r2_cSNV_all_min_corr_post_counts
X15r2_cSNV_all_max_corr_post_counts = max(X15r2_cSNV_all_df$corr_post)
X15r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X15r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X15r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X15r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X15r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X15r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X15r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X15_p_hdr_snv = paste('p_hdr_',X15_cut_end,'_snv',sep='')
X15r2_pSNV_all <- which(X15r2[,X15_p_hdr_snv]=='True')
X15r2_pSNV_all_df = X15r2[X15r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_pSNV_all_lib_count = length(X15r2_pSNV_all_df$lib)
X15r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X15r2_pSNV_all_min_lib_counts = min(X15r2_pSNV_all_df$lib)
X15r2_pSNV_all_min_lib_counts
X15r2_pSNV_all_max_lib_counts = max(X15r2_pSNV_all_df$lib)
X15r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X15r2_pSNV_all_pre_count = length(X15r2_pSNV_all_df$pre)
X15r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X15r2_pSNV_all_min_pre_counts = min(X15r2_pSNV_all_df$pre)
X15r2_pSNV_all_min_pre_counts
X15r2_pSNV_all_max_pre_counts = max(X15r2_pSNV_all_df$pre)
X15r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X15r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X15r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_pSNV_all_post_count = length(X15r2_pSNV_all_df$post)
X15r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X15r2_pSNV_all_min_post_counts = min(X15r2_pSNV_all_df$post)
X15r2_pSNV_all_min_post_counts
X15r2_pSNV_all_max_post_counts = max(X15r2_pSNV_all_df$post)
X15r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X15r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X15r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_prog_map_thresh5_lib_count = length(X15r2_prog_map_thresh5_df$lib)
X15r2_prog_map_thresh5_lib_count
X15r2_prog_map_thresh5_min_lib_counts = min(X15r2_prog_map_thresh5_df$lib)
X15r2_prog_map_thresh5_min_lib_counts
X15r2_prog_map_thresh5_max_lib_counts = max(X15r2_prog_map_thresh5_df$lib)
X15r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X15r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X15r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_prog_map_thresh5_pre_count = length(X15r2_prog_map_thresh5_df$pre)
X15r2_prog_map_thresh5_pre_count
X15r2_prog_map_thresh5_min_pre_counts = min(X15r2_prog_map_thresh5_df$pre)
X15r2_prog_map_thresh5_min_pre_counts
X15r2_prog_map_thresh5_max_pre_counts = max(X15r2_prog_map_thresh5_df$pre)
X15r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15r2_prog_map_thresh5_post_count = length(X15r2_prog_map_thresh5_df$post)
X15r2_prog_map_thresh5_post_count
X15r2_prog_map_thresh5_min_post_counts = min(X15r2_prog_map_thresh5_df$post)
X15r2_prog_map_thresh5_min_post_counts
X15r2_prog_map_thresh5_max_post_counts = max(X15r2_prog_map_thresh5_df$post)
X15r2_prog_map_thresh5_max_post_counts
X15r2_prog_map_thresh5_corr_post_count = length(X15r2_prog_map_thresh5_df$corr_post)
X15r2_prog_map_thresh5_corr_post_count
X15r2_prog_map_thresh5_min_corr_post_counts = min(X15r2_prog_map_thresh5_df$corr_post)
X15r2_prog_map_thresh5_min_corr_post_counts
X15r2_prog_map_thresh5_max_corr_post_counts = max(X15r2_prog_map_thresh5_df$corr_post)
X15r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X15r2_pSNV_thresh5 <- which(X15r2[,X15_p_hdr_snv]=='True' & as.numeric(as.character(X15r2[,'pre_freq']))>=0.00001)
X15r2_pSNV_thresh5_df = X15r2[X15r2_pSNV_thresh5,]
X15r2_pSNV_thresh5_lib_count = length(X15r2_pSNV_thresh5_df$lib)
X15r2_pSNV_thresh5_lib_count
X15r2_pSNV_thresh5_min_lib_counts = min(X15r2_pSNV_thresh5_df$lib)
X15r2_pSNV_thresh5_min_lib_counts
X15r2_pSNV_thresh5_max_lib_counts = max(X15r2_pSNV_thresh5_df$lib)
X15r2_pSNV_thresh5_max_lib_counts
X15r2_pSNV_thresh5_pre_count = length(X15r2_pSNV_thresh5_df$pre)
X15r2_pSNV_thresh5_pre_count
X15r2_pSNV_thresh5_min_pre_counts = min(X15r2_pSNV_thresh5_df$pre)
X15r2_pSNV_thresh5_min_pre_counts
X15r2_pSNV_thresh5_max_pre_counts = max(X15r2_pSNV_thresh5_df$pre)
X15r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X15r2_pSNV_thresh5_post_count = length(X15r2_pSNV_thresh5_df$post)
X15r2_pSNV_thresh5_post_count
X15r2_pSNV_thresh5_min_post_counts = min(X15r2_pSNV_thresh5_df$post)
X15r2_pSNV_thresh5_min_post_counts
X15r2_pSNV_thresh5_max_post_counts = max(X15r2_pSNV_thresh5_df$post)
X15r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X15r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X15r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X15r1_prog_var_thresh5_df:
X15r1_prog_var_thresh5_df_r2_int <- X15r1_prog_var_thresh5_df[which(X15r1_prog_var_thresh5_df$variant %in% X15r2_prog_var_thresh5_df$variant),]
#Intersection variants of X15r2_prog_var_thresh5_df:
X15r2_prog_var_thresh5_df_r1_int <- X15r2_prog_var_thresh5_df[which(X15r2_prog_var_thresh5_df$variant %in% X15r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X15r1_prog_var_thresh5_df_r2_int_ord <- X15r1_prog_var_thresh5_df_r2_int[order(X15r1_prog_var_thresh5_df_r2_int$variant),]
X15r2_prog_var_thresh5_df_r1_int_ord <- X15r2_prog_var_thresh5_df_r1_int[order(X15r2_prog_var_thresh5_df_r1_int$variant),]

dim(X15r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X15r1r2int_prog_var_thresh5_pre_count <- dim(X15r1_prog_var_thresh5_df_r2_int)[1] 
X15r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X15r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X15r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X15r2_prog_var_thresh5_df_r1_int_ord$pre
X15r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X15r2_prog_var_thresh5_df_r1_int_ord$lib
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X15r2_prog_var_thresh5_df_r1_int_ord$post
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X15r2_prog_var_thresh5_df_r1_int_ord$rna
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X15r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X15r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X15r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$post_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X15r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X15r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X15r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X15r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X15r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X15r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X15r2_prog_var_thresh5_df_r1_int_ord$corr_post
X15r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X15r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X15r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X15r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X15r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X15r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X15r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X15r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X15r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X15r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X15r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X15r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X15r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X15r1_cSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X15r1_cSNV_missense_post_pre_med <- unname(X15r1_cSNV_missense_post_pre_quarts[3])
X15r1_cSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X15r1_cSNV_syn_post_pre_med <- unname(X15r1_cSNV_syn_post_pre_quarts[3])
X15r1_cSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X15r1_cSNV_nonsense_post_pre_med <- unname(X15r1_cSNV_nonsense_post_pre_quarts[3])
X15r1_cSNV_syn_to_non_post_pre_spread <- X15r1_cSNV_syn_post_pre_med - X15r1_cSNV_nonsense_post_pre_med

X15r2_cSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X15r2_cSNV_missense_post_pre_med <- unname(X15r2_cSNV_missense_post_pre_quarts[3])
X15r2_cSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X15r2_cSNV_syn_post_pre_med <- unname(X15r2_cSNV_syn_post_pre_quarts[3])
X15r2_cSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X15r2_cSNV_nonsense_post_pre_med <- unname(X15r2_cSNV_nonsense_post_pre_quarts[3])
X15r2_cSNV_syn_to_non_post_pre_spread <- X15r2_cSNV_syn_post_pre_med - X15r2_cSNV_nonsense_post_pre_med

X15r1r2a_cSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X15r1r2a_cSNV_missense_post_pre_med <- unname(X15r1r2a_cSNV_missense_post_pre_quarts[3])
X15r1r2a_cSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X15r1r2a_cSNV_syn_post_pre_med <- unname(X15r1r2a_cSNV_syn_post_pre_quarts[3])
X15r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X15r1r2a_cSNV_nonsense_post_pre_med <- unname(X15r1r2a_cSNV_nonsense_post_pre_quarts[3])
X15r1r2a_cSNV_syn_to_non_post_pre_spread <- X15r1r2a_cSNV_syn_post_pre_med - X15r1r2a_cSNV_nonsense_post_pre_med

X15r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_cSNV_missense_post_pre_med <- unname(X15r1r2pw_cSNV_missense_post_pre_quarts[3])
X15r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_cSNV_syn_post_pre_med <- unname(X15r1r2pw_cSNV_syn_post_pre_quarts[3])
X15r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_cSNV_nonsense_post_pre_med <- unname(X15r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X15r1r2pw_cSNV_syn_to_non_post_pre_spread <- X15r1r2pw_cSNV_syn_post_pre_med - X15r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X15r1_tSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X15r1_tSNV_missense_post_pre_med <- unname(X15r1_tSNV_missense_post_pre_quarts[3])
X15r1_tSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X15r1_tSNV_syn_post_pre_med <- unname(X15r1_tSNV_syn_post_pre_quarts[3])
X15r1_tSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X15r1_tSNV_nonsense_post_pre_med <- unname(X15r1_tSNV_nonsense_post_pre_quarts[3])
X15r1_tSNV_syn_to_non_post_pre_spread <- X15r1_tSNV_syn_post_pre_med - X15r1_tSNV_nonsense_post_pre_med

X15r2_tSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X15r2_tSNV_missense_post_pre_med <- unname(X15r2_tSNV_missense_post_pre_quarts[3])
X15r2_tSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X15r2_tSNV_syn_post_pre_med <- unname(X15r2_tSNV_syn_post_pre_quarts[3])
X15r2_tSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X15r2_tSNV_nonsense_post_pre_med <- unname(X15r2_tSNV_nonsense_post_pre_quarts[3])
X15r2_tSNV_syn_to_non_post_pre_spread <- X15r2_tSNV_syn_post_pre_med - X15r2_tSNV_nonsense_post_pre_med

X15r1r2a_tSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X15r1r2a_tSNV_missense_post_pre_med <- unname(X15r1r2a_tSNV_missense_post_pre_quarts[3])
X15r1r2a_tSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X15r1r2a_tSNV_syn_post_pre_med <- unname(X15r1r2a_tSNV_syn_post_pre_quarts[3])
X15r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X15r1r2a_tSNV_nonsense_post_pre_med <- unname(X15r1r2a_tSNV_nonsense_post_pre_quarts[3])
X15r1r2a_tSNV_syn_to_non_post_pre_spread <- X15r1r2a_tSNV_syn_post_pre_med - X15r1r2a_tSNV_nonsense_post_pre_med

X15r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_tSNV_missense_post_pre_med <- unname(X15r1r2pw_tSNV_missense_post_pre_quarts[3])
X15r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_tSNV_syn_post_pre_med <- unname(X15r1r2pw_tSNV_syn_post_pre_quarts[3])
X15r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X15r1r2pw_tSNV_nonsense_post_pre_med <- unname(X15r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X15r1r2pw_tSNV_syn_to_non_post_pre_spread <- X15r1r2pw_tSNV_syn_post_pre_med - X15r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X15r1_cSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X15r1_cSNV_missense_post_lib_med <- unname(X15r1_cSNV_missense_post_lib_quarts[3])
X15r1_cSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X15r1_cSNV_syn_post_lib_med <- unname(X15r1_cSNV_syn_post_lib_quarts[3])
X15r1_cSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X15r1_cSNV_nonsense_post_lib_med <- unname(X15r1_cSNV_nonsense_post_lib_quarts[3])
X15r1_cSNV_syn_to_non_post_lib_spread <- X15r1_cSNV_syn_post_lib_med - X15r1_cSNV_nonsense_post_lib_med

X15r2_cSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X15r2_cSNV_missense_post_lib_med <- unname(X15r2_cSNV_missense_post_lib_quarts[3])
X15r2_cSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X15r2_cSNV_syn_post_lib_med <- unname(X15r2_cSNV_syn_post_lib_quarts[3])
X15r2_cSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X15r2_cSNV_nonsense_post_lib_med <- unname(X15r2_cSNV_nonsense_post_lib_quarts[3])
X15r2_cSNV_syn_to_non_post_lib_spread <- X15r2_cSNV_syn_post_lib_med - X15r2_cSNV_nonsense_post_lib_med

X15r1r2a_cSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_missense_post_lib_med <- unname(X15r1r2a_cSNV_missense_post_lib_quarts[3])
X15r1r2a_cSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_syn_post_lib_med <- unname(X15r1r2a_cSNV_syn_post_lib_quarts[3])
X15r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_nonsense_post_lib_med <- unname(X15r1r2a_cSNV_nonsense_post_lib_quarts[3])
X15r1r2a_cSNV_syn_to_non_post_lib_spread <- X15r1r2a_cSNV_syn_post_lib_med - X15r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X15r1_tSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X15r1_tSNV_missense_post_lib_med <- unname(X15r1_tSNV_missense_post_lib_quarts[3])
X15r1_tSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X15r1_tSNV_syn_post_lib_med <- unname(X15r1_tSNV_syn_post_lib_quarts[3])
X15r1_tSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X15r1_tSNV_nonsense_post_lib_med <- unname(X15r1_tSNV_nonsense_post_lib_quarts[3])
X15r1_tSNV_syn_to_non_post_lib_spread <- X15r1_tSNV_syn_post_lib_med - X15r1_tSNV_nonsense_post_lib_med

X15r2_tSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X15r2_tSNV_missense_post_lib_med <- unname(X15r2_tSNV_missense_post_lib_quarts[3])
X15r2_tSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X15r2_tSNV_syn_post_lib_med <- unname(X15r2_tSNV_syn_post_lib_quarts[3])
X15r2_tSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X15r2_tSNV_nonsense_post_lib_med <- unname(X15r2_tSNV_nonsense_post_lib_quarts[3])
X15r2_tSNV_syn_to_non_post_lib_spread <- X15r2_tSNV_syn_post_lib_med - X15r2_tSNV_nonsense_post_lib_med

X15r1r2a_tSNV_missense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_missense_post_lib_med <- unname(X15r1r2a_tSNV_missense_post_lib_quarts[3])
X15r1r2a_tSNV_syn_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_syn_post_lib_med <- unname(X15r1r2a_tSNV_syn_post_lib_quarts[3])
X15r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_nonsense_post_lib_med <- unname(X15r1r2a_tSNV_nonsense_post_lib_quarts[3])
X15r1r2a_tSNV_syn_to_non_post_lib_spread <- X15r1r2a_tSNV_syn_post_lib_med - X15r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X15r1_cSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X15r1_cSNV_missense_pre_lib_med <- unname(X15r1_cSNV_missense_pre_lib_quarts[3])
X15r1_cSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X15r1_cSNV_syn_pre_lib_med <- unname(X15r1_cSNV_syn_pre_lib_quarts[3])
X15r1_cSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X15r1_cSNV_nonsense_pre_lib_med <- unname(X15r1_cSNV_nonsense_pre_lib_quarts[3])
X15r1_cSNV_syn_to_non_pre_lib_spread <- X15r1_cSNV_syn_pre_lib_med - X15r1_cSNV_nonsense_pre_lib_med

X15r2_cSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X15r2_cSNV_missense_pre_lib_med <- unname(X15r2_cSNV_missense_pre_lib_quarts[3])
X15r2_cSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X15r2_cSNV_syn_pre_lib_med <- unname(X15r2_cSNV_syn_pre_lib_quarts[3])
X15r2_cSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X15r2_cSNV_nonsense_pre_lib_med <- unname(X15r2_cSNV_nonsense_pre_lib_quarts[3])
X15r2_cSNV_syn_to_non_pre_lib_spread <- X15r2_cSNV_syn_pre_lib_med - X15r2_cSNV_nonsense_pre_lib_med

X15r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_missense_pre_lib_med <- unname(X15r1r2a_cSNV_missense_pre_lib_quarts[3])
X15r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_syn_pre_lib_med <- unname(X15r1r2a_cSNV_syn_pre_lib_quarts[3])
X15r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X15r1r2a_cSNV_nonsense_pre_lib_med <- unname(X15r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X15r1r2a_cSNV_syn_to_non_pre_lib_spread <- X15r1r2a_cSNV_syn_pre_lib_med - X15r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X15r1_tSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X15r1_tSNV_missense_pre_lib_med <- unname(X15r1_tSNV_missense_pre_lib_quarts[3])
X15r1_tSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X15r1_tSNV_syn_pre_lib_med <- unname(X15r1_tSNV_syn_pre_lib_quarts[3])
X15r1_tSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X15r1_tSNV_nonsense_pre_lib_med <- unname(X15r1_tSNV_nonsense_pre_lib_quarts[3])
X15r1_tSNV_syn_to_non_pre_lib_spread <- X15r1_tSNV_syn_pre_lib_med - X15r1_tSNV_nonsense_pre_lib_med

X15r2_tSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X15r2_tSNV_missense_pre_lib_med <- unname(X15r2_tSNV_missense_pre_lib_quarts[3])
X15r2_tSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X15r2_tSNV_syn_pre_lib_med <- unname(X15r2_tSNV_syn_pre_lib_quarts[3])
X15r2_tSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X15r2_tSNV_nonsense_pre_lib_med <- unname(X15r2_tSNV_nonsense_pre_lib_quarts[3])
X15r2_tSNV_syn_to_non_pre_lib_spread <- X15r2_tSNV_syn_pre_lib_med - X15r2_tSNV_nonsense_pre_lib_med

X15r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_missense_pre_lib_med <- unname(X15r1r2a_tSNV_missense_pre_lib_quarts[3])
X15r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_syn_pre_lib_med <- unname(X15r1r2a_tSNV_syn_pre_lib_quarts[3])
X15r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X15r1r2a_tSNV_nonsense_pre_lib_med <- unname(X15r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X15r1r2a_tSNV_syn_to_non_pre_lib_spread <- X15r1r2a_tSNV_syn_pre_lib_med - X15r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X15r1_tSNV_syn_rna_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X15r1_tSNV_syn_rna_pre_med <- unname(X15r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X15r1_tSNV_syn_rna_post_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X15r1_tSNV_syn_rna_post_med <- unname(X15r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X15r2_tSNV_syn_rna_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X15r2_tSNV_syn_rna_pre_med <- unname(X15r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X15r2_tSNV_syn_rna_post_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X15r2_tSNV_syn_rna_post_med <- unname(X15r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X15r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X15r1r2a_tSNV_syn_rna_pre_med <- unname(X15r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X15r1r2a_tSNV_syn_rna_post_quarts <- quantile(X15r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X15r1r2a_tSNV_syn_rna_post_med <- unname(X15r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X15r1_cSNV_syn_pre_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X15r1_cSNV_syn_post_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X15r1_cSNV_syn_post_lib_med
# tHDR
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X15r1_tSNV_syn_pre_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X15r1_tSNV_syn_post_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X15r1_tSNV_syn_post_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X15r1_tSNV_syn_rna_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X15r1_tSNV_syn_rna_post_med

#r2
X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X15r2_cSNV_syn_pre_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X15r2_cSNV_syn_post_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X15r2_cSNV_syn_post_lib_med
# tHDR
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X15r2_tSNV_syn_pre_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X15r2_tSNV_syn_post_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X15r2_tSNV_syn_post_lib_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X15r2_tSNV_syn_rna_pre_med
X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X15r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X15r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X15r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X15r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X15r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X15r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X15r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X15r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X15r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X15r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X15r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X15r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X15r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X15r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X15r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X15r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X15r1_prog_var_thresh5_df_r2_int_ord[which(X15r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X15r1_prog_var_thresh5_df_r2_int_ord
X15r1_prog_map_thresh5_df_r2_int_ord = which(X15r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X15r1_prog_map_thresh5_df_r2_int_ord_df = X15r1_prog_var_thresh5_df_r2_int_ord[X15r1_prog_map_thresh5_df_r2_int_ord,]
X15r1_prog_map_exon_thresh5_df_r2_int_ord = which(X15r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X15r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X15r1_prog_map_exon_thresh5_df_r2_int_ord_df = X15r1_prog_map_thresh5_df_r2_int_ord_df[X15r1_prog_map_exon_thresh5_df_r2_int_ord,]
X15r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X15r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X15r1_prog_map_thresh5_df_r2_int_ord_df[X15r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X15r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X15r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X15r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X15r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X15r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X15r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X15r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X15r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X15r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X15r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X15r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X15r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X15r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X15r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X15r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X15r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X15r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X15r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X15r1r2_cSNV_r1_post_by_r2_post_cor_s
X15r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X15r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X15r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X15r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X15r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X15r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X15r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X15r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X15r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X15r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X15r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X15r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X15r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X15r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X15r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X15r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X15r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X15r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1_cSNV_post_pre_by_cadd_cor_s
#X15r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X15r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r2_cSNV_post_pre_by_cadd_cor_s

#X15r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X15r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1_cSNV_post_lib_by_cadd_cor_s
#X15r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X15r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X15r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X15r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1_tSNV_post_pre_by_cadd_cor_s
#X15r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X15r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r2_tSNV_post_pre_by_cadd_cor_s

#X15r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X15r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1_tSNV_post_lib_by_cadd_cor_s
#X15r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X15r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X15r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X15r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X15r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X15r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X15r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X15r1_prog_var_all_lib_count
X15r1_prog_var_all_pre_count
X15r2_prog_var_all_pre_count
X15r1_prog_map_thresh5_lib_count
X15r1_prog_map_thresh5_pre_count
X15r2_prog_map_thresh5_pre_count
X15r1_prog_map_thresh5_post_count
X15r2_prog_map_thresh5_post_count
X15r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X15r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X15r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X15r1r2_cSNV_r1_post_by_r2_post_cor_s
X15r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X15r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X15r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X15r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X15r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X15r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X15r1_cSNV_post_pre_by_cadd_cor_s
X15r2_cSNV_post_pre_by_cadd_cor_s
X15r1_cSNV_post_lib_by_cadd_cor_s
X15r2_cSNV_post_lib_by_cadd_cor_s
X15r1_tSNV_post_pre_by_cadd_cor_s
X15r2_tSNV_post_pre_by_cadd_cor_s
X15r1_tSNV_post_lib_by_cadd_cor_s
X15r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X15r1r2a_cSNV_post_pre_by_cadd_cor_s
X15r1r2w_cSNV_post_pre_by_cadd_cor_s
X15r1r2a_cSNV_post_lib_by_cadd_cor_s
X15r1r2w_cSNV_post_lib_by_cadd_cor_s
X15r1r2a_tSNV_post_pre_by_cadd_cor_s
X15r1r2w_tSNV_post_pre_by_cadd_cor_s
X15r1r2a_tSNV_post_lib_by_cadd_cor_s
X15r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X15r1_cSNV_syn_to_non_post_pre_spread
X15r2_cSNV_syn_to_non_post_pre_spread
X15r1r2a_cSNV_syn_to_non_post_pre_spread
X15r1_cSNV_syn_to_non_post_lib_spread
X15r2_cSNV_syn_to_non_post_lib_spread
X15r1r2a_cSNV_syn_to_non_post_lib_spread
X15r1_tSNV_syn_to_non_post_pre_spread
X15r2_tSNV_syn_to_non_post_pre_spread
X15r1r2a_tSNV_syn_to_non_post_pre_spread
X15r1_tSNV_syn_to_non_post_lib_spread
X15r2_tSNV_syn_to_non_post_lib_spread
X15r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X15r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X15r1_prog_map_thresh5_df_r2_int_ord_df[which(X15r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X15r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df[which(X15r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df[which(X15r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df[which(X15r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X15r1_cSNV_pre_lib_cors = cor(log2(X15r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X15r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15r1_tSNV_pre_lib_cors = cor(log2(X15r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15r1_cSNV_post_lib_cors = cor(log2(X15r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X15r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X15r1_tSNV_post_lib_cors = cor(log2(X15r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X15r1_cSNV_post_pre_cors = cor(log2(X15r1_prog_map_thresh5_df$post_pseudo_freq),log2(X15r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15r1_tSNV_post_pre_cors = cor(log2(X15r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X15r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15r1_cSNV_rna_lib_cors = cor(log2(X15r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X15r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15r1_tSNV_rna_lib_cors = cor(log2(X15r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X15r1_cSNV_rna_pre_cors = cor(log2(X15r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X15r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15r1_tSNV_rna_pre_cors = cor(log2(X15r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X15r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15r1r2_cSNV_pre_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X15r1r2_tSNV_pre_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X15r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X15r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X15r1r2_cSNV_post_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X15r1r2_tSNV_post_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X15r1r2_cSNV_post_lib_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X15r1r2_tSNV_post_lib_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X15r1r2_cSNV_post_pre_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X15r1r2_tSNV_post_pre_ratio_cors = cor(log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X15r1r2_cSNV_rna_cors = cor(log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X15r1r2_tSNV_rna_cors = cor(log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X15r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X15r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X15r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X15r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X15r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X15r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X15r1_cors <- c("X15r1",X15r1_cSNV_pre_lib_cors,X15r1_tSNV_pre_lib_cors,X15r1_cSNV_post_lib_cors,X15r1_tSNV_post_lib_cors,X15r1_cSNV_post_pre_cors,X15r1_tSNV_post_pre_cors,X15r1_cSNV_rna_lib_cors,X15r1_tSNV_rna_lib_cors,X15r1_cSNV_rna_pre_cors,X15r1_tSNV_rna_pre_cors,X15r1r2_cSNV_pre_cors,X15r1r2_tSNV_pre_cors,X15r1r2_cSNV_pre_lib_ratio_cors,X15r1r2_tSNV_pre_lib_ratio_cors,X15r1r2_cSNV_post_cors,X15r1r2_tSNV_post_cors,X15r1r2_cSNV_post_lib_ratio_cors,X15r1r2_tSNV_post_lib_ratio_cors,X15r1r2_cSNV_post_pre_ratio_cors,X15r1r2_tSNV_post_pre_ratio_cors,X15r1r2_cSNV_rna_cors,X15r1r2_tSNV_rna_cors,X15r1r2_tSNV_rna_pre_ratio_cors,X15r1_cSNV_pre_lib_ratio_cadd_cors,X15r1_tSNV_pre_lib_ratio_cadd_cors,X15r1_cSNV_post_lib_ratio_cadd_cors,X15r1_tSNV_post_lib_ratio_cadd_cors,X15r1_cSNV_post_pre_ratio_cadd_cors,X15r1_tSNV_post_pre_ratio_cadd_cors,X15r1_cSNV_post_pre_ratio_cadd_missense_cors,X15r1_tSNV_post_pre_ratio_cadd_missense_cors,X15r1_cSNV_post_pre_ratio_polyphen_missense_cors,X15r1_tSNV_post_pre_ratio_polyphen_missense_cors,X15r1_cSNV_post_pre_ratio_grantham_missense_cors,X15r1_tSNV_post_pre_ratio_grantham_missense_cors,X15r1r2a_cSNV_pre_lib_ratio_cadd_cors,X15r1r2a_tSNV_pre_lib_ratio_cadd_cors,X15r1r2a_cSNV_post_lib_ratio_cadd_cors,X15r1r2a_tSNV_post_lib_ratio_cadd_cors,X15r1r2a_cSNV_post_pre_ratio_cadd_cors,X15r1r2a_tSNV_post_pre_ratio_cadd_cors,X15r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X15r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X15r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X15r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X15r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X15r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X15r1r2w_cSNV_pre_lib_ratio_cadd_cors,X15r1r2w_cSNV_post_lib_ratio_cadd_cors,X15r1r2w_cSNV_post_pre_ratio_cadd_cors,X15r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X15r2_cSNV_pre_lib_cors = cor(log2(X15r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X15r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15r2_tSNV_pre_lib_cors = cor(log2(X15r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15r2_cSNV_post_lib_cors = cor(log2(X15r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X15r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X15r2_tSNV_post_lib_cors = cor(log2(X15r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X15r2_cSNV_post_pre_cors = cor(log2(X15r2_prog_map_thresh5_df$post_pseudo_freq),log2(X15r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15r2_tSNV_post_pre_cors = cor(log2(X15r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X15r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15r2_cSNV_rna_lib_cors = cor(log2(X15r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X15r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15r2_tSNV_rna_lib_cors = cor(log2(X15r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X15r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X15r2_cSNV_rna_pre_cors = cor(log2(X15r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X15r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15r2_tSNV_rna_pre_cors = cor(log2(X15r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X15r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X15r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X15r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X15r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X15r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X15r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X15r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X15r2_cors <- c("X15r2",X15r2_cSNV_pre_lib_cors,X15r2_tSNV_pre_lib_cors,X15r2_cSNV_post_lib_cors,X15r2_tSNV_post_lib_cors,X15r2_cSNV_post_pre_cors,X15r2_tSNV_post_pre_cors,X15r2_cSNV_rna_lib_cors,X15r2_tSNV_rna_lib_cors,X15r2_cSNV_rna_pre_cors,X15r2_tSNV_rna_pre_cors,X15r1r2_cSNV_pre_cors,X15r1r2_tSNV_pre_cors,X15r1r2_cSNV_pre_lib_ratio_cors,X15r1r2_tSNV_pre_lib_ratio_cors,X15r1r2_cSNV_post_cors,X15r1r2_tSNV_post_cors,X15r1r2_cSNV_post_lib_ratio_cors,X15r1r2_tSNV_post_lib_ratio_cors,X15r1r2_cSNV_post_pre_ratio_cors,X15r1r2_tSNV_post_pre_ratio_cors,X15r1r2_cSNV_rna_cors,X15r1r2_tSNV_rna_cors,X15r1r2_tSNV_rna_pre_ratio_cors,X15r2_cSNV_pre_lib_ratio_cadd_cors,X15r2_tSNV_pre_lib_ratio_cadd_cors,X15r2_cSNV_post_lib_ratio_cadd_cors,X15r2_tSNV_post_lib_ratio_cadd_cors,X15r2_cSNV_post_pre_ratio_cadd_cors,X15r2_tSNV_post_pre_ratio_cadd_cors,X15r2_cSNV_post_pre_ratio_cadd_missense_cors,X15r2_tSNV_post_pre_ratio_cadd_missense_cors,X15r2_cSNV_post_pre_ratio_polyphen_missense_cors,X15r2_tSNV_post_pre_ratio_polyphen_missense_cors,X15r2_cSNV_post_pre_ratio_grantham_missense_cors,X15r2_tSNV_post_pre_ratio_grantham_missense_cors,X15r1r2a_cSNV_pre_lib_ratio_cadd_cors,X15r1r2a_tSNV_pre_lib_ratio_cadd_cors,X15r1r2a_cSNV_post_lib_ratio_cadd_cors,X15r1r2a_tSNV_post_lib_ratio_cadd_cors,X15r1r2a_cSNV_post_pre_ratio_cadd_cors,X15r1r2a_tSNV_post_pre_ratio_cadd_cors,X15r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X15r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X15r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X15r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X15r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X15r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X15r1r2w_cSNV_pre_lib_ratio_cadd_cors,X15r1r2w_cSNV_post_lib_ratio_cadd_cors,X15r1r2w_cSNV_post_pre_ratio_cadd_cors,X15r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X15r1)
rm(X15r2)
gc()
X16r1_file <- paste(experiment_dir_171011,'X16r1','_annotated.txt',sep='')
X16r2_file <- paste(experiment_dir_171011,'X16r2','_annotated.txt',sep='')
X16r1 <- read.table(X16r1_file, header=TRUE, sep="\t")
X16r2 <- read.table(X16r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X16 <- editing_info[which(editing_info$amplicon == 'X16'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X16_HDR_5_SNV = as.character(editing_info_X16$HDR_5_SNV)
X16_HDR_3_SNV = as.character(editing_info_X16$HDR_3_SNV)
#X16_cut_pos = as.character(editing_info_X16$cut_pos)
X16_cut_end = as.character(editing_info_X16$cut_end)
X16_mut_start = as.character(editing_info_X16$mut_start)
X16_mut_end = as.character(editing_info_X16$mut_end)
### Replicate 1
X16r1_cSNV_all <- which(X16r1[,'c_hdr_snv']=='True')
X16r1_cSNV_all_df = X16r1[X16r1_cSNV_all,]
X16r1_prog_var_all <- which(X16r1[,'all_hdr_variant']=='True' & X16r1[,'edit_string']!='-WT')
X16r1_prog_var_all_df = X16r1[X16r1_prog_var_all,]
X16r1_prog_map_all = which(X16r1_prog_var_all_df[,'pos']!='REF')
X16r1_prog_map_all_df = X16r1_prog_var_all_df[X16r1_prog_map_all,]
X16r1_prog_map_exon_all = which(X16r1_prog_map_all_df[,'cDNApos']!='REF' & X16r1_prog_map_all_df[,'cDNApos']!='NA')
X16r1_prog_map_exon_all_df = X16r1_prog_map_all_df[X16r1_prog_map_exon_all,]
X16r1_prog_map_CADD = which(X16r1_prog_map_all_df[,'CADD.phred']!='NA')
X16r1_prog_map_CADD_df = X16r1_prog_map_all_df[X16r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X16r1_prog_var_thresh5 <- which(as.numeric(as.character(X16r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X16r1_prog_var_thresh5_df = X16r1_prog_var_all_df[X16r1_prog_var_thresh5,]
X16r1_prog_map_thresh5 <- which(as.numeric(as.character(X16r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X16r1_prog_map_thresh5_df = X16r1_prog_map_all_df[X16r1_prog_map_thresh5,]
X16r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X16r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X16r1_prog_map_exon_thresh5_df = X16r1_prog_map_exon_all_df[X16r1_prog_map_exon_thresh5,]
X16r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X16r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X16r1_prog_map_CADD_thresh5_df = X16r1_prog_map_CADD_df[X16r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X16r1_prog_var_all_lib_count = length(X16r1_prog_var_all_df$lib)
X16r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X16r1_prog_var_all_min_lib_counts = min(X16r1_prog_var_all_df$lib)
X16r1_prog_var_all_min_lib_counts
X16r1_prog_var_all_max_lib_counts = max(X16r1_prog_var_all_df$lib)
X16r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X16r1_prog_map_all_lib_count = length(X16r1_prog_map_all_df$lib)
X16r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X16r1_prog_map_all_min_lib_counts = min(X16r1_prog_map_all_df$lib)
X16r1_prog_map_all_min_lib_counts
X16r1_prog_map_all_max_lib_counts = max(X16r1_prog_map_all_df$lib)
X16r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X16r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X16r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X16r1_prog_var_all_pre_count = length(X16r1_prog_var_all_df$pre)
X16r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X16r1_prog_var_all_min_pre_counts = min(X16r1_prog_var_all_df$pre)
X16r1_prog_var_all_min_pre_counts
X16r1_prog_var_all_max_pre_counts = max(X16r1_prog_var_all_df$pre)
X16r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X16r1_prog_map_all_pre_count = length(X16r1_prog_map_all_df$pre)
X16r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X16r1_prog_map_all_min_pre_counts = min(X16r1_prog_map_all_df$pre)
X16r1_prog_map_all_min_pre_counts
X16r1_prog_map_all_max_pre_counts = max(X16r1_prog_map_all_df$pre)
X16r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X16r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X16r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X16r1_prog_map_all_post_count = length(X16r1_prog_map_all_df$post)
X16r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X16r1_prog_map_all_min_post_counts = min(X16r1_prog_map_all_df$post)
X16r1_prog_map_all_min_post_counts
X16r1_prog_map_all_max_post_counts = max(X16r1_prog_map_all_df$post)
X16r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X16r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X16r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X16r1_prog_map_all_syn_df <- X16r1_prog_map_all_df[which(X16r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X16r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X16r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X16r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X16r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X16r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X16r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X16r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X16r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X16r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X16r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X16r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X16r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X16r1_prog_map_all_min_rna_counts = min(X16r1_prog_map_exon_all_df$tHDR_rna)
X16r1_prog_map_all_min_rna_counts
X16r1_prog_map_all_max_rna_counts = max(X16r1_prog_map_exon_all_df$tHDR_rna)
X16r1_prog_map_all_max_rna_counts
X16r1_prog_map_all_min_rna_pseudo_freq = min(X16r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16r1_prog_map_all_min_rna_pseudo_freq
X16r1_prog_map_all_max_rna_pseudo_freq = max(X16r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16r1_prog_map_all_max_rna_pseudo_freq
X16r1_prog_map_all_min_rna_pre_ratio = min(X16r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16r1_prog_map_all_min_rna_pre_ratio
X16r1_prog_map_all_max_rna_pre_ratio = max(X16r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16r1_prog_map_all_max_rna_pre_ratio
X16r1_prog_map_all_min_rna_post_ratio = min(X16r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16r1_prog_map_all_min_rna_post_ratio
X16r1_prog_map_all_max_rna_post_ratio = max(X16r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X16r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X16r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X16r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X16r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X16r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X16r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X16r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X16r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X16r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X16r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X16r1_prog_map_all_df$post_pre_ratio),log2(X16r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X16r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X16r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X16r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X16r1_cSNV_all_corr_pre_count = length(X16r1_cSNV_all_df$corr_pre)
X16r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X16r1_cSNV_all_min_corr_pre_counts = min(X16r1_cSNV_all_df$corr_pre)
X16r1_cSNV_all_min_corr_pre_counts
X16r1_cSNV_all_max_corr_pre_counts = max(X16r1_cSNV_all_df$corr_pre)
X16r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X16r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X16r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X16r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X16r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X16r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_cSNV_all_corr_post_count = length(X16r1_cSNV_all_df$corr_post)
X16r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X16r1_cSNV_all_min_corr_post_counts = min(X16r1_cSNV_all_df$corr_post)
X16r1_cSNV_all_min_corr_post_counts
X16r1_cSNV_all_max_corr_post_counts = max(X16r1_cSNV_all_df$corr_post)
X16r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X16r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X16r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X16r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X16r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X16r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X16r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X16_p_hdr_snv = paste('p_hdr_',X16_cut_end,'_snv',sep='')
X16r1_pSNV_all <- which(X16r1[,X16_p_hdr_snv]=='True')
X16r1_pSNV_all_df = X16r1[X16r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_pSNV_all_lib_count = length(X16r1_pSNV_all_df$lib)
X16r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X16r1_pSNV_all_min_lib_counts = min(X16r1_pSNV_all_df$lib)
X16r1_pSNV_all_min_lib_counts
X16r1_pSNV_all_max_lib_counts = max(X16r1_pSNV_all_df$lib)
X16r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X16r1_pSNV_all_pre_count = length(X16r1_pSNV_all_df$pre)
X16r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X16r1_pSNV_all_min_pre_counts = min(X16r1_pSNV_all_df$pre)
X16r1_pSNV_all_min_pre_counts
X16r1_pSNV_all_max_pre_counts = max(X16r1_pSNV_all_df$pre)
X16r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X16r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X16r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_pSNV_all_post_count = length(X16r1_pSNV_all_df$post)
X16r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X16r1_pSNV_all_min_post_counts = min(X16r1_pSNV_all_df$post)
X16r1_pSNV_all_min_post_counts
X16r1_pSNV_all_max_post_counts = max(X16r1_pSNV_all_df$post)
X16r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X16r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X16r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_prog_map_thresh5_lib_count = length(X16r1_prog_map_thresh5_df$lib)
X16r1_prog_map_thresh5_lib_count
X16r1_prog_map_thresh5_min_lib_counts = min(X16r1_prog_map_thresh5_df$lib)
X16r1_prog_map_thresh5_min_lib_counts
X16r1_prog_map_thresh5_max_lib_counts = max(X16r1_prog_map_thresh5_df$lib)
X16r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X16r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X16r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_prog_map_thresh5_pre_count = length(X16r1_prog_map_thresh5_df$pre)
X16r1_prog_map_thresh5_pre_count
X16r1_prog_map_thresh5_min_pre_counts = min(X16r1_prog_map_thresh5_df$pre)
X16r1_prog_map_thresh5_min_pre_counts
X16r1_prog_map_thresh5_max_pre_counts = max(X16r1_prog_map_thresh5_df$pre)
X16r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r1_prog_map_thresh5_post_count = length(X16r1_prog_map_thresh5_df$post)
X16r1_prog_map_thresh5_post_count
X16r1_prog_map_thresh5_min_post_counts = min(X16r1_prog_map_thresh5_df$post)
X16r1_prog_map_thresh5_min_post_counts
X16r1_prog_map_thresh5_max_post_counts = max(X16r1_prog_map_thresh5_df$post)
X16r1_prog_map_thresh5_max_post_counts
X16r1_prog_map_thresh5_corr_post_count = length(X16r1_cSNV_all_df$corr_post)
X16r1_prog_map_thresh5_corr_post_count
X16r1_prog_map_thresh5_min_corr_post_counts = min(X16r1_cSNV_all_df$corr_post)
X16r1_prog_map_thresh5_min_corr_post_counts
X16r1_prog_map_thresh5_max_corr_post_counts = max(X16r1_cSNV_all_df$corr_post)
X16r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X16r1_pSNV_thresh5 <- which(X16r1[,X16_p_hdr_snv]=='True' & as.numeric(as.character(X16r1[,'pre_freq']))>=0.00001)
X16r1_pSNV_thresh5_df = X16r1[X16r1_pSNV_thresh5,]
X16r1_pSNV_thresh5_lib_count = length(X16r1_pSNV_thresh5_df$lib)
X16r1_pSNV_thresh5_lib_count
X16r1_pSNV_thresh5_min_lib_counts = min(X16r1_pSNV_thresh5_df$lib)
X16r1_pSNV_thresh5_min_lib_counts
X16r1_pSNV_thresh5_max_lib_counts = max(X16r1_pSNV_thresh5_df$lib)
X16r1_pSNV_thresh5_max_lib_counts
X16r1_pSNV_thresh5_pre_count = length(X16r1_pSNV_thresh5_df$pre)
X16r1_pSNV_thresh5_pre_count
X16r1_pSNV_thresh5_min_pre_counts = min(X16r1_pSNV_thresh5_df$pre)
X16r1_pSNV_thresh5_min_pre_counts
X16r1_pSNV_thresh5_max_pre_counts = max(X16r1_pSNV_thresh5_df$pre)
X16r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X16r1_pSNV_thresh5_post_count = length(X16r1_pSNV_thresh5_df$post)
X16r1_pSNV_thresh5_post_count
X16r1_pSNV_thresh5_min_post_counts = min(X16r1_pSNV_thresh5_df$post)
X16r1_pSNV_thresh5_min_post_counts
X16r1_pSNV_thresh5_max_post_counts = max(X16r1_pSNV_thresh5_df$post)
X16r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X16r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X16r1_pSNV_thresh5_post_pos

### Replicate 2
X16r2_cSNV_all <- which(X16r2[,'c_hdr_snv']=='True')
X16r2_cSNV_all_df = X16r2[X16r2_cSNV_all,]
X16r2_prog_var_all <- which(X16r2[,'all_hdr_variant']=='True' & X16r2[,'edit_string']!='-WT')
X16r2_prog_var_all_df = X16r2[X16r2_prog_var_all,]
X16r2_prog_map_all = which(X16r2_prog_var_all_df[,'pos']!='REF')
X16r2_prog_map_all_df = X16r2_prog_var_all_df[X16r2_prog_map_all,]
X16r2_prog_map_exon_all = which(X16r2_prog_map_all_df[,'cDNApos']!='REF' & X16r2_prog_map_all_df[,'cDNApos']!='NA')
X16r2_prog_map_exon_all_df = X16r2_prog_map_all_df[X16r2_prog_map_exon_all,]
X16r2_prog_map_CADD = which(X16r2_prog_map_all_df[,'CADD.phred']!='NA')
X16r2_prog_map_CADD_df = X16r2_prog_map_all_df[X16r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X16r2_prog_var_thresh5 <- which(as.numeric(as.character(X16r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X16r2_prog_var_thresh5_df = X16r2_prog_var_all_df[X16r2_prog_var_thresh5,]
X16r2_prog_map_thresh5 <- which(as.numeric(as.character(X16r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X16r2_prog_map_thresh5_df = X16r2_prog_map_all_df[X16r2_prog_map_thresh5,]
X16r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X16r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X16r2_prog_map_exon_thresh5_df = X16r2_prog_map_exon_all_df[X16r2_prog_map_exon_thresh5,]
X16r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X16r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X16r2_prog_map_CADD_thresh5_df = X16r2_prog_map_CADD_df[X16r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X16r2_prog_var_all_lib_count = length(X16r2_prog_var_all_df$lib)
X16r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X16r2_prog_var_all_min_lib_counts = min(X16r2_prog_var_all_df$lib)
X16r2_prog_var_all_min_lib_counts
X16r2_prog_var_all_max_lib_counts = max(X16r2_prog_var_all_df$lib)
X16r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X16r2_prog_map_all_lib_count = length(X16r2_prog_map_all_df$lib)
X16r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X16r2_prog_map_all_min_lib_counts = min(X16r2_prog_map_all_df$lib)
X16r2_prog_map_all_min_lib_counts
X16r2_prog_map_all_max_lib_counts = max(X16r2_prog_map_all_df$lib)
X16r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X16r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X16r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X16r2_prog_var_all_pre_count = length(X16r2_prog_var_all_df$pre)
X16r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X16r2_prog_var_all_min_pre_counts = min(X16r2_prog_var_all_df$pre)
X16r2_prog_var_all_min_pre_counts
X16r2_prog_var_all_max_pre_counts = max(X16r2_prog_var_all_df$pre)
X16r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X16r2_prog_map_all_pre_count = length(X16r2_prog_map_all_df$pre)
X16r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X16r2_prog_map_all_min_pre_counts = min(X16r2_prog_map_all_df$pre)
X16r2_prog_map_all_min_pre_counts
X16r2_prog_map_all_max_pre_counts = max(X16r2_prog_map_all_df$pre)
X16r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X16r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X16r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X16r2_prog_map_all_post_count = length(X16r2_prog_map_all_df$post)
X16r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X16r2_prog_map_all_min_post_counts = min(X16r2_prog_map_all_df$post)
X16r2_prog_map_all_min_post_counts
X16r2_prog_map_all_max_post_counts = max(X16r2_prog_map_all_df$post)
X16r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X16r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X16r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X16r2_prog_map_all_syn_df <- X16r2_prog_map_all_df[which(X16r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X16r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X16r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X16r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X16r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X16r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X16r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X16r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X16r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X16r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X16r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X16r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X16r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X16r2_prog_map_all_min_rna_counts = min(X16r2_prog_map_exon_all_df$tHDR_rna)
X16r2_prog_map_all_min_rna_counts
X16r2_prog_map_all_max_rna_counts = max(X16r2_prog_map_exon_all_df$tHDR_rna)
X16r2_prog_map_all_max_rna_counts
X16r2_prog_map_all_min_rna_pseudo_freq = min(X16r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16r2_prog_map_all_min_rna_pseudo_freq
X16r2_prog_map_all_max_rna_pseudo_freq = max(X16r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16r2_prog_map_all_max_rna_pseudo_freq
X16r2_prog_map_all_min_rna_pre_ratio = min(X16r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16r2_prog_map_all_min_rna_pre_ratio
X16r2_prog_map_all_max_rna_pre_ratio = max(X16r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16r2_prog_map_all_max_rna_pre_ratio
X16r2_prog_map_all_min_rna_post_ratio = min(X16r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16r2_prog_map_all_min_rna_post_ratio
X16r2_prog_map_all_max_rna_post_ratio = max(X16r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X16r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X16r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X16r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X16r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X16r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X16r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X16r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X16r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X16r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X16r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X16r2_prog_map_all_df$post_pre_ratio),log2(X16r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X16r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X16r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X16r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X16r2_cSNV_all_corr_pre_count = length(X16r2_cSNV_all_df$corr_pre)
X16r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X16r2_cSNV_all_min_corr_pre_counts = min(X16r2_cSNV_all_df$corr_pre)
X16r2_cSNV_all_min_corr_pre_counts
X16r2_cSNV_all_max_corr_pre_counts = max(X16r2_cSNV_all_df$corr_pre)
X16r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X16r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X16r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X16r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X16r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X16r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_cSNV_all_corr_post_count = length(X16r2_cSNV_all_df$corr_post)
X16r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X16r2_cSNV_all_min_corr_post_counts = min(X16r2_cSNV_all_df$corr_post)
X16r2_cSNV_all_min_corr_post_counts
X16r2_cSNV_all_max_corr_post_counts = max(X16r2_cSNV_all_df$corr_post)
X16r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X16r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X16r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X16r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X16r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X16r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X16r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X16_p_hdr_snv = paste('p_hdr_',X16_cut_end,'_snv',sep='')
X16r2_pSNV_all <- which(X16r2[,X16_p_hdr_snv]=='True')
X16r2_pSNV_all_df = X16r2[X16r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_pSNV_all_lib_count = length(X16r2_pSNV_all_df$lib)
X16r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X16r2_pSNV_all_min_lib_counts = min(X16r2_pSNV_all_df$lib)
X16r2_pSNV_all_min_lib_counts
X16r2_pSNV_all_max_lib_counts = max(X16r2_pSNV_all_df$lib)
X16r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X16r2_pSNV_all_pre_count = length(X16r2_pSNV_all_df$pre)
X16r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X16r2_pSNV_all_min_pre_counts = min(X16r2_pSNV_all_df$pre)
X16r2_pSNV_all_min_pre_counts
X16r2_pSNV_all_max_pre_counts = max(X16r2_pSNV_all_df$pre)
X16r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X16r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X16r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_pSNV_all_post_count = length(X16r2_pSNV_all_df$post)
X16r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X16r2_pSNV_all_min_post_counts = min(X16r2_pSNV_all_df$post)
X16r2_pSNV_all_min_post_counts
X16r2_pSNV_all_max_post_counts = max(X16r2_pSNV_all_df$post)
X16r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X16r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X16r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_prog_map_thresh5_lib_count = length(X16r2_prog_map_thresh5_df$lib)
X16r2_prog_map_thresh5_lib_count
X16r2_prog_map_thresh5_min_lib_counts = min(X16r2_prog_map_thresh5_df$lib)
X16r2_prog_map_thresh5_min_lib_counts
X16r2_prog_map_thresh5_max_lib_counts = max(X16r2_prog_map_thresh5_df$lib)
X16r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X16r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X16r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_prog_map_thresh5_pre_count = length(X16r2_prog_map_thresh5_df$pre)
X16r2_prog_map_thresh5_pre_count
X16r2_prog_map_thresh5_min_pre_counts = min(X16r2_prog_map_thresh5_df$pre)
X16r2_prog_map_thresh5_min_pre_counts
X16r2_prog_map_thresh5_max_pre_counts = max(X16r2_prog_map_thresh5_df$pre)
X16r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16r2_prog_map_thresh5_post_count = length(X16r2_prog_map_thresh5_df$post)
X16r2_prog_map_thresh5_post_count
X16r2_prog_map_thresh5_min_post_counts = min(X16r2_prog_map_thresh5_df$post)
X16r2_prog_map_thresh5_min_post_counts
X16r2_prog_map_thresh5_max_post_counts = max(X16r2_prog_map_thresh5_df$post)
X16r2_prog_map_thresh5_max_post_counts
X16r2_prog_map_thresh5_corr_post_count = length(X16r2_prog_map_thresh5_df$corr_post)
X16r2_prog_map_thresh5_corr_post_count
X16r2_prog_map_thresh5_min_corr_post_counts = min(X16r2_prog_map_thresh5_df$corr_post)
X16r2_prog_map_thresh5_min_corr_post_counts
X16r2_prog_map_thresh5_max_corr_post_counts = max(X16r2_prog_map_thresh5_df$corr_post)
X16r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X16r2_pSNV_thresh5 <- which(X16r2[,X16_p_hdr_snv]=='True' & as.numeric(as.character(X16r2[,'pre_freq']))>=0.00001)
X16r2_pSNV_thresh5_df = X16r2[X16r2_pSNV_thresh5,]
X16r2_pSNV_thresh5_lib_count = length(X16r2_pSNV_thresh5_df$lib)
X16r2_pSNV_thresh5_lib_count
X16r2_pSNV_thresh5_min_lib_counts = min(X16r2_pSNV_thresh5_df$lib)
X16r2_pSNV_thresh5_min_lib_counts
X16r2_pSNV_thresh5_max_lib_counts = max(X16r2_pSNV_thresh5_df$lib)
X16r2_pSNV_thresh5_max_lib_counts
X16r2_pSNV_thresh5_pre_count = length(X16r2_pSNV_thresh5_df$pre)
X16r2_pSNV_thresh5_pre_count
X16r2_pSNV_thresh5_min_pre_counts = min(X16r2_pSNV_thresh5_df$pre)
X16r2_pSNV_thresh5_min_pre_counts
X16r2_pSNV_thresh5_max_pre_counts = max(X16r2_pSNV_thresh5_df$pre)
X16r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X16r2_pSNV_thresh5_post_count = length(X16r2_pSNV_thresh5_df$post)
X16r2_pSNV_thresh5_post_count
X16r2_pSNV_thresh5_min_post_counts = min(X16r2_pSNV_thresh5_df$post)
X16r2_pSNV_thresh5_min_post_counts
X16r2_pSNV_thresh5_max_post_counts = max(X16r2_pSNV_thresh5_df$post)
X16r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X16r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X16r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X16r1_prog_var_thresh5_df:
X16r1_prog_var_thresh5_df_r2_int <- X16r1_prog_var_thresh5_df[which(X16r1_prog_var_thresh5_df$variant %in% X16r2_prog_var_thresh5_df$variant),]
#Intersection variants of X16r2_prog_var_thresh5_df:
X16r2_prog_var_thresh5_df_r1_int <- X16r2_prog_var_thresh5_df[which(X16r2_prog_var_thresh5_df$variant %in% X16r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X16r1_prog_var_thresh5_df_r2_int_ord <- X16r1_prog_var_thresh5_df_r2_int[order(X16r1_prog_var_thresh5_df_r2_int$variant),]
X16r2_prog_var_thresh5_df_r1_int_ord <- X16r2_prog_var_thresh5_df_r1_int[order(X16r2_prog_var_thresh5_df_r1_int$variant),]

dim(X16r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X16r1r2int_prog_var_thresh5_pre_count <- dim(X16r1_prog_var_thresh5_df_r2_int)[1] 
X16r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X16r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X16r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X16r2_prog_var_thresh5_df_r1_int_ord$pre
X16r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X16r2_prog_var_thresh5_df_r1_int_ord$lib
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X16r2_prog_var_thresh5_df_r1_int_ord$post
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X16r2_prog_var_thresh5_df_r1_int_ord$rna
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X16r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X16r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X16r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$post_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X16r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X16r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X16r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X16r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X16r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X16r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X16r2_prog_var_thresh5_df_r1_int_ord$corr_post
X16r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X16r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X16r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X16r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X16r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X16r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X16r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X16r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X16r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X16r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X16r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X16r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X16r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X16r1_cSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X16r1_cSNV_missense_post_pre_med <- unname(X16r1_cSNV_missense_post_pre_quarts[3])
X16r1_cSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X16r1_cSNV_syn_post_pre_med <- unname(X16r1_cSNV_syn_post_pre_quarts[3])
X16r1_cSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X16r1_cSNV_nonsense_post_pre_med <- unname(X16r1_cSNV_nonsense_post_pre_quarts[3])
X16r1_cSNV_syn_to_non_post_pre_spread <- X16r1_cSNV_syn_post_pre_med - X16r1_cSNV_nonsense_post_pre_med

X16r2_cSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X16r2_cSNV_missense_post_pre_med <- unname(X16r2_cSNV_missense_post_pre_quarts[3])
X16r2_cSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X16r2_cSNV_syn_post_pre_med <- unname(X16r2_cSNV_syn_post_pre_quarts[3])
X16r2_cSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X16r2_cSNV_nonsense_post_pre_med <- unname(X16r2_cSNV_nonsense_post_pre_quarts[3])
X16r2_cSNV_syn_to_non_post_pre_spread <- X16r2_cSNV_syn_post_pre_med - X16r2_cSNV_nonsense_post_pre_med

X16r1r2a_cSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X16r1r2a_cSNV_missense_post_pre_med <- unname(X16r1r2a_cSNV_missense_post_pre_quarts[3])
X16r1r2a_cSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X16r1r2a_cSNV_syn_post_pre_med <- unname(X16r1r2a_cSNV_syn_post_pre_quarts[3])
X16r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X16r1r2a_cSNV_nonsense_post_pre_med <- unname(X16r1r2a_cSNV_nonsense_post_pre_quarts[3])
X16r1r2a_cSNV_syn_to_non_post_pre_spread <- X16r1r2a_cSNV_syn_post_pre_med - X16r1r2a_cSNV_nonsense_post_pre_med

X16r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_cSNV_missense_post_pre_med <- unname(X16r1r2pw_cSNV_missense_post_pre_quarts[3])
X16r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_cSNV_syn_post_pre_med <- unname(X16r1r2pw_cSNV_syn_post_pre_quarts[3])
X16r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_cSNV_nonsense_post_pre_med <- unname(X16r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X16r1r2pw_cSNV_syn_to_non_post_pre_spread <- X16r1r2pw_cSNV_syn_post_pre_med - X16r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X16r1_tSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X16r1_tSNV_missense_post_pre_med <- unname(X16r1_tSNV_missense_post_pre_quarts[3])
X16r1_tSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X16r1_tSNV_syn_post_pre_med <- unname(X16r1_tSNV_syn_post_pre_quarts[3])
X16r1_tSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X16r1_tSNV_nonsense_post_pre_med <- unname(X16r1_tSNV_nonsense_post_pre_quarts[3])
X16r1_tSNV_syn_to_non_post_pre_spread <- X16r1_tSNV_syn_post_pre_med - X16r1_tSNV_nonsense_post_pre_med

X16r2_tSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X16r2_tSNV_missense_post_pre_med <- unname(X16r2_tSNV_missense_post_pre_quarts[3])
X16r2_tSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X16r2_tSNV_syn_post_pre_med <- unname(X16r2_tSNV_syn_post_pre_quarts[3])
X16r2_tSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X16r2_tSNV_nonsense_post_pre_med <- unname(X16r2_tSNV_nonsense_post_pre_quarts[3])
X16r2_tSNV_syn_to_non_post_pre_spread <- X16r2_tSNV_syn_post_pre_med - X16r2_tSNV_nonsense_post_pre_med

X16r1r2a_tSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X16r1r2a_tSNV_missense_post_pre_med <- unname(X16r1r2a_tSNV_missense_post_pre_quarts[3])
X16r1r2a_tSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X16r1r2a_tSNV_syn_post_pre_med <- unname(X16r1r2a_tSNV_syn_post_pre_quarts[3])
X16r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X16r1r2a_tSNV_nonsense_post_pre_med <- unname(X16r1r2a_tSNV_nonsense_post_pre_quarts[3])
X16r1r2a_tSNV_syn_to_non_post_pre_spread <- X16r1r2a_tSNV_syn_post_pre_med - X16r1r2a_tSNV_nonsense_post_pre_med

X16r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_tSNV_missense_post_pre_med <- unname(X16r1r2pw_tSNV_missense_post_pre_quarts[3])
X16r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_tSNV_syn_post_pre_med <- unname(X16r1r2pw_tSNV_syn_post_pre_quarts[3])
X16r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X16r1r2pw_tSNV_nonsense_post_pre_med <- unname(X16r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X16r1r2pw_tSNV_syn_to_non_post_pre_spread <- X16r1r2pw_tSNV_syn_post_pre_med - X16r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X16r1_cSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X16r1_cSNV_missense_post_lib_med <- unname(X16r1_cSNV_missense_post_lib_quarts[3])
X16r1_cSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X16r1_cSNV_syn_post_lib_med <- unname(X16r1_cSNV_syn_post_lib_quarts[3])
X16r1_cSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X16r1_cSNV_nonsense_post_lib_med <- unname(X16r1_cSNV_nonsense_post_lib_quarts[3])
X16r1_cSNV_syn_to_non_post_lib_spread <- X16r1_cSNV_syn_post_lib_med - X16r1_cSNV_nonsense_post_lib_med

X16r2_cSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X16r2_cSNV_missense_post_lib_med <- unname(X16r2_cSNV_missense_post_lib_quarts[3])
X16r2_cSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X16r2_cSNV_syn_post_lib_med <- unname(X16r2_cSNV_syn_post_lib_quarts[3])
X16r2_cSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X16r2_cSNV_nonsense_post_lib_med <- unname(X16r2_cSNV_nonsense_post_lib_quarts[3])
X16r2_cSNV_syn_to_non_post_lib_spread <- X16r2_cSNV_syn_post_lib_med - X16r2_cSNV_nonsense_post_lib_med

X16r1r2a_cSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_missense_post_lib_med <- unname(X16r1r2a_cSNV_missense_post_lib_quarts[3])
X16r1r2a_cSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_syn_post_lib_med <- unname(X16r1r2a_cSNV_syn_post_lib_quarts[3])
X16r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_nonsense_post_lib_med <- unname(X16r1r2a_cSNV_nonsense_post_lib_quarts[3])
X16r1r2a_cSNV_syn_to_non_post_lib_spread <- X16r1r2a_cSNV_syn_post_lib_med - X16r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X16r1_tSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X16r1_tSNV_missense_post_lib_med <- unname(X16r1_tSNV_missense_post_lib_quarts[3])
X16r1_tSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X16r1_tSNV_syn_post_lib_med <- unname(X16r1_tSNV_syn_post_lib_quarts[3])
X16r1_tSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X16r1_tSNV_nonsense_post_lib_med <- unname(X16r1_tSNV_nonsense_post_lib_quarts[3])
X16r1_tSNV_syn_to_non_post_lib_spread <- X16r1_tSNV_syn_post_lib_med - X16r1_tSNV_nonsense_post_lib_med

X16r2_tSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X16r2_tSNV_missense_post_lib_med <- unname(X16r2_tSNV_missense_post_lib_quarts[3])
X16r2_tSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X16r2_tSNV_syn_post_lib_med <- unname(X16r2_tSNV_syn_post_lib_quarts[3])
X16r2_tSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X16r2_tSNV_nonsense_post_lib_med <- unname(X16r2_tSNV_nonsense_post_lib_quarts[3])
X16r2_tSNV_syn_to_non_post_lib_spread <- X16r2_tSNV_syn_post_lib_med - X16r2_tSNV_nonsense_post_lib_med

X16r1r2a_tSNV_missense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_missense_post_lib_med <- unname(X16r1r2a_tSNV_missense_post_lib_quarts[3])
X16r1r2a_tSNV_syn_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_syn_post_lib_med <- unname(X16r1r2a_tSNV_syn_post_lib_quarts[3])
X16r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_nonsense_post_lib_med <- unname(X16r1r2a_tSNV_nonsense_post_lib_quarts[3])
X16r1r2a_tSNV_syn_to_non_post_lib_spread <- X16r1r2a_tSNV_syn_post_lib_med - X16r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X16r1_cSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X16r1_cSNV_missense_pre_lib_med <- unname(X16r1_cSNV_missense_pre_lib_quarts[3])
X16r1_cSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X16r1_cSNV_syn_pre_lib_med <- unname(X16r1_cSNV_syn_pre_lib_quarts[3])
X16r1_cSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X16r1_cSNV_nonsense_pre_lib_med <- unname(X16r1_cSNV_nonsense_pre_lib_quarts[3])
X16r1_cSNV_syn_to_non_pre_lib_spread <- X16r1_cSNV_syn_pre_lib_med - X16r1_cSNV_nonsense_pre_lib_med

X16r2_cSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X16r2_cSNV_missense_pre_lib_med <- unname(X16r2_cSNV_missense_pre_lib_quarts[3])
X16r2_cSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X16r2_cSNV_syn_pre_lib_med <- unname(X16r2_cSNV_syn_pre_lib_quarts[3])
X16r2_cSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X16r2_cSNV_nonsense_pre_lib_med <- unname(X16r2_cSNV_nonsense_pre_lib_quarts[3])
X16r2_cSNV_syn_to_non_pre_lib_spread <- X16r2_cSNV_syn_pre_lib_med - X16r2_cSNV_nonsense_pre_lib_med

X16r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_missense_pre_lib_med <- unname(X16r1r2a_cSNV_missense_pre_lib_quarts[3])
X16r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_syn_pre_lib_med <- unname(X16r1r2a_cSNV_syn_pre_lib_quarts[3])
X16r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X16r1r2a_cSNV_nonsense_pre_lib_med <- unname(X16r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X16r1r2a_cSNV_syn_to_non_pre_lib_spread <- X16r1r2a_cSNV_syn_pre_lib_med - X16r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X16r1_tSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X16r1_tSNV_missense_pre_lib_med <- unname(X16r1_tSNV_missense_pre_lib_quarts[3])
X16r1_tSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X16r1_tSNV_syn_pre_lib_med <- unname(X16r1_tSNV_syn_pre_lib_quarts[3])
X16r1_tSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X16r1_tSNV_nonsense_pre_lib_med <- unname(X16r1_tSNV_nonsense_pre_lib_quarts[3])
X16r1_tSNV_syn_to_non_pre_lib_spread <- X16r1_tSNV_syn_pre_lib_med - X16r1_tSNV_nonsense_pre_lib_med

X16r2_tSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X16r2_tSNV_missense_pre_lib_med <- unname(X16r2_tSNV_missense_pre_lib_quarts[3])
X16r2_tSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X16r2_tSNV_syn_pre_lib_med <- unname(X16r2_tSNV_syn_pre_lib_quarts[3])
X16r2_tSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X16r2_tSNV_nonsense_pre_lib_med <- unname(X16r2_tSNV_nonsense_pre_lib_quarts[3])
X16r2_tSNV_syn_to_non_pre_lib_spread <- X16r2_tSNV_syn_pre_lib_med - X16r2_tSNV_nonsense_pre_lib_med

X16r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_missense_pre_lib_med <- unname(X16r1r2a_tSNV_missense_pre_lib_quarts[3])
X16r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_syn_pre_lib_med <- unname(X16r1r2a_tSNV_syn_pre_lib_quarts[3])
X16r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X16r1r2a_tSNV_nonsense_pre_lib_med <- unname(X16r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X16r1r2a_tSNV_syn_to_non_pre_lib_spread <- X16r1r2a_tSNV_syn_pre_lib_med - X16r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X16r1_tSNV_syn_rna_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X16r1_tSNV_syn_rna_pre_med <- unname(X16r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X16r1_tSNV_syn_rna_post_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X16r1_tSNV_syn_rna_post_med <- unname(X16r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X16r2_tSNV_syn_rna_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X16r2_tSNV_syn_rna_pre_med <- unname(X16r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X16r2_tSNV_syn_rna_post_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X16r2_tSNV_syn_rna_post_med <- unname(X16r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X16r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X16r1r2a_tSNV_syn_rna_pre_med <- unname(X16r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X16r1r2a_tSNV_syn_rna_post_quarts <- quantile(X16r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X16r1r2a_tSNV_syn_rna_post_med <- unname(X16r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X16r1_cSNV_syn_pre_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X16r1_cSNV_syn_post_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X16r1_cSNV_syn_post_lib_med
# tHDR
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X16r1_tSNV_syn_pre_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X16r1_tSNV_syn_post_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X16r1_tSNV_syn_post_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X16r1_tSNV_syn_rna_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X16r1_tSNV_syn_rna_post_med

#r2
X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X16r2_cSNV_syn_pre_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X16r2_cSNV_syn_post_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X16r2_cSNV_syn_post_lib_med
# tHDR
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X16r2_tSNV_syn_pre_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X16r2_tSNV_syn_post_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X16r2_tSNV_syn_post_lib_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X16r2_tSNV_syn_rna_pre_med
X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X16r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X16r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X16r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X16r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X16r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X16r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X16r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X16r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X16r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X16r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X16r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X16r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X16r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X16r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X16r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X16r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X16r1_prog_var_thresh5_df_r2_int_ord[which(X16r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X16r1_prog_var_thresh5_df_r2_int_ord
X16r1_prog_map_thresh5_df_r2_int_ord = which(X16r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X16r1_prog_map_thresh5_df_r2_int_ord_df = X16r1_prog_var_thresh5_df_r2_int_ord[X16r1_prog_map_thresh5_df_r2_int_ord,]
X16r1_prog_map_exon_thresh5_df_r2_int_ord = which(X16r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X16r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X16r1_prog_map_exon_thresh5_df_r2_int_ord_df = X16r1_prog_map_thresh5_df_r2_int_ord_df[X16r1_prog_map_exon_thresh5_df_r2_int_ord,]
X16r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X16r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X16r1_prog_map_thresh5_df_r2_int_ord_df[X16r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X16r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X16r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X16r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X16r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X16r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X16r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X16r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X16r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X16r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X16r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X16r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X16r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X16r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X16r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X16r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X16r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X16r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X16r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X16r1r2_cSNV_r1_post_by_r2_post_cor_s
X16r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X16r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X16r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X16r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X16r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X16r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X16r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X16r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X16r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X16r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X16r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X16r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X16r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X16r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X16r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X16r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X16r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X16r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1_cSNV_post_pre_by_cadd_cor_s
#X16r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X16r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r2_cSNV_post_pre_by_cadd_cor_s

#X16r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X16r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1_cSNV_post_lib_by_cadd_cor_s
#X16r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X16r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X16r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X16r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1_tSNV_post_pre_by_cadd_cor_s
#X16r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X16r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r2_tSNV_post_pre_by_cadd_cor_s

#X16r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X16r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1_tSNV_post_lib_by_cadd_cor_s
#X16r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X16r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X16r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X16r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X16r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X16r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X16r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X16r1_prog_var_all_lib_count
X16r1_prog_var_all_pre_count
X16r2_prog_var_all_pre_count
X16r1_prog_map_thresh5_lib_count
X16r1_prog_map_thresh5_pre_count
X16r2_prog_map_thresh5_pre_count
X16r1_prog_map_thresh5_post_count
X16r2_prog_map_thresh5_post_count
X16r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X16r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X16r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X16r1r2_cSNV_r1_post_by_r2_post_cor_s
X16r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X16r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X16r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X16r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X16r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X16r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X16r1_cSNV_post_pre_by_cadd_cor_s
X16r2_cSNV_post_pre_by_cadd_cor_s
X16r1_cSNV_post_lib_by_cadd_cor_s
X16r2_cSNV_post_lib_by_cadd_cor_s
X16r1_tSNV_post_pre_by_cadd_cor_s
X16r2_tSNV_post_pre_by_cadd_cor_s
X16r1_tSNV_post_lib_by_cadd_cor_s
X16r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X16r1r2a_cSNV_post_pre_by_cadd_cor_s
X16r1r2w_cSNV_post_pre_by_cadd_cor_s
X16r1r2a_cSNV_post_lib_by_cadd_cor_s
X16r1r2w_cSNV_post_lib_by_cadd_cor_s
X16r1r2a_tSNV_post_pre_by_cadd_cor_s
X16r1r2w_tSNV_post_pre_by_cadd_cor_s
X16r1r2a_tSNV_post_lib_by_cadd_cor_s
X16r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X16r1_cSNV_syn_to_non_post_pre_spread
X16r2_cSNV_syn_to_non_post_pre_spread
X16r1r2a_cSNV_syn_to_non_post_pre_spread
X16r1_cSNV_syn_to_non_post_lib_spread
X16r2_cSNV_syn_to_non_post_lib_spread
X16r1r2a_cSNV_syn_to_non_post_lib_spread
X16r1_tSNV_syn_to_non_post_pre_spread
X16r2_tSNV_syn_to_non_post_pre_spread
X16r1r2a_tSNV_syn_to_non_post_pre_spread
X16r1_tSNV_syn_to_non_post_lib_spread
X16r2_tSNV_syn_to_non_post_lib_spread
X16r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X16r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X16r1_prog_map_thresh5_df_r2_int_ord_df[which(X16r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X16r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df[which(X16r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df[which(X16r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df[which(X16r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X16r1_cSNV_pre_lib_cors = cor(log2(X16r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X16r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16r1_tSNV_pre_lib_cors = cor(log2(X16r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16r1_cSNV_post_lib_cors = cor(log2(X16r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X16r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X16r1_tSNV_post_lib_cors = cor(log2(X16r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X16r1_cSNV_post_pre_cors = cor(log2(X16r1_prog_map_thresh5_df$post_pseudo_freq),log2(X16r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16r1_tSNV_post_pre_cors = cor(log2(X16r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X16r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16r1_cSNV_rna_lib_cors = cor(log2(X16r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X16r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16r1_tSNV_rna_lib_cors = cor(log2(X16r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X16r1_cSNV_rna_pre_cors = cor(log2(X16r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X16r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16r1_tSNV_rna_pre_cors = cor(log2(X16r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X16r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16r1r2_cSNV_pre_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X16r1r2_tSNV_pre_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X16r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X16r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X16r1r2_cSNV_post_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X16r1r2_tSNV_post_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X16r1r2_cSNV_post_lib_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X16r1r2_tSNV_post_lib_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X16r1r2_cSNV_post_pre_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X16r1r2_tSNV_post_pre_ratio_cors = cor(log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X16r1r2_cSNV_rna_cors = cor(log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X16r1r2_tSNV_rna_cors = cor(log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X16r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X16r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X16r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X16r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X16r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X16r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X16r1_cors <- c("X16r1",X16r1_cSNV_pre_lib_cors,X16r1_tSNV_pre_lib_cors,X16r1_cSNV_post_lib_cors,X16r1_tSNV_post_lib_cors,X16r1_cSNV_post_pre_cors,X16r1_tSNV_post_pre_cors,X16r1_cSNV_rna_lib_cors,X16r1_tSNV_rna_lib_cors,X16r1_cSNV_rna_pre_cors,X16r1_tSNV_rna_pre_cors,X16r1r2_cSNV_pre_cors,X16r1r2_tSNV_pre_cors,X16r1r2_cSNV_pre_lib_ratio_cors,X16r1r2_tSNV_pre_lib_ratio_cors,X16r1r2_cSNV_post_cors,X16r1r2_tSNV_post_cors,X16r1r2_cSNV_post_lib_ratio_cors,X16r1r2_tSNV_post_lib_ratio_cors,X16r1r2_cSNV_post_pre_ratio_cors,X16r1r2_tSNV_post_pre_ratio_cors,X16r1r2_cSNV_rna_cors,X16r1r2_tSNV_rna_cors,X16r1r2_tSNV_rna_pre_ratio_cors,X16r1_cSNV_pre_lib_ratio_cadd_cors,X16r1_tSNV_pre_lib_ratio_cadd_cors,X16r1_cSNV_post_lib_ratio_cadd_cors,X16r1_tSNV_post_lib_ratio_cadd_cors,X16r1_cSNV_post_pre_ratio_cadd_cors,X16r1_tSNV_post_pre_ratio_cadd_cors,X16r1_cSNV_post_pre_ratio_cadd_missense_cors,X16r1_tSNV_post_pre_ratio_cadd_missense_cors,X16r1_cSNV_post_pre_ratio_polyphen_missense_cors,X16r1_tSNV_post_pre_ratio_polyphen_missense_cors,X16r1_cSNV_post_pre_ratio_grantham_missense_cors,X16r1_tSNV_post_pre_ratio_grantham_missense_cors,X16r1r2a_cSNV_pre_lib_ratio_cadd_cors,X16r1r2a_tSNV_pre_lib_ratio_cadd_cors,X16r1r2a_cSNV_post_lib_ratio_cadd_cors,X16r1r2a_tSNV_post_lib_ratio_cadd_cors,X16r1r2a_cSNV_post_pre_ratio_cadd_cors,X16r1r2a_tSNV_post_pre_ratio_cadd_cors,X16r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X16r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X16r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X16r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X16r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X16r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X16r1r2w_cSNV_pre_lib_ratio_cadd_cors,X16r1r2w_cSNV_post_lib_ratio_cadd_cors,X16r1r2w_cSNV_post_pre_ratio_cadd_cors,X16r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X16r2_cSNV_pre_lib_cors = cor(log2(X16r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X16r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16r2_tSNV_pre_lib_cors = cor(log2(X16r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16r2_cSNV_post_lib_cors = cor(log2(X16r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X16r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X16r2_tSNV_post_lib_cors = cor(log2(X16r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X16r2_cSNV_post_pre_cors = cor(log2(X16r2_prog_map_thresh5_df$post_pseudo_freq),log2(X16r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16r2_tSNV_post_pre_cors = cor(log2(X16r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X16r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16r2_cSNV_rna_lib_cors = cor(log2(X16r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X16r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16r2_tSNV_rna_lib_cors = cor(log2(X16r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X16r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X16r2_cSNV_rna_pre_cors = cor(log2(X16r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X16r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16r2_tSNV_rna_pre_cors = cor(log2(X16r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X16r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X16r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X16r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X16r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X16r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X16r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X16r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X16r2_cors <- c("X16r2",X16r2_cSNV_pre_lib_cors,X16r2_tSNV_pre_lib_cors,X16r2_cSNV_post_lib_cors,X16r2_tSNV_post_lib_cors,X16r2_cSNV_post_pre_cors,X16r2_tSNV_post_pre_cors,X16r2_cSNV_rna_lib_cors,X16r2_tSNV_rna_lib_cors,X16r2_cSNV_rna_pre_cors,X16r2_tSNV_rna_pre_cors,X16r1r2_cSNV_pre_cors,X16r1r2_tSNV_pre_cors,X16r1r2_cSNV_pre_lib_ratio_cors,X16r1r2_tSNV_pre_lib_ratio_cors,X16r1r2_cSNV_post_cors,X16r1r2_tSNV_post_cors,X16r1r2_cSNV_post_lib_ratio_cors,X16r1r2_tSNV_post_lib_ratio_cors,X16r1r2_cSNV_post_pre_ratio_cors,X16r1r2_tSNV_post_pre_ratio_cors,X16r1r2_cSNV_rna_cors,X16r1r2_tSNV_rna_cors,X16r1r2_tSNV_rna_pre_ratio_cors,X16r2_cSNV_pre_lib_ratio_cadd_cors,X16r2_tSNV_pre_lib_ratio_cadd_cors,X16r2_cSNV_post_lib_ratio_cadd_cors,X16r2_tSNV_post_lib_ratio_cadd_cors,X16r2_cSNV_post_pre_ratio_cadd_cors,X16r2_tSNV_post_pre_ratio_cadd_cors,X16r2_cSNV_post_pre_ratio_cadd_missense_cors,X16r2_tSNV_post_pre_ratio_cadd_missense_cors,X16r2_cSNV_post_pre_ratio_polyphen_missense_cors,X16r2_tSNV_post_pre_ratio_polyphen_missense_cors,X16r2_cSNV_post_pre_ratio_grantham_missense_cors,X16r2_tSNV_post_pre_ratio_grantham_missense_cors,X16r1r2a_cSNV_pre_lib_ratio_cadd_cors,X16r1r2a_tSNV_pre_lib_ratio_cadd_cors,X16r1r2a_cSNV_post_lib_ratio_cadd_cors,X16r1r2a_tSNV_post_lib_ratio_cadd_cors,X16r1r2a_cSNV_post_pre_ratio_cadd_cors,X16r1r2a_tSNV_post_pre_ratio_cadd_cors,X16r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X16r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X16r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X16r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X16r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X16r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X16r1r2w_cSNV_pre_lib_ratio_cadd_cors,X16r1r2w_cSNV_post_lib_ratio_cadd_cors,X16r1r2w_cSNV_post_pre_ratio_cadd_cors,X16r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X16r1)
rm(X16r2)
gc()
X17r1_file <- paste(experiment_dir_171011,'X17r1','_annotated.txt',sep='')
X17r2_file <- paste(experiment_dir_171011,'X17r2','_annotated.txt',sep='')
X17r1 <- read.table(X17r1_file, header=TRUE, sep="\t")
X17r2 <- read.table(X17r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X17 <- editing_info[which(editing_info$amplicon == 'X17'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X17_HDR_5_SNV = as.character(editing_info_X17$HDR_5_SNV)
X17_HDR_3_SNV = as.character(editing_info_X17$HDR_3_SNV)
#X17_cut_pos = as.character(editing_info_X17$cut_pos)
X17_cut_end = as.character(editing_info_X17$cut_end)
X17_mut_start = as.character(editing_info_X17$mut_start)
X17_mut_end = as.character(editing_info_X17$mut_end)
### Replicate 1
X17r1_cSNV_all <- which(X17r1[,'c_hdr_snv']=='True')
X17r1_cSNV_all_df = X17r1[X17r1_cSNV_all,]
X17r1_prog_var_all <- which(X17r1[,'all_hdr_variant']=='True' & X17r1[,'edit_string']!='-WT')
X17r1_prog_var_all_df = X17r1[X17r1_prog_var_all,]
X17r1_prog_map_all = which(X17r1_prog_var_all_df[,'pos']!='REF')
X17r1_prog_map_all_df = X17r1_prog_var_all_df[X17r1_prog_map_all,]
X17r1_prog_map_exon_all = which(X17r1_prog_map_all_df[,'cDNApos']!='REF' & X17r1_prog_map_all_df[,'cDNApos']!='NA')
X17r1_prog_map_exon_all_df = X17r1_prog_map_all_df[X17r1_prog_map_exon_all,]
X17r1_prog_map_CADD = which(X17r1_prog_map_all_df[,'CADD.phred']!='NA')
X17r1_prog_map_CADD_df = X17r1_prog_map_all_df[X17r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X17r1_prog_var_thresh5 <- which(as.numeric(as.character(X17r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X17r1_prog_var_thresh5_df = X17r1_prog_var_all_df[X17r1_prog_var_thresh5,]
X17r1_prog_map_thresh5 <- which(as.numeric(as.character(X17r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X17r1_prog_map_thresh5_df = X17r1_prog_map_all_df[X17r1_prog_map_thresh5,]
X17r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X17r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X17r1_prog_map_exon_thresh5_df = X17r1_prog_map_exon_all_df[X17r1_prog_map_exon_thresh5,]
X17r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X17r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X17r1_prog_map_CADD_thresh5_df = X17r1_prog_map_CADD_df[X17r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X17r1_prog_var_all_lib_count = length(X17r1_prog_var_all_df$lib)
X17r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X17r1_prog_var_all_min_lib_counts = min(X17r1_prog_var_all_df$lib)
X17r1_prog_var_all_min_lib_counts
X17r1_prog_var_all_max_lib_counts = max(X17r1_prog_var_all_df$lib)
X17r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X17r1_prog_map_all_lib_count = length(X17r1_prog_map_all_df$lib)
X17r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X17r1_prog_map_all_min_lib_counts = min(X17r1_prog_map_all_df$lib)
X17r1_prog_map_all_min_lib_counts
X17r1_prog_map_all_max_lib_counts = max(X17r1_prog_map_all_df$lib)
X17r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X17r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X17r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X17r1_prog_var_all_pre_count = length(X17r1_prog_var_all_df$pre)
X17r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X17r1_prog_var_all_min_pre_counts = min(X17r1_prog_var_all_df$pre)
X17r1_prog_var_all_min_pre_counts
X17r1_prog_var_all_max_pre_counts = max(X17r1_prog_var_all_df$pre)
X17r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X17r1_prog_map_all_pre_count = length(X17r1_prog_map_all_df$pre)
X17r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X17r1_prog_map_all_min_pre_counts = min(X17r1_prog_map_all_df$pre)
X17r1_prog_map_all_min_pre_counts
X17r1_prog_map_all_max_pre_counts = max(X17r1_prog_map_all_df$pre)
X17r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X17r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X17r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X17r1_prog_map_all_post_count = length(X17r1_prog_map_all_df$post)
X17r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X17r1_prog_map_all_min_post_counts = min(X17r1_prog_map_all_df$post)
X17r1_prog_map_all_min_post_counts
X17r1_prog_map_all_max_post_counts = max(X17r1_prog_map_all_df$post)
X17r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X17r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X17r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X17r1_prog_map_all_syn_df <- X17r1_prog_map_all_df[which(X17r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X17r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X17r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X17r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X17r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X17r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X17r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X17r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X17r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X17r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X17r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X17r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X17r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X17r1_prog_map_all_min_rna_counts = min(X17r1_prog_map_exon_all_df$tHDR_rna)
X17r1_prog_map_all_min_rna_counts
X17r1_prog_map_all_max_rna_counts = max(X17r1_prog_map_exon_all_df$tHDR_rna)
X17r1_prog_map_all_max_rna_counts
X17r1_prog_map_all_min_rna_pseudo_freq = min(X17r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17r1_prog_map_all_min_rna_pseudo_freq
X17r1_prog_map_all_max_rna_pseudo_freq = max(X17r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17r1_prog_map_all_max_rna_pseudo_freq
X17r1_prog_map_all_min_rna_pre_ratio = min(X17r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17r1_prog_map_all_min_rna_pre_ratio
X17r1_prog_map_all_max_rna_pre_ratio = max(X17r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17r1_prog_map_all_max_rna_pre_ratio
X17r1_prog_map_all_min_rna_post_ratio = min(X17r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17r1_prog_map_all_min_rna_post_ratio
X17r1_prog_map_all_max_rna_post_ratio = max(X17r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X17r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X17r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X17r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X17r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X17r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X17r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X17r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X17r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X17r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X17r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X17r1_prog_map_all_df$post_pre_ratio),log2(X17r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X17r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X17r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X17r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X17r1_cSNV_all_corr_pre_count = length(X17r1_cSNV_all_df$corr_pre)
X17r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X17r1_cSNV_all_min_corr_pre_counts = min(X17r1_cSNV_all_df$corr_pre)
X17r1_cSNV_all_min_corr_pre_counts
X17r1_cSNV_all_max_corr_pre_counts = max(X17r1_cSNV_all_df$corr_pre)
X17r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X17r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X17r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X17r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X17r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X17r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_cSNV_all_corr_post_count = length(X17r1_cSNV_all_df$corr_post)
X17r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X17r1_cSNV_all_min_corr_post_counts = min(X17r1_cSNV_all_df$corr_post)
X17r1_cSNV_all_min_corr_post_counts
X17r1_cSNV_all_max_corr_post_counts = max(X17r1_cSNV_all_df$corr_post)
X17r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X17r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X17r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X17r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X17r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X17r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X17r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X17_p_hdr_snv = paste('p_hdr_',X17_cut_end,'_snv',sep='')
X17r1_pSNV_all <- which(X17r1[,X17_p_hdr_snv]=='True')
X17r1_pSNV_all_df = X17r1[X17r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_pSNV_all_lib_count = length(X17r1_pSNV_all_df$lib)
X17r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X17r1_pSNV_all_min_lib_counts = min(X17r1_pSNV_all_df$lib)
X17r1_pSNV_all_min_lib_counts
X17r1_pSNV_all_max_lib_counts = max(X17r1_pSNV_all_df$lib)
X17r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X17r1_pSNV_all_pre_count = length(X17r1_pSNV_all_df$pre)
X17r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X17r1_pSNV_all_min_pre_counts = min(X17r1_pSNV_all_df$pre)
X17r1_pSNV_all_min_pre_counts
X17r1_pSNV_all_max_pre_counts = max(X17r1_pSNV_all_df$pre)
X17r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X17r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X17r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_pSNV_all_post_count = length(X17r1_pSNV_all_df$post)
X17r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X17r1_pSNV_all_min_post_counts = min(X17r1_pSNV_all_df$post)
X17r1_pSNV_all_min_post_counts
X17r1_pSNV_all_max_post_counts = max(X17r1_pSNV_all_df$post)
X17r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X17r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X17r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_prog_map_thresh5_lib_count = length(X17r1_prog_map_thresh5_df$lib)
X17r1_prog_map_thresh5_lib_count
X17r1_prog_map_thresh5_min_lib_counts = min(X17r1_prog_map_thresh5_df$lib)
X17r1_prog_map_thresh5_min_lib_counts
X17r1_prog_map_thresh5_max_lib_counts = max(X17r1_prog_map_thresh5_df$lib)
X17r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X17r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X17r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_prog_map_thresh5_pre_count = length(X17r1_prog_map_thresh5_df$pre)
X17r1_prog_map_thresh5_pre_count
X17r1_prog_map_thresh5_min_pre_counts = min(X17r1_prog_map_thresh5_df$pre)
X17r1_prog_map_thresh5_min_pre_counts
X17r1_prog_map_thresh5_max_pre_counts = max(X17r1_prog_map_thresh5_df$pre)
X17r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r1_prog_map_thresh5_post_count = length(X17r1_prog_map_thresh5_df$post)
X17r1_prog_map_thresh5_post_count
X17r1_prog_map_thresh5_min_post_counts = min(X17r1_prog_map_thresh5_df$post)
X17r1_prog_map_thresh5_min_post_counts
X17r1_prog_map_thresh5_max_post_counts = max(X17r1_prog_map_thresh5_df$post)
X17r1_prog_map_thresh5_max_post_counts
X17r1_prog_map_thresh5_corr_post_count = length(X17r1_cSNV_all_df$corr_post)
X17r1_prog_map_thresh5_corr_post_count
X17r1_prog_map_thresh5_min_corr_post_counts = min(X17r1_cSNV_all_df$corr_post)
X17r1_prog_map_thresh5_min_corr_post_counts
X17r1_prog_map_thresh5_max_corr_post_counts = max(X17r1_cSNV_all_df$corr_post)
X17r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X17r1_pSNV_thresh5 <- which(X17r1[,X17_p_hdr_snv]=='True' & as.numeric(as.character(X17r1[,'pre_freq']))>=0.00001)
X17r1_pSNV_thresh5_df = X17r1[X17r1_pSNV_thresh5,]
X17r1_pSNV_thresh5_lib_count = length(X17r1_pSNV_thresh5_df$lib)
X17r1_pSNV_thresh5_lib_count
X17r1_pSNV_thresh5_min_lib_counts = min(X17r1_pSNV_thresh5_df$lib)
X17r1_pSNV_thresh5_min_lib_counts
X17r1_pSNV_thresh5_max_lib_counts = max(X17r1_pSNV_thresh5_df$lib)
X17r1_pSNV_thresh5_max_lib_counts
X17r1_pSNV_thresh5_pre_count = length(X17r1_pSNV_thresh5_df$pre)
X17r1_pSNV_thresh5_pre_count
X17r1_pSNV_thresh5_min_pre_counts = min(X17r1_pSNV_thresh5_df$pre)
X17r1_pSNV_thresh5_min_pre_counts
X17r1_pSNV_thresh5_max_pre_counts = max(X17r1_pSNV_thresh5_df$pre)
X17r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X17r1_pSNV_thresh5_post_count = length(X17r1_pSNV_thresh5_df$post)
X17r1_pSNV_thresh5_post_count
X17r1_pSNV_thresh5_min_post_counts = min(X17r1_pSNV_thresh5_df$post)
X17r1_pSNV_thresh5_min_post_counts
X17r1_pSNV_thresh5_max_post_counts = max(X17r1_pSNV_thresh5_df$post)
X17r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X17r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X17r1_pSNV_thresh5_post_pos

### Replicate 2
X17r2_cSNV_all <- which(X17r2[,'c_hdr_snv']=='True')
X17r2_cSNV_all_df = X17r2[X17r2_cSNV_all,]
X17r2_prog_var_all <- which(X17r2[,'all_hdr_variant']=='True' & X17r2[,'edit_string']!='-WT')
X17r2_prog_var_all_df = X17r2[X17r2_prog_var_all,]
X17r2_prog_map_all = which(X17r2_prog_var_all_df[,'pos']!='REF')
X17r2_prog_map_all_df = X17r2_prog_var_all_df[X17r2_prog_map_all,]
X17r2_prog_map_exon_all = which(X17r2_prog_map_all_df[,'cDNApos']!='REF' & X17r2_prog_map_all_df[,'cDNApos']!='NA')
X17r2_prog_map_exon_all_df = X17r2_prog_map_all_df[X17r2_prog_map_exon_all,]
X17r2_prog_map_CADD = which(X17r2_prog_map_all_df[,'CADD.phred']!='NA')
X17r2_prog_map_CADD_df = X17r2_prog_map_all_df[X17r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X17r2_prog_var_thresh5 <- which(as.numeric(as.character(X17r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X17r2_prog_var_thresh5_df = X17r2_prog_var_all_df[X17r2_prog_var_thresh5,]
X17r2_prog_map_thresh5 <- which(as.numeric(as.character(X17r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X17r2_prog_map_thresh5_df = X17r2_prog_map_all_df[X17r2_prog_map_thresh5,]
X17r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X17r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X17r2_prog_map_exon_thresh5_df = X17r2_prog_map_exon_all_df[X17r2_prog_map_exon_thresh5,]
X17r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X17r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X17r2_prog_map_CADD_thresh5_df = X17r2_prog_map_CADD_df[X17r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X17r2_prog_var_all_lib_count = length(X17r2_prog_var_all_df$lib)
X17r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X17r2_prog_var_all_min_lib_counts = min(X17r2_prog_var_all_df$lib)
X17r2_prog_var_all_min_lib_counts
X17r2_prog_var_all_max_lib_counts = max(X17r2_prog_var_all_df$lib)
X17r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X17r2_prog_map_all_lib_count = length(X17r2_prog_map_all_df$lib)
X17r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X17r2_prog_map_all_min_lib_counts = min(X17r2_prog_map_all_df$lib)
X17r2_prog_map_all_min_lib_counts
X17r2_prog_map_all_max_lib_counts = max(X17r2_prog_map_all_df$lib)
X17r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X17r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X17r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X17r2_prog_var_all_pre_count = length(X17r2_prog_var_all_df$pre)
X17r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X17r2_prog_var_all_min_pre_counts = min(X17r2_prog_var_all_df$pre)
X17r2_prog_var_all_min_pre_counts
X17r2_prog_var_all_max_pre_counts = max(X17r2_prog_var_all_df$pre)
X17r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X17r2_prog_map_all_pre_count = length(X17r2_prog_map_all_df$pre)
X17r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X17r2_prog_map_all_min_pre_counts = min(X17r2_prog_map_all_df$pre)
X17r2_prog_map_all_min_pre_counts
X17r2_prog_map_all_max_pre_counts = max(X17r2_prog_map_all_df$pre)
X17r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X17r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X17r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X17r2_prog_map_all_post_count = length(X17r2_prog_map_all_df$post)
X17r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X17r2_prog_map_all_min_post_counts = min(X17r2_prog_map_all_df$post)
X17r2_prog_map_all_min_post_counts
X17r2_prog_map_all_max_post_counts = max(X17r2_prog_map_all_df$post)
X17r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X17r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X17r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X17r2_prog_map_all_syn_df <- X17r2_prog_map_all_df[which(X17r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X17r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X17r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X17r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X17r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X17r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X17r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X17r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X17r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X17r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X17r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X17r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X17r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X17r2_prog_map_all_min_rna_counts = min(X17r2_prog_map_exon_all_df$tHDR_rna)
X17r2_prog_map_all_min_rna_counts
X17r2_prog_map_all_max_rna_counts = max(X17r2_prog_map_exon_all_df$tHDR_rna)
X17r2_prog_map_all_max_rna_counts
X17r2_prog_map_all_min_rna_pseudo_freq = min(X17r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17r2_prog_map_all_min_rna_pseudo_freq
X17r2_prog_map_all_max_rna_pseudo_freq = max(X17r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17r2_prog_map_all_max_rna_pseudo_freq
X17r2_prog_map_all_min_rna_pre_ratio = min(X17r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17r2_prog_map_all_min_rna_pre_ratio
X17r2_prog_map_all_max_rna_pre_ratio = max(X17r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17r2_prog_map_all_max_rna_pre_ratio
X17r2_prog_map_all_min_rna_post_ratio = min(X17r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17r2_prog_map_all_min_rna_post_ratio
X17r2_prog_map_all_max_rna_post_ratio = max(X17r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X17r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X17r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X17r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X17r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X17r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X17r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X17r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X17r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X17r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X17r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X17r2_prog_map_all_df$post_pre_ratio),log2(X17r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X17r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X17r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X17r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X17r2_cSNV_all_corr_pre_count = length(X17r2_cSNV_all_df$corr_pre)
X17r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X17r2_cSNV_all_min_corr_pre_counts = min(X17r2_cSNV_all_df$corr_pre)
X17r2_cSNV_all_min_corr_pre_counts
X17r2_cSNV_all_max_corr_pre_counts = max(X17r2_cSNV_all_df$corr_pre)
X17r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X17r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X17r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X17r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X17r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X17r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_cSNV_all_corr_post_count = length(X17r2_cSNV_all_df$corr_post)
X17r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X17r2_cSNV_all_min_corr_post_counts = min(X17r2_cSNV_all_df$corr_post)
X17r2_cSNV_all_min_corr_post_counts
X17r2_cSNV_all_max_corr_post_counts = max(X17r2_cSNV_all_df$corr_post)
X17r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X17r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X17r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X17r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X17r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X17r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X17r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X17_p_hdr_snv = paste('p_hdr_',X17_cut_end,'_snv',sep='')
X17r2_pSNV_all <- which(X17r2[,X17_p_hdr_snv]=='True')
X17r2_pSNV_all_df = X17r2[X17r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_pSNV_all_lib_count = length(X17r2_pSNV_all_df$lib)
X17r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X17r2_pSNV_all_min_lib_counts = min(X17r2_pSNV_all_df$lib)
X17r2_pSNV_all_min_lib_counts
X17r2_pSNV_all_max_lib_counts = max(X17r2_pSNV_all_df$lib)
X17r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X17r2_pSNV_all_pre_count = length(X17r2_pSNV_all_df$pre)
X17r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X17r2_pSNV_all_min_pre_counts = min(X17r2_pSNV_all_df$pre)
X17r2_pSNV_all_min_pre_counts
X17r2_pSNV_all_max_pre_counts = max(X17r2_pSNV_all_df$pre)
X17r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X17r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X17r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_pSNV_all_post_count = length(X17r2_pSNV_all_df$post)
X17r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X17r2_pSNV_all_min_post_counts = min(X17r2_pSNV_all_df$post)
X17r2_pSNV_all_min_post_counts
X17r2_pSNV_all_max_post_counts = max(X17r2_pSNV_all_df$post)
X17r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X17r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X17r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_prog_map_thresh5_lib_count = length(X17r2_prog_map_thresh5_df$lib)
X17r2_prog_map_thresh5_lib_count
X17r2_prog_map_thresh5_min_lib_counts = min(X17r2_prog_map_thresh5_df$lib)
X17r2_prog_map_thresh5_min_lib_counts
X17r2_prog_map_thresh5_max_lib_counts = max(X17r2_prog_map_thresh5_df$lib)
X17r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X17r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X17r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_prog_map_thresh5_pre_count = length(X17r2_prog_map_thresh5_df$pre)
X17r2_prog_map_thresh5_pre_count
X17r2_prog_map_thresh5_min_pre_counts = min(X17r2_prog_map_thresh5_df$pre)
X17r2_prog_map_thresh5_min_pre_counts
X17r2_prog_map_thresh5_max_pre_counts = max(X17r2_prog_map_thresh5_df$pre)
X17r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17r2_prog_map_thresh5_post_count = length(X17r2_prog_map_thresh5_df$post)
X17r2_prog_map_thresh5_post_count
X17r2_prog_map_thresh5_min_post_counts = min(X17r2_prog_map_thresh5_df$post)
X17r2_prog_map_thresh5_min_post_counts
X17r2_prog_map_thresh5_max_post_counts = max(X17r2_prog_map_thresh5_df$post)
X17r2_prog_map_thresh5_max_post_counts
X17r2_prog_map_thresh5_corr_post_count = length(X17r2_prog_map_thresh5_df$corr_post)
X17r2_prog_map_thresh5_corr_post_count
X17r2_prog_map_thresh5_min_corr_post_counts = min(X17r2_prog_map_thresh5_df$corr_post)
X17r2_prog_map_thresh5_min_corr_post_counts
X17r2_prog_map_thresh5_max_corr_post_counts = max(X17r2_prog_map_thresh5_df$corr_post)
X17r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X17r2_pSNV_thresh5 <- which(X17r2[,X17_p_hdr_snv]=='True' & as.numeric(as.character(X17r2[,'pre_freq']))>=0.00001)
X17r2_pSNV_thresh5_df = X17r2[X17r2_pSNV_thresh5,]
X17r2_pSNV_thresh5_lib_count = length(X17r2_pSNV_thresh5_df$lib)
X17r2_pSNV_thresh5_lib_count
X17r2_pSNV_thresh5_min_lib_counts = min(X17r2_pSNV_thresh5_df$lib)
X17r2_pSNV_thresh5_min_lib_counts
X17r2_pSNV_thresh5_max_lib_counts = max(X17r2_pSNV_thresh5_df$lib)
X17r2_pSNV_thresh5_max_lib_counts
X17r2_pSNV_thresh5_pre_count = length(X17r2_pSNV_thresh5_df$pre)
X17r2_pSNV_thresh5_pre_count
X17r2_pSNV_thresh5_min_pre_counts = min(X17r2_pSNV_thresh5_df$pre)
X17r2_pSNV_thresh5_min_pre_counts
X17r2_pSNV_thresh5_max_pre_counts = max(X17r2_pSNV_thresh5_df$pre)
X17r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X17r2_pSNV_thresh5_post_count = length(X17r2_pSNV_thresh5_df$post)
X17r2_pSNV_thresh5_post_count
X17r2_pSNV_thresh5_min_post_counts = min(X17r2_pSNV_thresh5_df$post)
X17r2_pSNV_thresh5_min_post_counts
X17r2_pSNV_thresh5_max_post_counts = max(X17r2_pSNV_thresh5_df$post)
X17r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X17r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X17r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X17r1_prog_var_thresh5_df:
X17r1_prog_var_thresh5_df_r2_int <- X17r1_prog_var_thresh5_df[which(X17r1_prog_var_thresh5_df$variant %in% X17r2_prog_var_thresh5_df$variant),]
#Intersection variants of X17r2_prog_var_thresh5_df:
X17r2_prog_var_thresh5_df_r1_int <- X17r2_prog_var_thresh5_df[which(X17r2_prog_var_thresh5_df$variant %in% X17r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X17r1_prog_var_thresh5_df_r2_int_ord <- X17r1_prog_var_thresh5_df_r2_int[order(X17r1_prog_var_thresh5_df_r2_int$variant),]
X17r2_prog_var_thresh5_df_r1_int_ord <- X17r2_prog_var_thresh5_df_r1_int[order(X17r2_prog_var_thresh5_df_r1_int$variant),]

dim(X17r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X17r1r2int_prog_var_thresh5_pre_count <- dim(X17r1_prog_var_thresh5_df_r2_int)[1] 
X17r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X17r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X17r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X17r2_prog_var_thresh5_df_r1_int_ord$pre
X17r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X17r2_prog_var_thresh5_df_r1_int_ord$lib
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X17r2_prog_var_thresh5_df_r1_int_ord$post
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X17r2_prog_var_thresh5_df_r1_int_ord$rna
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X17r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X17r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X17r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$post_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X17r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X17r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X17r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X17r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X17r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X17r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X17r2_prog_var_thresh5_df_r1_int_ord$corr_post
X17r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X17r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X17r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X17r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X17r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X17r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X17r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X17r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X17r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X17r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X17r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X17r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X17r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X17r1_cSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X17r1_cSNV_missense_post_pre_med <- unname(X17r1_cSNV_missense_post_pre_quarts[3])
X17r1_cSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X17r1_cSNV_syn_post_pre_med <- unname(X17r1_cSNV_syn_post_pre_quarts[3])
X17r1_cSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X17r1_cSNV_nonsense_post_pre_med <- unname(X17r1_cSNV_nonsense_post_pre_quarts[3])
X17r1_cSNV_syn_to_non_post_pre_spread <- X17r1_cSNV_syn_post_pre_med - X17r1_cSNV_nonsense_post_pre_med

X17r2_cSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X17r2_cSNV_missense_post_pre_med <- unname(X17r2_cSNV_missense_post_pre_quarts[3])
X17r2_cSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X17r2_cSNV_syn_post_pre_med <- unname(X17r2_cSNV_syn_post_pre_quarts[3])
X17r2_cSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X17r2_cSNV_nonsense_post_pre_med <- unname(X17r2_cSNV_nonsense_post_pre_quarts[3])
X17r2_cSNV_syn_to_non_post_pre_spread <- X17r2_cSNV_syn_post_pre_med - X17r2_cSNV_nonsense_post_pre_med

X17r1r2a_cSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X17r1r2a_cSNV_missense_post_pre_med <- unname(X17r1r2a_cSNV_missense_post_pre_quarts[3])
X17r1r2a_cSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X17r1r2a_cSNV_syn_post_pre_med <- unname(X17r1r2a_cSNV_syn_post_pre_quarts[3])
X17r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X17r1r2a_cSNV_nonsense_post_pre_med <- unname(X17r1r2a_cSNV_nonsense_post_pre_quarts[3])
X17r1r2a_cSNV_syn_to_non_post_pre_spread <- X17r1r2a_cSNV_syn_post_pre_med - X17r1r2a_cSNV_nonsense_post_pre_med

X17r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_cSNV_missense_post_pre_med <- unname(X17r1r2pw_cSNV_missense_post_pre_quarts[3])
X17r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_cSNV_syn_post_pre_med <- unname(X17r1r2pw_cSNV_syn_post_pre_quarts[3])
X17r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_cSNV_nonsense_post_pre_med <- unname(X17r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X17r1r2pw_cSNV_syn_to_non_post_pre_spread <- X17r1r2pw_cSNV_syn_post_pre_med - X17r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X17r1_tSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X17r1_tSNV_missense_post_pre_med <- unname(X17r1_tSNV_missense_post_pre_quarts[3])
X17r1_tSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X17r1_tSNV_syn_post_pre_med <- unname(X17r1_tSNV_syn_post_pre_quarts[3])
X17r1_tSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X17r1_tSNV_nonsense_post_pre_med <- unname(X17r1_tSNV_nonsense_post_pre_quarts[3])
X17r1_tSNV_syn_to_non_post_pre_spread <- X17r1_tSNV_syn_post_pre_med - X17r1_tSNV_nonsense_post_pre_med

X17r2_tSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X17r2_tSNV_missense_post_pre_med <- unname(X17r2_tSNV_missense_post_pre_quarts[3])
X17r2_tSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X17r2_tSNV_syn_post_pre_med <- unname(X17r2_tSNV_syn_post_pre_quarts[3])
X17r2_tSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X17r2_tSNV_nonsense_post_pre_med <- unname(X17r2_tSNV_nonsense_post_pre_quarts[3])
X17r2_tSNV_syn_to_non_post_pre_spread <- X17r2_tSNV_syn_post_pre_med - X17r2_tSNV_nonsense_post_pre_med

X17r1r2a_tSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X17r1r2a_tSNV_missense_post_pre_med <- unname(X17r1r2a_tSNV_missense_post_pre_quarts[3])
X17r1r2a_tSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X17r1r2a_tSNV_syn_post_pre_med <- unname(X17r1r2a_tSNV_syn_post_pre_quarts[3])
X17r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X17r1r2a_tSNV_nonsense_post_pre_med <- unname(X17r1r2a_tSNV_nonsense_post_pre_quarts[3])
X17r1r2a_tSNV_syn_to_non_post_pre_spread <- X17r1r2a_tSNV_syn_post_pre_med - X17r1r2a_tSNV_nonsense_post_pre_med

X17r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_tSNV_missense_post_pre_med <- unname(X17r1r2pw_tSNV_missense_post_pre_quarts[3])
X17r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_tSNV_syn_post_pre_med <- unname(X17r1r2pw_tSNV_syn_post_pre_quarts[3])
X17r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X17r1r2pw_tSNV_nonsense_post_pre_med <- unname(X17r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X17r1r2pw_tSNV_syn_to_non_post_pre_spread <- X17r1r2pw_tSNV_syn_post_pre_med - X17r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X17r1_cSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X17r1_cSNV_missense_post_lib_med <- unname(X17r1_cSNV_missense_post_lib_quarts[3])
X17r1_cSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X17r1_cSNV_syn_post_lib_med <- unname(X17r1_cSNV_syn_post_lib_quarts[3])
X17r1_cSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X17r1_cSNV_nonsense_post_lib_med <- unname(X17r1_cSNV_nonsense_post_lib_quarts[3])
X17r1_cSNV_syn_to_non_post_lib_spread <- X17r1_cSNV_syn_post_lib_med - X17r1_cSNV_nonsense_post_lib_med

X17r2_cSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X17r2_cSNV_missense_post_lib_med <- unname(X17r2_cSNV_missense_post_lib_quarts[3])
X17r2_cSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X17r2_cSNV_syn_post_lib_med <- unname(X17r2_cSNV_syn_post_lib_quarts[3])
X17r2_cSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X17r2_cSNV_nonsense_post_lib_med <- unname(X17r2_cSNV_nonsense_post_lib_quarts[3])
X17r2_cSNV_syn_to_non_post_lib_spread <- X17r2_cSNV_syn_post_lib_med - X17r2_cSNV_nonsense_post_lib_med

X17r1r2a_cSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_missense_post_lib_med <- unname(X17r1r2a_cSNV_missense_post_lib_quarts[3])
X17r1r2a_cSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_syn_post_lib_med <- unname(X17r1r2a_cSNV_syn_post_lib_quarts[3])
X17r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_nonsense_post_lib_med <- unname(X17r1r2a_cSNV_nonsense_post_lib_quarts[3])
X17r1r2a_cSNV_syn_to_non_post_lib_spread <- X17r1r2a_cSNV_syn_post_lib_med - X17r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X17r1_tSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X17r1_tSNV_missense_post_lib_med <- unname(X17r1_tSNV_missense_post_lib_quarts[3])
X17r1_tSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X17r1_tSNV_syn_post_lib_med <- unname(X17r1_tSNV_syn_post_lib_quarts[3])
X17r1_tSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X17r1_tSNV_nonsense_post_lib_med <- unname(X17r1_tSNV_nonsense_post_lib_quarts[3])
X17r1_tSNV_syn_to_non_post_lib_spread <- X17r1_tSNV_syn_post_lib_med - X17r1_tSNV_nonsense_post_lib_med

X17r2_tSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X17r2_tSNV_missense_post_lib_med <- unname(X17r2_tSNV_missense_post_lib_quarts[3])
X17r2_tSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X17r2_tSNV_syn_post_lib_med <- unname(X17r2_tSNV_syn_post_lib_quarts[3])
X17r2_tSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X17r2_tSNV_nonsense_post_lib_med <- unname(X17r2_tSNV_nonsense_post_lib_quarts[3])
X17r2_tSNV_syn_to_non_post_lib_spread <- X17r2_tSNV_syn_post_lib_med - X17r2_tSNV_nonsense_post_lib_med

X17r1r2a_tSNV_missense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_missense_post_lib_med <- unname(X17r1r2a_tSNV_missense_post_lib_quarts[3])
X17r1r2a_tSNV_syn_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_syn_post_lib_med <- unname(X17r1r2a_tSNV_syn_post_lib_quarts[3])
X17r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_nonsense_post_lib_med <- unname(X17r1r2a_tSNV_nonsense_post_lib_quarts[3])
X17r1r2a_tSNV_syn_to_non_post_lib_spread <- X17r1r2a_tSNV_syn_post_lib_med - X17r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X17r1_cSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X17r1_cSNV_missense_pre_lib_med <- unname(X17r1_cSNV_missense_pre_lib_quarts[3])
X17r1_cSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X17r1_cSNV_syn_pre_lib_med <- unname(X17r1_cSNV_syn_pre_lib_quarts[3])
X17r1_cSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X17r1_cSNV_nonsense_pre_lib_med <- unname(X17r1_cSNV_nonsense_pre_lib_quarts[3])
X17r1_cSNV_syn_to_non_pre_lib_spread <- X17r1_cSNV_syn_pre_lib_med - X17r1_cSNV_nonsense_pre_lib_med

X17r2_cSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X17r2_cSNV_missense_pre_lib_med <- unname(X17r2_cSNV_missense_pre_lib_quarts[3])
X17r2_cSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X17r2_cSNV_syn_pre_lib_med <- unname(X17r2_cSNV_syn_pre_lib_quarts[3])
X17r2_cSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X17r2_cSNV_nonsense_pre_lib_med <- unname(X17r2_cSNV_nonsense_pre_lib_quarts[3])
X17r2_cSNV_syn_to_non_pre_lib_spread <- X17r2_cSNV_syn_pre_lib_med - X17r2_cSNV_nonsense_pre_lib_med

X17r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_missense_pre_lib_med <- unname(X17r1r2a_cSNV_missense_pre_lib_quarts[3])
X17r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_syn_pre_lib_med <- unname(X17r1r2a_cSNV_syn_pre_lib_quarts[3])
X17r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X17r1r2a_cSNV_nonsense_pre_lib_med <- unname(X17r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X17r1r2a_cSNV_syn_to_non_pre_lib_spread <- X17r1r2a_cSNV_syn_pre_lib_med - X17r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X17r1_tSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X17r1_tSNV_missense_pre_lib_med <- unname(X17r1_tSNV_missense_pre_lib_quarts[3])
X17r1_tSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X17r1_tSNV_syn_pre_lib_med <- unname(X17r1_tSNV_syn_pre_lib_quarts[3])
X17r1_tSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X17r1_tSNV_nonsense_pre_lib_med <- unname(X17r1_tSNV_nonsense_pre_lib_quarts[3])
X17r1_tSNV_syn_to_non_pre_lib_spread <- X17r1_tSNV_syn_pre_lib_med - X17r1_tSNV_nonsense_pre_lib_med

X17r2_tSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X17r2_tSNV_missense_pre_lib_med <- unname(X17r2_tSNV_missense_pre_lib_quarts[3])
X17r2_tSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X17r2_tSNV_syn_pre_lib_med <- unname(X17r2_tSNV_syn_pre_lib_quarts[3])
X17r2_tSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X17r2_tSNV_nonsense_pre_lib_med <- unname(X17r2_tSNV_nonsense_pre_lib_quarts[3])
X17r2_tSNV_syn_to_non_pre_lib_spread <- X17r2_tSNV_syn_pre_lib_med - X17r2_tSNV_nonsense_pre_lib_med

X17r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_missense_pre_lib_med <- unname(X17r1r2a_tSNV_missense_pre_lib_quarts[3])
X17r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_syn_pre_lib_med <- unname(X17r1r2a_tSNV_syn_pre_lib_quarts[3])
X17r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X17r1r2a_tSNV_nonsense_pre_lib_med <- unname(X17r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X17r1r2a_tSNV_syn_to_non_pre_lib_spread <- X17r1r2a_tSNV_syn_pre_lib_med - X17r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X17r1_tSNV_syn_rna_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X17r1_tSNV_syn_rna_pre_med <- unname(X17r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X17r1_tSNV_syn_rna_post_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X17r1_tSNV_syn_rna_post_med <- unname(X17r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X17r2_tSNV_syn_rna_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X17r2_tSNV_syn_rna_pre_med <- unname(X17r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X17r2_tSNV_syn_rna_post_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X17r2_tSNV_syn_rna_post_med <- unname(X17r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X17r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X17r1r2a_tSNV_syn_rna_pre_med <- unname(X17r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X17r1r2a_tSNV_syn_rna_post_quarts <- quantile(X17r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X17r1r2a_tSNV_syn_rna_post_med <- unname(X17r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X17r1_cSNV_syn_pre_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X17r1_cSNV_syn_post_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X17r1_cSNV_syn_post_lib_med
# tHDR
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X17r1_tSNV_syn_pre_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X17r1_tSNV_syn_post_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X17r1_tSNV_syn_post_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X17r1_tSNV_syn_rna_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X17r1_tSNV_syn_rna_post_med

#r2
X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X17r2_cSNV_syn_pre_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X17r2_cSNV_syn_post_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X17r2_cSNV_syn_post_lib_med
# tHDR
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X17r2_tSNV_syn_pre_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X17r2_tSNV_syn_post_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X17r2_tSNV_syn_post_lib_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X17r2_tSNV_syn_rna_pre_med
X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X17r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X17r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X17r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X17r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X17r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X17r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X17r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X17r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X17r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X17r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X17r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X17r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X17r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X17r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X17r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X17r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X17r1_prog_var_thresh5_df_r2_int_ord[which(X17r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X17r1_prog_var_thresh5_df_r2_int_ord
X17r1_prog_map_thresh5_df_r2_int_ord = which(X17r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X17r1_prog_map_thresh5_df_r2_int_ord_df = X17r1_prog_var_thresh5_df_r2_int_ord[X17r1_prog_map_thresh5_df_r2_int_ord,]
X17r1_prog_map_exon_thresh5_df_r2_int_ord = which(X17r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X17r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X17r1_prog_map_exon_thresh5_df_r2_int_ord_df = X17r1_prog_map_thresh5_df_r2_int_ord_df[X17r1_prog_map_exon_thresh5_df_r2_int_ord,]
X17r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X17r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X17r1_prog_map_thresh5_df_r2_int_ord_df[X17r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X17r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X17r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X17r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X17r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X17r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X17r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X17r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X17r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X17r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X17r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X17r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X17r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X17r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X17r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X17r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X17r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X17r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X17r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X17r1r2_cSNV_r1_post_by_r2_post_cor_s
X17r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X17r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X17r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X17r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X17r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X17r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X17r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X17r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X17r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X17r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X17r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X17r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X17r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X17r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X17r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X17r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X17r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X17r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1_cSNV_post_pre_by_cadd_cor_s
#X17r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X17r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r2_cSNV_post_pre_by_cadd_cor_s

#X17r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X17r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1_cSNV_post_lib_by_cadd_cor_s
#X17r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X17r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X17r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X17r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1_tSNV_post_pre_by_cadd_cor_s
#X17r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X17r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r2_tSNV_post_pre_by_cadd_cor_s

#X17r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X17r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1_tSNV_post_lib_by_cadd_cor_s
#X17r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X17r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X17r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X17r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X17r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X17r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X17r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X17r1_prog_var_all_lib_count
X17r1_prog_var_all_pre_count
X17r2_prog_var_all_pre_count
X17r1_prog_map_thresh5_lib_count
X17r1_prog_map_thresh5_pre_count
X17r2_prog_map_thresh5_pre_count
X17r1_prog_map_thresh5_post_count
X17r2_prog_map_thresh5_post_count
X17r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X17r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X17r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X17r1r2_cSNV_r1_post_by_r2_post_cor_s
X17r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X17r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X17r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X17r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X17r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X17r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X17r1_cSNV_post_pre_by_cadd_cor_s
X17r2_cSNV_post_pre_by_cadd_cor_s
X17r1_cSNV_post_lib_by_cadd_cor_s
X17r2_cSNV_post_lib_by_cadd_cor_s
X17r1_tSNV_post_pre_by_cadd_cor_s
X17r2_tSNV_post_pre_by_cadd_cor_s
X17r1_tSNV_post_lib_by_cadd_cor_s
X17r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X17r1r2a_cSNV_post_pre_by_cadd_cor_s
X17r1r2w_cSNV_post_pre_by_cadd_cor_s
X17r1r2a_cSNV_post_lib_by_cadd_cor_s
X17r1r2w_cSNV_post_lib_by_cadd_cor_s
X17r1r2a_tSNV_post_pre_by_cadd_cor_s
X17r1r2w_tSNV_post_pre_by_cadd_cor_s
X17r1r2a_tSNV_post_lib_by_cadd_cor_s
X17r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X17r1_cSNV_syn_to_non_post_pre_spread
X17r2_cSNV_syn_to_non_post_pre_spread
X17r1r2a_cSNV_syn_to_non_post_pre_spread
X17r1_cSNV_syn_to_non_post_lib_spread
X17r2_cSNV_syn_to_non_post_lib_spread
X17r1r2a_cSNV_syn_to_non_post_lib_spread
X17r1_tSNV_syn_to_non_post_pre_spread
X17r2_tSNV_syn_to_non_post_pre_spread
X17r1r2a_tSNV_syn_to_non_post_pre_spread
X17r1_tSNV_syn_to_non_post_lib_spread
X17r2_tSNV_syn_to_non_post_lib_spread
X17r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X17r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X17r1_prog_map_thresh5_df_r2_int_ord_df[which(X17r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X17r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df[which(X17r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df[which(X17r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df[which(X17r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X17r1_cSNV_pre_lib_cors = cor(log2(X17r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X17r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17r1_tSNV_pre_lib_cors = cor(log2(X17r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17r1_cSNV_post_lib_cors = cor(log2(X17r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X17r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X17r1_tSNV_post_lib_cors = cor(log2(X17r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X17r1_cSNV_post_pre_cors = cor(log2(X17r1_prog_map_thresh5_df$post_pseudo_freq),log2(X17r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17r1_tSNV_post_pre_cors = cor(log2(X17r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X17r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17r1_cSNV_rna_lib_cors = cor(log2(X17r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X17r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17r1_tSNV_rna_lib_cors = cor(log2(X17r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X17r1_cSNV_rna_pre_cors = cor(log2(X17r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X17r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17r1_tSNV_rna_pre_cors = cor(log2(X17r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X17r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17r1r2_cSNV_pre_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X17r1r2_tSNV_pre_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X17r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X17r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X17r1r2_cSNV_post_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X17r1r2_tSNV_post_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X17r1r2_cSNV_post_lib_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X17r1r2_tSNV_post_lib_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X17r1r2_cSNV_post_pre_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X17r1r2_tSNV_post_pre_ratio_cors = cor(log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X17r1r2_cSNV_rna_cors = cor(log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X17r1r2_tSNV_rna_cors = cor(log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X17r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X17r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X17r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X17r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X17r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X17r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X17r1_cors <- c("X17r1",X17r1_cSNV_pre_lib_cors,X17r1_tSNV_pre_lib_cors,X17r1_cSNV_post_lib_cors,X17r1_tSNV_post_lib_cors,X17r1_cSNV_post_pre_cors,X17r1_tSNV_post_pre_cors,X17r1_cSNV_rna_lib_cors,X17r1_tSNV_rna_lib_cors,X17r1_cSNV_rna_pre_cors,X17r1_tSNV_rna_pre_cors,X17r1r2_cSNV_pre_cors,X17r1r2_tSNV_pre_cors,X17r1r2_cSNV_pre_lib_ratio_cors,X17r1r2_tSNV_pre_lib_ratio_cors,X17r1r2_cSNV_post_cors,X17r1r2_tSNV_post_cors,X17r1r2_cSNV_post_lib_ratio_cors,X17r1r2_tSNV_post_lib_ratio_cors,X17r1r2_cSNV_post_pre_ratio_cors,X17r1r2_tSNV_post_pre_ratio_cors,X17r1r2_cSNV_rna_cors,X17r1r2_tSNV_rna_cors,X17r1r2_tSNV_rna_pre_ratio_cors,X17r1_cSNV_pre_lib_ratio_cadd_cors,X17r1_tSNV_pre_lib_ratio_cadd_cors,X17r1_cSNV_post_lib_ratio_cadd_cors,X17r1_tSNV_post_lib_ratio_cadd_cors,X17r1_cSNV_post_pre_ratio_cadd_cors,X17r1_tSNV_post_pre_ratio_cadd_cors,X17r1_cSNV_post_pre_ratio_cadd_missense_cors,X17r1_tSNV_post_pre_ratio_cadd_missense_cors,X17r1_cSNV_post_pre_ratio_polyphen_missense_cors,X17r1_tSNV_post_pre_ratio_polyphen_missense_cors,X17r1_cSNV_post_pre_ratio_grantham_missense_cors,X17r1_tSNV_post_pre_ratio_grantham_missense_cors,X17r1r2a_cSNV_pre_lib_ratio_cadd_cors,X17r1r2a_tSNV_pre_lib_ratio_cadd_cors,X17r1r2a_cSNV_post_lib_ratio_cadd_cors,X17r1r2a_tSNV_post_lib_ratio_cadd_cors,X17r1r2a_cSNV_post_pre_ratio_cadd_cors,X17r1r2a_tSNV_post_pre_ratio_cadd_cors,X17r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X17r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X17r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X17r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X17r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X17r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X17r1r2w_cSNV_pre_lib_ratio_cadd_cors,X17r1r2w_cSNV_post_lib_ratio_cadd_cors,X17r1r2w_cSNV_post_pre_ratio_cadd_cors,X17r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X17r2_cSNV_pre_lib_cors = cor(log2(X17r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X17r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17r2_tSNV_pre_lib_cors = cor(log2(X17r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17r2_cSNV_post_lib_cors = cor(log2(X17r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X17r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X17r2_tSNV_post_lib_cors = cor(log2(X17r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X17r2_cSNV_post_pre_cors = cor(log2(X17r2_prog_map_thresh5_df$post_pseudo_freq),log2(X17r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17r2_tSNV_post_pre_cors = cor(log2(X17r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X17r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17r2_cSNV_rna_lib_cors = cor(log2(X17r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X17r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17r2_tSNV_rna_lib_cors = cor(log2(X17r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X17r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X17r2_cSNV_rna_pre_cors = cor(log2(X17r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X17r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17r2_tSNV_rna_pre_cors = cor(log2(X17r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X17r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X17r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X17r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X17r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X17r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X17r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X17r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X17r2_cors <- c("X17r2",X17r2_cSNV_pre_lib_cors,X17r2_tSNV_pre_lib_cors,X17r2_cSNV_post_lib_cors,X17r2_tSNV_post_lib_cors,X17r2_cSNV_post_pre_cors,X17r2_tSNV_post_pre_cors,X17r2_cSNV_rna_lib_cors,X17r2_tSNV_rna_lib_cors,X17r2_cSNV_rna_pre_cors,X17r2_tSNV_rna_pre_cors,X17r1r2_cSNV_pre_cors,X17r1r2_tSNV_pre_cors,X17r1r2_cSNV_pre_lib_ratio_cors,X17r1r2_tSNV_pre_lib_ratio_cors,X17r1r2_cSNV_post_cors,X17r1r2_tSNV_post_cors,X17r1r2_cSNV_post_lib_ratio_cors,X17r1r2_tSNV_post_lib_ratio_cors,X17r1r2_cSNV_post_pre_ratio_cors,X17r1r2_tSNV_post_pre_ratio_cors,X17r1r2_cSNV_rna_cors,X17r1r2_tSNV_rna_cors,X17r1r2_tSNV_rna_pre_ratio_cors,X17r2_cSNV_pre_lib_ratio_cadd_cors,X17r2_tSNV_pre_lib_ratio_cadd_cors,X17r2_cSNV_post_lib_ratio_cadd_cors,X17r2_tSNV_post_lib_ratio_cadd_cors,X17r2_cSNV_post_pre_ratio_cadd_cors,X17r2_tSNV_post_pre_ratio_cadd_cors,X17r2_cSNV_post_pre_ratio_cadd_missense_cors,X17r2_tSNV_post_pre_ratio_cadd_missense_cors,X17r2_cSNV_post_pre_ratio_polyphen_missense_cors,X17r2_tSNV_post_pre_ratio_polyphen_missense_cors,X17r2_cSNV_post_pre_ratio_grantham_missense_cors,X17r2_tSNV_post_pre_ratio_grantham_missense_cors,X17r1r2a_cSNV_pre_lib_ratio_cadd_cors,X17r1r2a_tSNV_pre_lib_ratio_cadd_cors,X17r1r2a_cSNV_post_lib_ratio_cadd_cors,X17r1r2a_tSNV_post_lib_ratio_cadd_cors,X17r1r2a_cSNV_post_pre_ratio_cadd_cors,X17r1r2a_tSNV_post_pre_ratio_cadd_cors,X17r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X17r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X17r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X17r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X17r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X17r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X17r1r2w_cSNV_pre_lib_ratio_cadd_cors,X17r1r2w_cSNV_post_lib_ratio_cadd_cors,X17r1r2w_cSNV_post_pre_ratio_cadd_cors,X17r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X17r1)
rm(X17r2)
gc()
X18r1_file <- paste(experiment_dir_171011,'X18r1','_annotated.txt',sep='')
X18r2_file <- paste(experiment_dir_171011,'X18r2','_annotated.txt',sep='')
X18r1 <- read.table(X18r1_file, header=TRUE, sep="\t")
X18r2 <- read.table(X18r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X18 <- editing_info[which(editing_info$amplicon == 'X18'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X18_HDR_5_SNV = as.character(editing_info_X18$HDR_5_SNV)
X18_HDR_3_SNV = as.character(editing_info_X18$HDR_3_SNV)
#X18_cut_pos = as.character(editing_info_X18$cut_pos)
X18_cut_end = as.character(editing_info_X18$cut_end)
X18_mut_start = as.character(editing_info_X18$mut_start)
X18_mut_end = as.character(editing_info_X18$mut_end)
### Replicate 1
X18r1_cSNV_all <- which(X18r1[,'c_hdr_snv']=='True')
X18r1_cSNV_all_df = X18r1[X18r1_cSNV_all,]
X18r1_prog_var_all <- which(X18r1[,'all_hdr_variant']=='True' & X18r1[,'edit_string']!='-WT')
X18r1_prog_var_all_df = X18r1[X18r1_prog_var_all,]
X18r1_prog_map_all = which(X18r1_prog_var_all_df[,'pos']!='REF')
X18r1_prog_map_all_df = X18r1_prog_var_all_df[X18r1_prog_map_all,]
X18r1_prog_map_exon_all = which(X18r1_prog_map_all_df[,'cDNApos']!='REF' & X18r1_prog_map_all_df[,'cDNApos']!='NA')
X18r1_prog_map_exon_all_df = X18r1_prog_map_all_df[X18r1_prog_map_exon_all,]
X18r1_prog_map_CADD = which(X18r1_prog_map_all_df[,'CADD.phred']!='NA')
X18r1_prog_map_CADD_df = X18r1_prog_map_all_df[X18r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X18r1_prog_var_thresh5 <- which(as.numeric(as.character(X18r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X18r1_prog_var_thresh5_df = X18r1_prog_var_all_df[X18r1_prog_var_thresh5,]
X18r1_prog_map_thresh5 <- which(as.numeric(as.character(X18r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X18r1_prog_map_thresh5_df = X18r1_prog_map_all_df[X18r1_prog_map_thresh5,]
X18r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X18r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X18r1_prog_map_exon_thresh5_df = X18r1_prog_map_exon_all_df[X18r1_prog_map_exon_thresh5,]
X18r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X18r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X18r1_prog_map_CADD_thresh5_df = X18r1_prog_map_CADD_df[X18r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X18r1_prog_var_all_lib_count = length(X18r1_prog_var_all_df$lib)
X18r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X18r1_prog_var_all_min_lib_counts = min(X18r1_prog_var_all_df$lib)
X18r1_prog_var_all_min_lib_counts
X18r1_prog_var_all_max_lib_counts = max(X18r1_prog_var_all_df$lib)
X18r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X18r1_prog_map_all_lib_count = length(X18r1_prog_map_all_df$lib)
X18r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X18r1_prog_map_all_min_lib_counts = min(X18r1_prog_map_all_df$lib)
X18r1_prog_map_all_min_lib_counts
X18r1_prog_map_all_max_lib_counts = max(X18r1_prog_map_all_df$lib)
X18r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X18r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X18r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X18r1_prog_var_all_pre_count = length(X18r1_prog_var_all_df$pre)
X18r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X18r1_prog_var_all_min_pre_counts = min(X18r1_prog_var_all_df$pre)
X18r1_prog_var_all_min_pre_counts
X18r1_prog_var_all_max_pre_counts = max(X18r1_prog_var_all_df$pre)
X18r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X18r1_prog_map_all_pre_count = length(X18r1_prog_map_all_df$pre)
X18r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X18r1_prog_map_all_min_pre_counts = min(X18r1_prog_map_all_df$pre)
X18r1_prog_map_all_min_pre_counts
X18r1_prog_map_all_max_pre_counts = max(X18r1_prog_map_all_df$pre)
X18r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X18r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X18r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X18r1_prog_map_all_post_count = length(X18r1_prog_map_all_df$post)
X18r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X18r1_prog_map_all_min_post_counts = min(X18r1_prog_map_all_df$post)
X18r1_prog_map_all_min_post_counts
X18r1_prog_map_all_max_post_counts = max(X18r1_prog_map_all_df$post)
X18r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X18r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X18r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X18r1_prog_map_all_syn_df <- X18r1_prog_map_all_df[which(X18r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X18r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X18r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X18r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X18r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X18r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X18r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X18r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X18r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X18r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X18r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X18r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X18r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X18r1_prog_map_all_min_rna_counts = min(X18r1_prog_map_exon_all_df$tHDR_rna)
X18r1_prog_map_all_min_rna_counts
X18r1_prog_map_all_max_rna_counts = max(X18r1_prog_map_exon_all_df$tHDR_rna)
X18r1_prog_map_all_max_rna_counts
X18r1_prog_map_all_min_rna_pseudo_freq = min(X18r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18r1_prog_map_all_min_rna_pseudo_freq
X18r1_prog_map_all_max_rna_pseudo_freq = max(X18r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18r1_prog_map_all_max_rna_pseudo_freq
X18r1_prog_map_all_min_rna_pre_ratio = min(X18r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18r1_prog_map_all_min_rna_pre_ratio
X18r1_prog_map_all_max_rna_pre_ratio = max(X18r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18r1_prog_map_all_max_rna_pre_ratio
X18r1_prog_map_all_min_rna_post_ratio = min(X18r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18r1_prog_map_all_min_rna_post_ratio
X18r1_prog_map_all_max_rna_post_ratio = max(X18r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X18r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X18r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X18r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X18r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X18r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X18r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X18r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X18r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X18r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X18r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X18r1_prog_map_all_df$post_pre_ratio),log2(X18r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X18r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X18r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X18r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X18r1_cSNV_all_corr_pre_count = length(X18r1_cSNV_all_df$corr_pre)
X18r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X18r1_cSNV_all_min_corr_pre_counts = min(X18r1_cSNV_all_df$corr_pre)
X18r1_cSNV_all_min_corr_pre_counts
X18r1_cSNV_all_max_corr_pre_counts = max(X18r1_cSNV_all_df$corr_pre)
X18r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X18r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X18r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X18r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X18r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X18r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_cSNV_all_corr_post_count = length(X18r1_cSNV_all_df$corr_post)
X18r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X18r1_cSNV_all_min_corr_post_counts = min(X18r1_cSNV_all_df$corr_post)
X18r1_cSNV_all_min_corr_post_counts
X18r1_cSNV_all_max_corr_post_counts = max(X18r1_cSNV_all_df$corr_post)
X18r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X18r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X18r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X18r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X18r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X18r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X18r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X18_p_hdr_snv = paste('p_hdr_',X18_cut_end,'_snv',sep='')
X18r1_pSNV_all <- which(X18r1[,X18_p_hdr_snv]=='True')
X18r1_pSNV_all_df = X18r1[X18r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_pSNV_all_lib_count = length(X18r1_pSNV_all_df$lib)
X18r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X18r1_pSNV_all_min_lib_counts = min(X18r1_pSNV_all_df$lib)
X18r1_pSNV_all_min_lib_counts
X18r1_pSNV_all_max_lib_counts = max(X18r1_pSNV_all_df$lib)
X18r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X18r1_pSNV_all_pre_count = length(X18r1_pSNV_all_df$pre)
X18r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X18r1_pSNV_all_min_pre_counts = min(X18r1_pSNV_all_df$pre)
X18r1_pSNV_all_min_pre_counts
X18r1_pSNV_all_max_pre_counts = max(X18r1_pSNV_all_df$pre)
X18r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X18r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X18r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_pSNV_all_post_count = length(X18r1_pSNV_all_df$post)
X18r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X18r1_pSNV_all_min_post_counts = min(X18r1_pSNV_all_df$post)
X18r1_pSNV_all_min_post_counts
X18r1_pSNV_all_max_post_counts = max(X18r1_pSNV_all_df$post)
X18r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X18r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X18r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_prog_map_thresh5_lib_count = length(X18r1_prog_map_thresh5_df$lib)
X18r1_prog_map_thresh5_lib_count
X18r1_prog_map_thresh5_min_lib_counts = min(X18r1_prog_map_thresh5_df$lib)
X18r1_prog_map_thresh5_min_lib_counts
X18r1_prog_map_thresh5_max_lib_counts = max(X18r1_prog_map_thresh5_df$lib)
X18r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X18r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X18r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_prog_map_thresh5_pre_count = length(X18r1_prog_map_thresh5_df$pre)
X18r1_prog_map_thresh5_pre_count
X18r1_prog_map_thresh5_min_pre_counts = min(X18r1_prog_map_thresh5_df$pre)
X18r1_prog_map_thresh5_min_pre_counts
X18r1_prog_map_thresh5_max_pre_counts = max(X18r1_prog_map_thresh5_df$pre)
X18r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r1_prog_map_thresh5_post_count = length(X18r1_prog_map_thresh5_df$post)
X18r1_prog_map_thresh5_post_count
X18r1_prog_map_thresh5_min_post_counts = min(X18r1_prog_map_thresh5_df$post)
X18r1_prog_map_thresh5_min_post_counts
X18r1_prog_map_thresh5_max_post_counts = max(X18r1_prog_map_thresh5_df$post)
X18r1_prog_map_thresh5_max_post_counts
X18r1_prog_map_thresh5_corr_post_count = length(X18r1_cSNV_all_df$corr_post)
X18r1_prog_map_thresh5_corr_post_count
X18r1_prog_map_thresh5_min_corr_post_counts = min(X18r1_cSNV_all_df$corr_post)
X18r1_prog_map_thresh5_min_corr_post_counts
X18r1_prog_map_thresh5_max_corr_post_counts = max(X18r1_cSNV_all_df$corr_post)
X18r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X18r1_pSNV_thresh5 <- which(X18r1[,X18_p_hdr_snv]=='True' & as.numeric(as.character(X18r1[,'pre_freq']))>=0.00001)
X18r1_pSNV_thresh5_df = X18r1[X18r1_pSNV_thresh5,]
X18r1_pSNV_thresh5_lib_count = length(X18r1_pSNV_thresh5_df$lib)
X18r1_pSNV_thresh5_lib_count
X18r1_pSNV_thresh5_min_lib_counts = min(X18r1_pSNV_thresh5_df$lib)
X18r1_pSNV_thresh5_min_lib_counts
X18r1_pSNV_thresh5_max_lib_counts = max(X18r1_pSNV_thresh5_df$lib)
X18r1_pSNV_thresh5_max_lib_counts
X18r1_pSNV_thresh5_pre_count = length(X18r1_pSNV_thresh5_df$pre)
X18r1_pSNV_thresh5_pre_count
X18r1_pSNV_thresh5_min_pre_counts = min(X18r1_pSNV_thresh5_df$pre)
X18r1_pSNV_thresh5_min_pre_counts
X18r1_pSNV_thresh5_max_pre_counts = max(X18r1_pSNV_thresh5_df$pre)
X18r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X18r1_pSNV_thresh5_post_count = length(X18r1_pSNV_thresh5_df$post)
X18r1_pSNV_thresh5_post_count
X18r1_pSNV_thresh5_min_post_counts = min(X18r1_pSNV_thresh5_df$post)
X18r1_pSNV_thresh5_min_post_counts
X18r1_pSNV_thresh5_max_post_counts = max(X18r1_pSNV_thresh5_df$post)
X18r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X18r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X18r1_pSNV_thresh5_post_pos

### Replicate 2
X18r2_cSNV_all <- which(X18r2[,'c_hdr_snv']=='True')
X18r2_cSNV_all_df = X18r2[X18r2_cSNV_all,]
X18r2_prog_var_all <- which(X18r2[,'all_hdr_variant']=='True' & X18r2[,'edit_string']!='-WT')
X18r2_prog_var_all_df = X18r2[X18r2_prog_var_all,]
X18r2_prog_map_all = which(X18r2_prog_var_all_df[,'pos']!='REF')
X18r2_prog_map_all_df = X18r2_prog_var_all_df[X18r2_prog_map_all,]
X18r2_prog_map_exon_all = which(X18r2_prog_map_all_df[,'cDNApos']!='REF' & X18r2_prog_map_all_df[,'cDNApos']!='NA')
X18r2_prog_map_exon_all_df = X18r2_prog_map_all_df[X18r2_prog_map_exon_all,]
X18r2_prog_map_CADD = which(X18r2_prog_map_all_df[,'CADD.phred']!='NA')
X18r2_prog_map_CADD_df = X18r2_prog_map_all_df[X18r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X18r2_prog_var_thresh5 <- which(as.numeric(as.character(X18r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X18r2_prog_var_thresh5_df = X18r2_prog_var_all_df[X18r2_prog_var_thresh5,]
X18r2_prog_map_thresh5 <- which(as.numeric(as.character(X18r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X18r2_prog_map_thresh5_df = X18r2_prog_map_all_df[X18r2_prog_map_thresh5,]
X18r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X18r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X18r2_prog_map_exon_thresh5_df = X18r2_prog_map_exon_all_df[X18r2_prog_map_exon_thresh5,]
X18r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X18r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X18r2_prog_map_CADD_thresh5_df = X18r2_prog_map_CADD_df[X18r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X18r2_prog_var_all_lib_count = length(X18r2_prog_var_all_df$lib)
X18r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X18r2_prog_var_all_min_lib_counts = min(X18r2_prog_var_all_df$lib)
X18r2_prog_var_all_min_lib_counts
X18r2_prog_var_all_max_lib_counts = max(X18r2_prog_var_all_df$lib)
X18r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X18r2_prog_map_all_lib_count = length(X18r2_prog_map_all_df$lib)
X18r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X18r2_prog_map_all_min_lib_counts = min(X18r2_prog_map_all_df$lib)
X18r2_prog_map_all_min_lib_counts
X18r2_prog_map_all_max_lib_counts = max(X18r2_prog_map_all_df$lib)
X18r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X18r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X18r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X18r2_prog_var_all_pre_count = length(X18r2_prog_var_all_df$pre)
X18r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X18r2_prog_var_all_min_pre_counts = min(X18r2_prog_var_all_df$pre)
X18r2_prog_var_all_min_pre_counts
X18r2_prog_var_all_max_pre_counts = max(X18r2_prog_var_all_df$pre)
X18r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X18r2_prog_map_all_pre_count = length(X18r2_prog_map_all_df$pre)
X18r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X18r2_prog_map_all_min_pre_counts = min(X18r2_prog_map_all_df$pre)
X18r2_prog_map_all_min_pre_counts
X18r2_prog_map_all_max_pre_counts = max(X18r2_prog_map_all_df$pre)
X18r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X18r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X18r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X18r2_prog_map_all_post_count = length(X18r2_prog_map_all_df$post)
X18r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X18r2_prog_map_all_min_post_counts = min(X18r2_prog_map_all_df$post)
X18r2_prog_map_all_min_post_counts
X18r2_prog_map_all_max_post_counts = max(X18r2_prog_map_all_df$post)
X18r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X18r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X18r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X18r2_prog_map_all_syn_df <- X18r2_prog_map_all_df[which(X18r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X18r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X18r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X18r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X18r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X18r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X18r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X18r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X18r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X18r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X18r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X18r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X18r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X18r2_prog_map_all_min_rna_counts = min(X18r2_prog_map_exon_all_df$tHDR_rna)
X18r2_prog_map_all_min_rna_counts
X18r2_prog_map_all_max_rna_counts = max(X18r2_prog_map_exon_all_df$tHDR_rna)
X18r2_prog_map_all_max_rna_counts
X18r2_prog_map_all_min_rna_pseudo_freq = min(X18r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18r2_prog_map_all_min_rna_pseudo_freq
X18r2_prog_map_all_max_rna_pseudo_freq = max(X18r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18r2_prog_map_all_max_rna_pseudo_freq
X18r2_prog_map_all_min_rna_pre_ratio = min(X18r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18r2_prog_map_all_min_rna_pre_ratio
X18r2_prog_map_all_max_rna_pre_ratio = max(X18r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18r2_prog_map_all_max_rna_pre_ratio
X18r2_prog_map_all_min_rna_post_ratio = min(X18r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18r2_prog_map_all_min_rna_post_ratio
X18r2_prog_map_all_max_rna_post_ratio = max(X18r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X18r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X18r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X18r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X18r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X18r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X18r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X18r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X18r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X18r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X18r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X18r2_prog_map_all_df$post_pre_ratio),log2(X18r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X18r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X18r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X18r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X18r2_cSNV_all_corr_pre_count = length(X18r2_cSNV_all_df$corr_pre)
X18r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X18r2_cSNV_all_min_corr_pre_counts = min(X18r2_cSNV_all_df$corr_pre)
X18r2_cSNV_all_min_corr_pre_counts
X18r2_cSNV_all_max_corr_pre_counts = max(X18r2_cSNV_all_df$corr_pre)
X18r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X18r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X18r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X18r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X18r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X18r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_cSNV_all_corr_post_count = length(X18r2_cSNV_all_df$corr_post)
X18r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X18r2_cSNV_all_min_corr_post_counts = min(X18r2_cSNV_all_df$corr_post)
X18r2_cSNV_all_min_corr_post_counts
X18r2_cSNV_all_max_corr_post_counts = max(X18r2_cSNV_all_df$corr_post)
X18r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X18r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X18r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X18r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X18r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X18r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X18r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X18_p_hdr_snv = paste('p_hdr_',X18_cut_end,'_snv',sep='')
X18r2_pSNV_all <- which(X18r2[,X18_p_hdr_snv]=='True')
X18r2_pSNV_all_df = X18r2[X18r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_pSNV_all_lib_count = length(X18r2_pSNV_all_df$lib)
X18r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X18r2_pSNV_all_min_lib_counts = min(X18r2_pSNV_all_df$lib)
X18r2_pSNV_all_min_lib_counts
X18r2_pSNV_all_max_lib_counts = max(X18r2_pSNV_all_df$lib)
X18r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X18r2_pSNV_all_pre_count = length(X18r2_pSNV_all_df$pre)
X18r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X18r2_pSNV_all_min_pre_counts = min(X18r2_pSNV_all_df$pre)
X18r2_pSNV_all_min_pre_counts
X18r2_pSNV_all_max_pre_counts = max(X18r2_pSNV_all_df$pre)
X18r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X18r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X18r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_pSNV_all_post_count = length(X18r2_pSNV_all_df$post)
X18r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X18r2_pSNV_all_min_post_counts = min(X18r2_pSNV_all_df$post)
X18r2_pSNV_all_min_post_counts
X18r2_pSNV_all_max_post_counts = max(X18r2_pSNV_all_df$post)
X18r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X18r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X18r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_prog_map_thresh5_lib_count = length(X18r2_prog_map_thresh5_df$lib)
X18r2_prog_map_thresh5_lib_count
X18r2_prog_map_thresh5_min_lib_counts = min(X18r2_prog_map_thresh5_df$lib)
X18r2_prog_map_thresh5_min_lib_counts
X18r2_prog_map_thresh5_max_lib_counts = max(X18r2_prog_map_thresh5_df$lib)
X18r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X18r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X18r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_prog_map_thresh5_pre_count = length(X18r2_prog_map_thresh5_df$pre)
X18r2_prog_map_thresh5_pre_count
X18r2_prog_map_thresh5_min_pre_counts = min(X18r2_prog_map_thresh5_df$pre)
X18r2_prog_map_thresh5_min_pre_counts
X18r2_prog_map_thresh5_max_pre_counts = max(X18r2_prog_map_thresh5_df$pre)
X18r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18r2_prog_map_thresh5_post_count = length(X18r2_prog_map_thresh5_df$post)
X18r2_prog_map_thresh5_post_count
X18r2_prog_map_thresh5_min_post_counts = min(X18r2_prog_map_thresh5_df$post)
X18r2_prog_map_thresh5_min_post_counts
X18r2_prog_map_thresh5_max_post_counts = max(X18r2_prog_map_thresh5_df$post)
X18r2_prog_map_thresh5_max_post_counts
X18r2_prog_map_thresh5_corr_post_count = length(X18r2_prog_map_thresh5_df$corr_post)
X18r2_prog_map_thresh5_corr_post_count
X18r2_prog_map_thresh5_min_corr_post_counts = min(X18r2_prog_map_thresh5_df$corr_post)
X18r2_prog_map_thresh5_min_corr_post_counts
X18r2_prog_map_thresh5_max_corr_post_counts = max(X18r2_prog_map_thresh5_df$corr_post)
X18r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X18r2_pSNV_thresh5 <- which(X18r2[,X18_p_hdr_snv]=='True' & as.numeric(as.character(X18r2[,'pre_freq']))>=0.00001)
X18r2_pSNV_thresh5_df = X18r2[X18r2_pSNV_thresh5,]
X18r2_pSNV_thresh5_lib_count = length(X18r2_pSNV_thresh5_df$lib)
X18r2_pSNV_thresh5_lib_count
X18r2_pSNV_thresh5_min_lib_counts = min(X18r2_pSNV_thresh5_df$lib)
X18r2_pSNV_thresh5_min_lib_counts
X18r2_pSNV_thresh5_max_lib_counts = max(X18r2_pSNV_thresh5_df$lib)
X18r2_pSNV_thresh5_max_lib_counts
X18r2_pSNV_thresh5_pre_count = length(X18r2_pSNV_thresh5_df$pre)
X18r2_pSNV_thresh5_pre_count
X18r2_pSNV_thresh5_min_pre_counts = min(X18r2_pSNV_thresh5_df$pre)
X18r2_pSNV_thresh5_min_pre_counts
X18r2_pSNV_thresh5_max_pre_counts = max(X18r2_pSNV_thresh5_df$pre)
X18r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X18r2_pSNV_thresh5_post_count = length(X18r2_pSNV_thresh5_df$post)
X18r2_pSNV_thresh5_post_count
X18r2_pSNV_thresh5_min_post_counts = min(X18r2_pSNV_thresh5_df$post)
X18r2_pSNV_thresh5_min_post_counts
X18r2_pSNV_thresh5_max_post_counts = max(X18r2_pSNV_thresh5_df$post)
X18r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X18r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X18r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X18r1_prog_var_thresh5_df:
X18r1_prog_var_thresh5_df_r2_int <- X18r1_prog_var_thresh5_df[which(X18r1_prog_var_thresh5_df$variant %in% X18r2_prog_var_thresh5_df$variant),]
#Intersection variants of X18r2_prog_var_thresh5_df:
X18r2_prog_var_thresh5_df_r1_int <- X18r2_prog_var_thresh5_df[which(X18r2_prog_var_thresh5_df$variant %in% X18r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X18r1_prog_var_thresh5_df_r2_int_ord <- X18r1_prog_var_thresh5_df_r2_int[order(X18r1_prog_var_thresh5_df_r2_int$variant),]
X18r2_prog_var_thresh5_df_r1_int_ord <- X18r2_prog_var_thresh5_df_r1_int[order(X18r2_prog_var_thresh5_df_r1_int$variant),]

dim(X18r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X18r1r2int_prog_var_thresh5_pre_count <- dim(X18r1_prog_var_thresh5_df_r2_int)[1] 
X18r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X18r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X18r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X18r2_prog_var_thresh5_df_r1_int_ord$pre
X18r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X18r2_prog_var_thresh5_df_r1_int_ord$lib
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X18r2_prog_var_thresh5_df_r1_int_ord$post
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X18r2_prog_var_thresh5_df_r1_int_ord$rna
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X18r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X18r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X18r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$post_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X18r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X18r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X18r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X18r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X18r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X18r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X18r2_prog_var_thresh5_df_r1_int_ord$corr_post
X18r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X18r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X18r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X18r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X18r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X18r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X18r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X18r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X18r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X18r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X18r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X18r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X18r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X18r1_cSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X18r1_cSNV_missense_post_pre_med <- unname(X18r1_cSNV_missense_post_pre_quarts[3])
X18r1_cSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X18r1_cSNV_syn_post_pre_med <- unname(X18r1_cSNV_syn_post_pre_quarts[3])
X18r1_cSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X18r1_cSNV_nonsense_post_pre_med <- unname(X18r1_cSNV_nonsense_post_pre_quarts[3])
X18r1_cSNV_syn_to_non_post_pre_spread <- X18r1_cSNV_syn_post_pre_med - X18r1_cSNV_nonsense_post_pre_med

X18r2_cSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X18r2_cSNV_missense_post_pre_med <- unname(X18r2_cSNV_missense_post_pre_quarts[3])
X18r2_cSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X18r2_cSNV_syn_post_pre_med <- unname(X18r2_cSNV_syn_post_pre_quarts[3])
X18r2_cSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X18r2_cSNV_nonsense_post_pre_med <- unname(X18r2_cSNV_nonsense_post_pre_quarts[3])
X18r2_cSNV_syn_to_non_post_pre_spread <- X18r2_cSNV_syn_post_pre_med - X18r2_cSNV_nonsense_post_pre_med

X18r1r2a_cSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X18r1r2a_cSNV_missense_post_pre_med <- unname(X18r1r2a_cSNV_missense_post_pre_quarts[3])
X18r1r2a_cSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X18r1r2a_cSNV_syn_post_pre_med <- unname(X18r1r2a_cSNV_syn_post_pre_quarts[3])
X18r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X18r1r2a_cSNV_nonsense_post_pre_med <- unname(X18r1r2a_cSNV_nonsense_post_pre_quarts[3])
X18r1r2a_cSNV_syn_to_non_post_pre_spread <- X18r1r2a_cSNV_syn_post_pre_med - X18r1r2a_cSNV_nonsense_post_pre_med

X18r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_cSNV_missense_post_pre_med <- unname(X18r1r2pw_cSNV_missense_post_pre_quarts[3])
X18r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_cSNV_syn_post_pre_med <- unname(X18r1r2pw_cSNV_syn_post_pre_quarts[3])
X18r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_cSNV_nonsense_post_pre_med <- unname(X18r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X18r1r2pw_cSNV_syn_to_non_post_pre_spread <- X18r1r2pw_cSNV_syn_post_pre_med - X18r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X18r1_tSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X18r1_tSNV_missense_post_pre_med <- unname(X18r1_tSNV_missense_post_pre_quarts[3])
X18r1_tSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X18r1_tSNV_syn_post_pre_med <- unname(X18r1_tSNV_syn_post_pre_quarts[3])
X18r1_tSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X18r1_tSNV_nonsense_post_pre_med <- unname(X18r1_tSNV_nonsense_post_pre_quarts[3])
X18r1_tSNV_syn_to_non_post_pre_spread <- X18r1_tSNV_syn_post_pre_med - X18r1_tSNV_nonsense_post_pre_med

X18r2_tSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X18r2_tSNV_missense_post_pre_med <- unname(X18r2_tSNV_missense_post_pre_quarts[3])
X18r2_tSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X18r2_tSNV_syn_post_pre_med <- unname(X18r2_tSNV_syn_post_pre_quarts[3])
X18r2_tSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X18r2_tSNV_nonsense_post_pre_med <- unname(X18r2_tSNV_nonsense_post_pre_quarts[3])
X18r2_tSNV_syn_to_non_post_pre_spread <- X18r2_tSNV_syn_post_pre_med - X18r2_tSNV_nonsense_post_pre_med

X18r1r2a_tSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X18r1r2a_tSNV_missense_post_pre_med <- unname(X18r1r2a_tSNV_missense_post_pre_quarts[3])
X18r1r2a_tSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X18r1r2a_tSNV_syn_post_pre_med <- unname(X18r1r2a_tSNV_syn_post_pre_quarts[3])
X18r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X18r1r2a_tSNV_nonsense_post_pre_med <- unname(X18r1r2a_tSNV_nonsense_post_pre_quarts[3])
X18r1r2a_tSNV_syn_to_non_post_pre_spread <- X18r1r2a_tSNV_syn_post_pre_med - X18r1r2a_tSNV_nonsense_post_pre_med

X18r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_tSNV_missense_post_pre_med <- unname(X18r1r2pw_tSNV_missense_post_pre_quarts[3])
X18r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_tSNV_syn_post_pre_med <- unname(X18r1r2pw_tSNV_syn_post_pre_quarts[3])
X18r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X18r1r2pw_tSNV_nonsense_post_pre_med <- unname(X18r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X18r1r2pw_tSNV_syn_to_non_post_pre_spread <- X18r1r2pw_tSNV_syn_post_pre_med - X18r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X18r1_cSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X18r1_cSNV_missense_post_lib_med <- unname(X18r1_cSNV_missense_post_lib_quarts[3])
X18r1_cSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X18r1_cSNV_syn_post_lib_med <- unname(X18r1_cSNV_syn_post_lib_quarts[3])
X18r1_cSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X18r1_cSNV_nonsense_post_lib_med <- unname(X18r1_cSNV_nonsense_post_lib_quarts[3])
X18r1_cSNV_syn_to_non_post_lib_spread <- X18r1_cSNV_syn_post_lib_med - X18r1_cSNV_nonsense_post_lib_med

X18r2_cSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X18r2_cSNV_missense_post_lib_med <- unname(X18r2_cSNV_missense_post_lib_quarts[3])
X18r2_cSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X18r2_cSNV_syn_post_lib_med <- unname(X18r2_cSNV_syn_post_lib_quarts[3])
X18r2_cSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X18r2_cSNV_nonsense_post_lib_med <- unname(X18r2_cSNV_nonsense_post_lib_quarts[3])
X18r2_cSNV_syn_to_non_post_lib_spread <- X18r2_cSNV_syn_post_lib_med - X18r2_cSNV_nonsense_post_lib_med

X18r1r2a_cSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_missense_post_lib_med <- unname(X18r1r2a_cSNV_missense_post_lib_quarts[3])
X18r1r2a_cSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_syn_post_lib_med <- unname(X18r1r2a_cSNV_syn_post_lib_quarts[3])
X18r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_nonsense_post_lib_med <- unname(X18r1r2a_cSNV_nonsense_post_lib_quarts[3])
X18r1r2a_cSNV_syn_to_non_post_lib_spread <- X18r1r2a_cSNV_syn_post_lib_med - X18r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X18r1_tSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X18r1_tSNV_missense_post_lib_med <- unname(X18r1_tSNV_missense_post_lib_quarts[3])
X18r1_tSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X18r1_tSNV_syn_post_lib_med <- unname(X18r1_tSNV_syn_post_lib_quarts[3])
X18r1_tSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X18r1_tSNV_nonsense_post_lib_med <- unname(X18r1_tSNV_nonsense_post_lib_quarts[3])
X18r1_tSNV_syn_to_non_post_lib_spread <- X18r1_tSNV_syn_post_lib_med - X18r1_tSNV_nonsense_post_lib_med

X18r2_tSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X18r2_tSNV_missense_post_lib_med <- unname(X18r2_tSNV_missense_post_lib_quarts[3])
X18r2_tSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X18r2_tSNV_syn_post_lib_med <- unname(X18r2_tSNV_syn_post_lib_quarts[3])
X18r2_tSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X18r2_tSNV_nonsense_post_lib_med <- unname(X18r2_tSNV_nonsense_post_lib_quarts[3])
X18r2_tSNV_syn_to_non_post_lib_spread <- X18r2_tSNV_syn_post_lib_med - X18r2_tSNV_nonsense_post_lib_med

X18r1r2a_tSNV_missense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_missense_post_lib_med <- unname(X18r1r2a_tSNV_missense_post_lib_quarts[3])
X18r1r2a_tSNV_syn_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_syn_post_lib_med <- unname(X18r1r2a_tSNV_syn_post_lib_quarts[3])
X18r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_nonsense_post_lib_med <- unname(X18r1r2a_tSNV_nonsense_post_lib_quarts[3])
X18r1r2a_tSNV_syn_to_non_post_lib_spread <- X18r1r2a_tSNV_syn_post_lib_med - X18r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X18r1_cSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X18r1_cSNV_missense_pre_lib_med <- unname(X18r1_cSNV_missense_pre_lib_quarts[3])
X18r1_cSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X18r1_cSNV_syn_pre_lib_med <- unname(X18r1_cSNV_syn_pre_lib_quarts[3])
X18r1_cSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X18r1_cSNV_nonsense_pre_lib_med <- unname(X18r1_cSNV_nonsense_pre_lib_quarts[3])
X18r1_cSNV_syn_to_non_pre_lib_spread <- X18r1_cSNV_syn_pre_lib_med - X18r1_cSNV_nonsense_pre_lib_med

X18r2_cSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X18r2_cSNV_missense_pre_lib_med <- unname(X18r2_cSNV_missense_pre_lib_quarts[3])
X18r2_cSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X18r2_cSNV_syn_pre_lib_med <- unname(X18r2_cSNV_syn_pre_lib_quarts[3])
X18r2_cSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X18r2_cSNV_nonsense_pre_lib_med <- unname(X18r2_cSNV_nonsense_pre_lib_quarts[3])
X18r2_cSNV_syn_to_non_pre_lib_spread <- X18r2_cSNV_syn_pre_lib_med - X18r2_cSNV_nonsense_pre_lib_med

X18r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_missense_pre_lib_med <- unname(X18r1r2a_cSNV_missense_pre_lib_quarts[3])
X18r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_syn_pre_lib_med <- unname(X18r1r2a_cSNV_syn_pre_lib_quarts[3])
X18r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X18r1r2a_cSNV_nonsense_pre_lib_med <- unname(X18r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X18r1r2a_cSNV_syn_to_non_pre_lib_spread <- X18r1r2a_cSNV_syn_pre_lib_med - X18r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X18r1_tSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X18r1_tSNV_missense_pre_lib_med <- unname(X18r1_tSNV_missense_pre_lib_quarts[3])
X18r1_tSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X18r1_tSNV_syn_pre_lib_med <- unname(X18r1_tSNV_syn_pre_lib_quarts[3])
X18r1_tSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X18r1_tSNV_nonsense_pre_lib_med <- unname(X18r1_tSNV_nonsense_pre_lib_quarts[3])
X18r1_tSNV_syn_to_non_pre_lib_spread <- X18r1_tSNV_syn_pre_lib_med - X18r1_tSNV_nonsense_pre_lib_med

X18r2_tSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X18r2_tSNV_missense_pre_lib_med <- unname(X18r2_tSNV_missense_pre_lib_quarts[3])
X18r2_tSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X18r2_tSNV_syn_pre_lib_med <- unname(X18r2_tSNV_syn_pre_lib_quarts[3])
X18r2_tSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X18r2_tSNV_nonsense_pre_lib_med <- unname(X18r2_tSNV_nonsense_pre_lib_quarts[3])
X18r2_tSNV_syn_to_non_pre_lib_spread <- X18r2_tSNV_syn_pre_lib_med - X18r2_tSNV_nonsense_pre_lib_med

X18r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_missense_pre_lib_med <- unname(X18r1r2a_tSNV_missense_pre_lib_quarts[3])
X18r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_syn_pre_lib_med <- unname(X18r1r2a_tSNV_syn_pre_lib_quarts[3])
X18r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X18r1r2a_tSNV_nonsense_pre_lib_med <- unname(X18r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X18r1r2a_tSNV_syn_to_non_pre_lib_spread <- X18r1r2a_tSNV_syn_pre_lib_med - X18r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X18r1_tSNV_syn_rna_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X18r1_tSNV_syn_rna_pre_med <- unname(X18r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X18r1_tSNV_syn_rna_post_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X18r1_tSNV_syn_rna_post_med <- unname(X18r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X18r2_tSNV_syn_rna_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X18r2_tSNV_syn_rna_pre_med <- unname(X18r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X18r2_tSNV_syn_rna_post_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X18r2_tSNV_syn_rna_post_med <- unname(X18r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X18r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X18r1r2a_tSNV_syn_rna_pre_med <- unname(X18r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X18r1r2a_tSNV_syn_rna_post_quarts <- quantile(X18r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X18r1r2a_tSNV_syn_rna_post_med <- unname(X18r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X18r1_cSNV_syn_pre_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X18r1_cSNV_syn_post_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X18r1_cSNV_syn_post_lib_med
# tHDR
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X18r1_tSNV_syn_pre_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X18r1_tSNV_syn_post_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X18r1_tSNV_syn_post_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X18r1_tSNV_syn_rna_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X18r1_tSNV_syn_rna_post_med

#r2
X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X18r2_cSNV_syn_pre_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X18r2_cSNV_syn_post_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X18r2_cSNV_syn_post_lib_med
# tHDR
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X18r2_tSNV_syn_pre_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X18r2_tSNV_syn_post_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X18r2_tSNV_syn_post_lib_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X18r2_tSNV_syn_rna_pre_med
X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X18r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X18r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X18r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X18r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X18r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X18r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X18r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X18r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X18r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X18r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X18r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X18r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X18r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X18r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X18r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X18r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X18r1_prog_var_thresh5_df_r2_int_ord[which(X18r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X18r1_prog_var_thresh5_df_r2_int_ord
X18r1_prog_map_thresh5_df_r2_int_ord = which(X18r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X18r1_prog_map_thresh5_df_r2_int_ord_df = X18r1_prog_var_thresh5_df_r2_int_ord[X18r1_prog_map_thresh5_df_r2_int_ord,]
X18r1_prog_map_exon_thresh5_df_r2_int_ord = which(X18r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X18r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X18r1_prog_map_exon_thresh5_df_r2_int_ord_df = X18r1_prog_map_thresh5_df_r2_int_ord_df[X18r1_prog_map_exon_thresh5_df_r2_int_ord,]
X18r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X18r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X18r1_prog_map_thresh5_df_r2_int_ord_df[X18r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X18r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X18r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X18r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X18r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X18r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X18r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X18r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X18r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X18r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X18r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X18r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X18r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X18r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X18r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X18r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X18r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X18r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X18r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X18r1r2_cSNV_r1_post_by_r2_post_cor_s
X18r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X18r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X18r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X18r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X18r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X18r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X18r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X18r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X18r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X18r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X18r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X18r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X18r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X18r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X18r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X18r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X18r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X18r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1_cSNV_post_pre_by_cadd_cor_s
#X18r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X18r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r2_cSNV_post_pre_by_cadd_cor_s

#X18r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X18r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1_cSNV_post_lib_by_cadd_cor_s
#X18r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X18r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X18r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X18r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1_tSNV_post_pre_by_cadd_cor_s
#X18r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X18r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r2_tSNV_post_pre_by_cadd_cor_s

#X18r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X18r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1_tSNV_post_lib_by_cadd_cor_s
#X18r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X18r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X18r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X18r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X18r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X18r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X18r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X18r1_prog_var_all_lib_count
X18r1_prog_var_all_pre_count
X18r2_prog_var_all_pre_count
X18r1_prog_map_thresh5_lib_count
X18r1_prog_map_thresh5_pre_count
X18r2_prog_map_thresh5_pre_count
X18r1_prog_map_thresh5_post_count
X18r2_prog_map_thresh5_post_count
X18r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X18r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X18r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X18r1r2_cSNV_r1_post_by_r2_post_cor_s
X18r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X18r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X18r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X18r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X18r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X18r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X18r1_cSNV_post_pre_by_cadd_cor_s
X18r2_cSNV_post_pre_by_cadd_cor_s
X18r1_cSNV_post_lib_by_cadd_cor_s
X18r2_cSNV_post_lib_by_cadd_cor_s
X18r1_tSNV_post_pre_by_cadd_cor_s
X18r2_tSNV_post_pre_by_cadd_cor_s
X18r1_tSNV_post_lib_by_cadd_cor_s
X18r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X18r1r2a_cSNV_post_pre_by_cadd_cor_s
X18r1r2w_cSNV_post_pre_by_cadd_cor_s
X18r1r2a_cSNV_post_lib_by_cadd_cor_s
X18r1r2w_cSNV_post_lib_by_cadd_cor_s
X18r1r2a_tSNV_post_pre_by_cadd_cor_s
X18r1r2w_tSNV_post_pre_by_cadd_cor_s
X18r1r2a_tSNV_post_lib_by_cadd_cor_s
X18r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X18r1_cSNV_syn_to_non_post_pre_spread
X18r2_cSNV_syn_to_non_post_pre_spread
X18r1r2a_cSNV_syn_to_non_post_pre_spread
X18r1_cSNV_syn_to_non_post_lib_spread
X18r2_cSNV_syn_to_non_post_lib_spread
X18r1r2a_cSNV_syn_to_non_post_lib_spread
X18r1_tSNV_syn_to_non_post_pre_spread
X18r2_tSNV_syn_to_non_post_pre_spread
X18r1r2a_tSNV_syn_to_non_post_pre_spread
X18r1_tSNV_syn_to_non_post_lib_spread
X18r2_tSNV_syn_to_non_post_lib_spread
X18r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X18r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X18r1_prog_map_thresh5_df_r2_int_ord_df[which(X18r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X18r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df[which(X18r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df[which(X18r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df[which(X18r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X18r1_cSNV_pre_lib_cors = cor(log2(X18r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X18r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18r1_tSNV_pre_lib_cors = cor(log2(X18r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18r1_cSNV_post_lib_cors = cor(log2(X18r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X18r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X18r1_tSNV_post_lib_cors = cor(log2(X18r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X18r1_cSNV_post_pre_cors = cor(log2(X18r1_prog_map_thresh5_df$post_pseudo_freq),log2(X18r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18r1_tSNV_post_pre_cors = cor(log2(X18r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X18r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18r1_cSNV_rna_lib_cors = cor(log2(X18r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X18r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18r1_tSNV_rna_lib_cors = cor(log2(X18r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X18r1_cSNV_rna_pre_cors = cor(log2(X18r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X18r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18r1_tSNV_rna_pre_cors = cor(log2(X18r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X18r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18r1r2_cSNV_pre_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X18r1r2_tSNV_pre_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X18r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X18r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X18r1r2_cSNV_post_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X18r1r2_tSNV_post_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X18r1r2_cSNV_post_lib_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X18r1r2_tSNV_post_lib_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X18r1r2_cSNV_post_pre_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X18r1r2_tSNV_post_pre_ratio_cors = cor(log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X18r1r2_cSNV_rna_cors = cor(log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X18r1r2_tSNV_rna_cors = cor(log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X18r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X18r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X18r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X18r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X18r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X18r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X18r1_cors <- c("X18r1",X18r1_cSNV_pre_lib_cors,X18r1_tSNV_pre_lib_cors,X18r1_cSNV_post_lib_cors,X18r1_tSNV_post_lib_cors,X18r1_cSNV_post_pre_cors,X18r1_tSNV_post_pre_cors,X18r1_cSNV_rna_lib_cors,X18r1_tSNV_rna_lib_cors,X18r1_cSNV_rna_pre_cors,X18r1_tSNV_rna_pre_cors,X18r1r2_cSNV_pre_cors,X18r1r2_tSNV_pre_cors,X18r1r2_cSNV_pre_lib_ratio_cors,X18r1r2_tSNV_pre_lib_ratio_cors,X18r1r2_cSNV_post_cors,X18r1r2_tSNV_post_cors,X18r1r2_cSNV_post_lib_ratio_cors,X18r1r2_tSNV_post_lib_ratio_cors,X18r1r2_cSNV_post_pre_ratio_cors,X18r1r2_tSNV_post_pre_ratio_cors,X18r1r2_cSNV_rna_cors,X18r1r2_tSNV_rna_cors,X18r1r2_tSNV_rna_pre_ratio_cors,X18r1_cSNV_pre_lib_ratio_cadd_cors,X18r1_tSNV_pre_lib_ratio_cadd_cors,X18r1_cSNV_post_lib_ratio_cadd_cors,X18r1_tSNV_post_lib_ratio_cadd_cors,X18r1_cSNV_post_pre_ratio_cadd_cors,X18r1_tSNV_post_pre_ratio_cadd_cors,X18r1_cSNV_post_pre_ratio_cadd_missense_cors,X18r1_tSNV_post_pre_ratio_cadd_missense_cors,X18r1_cSNV_post_pre_ratio_polyphen_missense_cors,X18r1_tSNV_post_pre_ratio_polyphen_missense_cors,X18r1_cSNV_post_pre_ratio_grantham_missense_cors,X18r1_tSNV_post_pre_ratio_grantham_missense_cors,X18r1r2a_cSNV_pre_lib_ratio_cadd_cors,X18r1r2a_tSNV_pre_lib_ratio_cadd_cors,X18r1r2a_cSNV_post_lib_ratio_cadd_cors,X18r1r2a_tSNV_post_lib_ratio_cadd_cors,X18r1r2a_cSNV_post_pre_ratio_cadd_cors,X18r1r2a_tSNV_post_pre_ratio_cadd_cors,X18r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X18r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X18r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X18r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X18r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X18r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X18r1r2w_cSNV_pre_lib_ratio_cadd_cors,X18r1r2w_cSNV_post_lib_ratio_cadd_cors,X18r1r2w_cSNV_post_pre_ratio_cadd_cors,X18r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X18r2_cSNV_pre_lib_cors = cor(log2(X18r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X18r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18r2_tSNV_pre_lib_cors = cor(log2(X18r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18r2_cSNV_post_lib_cors = cor(log2(X18r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X18r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X18r2_tSNV_post_lib_cors = cor(log2(X18r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X18r2_cSNV_post_pre_cors = cor(log2(X18r2_prog_map_thresh5_df$post_pseudo_freq),log2(X18r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18r2_tSNV_post_pre_cors = cor(log2(X18r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X18r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18r2_cSNV_rna_lib_cors = cor(log2(X18r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X18r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18r2_tSNV_rna_lib_cors = cor(log2(X18r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X18r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X18r2_cSNV_rna_pre_cors = cor(log2(X18r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X18r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18r2_tSNV_rna_pre_cors = cor(log2(X18r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X18r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X18r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X18r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X18r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X18r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X18r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X18r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X18r2_cors <- c("X18r2",X18r2_cSNV_pre_lib_cors,X18r2_tSNV_pre_lib_cors,X18r2_cSNV_post_lib_cors,X18r2_tSNV_post_lib_cors,X18r2_cSNV_post_pre_cors,X18r2_tSNV_post_pre_cors,X18r2_cSNV_rna_lib_cors,X18r2_tSNV_rna_lib_cors,X18r2_cSNV_rna_pre_cors,X18r2_tSNV_rna_pre_cors,X18r1r2_cSNV_pre_cors,X18r1r2_tSNV_pre_cors,X18r1r2_cSNV_pre_lib_ratio_cors,X18r1r2_tSNV_pre_lib_ratio_cors,X18r1r2_cSNV_post_cors,X18r1r2_tSNV_post_cors,X18r1r2_cSNV_post_lib_ratio_cors,X18r1r2_tSNV_post_lib_ratio_cors,X18r1r2_cSNV_post_pre_ratio_cors,X18r1r2_tSNV_post_pre_ratio_cors,X18r1r2_cSNV_rna_cors,X18r1r2_tSNV_rna_cors,X18r1r2_tSNV_rna_pre_ratio_cors,X18r2_cSNV_pre_lib_ratio_cadd_cors,X18r2_tSNV_pre_lib_ratio_cadd_cors,X18r2_cSNV_post_lib_ratio_cadd_cors,X18r2_tSNV_post_lib_ratio_cadd_cors,X18r2_cSNV_post_pre_ratio_cadd_cors,X18r2_tSNV_post_pre_ratio_cadd_cors,X18r2_cSNV_post_pre_ratio_cadd_missense_cors,X18r2_tSNV_post_pre_ratio_cadd_missense_cors,X18r2_cSNV_post_pre_ratio_polyphen_missense_cors,X18r2_tSNV_post_pre_ratio_polyphen_missense_cors,X18r2_cSNV_post_pre_ratio_grantham_missense_cors,X18r2_tSNV_post_pre_ratio_grantham_missense_cors,X18r1r2a_cSNV_pre_lib_ratio_cadd_cors,X18r1r2a_tSNV_pre_lib_ratio_cadd_cors,X18r1r2a_cSNV_post_lib_ratio_cadd_cors,X18r1r2a_tSNV_post_lib_ratio_cadd_cors,X18r1r2a_cSNV_post_pre_ratio_cadd_cors,X18r1r2a_tSNV_post_pre_ratio_cadd_cors,X18r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X18r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X18r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X18r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X18r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X18r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X18r1r2w_cSNV_pre_lib_ratio_cadd_cors,X18r1r2w_cSNV_post_lib_ratio_cadd_cors,X18r1r2w_cSNV_post_pre_ratio_cadd_cors,X18r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X18r1)
rm(X18r2)
gc()
X19r1_file <- paste(experiment_dir_171011,'X19r1','_annotated.txt',sep='')
X19r2_file <- paste(experiment_dir_171011,'X19r2','_annotated.txt',sep='')
X19r1 <- read.table(X19r1_file, header=TRUE, sep="\t")
X19r2 <- read.table(X19r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X19 <- editing_info[which(editing_info$amplicon == 'X19'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X19_HDR_5_SNV = as.character(editing_info_X19$HDR_5_SNV)
X19_HDR_3_SNV = as.character(editing_info_X19$HDR_3_SNV)
#X19_cut_pos = as.character(editing_info_X19$cut_pos)
X19_cut_end = as.character(editing_info_X19$cut_end)
X19_mut_start = as.character(editing_info_X19$mut_start)
X19_mut_end = as.character(editing_info_X19$mut_end)
### Replicate 1
X19r1_cSNV_all <- which(X19r1[,'c_hdr_snv']=='True')
X19r1_cSNV_all_df = X19r1[X19r1_cSNV_all,]
X19r1_prog_var_all <- which(X19r1[,'all_hdr_variant']=='True' & X19r1[,'edit_string']!='-WT')
X19r1_prog_var_all_df = X19r1[X19r1_prog_var_all,]
X19r1_prog_map_all = which(X19r1_prog_var_all_df[,'pos']!='REF')
X19r1_prog_map_all_df = X19r1_prog_var_all_df[X19r1_prog_map_all,]
X19r1_prog_map_exon_all = which(X19r1_prog_map_all_df[,'cDNApos']!='REF' & X19r1_prog_map_all_df[,'cDNApos']!='NA')
X19r1_prog_map_exon_all_df = X19r1_prog_map_all_df[X19r1_prog_map_exon_all,]
X19r1_prog_map_CADD = which(X19r1_prog_map_all_df[,'CADD.phred']!='NA')
X19r1_prog_map_CADD_df = X19r1_prog_map_all_df[X19r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X19r1_prog_var_thresh5 <- which(as.numeric(as.character(X19r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X19r1_prog_var_thresh5_df = X19r1_prog_var_all_df[X19r1_prog_var_thresh5,]
X19r1_prog_map_thresh5 <- which(as.numeric(as.character(X19r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X19r1_prog_map_thresh5_df = X19r1_prog_map_all_df[X19r1_prog_map_thresh5,]
X19r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X19r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X19r1_prog_map_exon_thresh5_df = X19r1_prog_map_exon_all_df[X19r1_prog_map_exon_thresh5,]
X19r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X19r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X19r1_prog_map_CADD_thresh5_df = X19r1_prog_map_CADD_df[X19r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X19r1_prog_var_all_lib_count = length(X19r1_prog_var_all_df$lib)
X19r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X19r1_prog_var_all_min_lib_counts = min(X19r1_prog_var_all_df$lib)
X19r1_prog_var_all_min_lib_counts
X19r1_prog_var_all_max_lib_counts = max(X19r1_prog_var_all_df$lib)
X19r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X19r1_prog_map_all_lib_count = length(X19r1_prog_map_all_df$lib)
X19r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X19r1_prog_map_all_min_lib_counts = min(X19r1_prog_map_all_df$lib)
X19r1_prog_map_all_min_lib_counts
X19r1_prog_map_all_max_lib_counts = max(X19r1_prog_map_all_df$lib)
X19r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X19r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X19r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X19r1_prog_var_all_pre_count = length(X19r1_prog_var_all_df$pre)
X19r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X19r1_prog_var_all_min_pre_counts = min(X19r1_prog_var_all_df$pre)
X19r1_prog_var_all_min_pre_counts
X19r1_prog_var_all_max_pre_counts = max(X19r1_prog_var_all_df$pre)
X19r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X19r1_prog_map_all_pre_count = length(X19r1_prog_map_all_df$pre)
X19r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X19r1_prog_map_all_min_pre_counts = min(X19r1_prog_map_all_df$pre)
X19r1_prog_map_all_min_pre_counts
X19r1_prog_map_all_max_pre_counts = max(X19r1_prog_map_all_df$pre)
X19r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X19r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X19r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X19r1_prog_map_all_post_count = length(X19r1_prog_map_all_df$post)
X19r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X19r1_prog_map_all_min_post_counts = min(X19r1_prog_map_all_df$post)
X19r1_prog_map_all_min_post_counts
X19r1_prog_map_all_max_post_counts = max(X19r1_prog_map_all_df$post)
X19r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X19r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X19r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X19r1_prog_map_all_syn_df <- X19r1_prog_map_all_df[which(X19r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X19r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X19r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X19r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X19r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X19r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X19r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X19r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X19r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X19r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X19r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X19r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X19r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X19r1_prog_map_all_min_rna_counts = min(X19r1_prog_map_exon_all_df$tHDR_rna)
X19r1_prog_map_all_min_rna_counts
X19r1_prog_map_all_max_rna_counts = max(X19r1_prog_map_exon_all_df$tHDR_rna)
X19r1_prog_map_all_max_rna_counts
X19r1_prog_map_all_min_rna_pseudo_freq = min(X19r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19r1_prog_map_all_min_rna_pseudo_freq
X19r1_prog_map_all_max_rna_pseudo_freq = max(X19r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19r1_prog_map_all_max_rna_pseudo_freq
X19r1_prog_map_all_min_rna_pre_ratio = min(X19r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19r1_prog_map_all_min_rna_pre_ratio
X19r1_prog_map_all_max_rna_pre_ratio = max(X19r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19r1_prog_map_all_max_rna_pre_ratio
X19r1_prog_map_all_min_rna_post_ratio = min(X19r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19r1_prog_map_all_min_rna_post_ratio
X19r1_prog_map_all_max_rna_post_ratio = max(X19r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X19r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X19r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X19r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X19r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X19r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X19r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X19r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X19r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X19r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X19r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X19r1_prog_map_all_df$post_pre_ratio),log2(X19r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X19r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X19r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X19r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X19r1_cSNV_all_corr_pre_count = length(X19r1_cSNV_all_df$corr_pre)
X19r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X19r1_cSNV_all_min_corr_pre_counts = min(X19r1_cSNV_all_df$corr_pre)
X19r1_cSNV_all_min_corr_pre_counts
X19r1_cSNV_all_max_corr_pre_counts = max(X19r1_cSNV_all_df$corr_pre)
X19r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X19r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X19r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X19r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X19r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X19r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_cSNV_all_corr_post_count = length(X19r1_cSNV_all_df$corr_post)
X19r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X19r1_cSNV_all_min_corr_post_counts = min(X19r1_cSNV_all_df$corr_post)
X19r1_cSNV_all_min_corr_post_counts
X19r1_cSNV_all_max_corr_post_counts = max(X19r1_cSNV_all_df$corr_post)
X19r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X19r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X19r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X19r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X19r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X19r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X19r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X19_p_hdr_snv = paste('p_hdr_',X19_cut_end,'_snv',sep='')
X19r1_pSNV_all <- which(X19r1[,X19_p_hdr_snv]=='True')
X19r1_pSNV_all_df = X19r1[X19r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_pSNV_all_lib_count = length(X19r1_pSNV_all_df$lib)
X19r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X19r1_pSNV_all_min_lib_counts = min(X19r1_pSNV_all_df$lib)
X19r1_pSNV_all_min_lib_counts
X19r1_pSNV_all_max_lib_counts = max(X19r1_pSNV_all_df$lib)
X19r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X19r1_pSNV_all_pre_count = length(X19r1_pSNV_all_df$pre)
X19r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X19r1_pSNV_all_min_pre_counts = min(X19r1_pSNV_all_df$pre)
X19r1_pSNV_all_min_pre_counts
X19r1_pSNV_all_max_pre_counts = max(X19r1_pSNV_all_df$pre)
X19r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X19r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X19r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_pSNV_all_post_count = length(X19r1_pSNV_all_df$post)
X19r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X19r1_pSNV_all_min_post_counts = min(X19r1_pSNV_all_df$post)
X19r1_pSNV_all_min_post_counts
X19r1_pSNV_all_max_post_counts = max(X19r1_pSNV_all_df$post)
X19r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X19r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X19r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_prog_map_thresh5_lib_count = length(X19r1_prog_map_thresh5_df$lib)
X19r1_prog_map_thresh5_lib_count
X19r1_prog_map_thresh5_min_lib_counts = min(X19r1_prog_map_thresh5_df$lib)
X19r1_prog_map_thresh5_min_lib_counts
X19r1_prog_map_thresh5_max_lib_counts = max(X19r1_prog_map_thresh5_df$lib)
X19r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X19r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X19r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_prog_map_thresh5_pre_count = length(X19r1_prog_map_thresh5_df$pre)
X19r1_prog_map_thresh5_pre_count
X19r1_prog_map_thresh5_min_pre_counts = min(X19r1_prog_map_thresh5_df$pre)
X19r1_prog_map_thresh5_min_pre_counts
X19r1_prog_map_thresh5_max_pre_counts = max(X19r1_prog_map_thresh5_df$pre)
X19r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r1_prog_map_thresh5_post_count = length(X19r1_prog_map_thresh5_df$post)
X19r1_prog_map_thresh5_post_count
X19r1_prog_map_thresh5_min_post_counts = min(X19r1_prog_map_thresh5_df$post)
X19r1_prog_map_thresh5_min_post_counts
X19r1_prog_map_thresh5_max_post_counts = max(X19r1_prog_map_thresh5_df$post)
X19r1_prog_map_thresh5_max_post_counts
X19r1_prog_map_thresh5_corr_post_count = length(X19r1_cSNV_all_df$corr_post)
X19r1_prog_map_thresh5_corr_post_count
X19r1_prog_map_thresh5_min_corr_post_counts = min(X19r1_cSNV_all_df$corr_post)
X19r1_prog_map_thresh5_min_corr_post_counts
X19r1_prog_map_thresh5_max_corr_post_counts = max(X19r1_cSNV_all_df$corr_post)
X19r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X19r1_pSNV_thresh5 <- which(X19r1[,X19_p_hdr_snv]=='True' & as.numeric(as.character(X19r1[,'pre_freq']))>=0.00001)
X19r1_pSNV_thresh5_df = X19r1[X19r1_pSNV_thresh5,]
X19r1_pSNV_thresh5_lib_count = length(X19r1_pSNV_thresh5_df$lib)
X19r1_pSNV_thresh5_lib_count
X19r1_pSNV_thresh5_min_lib_counts = min(X19r1_pSNV_thresh5_df$lib)
X19r1_pSNV_thresh5_min_lib_counts
X19r1_pSNV_thresh5_max_lib_counts = max(X19r1_pSNV_thresh5_df$lib)
X19r1_pSNV_thresh5_max_lib_counts
X19r1_pSNV_thresh5_pre_count = length(X19r1_pSNV_thresh5_df$pre)
X19r1_pSNV_thresh5_pre_count
X19r1_pSNV_thresh5_min_pre_counts = min(X19r1_pSNV_thresh5_df$pre)
X19r1_pSNV_thresh5_min_pre_counts
X19r1_pSNV_thresh5_max_pre_counts = max(X19r1_pSNV_thresh5_df$pre)
X19r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X19r1_pSNV_thresh5_post_count = length(X19r1_pSNV_thresh5_df$post)
X19r1_pSNV_thresh5_post_count
X19r1_pSNV_thresh5_min_post_counts = min(X19r1_pSNV_thresh5_df$post)
X19r1_pSNV_thresh5_min_post_counts
X19r1_pSNV_thresh5_max_post_counts = max(X19r1_pSNV_thresh5_df$post)
X19r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X19r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X19r1_pSNV_thresh5_post_pos

### Replicate 2
X19r2_cSNV_all <- which(X19r2[,'c_hdr_snv']=='True')
X19r2_cSNV_all_df = X19r2[X19r2_cSNV_all,]
X19r2_prog_var_all <- which(X19r2[,'all_hdr_variant']=='True' & X19r2[,'edit_string']!='-WT')
X19r2_prog_var_all_df = X19r2[X19r2_prog_var_all,]
X19r2_prog_map_all = which(X19r2_prog_var_all_df[,'pos']!='REF')
X19r2_prog_map_all_df = X19r2_prog_var_all_df[X19r2_prog_map_all,]
X19r2_prog_map_exon_all = which(X19r2_prog_map_all_df[,'cDNApos']!='REF' & X19r2_prog_map_all_df[,'cDNApos']!='NA')
X19r2_prog_map_exon_all_df = X19r2_prog_map_all_df[X19r2_prog_map_exon_all,]
X19r2_prog_map_CADD = which(X19r2_prog_map_all_df[,'CADD.phred']!='NA')
X19r2_prog_map_CADD_df = X19r2_prog_map_all_df[X19r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X19r2_prog_var_thresh5 <- which(as.numeric(as.character(X19r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X19r2_prog_var_thresh5_df = X19r2_prog_var_all_df[X19r2_prog_var_thresh5,]
X19r2_prog_map_thresh5 <- which(as.numeric(as.character(X19r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X19r2_prog_map_thresh5_df = X19r2_prog_map_all_df[X19r2_prog_map_thresh5,]
X19r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X19r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X19r2_prog_map_exon_thresh5_df = X19r2_prog_map_exon_all_df[X19r2_prog_map_exon_thresh5,]
X19r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X19r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X19r2_prog_map_CADD_thresh5_df = X19r2_prog_map_CADD_df[X19r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X19r2_prog_var_all_lib_count = length(X19r2_prog_var_all_df$lib)
X19r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X19r2_prog_var_all_min_lib_counts = min(X19r2_prog_var_all_df$lib)
X19r2_prog_var_all_min_lib_counts
X19r2_prog_var_all_max_lib_counts = max(X19r2_prog_var_all_df$lib)
X19r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X19r2_prog_map_all_lib_count = length(X19r2_prog_map_all_df$lib)
X19r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X19r2_prog_map_all_min_lib_counts = min(X19r2_prog_map_all_df$lib)
X19r2_prog_map_all_min_lib_counts
X19r2_prog_map_all_max_lib_counts = max(X19r2_prog_map_all_df$lib)
X19r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X19r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X19r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X19r2_prog_var_all_pre_count = length(X19r2_prog_var_all_df$pre)
X19r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X19r2_prog_var_all_min_pre_counts = min(X19r2_prog_var_all_df$pre)
X19r2_prog_var_all_min_pre_counts
X19r2_prog_var_all_max_pre_counts = max(X19r2_prog_var_all_df$pre)
X19r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X19r2_prog_map_all_pre_count = length(X19r2_prog_map_all_df$pre)
X19r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X19r2_prog_map_all_min_pre_counts = min(X19r2_prog_map_all_df$pre)
X19r2_prog_map_all_min_pre_counts
X19r2_prog_map_all_max_pre_counts = max(X19r2_prog_map_all_df$pre)
X19r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X19r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X19r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X19r2_prog_map_all_post_count = length(X19r2_prog_map_all_df$post)
X19r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X19r2_prog_map_all_min_post_counts = min(X19r2_prog_map_all_df$post)
X19r2_prog_map_all_min_post_counts
X19r2_prog_map_all_max_post_counts = max(X19r2_prog_map_all_df$post)
X19r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X19r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X19r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X19r2_prog_map_all_syn_df <- X19r2_prog_map_all_df[which(X19r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X19r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X19r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X19r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X19r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X19r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X19r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X19r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X19r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X19r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X19r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X19r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X19r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X19r2_prog_map_all_min_rna_counts = min(X19r2_prog_map_exon_all_df$tHDR_rna)
X19r2_prog_map_all_min_rna_counts
X19r2_prog_map_all_max_rna_counts = max(X19r2_prog_map_exon_all_df$tHDR_rna)
X19r2_prog_map_all_max_rna_counts
X19r2_prog_map_all_min_rna_pseudo_freq = min(X19r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19r2_prog_map_all_min_rna_pseudo_freq
X19r2_prog_map_all_max_rna_pseudo_freq = max(X19r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19r2_prog_map_all_max_rna_pseudo_freq
X19r2_prog_map_all_min_rna_pre_ratio = min(X19r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19r2_prog_map_all_min_rna_pre_ratio
X19r2_prog_map_all_max_rna_pre_ratio = max(X19r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19r2_prog_map_all_max_rna_pre_ratio
X19r2_prog_map_all_min_rna_post_ratio = min(X19r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19r2_prog_map_all_min_rna_post_ratio
X19r2_prog_map_all_max_rna_post_ratio = max(X19r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X19r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X19r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X19r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X19r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X19r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X19r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X19r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X19r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X19r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X19r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X19r2_prog_map_all_df$post_pre_ratio),log2(X19r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X19r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X19r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X19r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X19r2_cSNV_all_corr_pre_count = length(X19r2_cSNV_all_df$corr_pre)
X19r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X19r2_cSNV_all_min_corr_pre_counts = min(X19r2_cSNV_all_df$corr_pre)
X19r2_cSNV_all_min_corr_pre_counts
X19r2_cSNV_all_max_corr_pre_counts = max(X19r2_cSNV_all_df$corr_pre)
X19r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X19r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X19r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X19r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X19r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X19r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_cSNV_all_corr_post_count = length(X19r2_cSNV_all_df$corr_post)
X19r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X19r2_cSNV_all_min_corr_post_counts = min(X19r2_cSNV_all_df$corr_post)
X19r2_cSNV_all_min_corr_post_counts
X19r2_cSNV_all_max_corr_post_counts = max(X19r2_cSNV_all_df$corr_post)
X19r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X19r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X19r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X19r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X19r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X19r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X19r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X19_p_hdr_snv = paste('p_hdr_',X19_cut_end,'_snv',sep='')
X19r2_pSNV_all <- which(X19r2[,X19_p_hdr_snv]=='True')
X19r2_pSNV_all_df = X19r2[X19r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_pSNV_all_lib_count = length(X19r2_pSNV_all_df$lib)
X19r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X19r2_pSNV_all_min_lib_counts = min(X19r2_pSNV_all_df$lib)
X19r2_pSNV_all_min_lib_counts
X19r2_pSNV_all_max_lib_counts = max(X19r2_pSNV_all_df$lib)
X19r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X19r2_pSNV_all_pre_count = length(X19r2_pSNV_all_df$pre)
X19r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X19r2_pSNV_all_min_pre_counts = min(X19r2_pSNV_all_df$pre)
X19r2_pSNV_all_min_pre_counts
X19r2_pSNV_all_max_pre_counts = max(X19r2_pSNV_all_df$pre)
X19r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X19r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X19r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_pSNV_all_post_count = length(X19r2_pSNV_all_df$post)
X19r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X19r2_pSNV_all_min_post_counts = min(X19r2_pSNV_all_df$post)
X19r2_pSNV_all_min_post_counts
X19r2_pSNV_all_max_post_counts = max(X19r2_pSNV_all_df$post)
X19r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X19r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X19r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_prog_map_thresh5_lib_count = length(X19r2_prog_map_thresh5_df$lib)
X19r2_prog_map_thresh5_lib_count
X19r2_prog_map_thresh5_min_lib_counts = min(X19r2_prog_map_thresh5_df$lib)
X19r2_prog_map_thresh5_min_lib_counts
X19r2_prog_map_thresh5_max_lib_counts = max(X19r2_prog_map_thresh5_df$lib)
X19r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X19r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X19r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_prog_map_thresh5_pre_count = length(X19r2_prog_map_thresh5_df$pre)
X19r2_prog_map_thresh5_pre_count
X19r2_prog_map_thresh5_min_pre_counts = min(X19r2_prog_map_thresh5_df$pre)
X19r2_prog_map_thresh5_min_pre_counts
X19r2_prog_map_thresh5_max_pre_counts = max(X19r2_prog_map_thresh5_df$pre)
X19r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19r2_prog_map_thresh5_post_count = length(X19r2_prog_map_thresh5_df$post)
X19r2_prog_map_thresh5_post_count
X19r2_prog_map_thresh5_min_post_counts = min(X19r2_prog_map_thresh5_df$post)
X19r2_prog_map_thresh5_min_post_counts
X19r2_prog_map_thresh5_max_post_counts = max(X19r2_prog_map_thresh5_df$post)
X19r2_prog_map_thresh5_max_post_counts
X19r2_prog_map_thresh5_corr_post_count = length(X19r2_prog_map_thresh5_df$corr_post)
X19r2_prog_map_thresh5_corr_post_count
X19r2_prog_map_thresh5_min_corr_post_counts = min(X19r2_prog_map_thresh5_df$corr_post)
X19r2_prog_map_thresh5_min_corr_post_counts
X19r2_prog_map_thresh5_max_corr_post_counts = max(X19r2_prog_map_thresh5_df$corr_post)
X19r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X19r2_pSNV_thresh5 <- which(X19r2[,X19_p_hdr_snv]=='True' & as.numeric(as.character(X19r2[,'pre_freq']))>=0.00001)
X19r2_pSNV_thresh5_df = X19r2[X19r2_pSNV_thresh5,]
X19r2_pSNV_thresh5_lib_count = length(X19r2_pSNV_thresh5_df$lib)
X19r2_pSNV_thresh5_lib_count
X19r2_pSNV_thresh5_min_lib_counts = min(X19r2_pSNV_thresh5_df$lib)
X19r2_pSNV_thresh5_min_lib_counts
X19r2_pSNV_thresh5_max_lib_counts = max(X19r2_pSNV_thresh5_df$lib)
X19r2_pSNV_thresh5_max_lib_counts
X19r2_pSNV_thresh5_pre_count = length(X19r2_pSNV_thresh5_df$pre)
X19r2_pSNV_thresh5_pre_count
X19r2_pSNV_thresh5_min_pre_counts = min(X19r2_pSNV_thresh5_df$pre)
X19r2_pSNV_thresh5_min_pre_counts
X19r2_pSNV_thresh5_max_pre_counts = max(X19r2_pSNV_thresh5_df$pre)
X19r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X19r2_pSNV_thresh5_post_count = length(X19r2_pSNV_thresh5_df$post)
X19r2_pSNV_thresh5_post_count
X19r2_pSNV_thresh5_min_post_counts = min(X19r2_pSNV_thresh5_df$post)
X19r2_pSNV_thresh5_min_post_counts
X19r2_pSNV_thresh5_max_post_counts = max(X19r2_pSNV_thresh5_df$post)
X19r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X19r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X19r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X19r1_prog_var_thresh5_df:
X19r1_prog_var_thresh5_df_r2_int <- X19r1_prog_var_thresh5_df[which(X19r1_prog_var_thresh5_df$variant %in% X19r2_prog_var_thresh5_df$variant),]
#Intersection variants of X19r2_prog_var_thresh5_df:
X19r2_prog_var_thresh5_df_r1_int <- X19r2_prog_var_thresh5_df[which(X19r2_prog_var_thresh5_df$variant %in% X19r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X19r1_prog_var_thresh5_df_r2_int_ord <- X19r1_prog_var_thresh5_df_r2_int[order(X19r1_prog_var_thresh5_df_r2_int$variant),]
X19r2_prog_var_thresh5_df_r1_int_ord <- X19r2_prog_var_thresh5_df_r1_int[order(X19r2_prog_var_thresh5_df_r1_int$variant),]

dim(X19r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X19r1r2int_prog_var_thresh5_pre_count <- dim(X19r1_prog_var_thresh5_df_r2_int)[1] 
X19r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X19r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X19r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X19r2_prog_var_thresh5_df_r1_int_ord$pre
X19r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X19r2_prog_var_thresh5_df_r1_int_ord$lib
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X19r2_prog_var_thresh5_df_r1_int_ord$post
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X19r2_prog_var_thresh5_df_r1_int_ord$rna
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X19r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X19r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X19r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$post_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X19r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X19r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X19r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X19r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X19r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X19r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X19r2_prog_var_thresh5_df_r1_int_ord$corr_post
X19r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X19r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X19r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X19r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X19r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X19r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X19r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X19r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X19r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X19r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X19r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X19r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X19r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X19r1_cSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X19r1_cSNV_missense_post_pre_med <- unname(X19r1_cSNV_missense_post_pre_quarts[3])
X19r1_cSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X19r1_cSNV_syn_post_pre_med <- unname(X19r1_cSNV_syn_post_pre_quarts[3])
X19r1_cSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X19r1_cSNV_nonsense_post_pre_med <- unname(X19r1_cSNV_nonsense_post_pre_quarts[3])
X19r1_cSNV_syn_to_non_post_pre_spread <- X19r1_cSNV_syn_post_pre_med - X19r1_cSNV_nonsense_post_pre_med

X19r2_cSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X19r2_cSNV_missense_post_pre_med <- unname(X19r2_cSNV_missense_post_pre_quarts[3])
X19r2_cSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X19r2_cSNV_syn_post_pre_med <- unname(X19r2_cSNV_syn_post_pre_quarts[3])
X19r2_cSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X19r2_cSNV_nonsense_post_pre_med <- unname(X19r2_cSNV_nonsense_post_pre_quarts[3])
X19r2_cSNV_syn_to_non_post_pre_spread <- X19r2_cSNV_syn_post_pre_med - X19r2_cSNV_nonsense_post_pre_med

X19r1r2a_cSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X19r1r2a_cSNV_missense_post_pre_med <- unname(X19r1r2a_cSNV_missense_post_pre_quarts[3])
X19r1r2a_cSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X19r1r2a_cSNV_syn_post_pre_med <- unname(X19r1r2a_cSNV_syn_post_pre_quarts[3])
X19r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X19r1r2a_cSNV_nonsense_post_pre_med <- unname(X19r1r2a_cSNV_nonsense_post_pre_quarts[3])
X19r1r2a_cSNV_syn_to_non_post_pre_spread <- X19r1r2a_cSNV_syn_post_pre_med - X19r1r2a_cSNV_nonsense_post_pre_med

X19r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_cSNV_missense_post_pre_med <- unname(X19r1r2pw_cSNV_missense_post_pre_quarts[3])
X19r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_cSNV_syn_post_pre_med <- unname(X19r1r2pw_cSNV_syn_post_pre_quarts[3])
X19r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_cSNV_nonsense_post_pre_med <- unname(X19r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X19r1r2pw_cSNV_syn_to_non_post_pre_spread <- X19r1r2pw_cSNV_syn_post_pre_med - X19r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X19r1_tSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X19r1_tSNV_missense_post_pre_med <- unname(X19r1_tSNV_missense_post_pre_quarts[3])
X19r1_tSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X19r1_tSNV_syn_post_pre_med <- unname(X19r1_tSNV_syn_post_pre_quarts[3])
X19r1_tSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X19r1_tSNV_nonsense_post_pre_med <- unname(X19r1_tSNV_nonsense_post_pre_quarts[3])
X19r1_tSNV_syn_to_non_post_pre_spread <- X19r1_tSNV_syn_post_pre_med - X19r1_tSNV_nonsense_post_pre_med

X19r2_tSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X19r2_tSNV_missense_post_pre_med <- unname(X19r2_tSNV_missense_post_pre_quarts[3])
X19r2_tSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X19r2_tSNV_syn_post_pre_med <- unname(X19r2_tSNV_syn_post_pre_quarts[3])
X19r2_tSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X19r2_tSNV_nonsense_post_pre_med <- unname(X19r2_tSNV_nonsense_post_pre_quarts[3])
X19r2_tSNV_syn_to_non_post_pre_spread <- X19r2_tSNV_syn_post_pre_med - X19r2_tSNV_nonsense_post_pre_med

X19r1r2a_tSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X19r1r2a_tSNV_missense_post_pre_med <- unname(X19r1r2a_tSNV_missense_post_pre_quarts[3])
X19r1r2a_tSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X19r1r2a_tSNV_syn_post_pre_med <- unname(X19r1r2a_tSNV_syn_post_pre_quarts[3])
X19r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X19r1r2a_tSNV_nonsense_post_pre_med <- unname(X19r1r2a_tSNV_nonsense_post_pre_quarts[3])
X19r1r2a_tSNV_syn_to_non_post_pre_spread <- X19r1r2a_tSNV_syn_post_pre_med - X19r1r2a_tSNV_nonsense_post_pre_med

X19r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_tSNV_missense_post_pre_med <- unname(X19r1r2pw_tSNV_missense_post_pre_quarts[3])
X19r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_tSNV_syn_post_pre_med <- unname(X19r1r2pw_tSNV_syn_post_pre_quarts[3])
X19r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X19r1r2pw_tSNV_nonsense_post_pre_med <- unname(X19r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X19r1r2pw_tSNV_syn_to_non_post_pre_spread <- X19r1r2pw_tSNV_syn_post_pre_med - X19r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X19r1_cSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X19r1_cSNV_missense_post_lib_med <- unname(X19r1_cSNV_missense_post_lib_quarts[3])
X19r1_cSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X19r1_cSNV_syn_post_lib_med <- unname(X19r1_cSNV_syn_post_lib_quarts[3])
X19r1_cSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X19r1_cSNV_nonsense_post_lib_med <- unname(X19r1_cSNV_nonsense_post_lib_quarts[3])
X19r1_cSNV_syn_to_non_post_lib_spread <- X19r1_cSNV_syn_post_lib_med - X19r1_cSNV_nonsense_post_lib_med

X19r2_cSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X19r2_cSNV_missense_post_lib_med <- unname(X19r2_cSNV_missense_post_lib_quarts[3])
X19r2_cSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X19r2_cSNV_syn_post_lib_med <- unname(X19r2_cSNV_syn_post_lib_quarts[3])
X19r2_cSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X19r2_cSNV_nonsense_post_lib_med <- unname(X19r2_cSNV_nonsense_post_lib_quarts[3])
X19r2_cSNV_syn_to_non_post_lib_spread <- X19r2_cSNV_syn_post_lib_med - X19r2_cSNV_nonsense_post_lib_med

X19r1r2a_cSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_missense_post_lib_med <- unname(X19r1r2a_cSNV_missense_post_lib_quarts[3])
X19r1r2a_cSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_syn_post_lib_med <- unname(X19r1r2a_cSNV_syn_post_lib_quarts[3])
X19r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_nonsense_post_lib_med <- unname(X19r1r2a_cSNV_nonsense_post_lib_quarts[3])
X19r1r2a_cSNV_syn_to_non_post_lib_spread <- X19r1r2a_cSNV_syn_post_lib_med - X19r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X19r1_tSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X19r1_tSNV_missense_post_lib_med <- unname(X19r1_tSNV_missense_post_lib_quarts[3])
X19r1_tSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X19r1_tSNV_syn_post_lib_med <- unname(X19r1_tSNV_syn_post_lib_quarts[3])
X19r1_tSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X19r1_tSNV_nonsense_post_lib_med <- unname(X19r1_tSNV_nonsense_post_lib_quarts[3])
X19r1_tSNV_syn_to_non_post_lib_spread <- X19r1_tSNV_syn_post_lib_med - X19r1_tSNV_nonsense_post_lib_med

X19r2_tSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X19r2_tSNV_missense_post_lib_med <- unname(X19r2_tSNV_missense_post_lib_quarts[3])
X19r2_tSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X19r2_tSNV_syn_post_lib_med <- unname(X19r2_tSNV_syn_post_lib_quarts[3])
X19r2_tSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X19r2_tSNV_nonsense_post_lib_med <- unname(X19r2_tSNV_nonsense_post_lib_quarts[3])
X19r2_tSNV_syn_to_non_post_lib_spread <- X19r2_tSNV_syn_post_lib_med - X19r2_tSNV_nonsense_post_lib_med

X19r1r2a_tSNV_missense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_missense_post_lib_med <- unname(X19r1r2a_tSNV_missense_post_lib_quarts[3])
X19r1r2a_tSNV_syn_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_syn_post_lib_med <- unname(X19r1r2a_tSNV_syn_post_lib_quarts[3])
X19r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_nonsense_post_lib_med <- unname(X19r1r2a_tSNV_nonsense_post_lib_quarts[3])
X19r1r2a_tSNV_syn_to_non_post_lib_spread <- X19r1r2a_tSNV_syn_post_lib_med - X19r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X19r1_cSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X19r1_cSNV_missense_pre_lib_med <- unname(X19r1_cSNV_missense_pre_lib_quarts[3])
X19r1_cSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X19r1_cSNV_syn_pre_lib_med <- unname(X19r1_cSNV_syn_pre_lib_quarts[3])
X19r1_cSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X19r1_cSNV_nonsense_pre_lib_med <- unname(X19r1_cSNV_nonsense_pre_lib_quarts[3])
X19r1_cSNV_syn_to_non_pre_lib_spread <- X19r1_cSNV_syn_pre_lib_med - X19r1_cSNV_nonsense_pre_lib_med

X19r2_cSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X19r2_cSNV_missense_pre_lib_med <- unname(X19r2_cSNV_missense_pre_lib_quarts[3])
X19r2_cSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X19r2_cSNV_syn_pre_lib_med <- unname(X19r2_cSNV_syn_pre_lib_quarts[3])
X19r2_cSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X19r2_cSNV_nonsense_pre_lib_med <- unname(X19r2_cSNV_nonsense_pre_lib_quarts[3])
X19r2_cSNV_syn_to_non_pre_lib_spread <- X19r2_cSNV_syn_pre_lib_med - X19r2_cSNV_nonsense_pre_lib_med

X19r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_missense_pre_lib_med <- unname(X19r1r2a_cSNV_missense_pre_lib_quarts[3])
X19r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_syn_pre_lib_med <- unname(X19r1r2a_cSNV_syn_pre_lib_quarts[3])
X19r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X19r1r2a_cSNV_nonsense_pre_lib_med <- unname(X19r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X19r1r2a_cSNV_syn_to_non_pre_lib_spread <- X19r1r2a_cSNV_syn_pre_lib_med - X19r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X19r1_tSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X19r1_tSNV_missense_pre_lib_med <- unname(X19r1_tSNV_missense_pre_lib_quarts[3])
X19r1_tSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X19r1_tSNV_syn_pre_lib_med <- unname(X19r1_tSNV_syn_pre_lib_quarts[3])
X19r1_tSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X19r1_tSNV_nonsense_pre_lib_med <- unname(X19r1_tSNV_nonsense_pre_lib_quarts[3])
X19r1_tSNV_syn_to_non_pre_lib_spread <- X19r1_tSNV_syn_pre_lib_med - X19r1_tSNV_nonsense_pre_lib_med

X19r2_tSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X19r2_tSNV_missense_pre_lib_med <- unname(X19r2_tSNV_missense_pre_lib_quarts[3])
X19r2_tSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X19r2_tSNV_syn_pre_lib_med <- unname(X19r2_tSNV_syn_pre_lib_quarts[3])
X19r2_tSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X19r2_tSNV_nonsense_pre_lib_med <- unname(X19r2_tSNV_nonsense_pre_lib_quarts[3])
X19r2_tSNV_syn_to_non_pre_lib_spread <- X19r2_tSNV_syn_pre_lib_med - X19r2_tSNV_nonsense_pre_lib_med

X19r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_missense_pre_lib_med <- unname(X19r1r2a_tSNV_missense_pre_lib_quarts[3])
X19r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_syn_pre_lib_med <- unname(X19r1r2a_tSNV_syn_pre_lib_quarts[3])
X19r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X19r1r2a_tSNV_nonsense_pre_lib_med <- unname(X19r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X19r1r2a_tSNV_syn_to_non_pre_lib_spread <- X19r1r2a_tSNV_syn_pre_lib_med - X19r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X19r1_tSNV_syn_rna_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X19r1_tSNV_syn_rna_pre_med <- unname(X19r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X19r1_tSNV_syn_rna_post_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X19r1_tSNV_syn_rna_post_med <- unname(X19r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X19r2_tSNV_syn_rna_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X19r2_tSNV_syn_rna_pre_med <- unname(X19r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X19r2_tSNV_syn_rna_post_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X19r2_tSNV_syn_rna_post_med <- unname(X19r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X19r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X19r1r2a_tSNV_syn_rna_pre_med <- unname(X19r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X19r1r2a_tSNV_syn_rna_post_quarts <- quantile(X19r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X19r1r2a_tSNV_syn_rna_post_med <- unname(X19r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X19r1_cSNV_syn_pre_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X19r1_cSNV_syn_post_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X19r1_cSNV_syn_post_lib_med
# tHDR
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X19r1_tSNV_syn_pre_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X19r1_tSNV_syn_post_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X19r1_tSNV_syn_post_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X19r1_tSNV_syn_rna_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X19r1_tSNV_syn_rna_post_med

#r2
X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X19r2_cSNV_syn_pre_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X19r2_cSNV_syn_post_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X19r2_cSNV_syn_post_lib_med
# tHDR
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X19r2_tSNV_syn_pre_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X19r2_tSNV_syn_post_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X19r2_tSNV_syn_post_lib_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X19r2_tSNV_syn_rna_pre_med
X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X19r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X19r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X19r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X19r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X19r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X19r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X19r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X19r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X19r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X19r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X19r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X19r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X19r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X19r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X19r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X19r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X19r1_prog_var_thresh5_df_r2_int_ord[which(X19r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X19r1_prog_var_thresh5_df_r2_int_ord
X19r1_prog_map_thresh5_df_r2_int_ord = which(X19r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X19r1_prog_map_thresh5_df_r2_int_ord_df = X19r1_prog_var_thresh5_df_r2_int_ord[X19r1_prog_map_thresh5_df_r2_int_ord,]
X19r1_prog_map_exon_thresh5_df_r2_int_ord = which(X19r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X19r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X19r1_prog_map_exon_thresh5_df_r2_int_ord_df = X19r1_prog_map_thresh5_df_r2_int_ord_df[X19r1_prog_map_exon_thresh5_df_r2_int_ord,]
X19r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X19r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X19r1_prog_map_thresh5_df_r2_int_ord_df[X19r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X19r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X19r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X19r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X19r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X19r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X19r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X19r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X19r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X19r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X19r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X19r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X19r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X19r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X19r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X19r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X19r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X19r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X19r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X19r1r2_cSNV_r1_post_by_r2_post_cor_s
X19r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X19r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X19r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X19r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X19r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X19r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X19r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X19r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X19r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X19r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X19r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X19r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X19r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X19r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X19r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X19r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X19r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X19r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1_cSNV_post_pre_by_cadd_cor_s
#X19r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X19r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r2_cSNV_post_pre_by_cadd_cor_s

#X19r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X19r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1_cSNV_post_lib_by_cadd_cor_s
#X19r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X19r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X19r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X19r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1_tSNV_post_pre_by_cadd_cor_s
#X19r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X19r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r2_tSNV_post_pre_by_cadd_cor_s

#X19r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X19r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1_tSNV_post_lib_by_cadd_cor_s
#X19r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X19r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X19r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X19r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X19r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X19r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X19r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X19r1_prog_var_all_lib_count
X19r1_prog_var_all_pre_count
X19r2_prog_var_all_pre_count
X19r1_prog_map_thresh5_lib_count
X19r1_prog_map_thresh5_pre_count
X19r2_prog_map_thresh5_pre_count
X19r1_prog_map_thresh5_post_count
X19r2_prog_map_thresh5_post_count
X19r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X19r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X19r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X19r1r2_cSNV_r1_post_by_r2_post_cor_s
X19r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X19r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X19r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X19r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X19r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X19r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X19r1_cSNV_post_pre_by_cadd_cor_s
X19r2_cSNV_post_pre_by_cadd_cor_s
X19r1_cSNV_post_lib_by_cadd_cor_s
X19r2_cSNV_post_lib_by_cadd_cor_s
X19r1_tSNV_post_pre_by_cadd_cor_s
X19r2_tSNV_post_pre_by_cadd_cor_s
X19r1_tSNV_post_lib_by_cadd_cor_s
X19r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X19r1r2a_cSNV_post_pre_by_cadd_cor_s
X19r1r2w_cSNV_post_pre_by_cadd_cor_s
X19r1r2a_cSNV_post_lib_by_cadd_cor_s
X19r1r2w_cSNV_post_lib_by_cadd_cor_s
X19r1r2a_tSNV_post_pre_by_cadd_cor_s
X19r1r2w_tSNV_post_pre_by_cadd_cor_s
X19r1r2a_tSNV_post_lib_by_cadd_cor_s
X19r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X19r1_cSNV_syn_to_non_post_pre_spread
X19r2_cSNV_syn_to_non_post_pre_spread
X19r1r2a_cSNV_syn_to_non_post_pre_spread
X19r1_cSNV_syn_to_non_post_lib_spread
X19r2_cSNV_syn_to_non_post_lib_spread
X19r1r2a_cSNV_syn_to_non_post_lib_spread
X19r1_tSNV_syn_to_non_post_pre_spread
X19r2_tSNV_syn_to_non_post_pre_spread
X19r1r2a_tSNV_syn_to_non_post_pre_spread
X19r1_tSNV_syn_to_non_post_lib_spread
X19r2_tSNV_syn_to_non_post_lib_spread
X19r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X19r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X19r1_prog_map_thresh5_df_r2_int_ord_df[which(X19r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X19r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df[which(X19r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df[which(X19r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df[which(X19r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X19r1_cSNV_pre_lib_cors = cor(log2(X19r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X19r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19r1_tSNV_pre_lib_cors = cor(log2(X19r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19r1_cSNV_post_lib_cors = cor(log2(X19r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X19r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X19r1_tSNV_post_lib_cors = cor(log2(X19r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X19r1_cSNV_post_pre_cors = cor(log2(X19r1_prog_map_thresh5_df$post_pseudo_freq),log2(X19r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19r1_tSNV_post_pre_cors = cor(log2(X19r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X19r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19r1_cSNV_rna_lib_cors = cor(log2(X19r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X19r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19r1_tSNV_rna_lib_cors = cor(log2(X19r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X19r1_cSNV_rna_pre_cors = cor(log2(X19r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X19r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19r1_tSNV_rna_pre_cors = cor(log2(X19r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X19r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19r1r2_cSNV_pre_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X19r1r2_tSNV_pre_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X19r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X19r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X19r1r2_cSNV_post_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X19r1r2_tSNV_post_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X19r1r2_cSNV_post_lib_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X19r1r2_tSNV_post_lib_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X19r1r2_cSNV_post_pre_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X19r1r2_tSNV_post_pre_ratio_cors = cor(log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X19r1r2_cSNV_rna_cors = cor(log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X19r1r2_tSNV_rna_cors = cor(log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X19r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X19r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X19r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X19r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X19r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X19r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X19r1_cors <- c("X19r1",X19r1_cSNV_pre_lib_cors,X19r1_tSNV_pre_lib_cors,X19r1_cSNV_post_lib_cors,X19r1_tSNV_post_lib_cors,X19r1_cSNV_post_pre_cors,X19r1_tSNV_post_pre_cors,X19r1_cSNV_rna_lib_cors,X19r1_tSNV_rna_lib_cors,X19r1_cSNV_rna_pre_cors,X19r1_tSNV_rna_pre_cors,X19r1r2_cSNV_pre_cors,X19r1r2_tSNV_pre_cors,X19r1r2_cSNV_pre_lib_ratio_cors,X19r1r2_tSNV_pre_lib_ratio_cors,X19r1r2_cSNV_post_cors,X19r1r2_tSNV_post_cors,X19r1r2_cSNV_post_lib_ratio_cors,X19r1r2_tSNV_post_lib_ratio_cors,X19r1r2_cSNV_post_pre_ratio_cors,X19r1r2_tSNV_post_pre_ratio_cors,X19r1r2_cSNV_rna_cors,X19r1r2_tSNV_rna_cors,X19r1r2_tSNV_rna_pre_ratio_cors,X19r1_cSNV_pre_lib_ratio_cadd_cors,X19r1_tSNV_pre_lib_ratio_cadd_cors,X19r1_cSNV_post_lib_ratio_cadd_cors,X19r1_tSNV_post_lib_ratio_cadd_cors,X19r1_cSNV_post_pre_ratio_cadd_cors,X19r1_tSNV_post_pre_ratio_cadd_cors,X19r1_cSNV_post_pre_ratio_cadd_missense_cors,X19r1_tSNV_post_pre_ratio_cadd_missense_cors,X19r1_cSNV_post_pre_ratio_polyphen_missense_cors,X19r1_tSNV_post_pre_ratio_polyphen_missense_cors,X19r1_cSNV_post_pre_ratio_grantham_missense_cors,X19r1_tSNV_post_pre_ratio_grantham_missense_cors,X19r1r2a_cSNV_pre_lib_ratio_cadd_cors,X19r1r2a_tSNV_pre_lib_ratio_cadd_cors,X19r1r2a_cSNV_post_lib_ratio_cadd_cors,X19r1r2a_tSNV_post_lib_ratio_cadd_cors,X19r1r2a_cSNV_post_pre_ratio_cadd_cors,X19r1r2a_tSNV_post_pre_ratio_cadd_cors,X19r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X19r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X19r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X19r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X19r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X19r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X19r1r2w_cSNV_pre_lib_ratio_cadd_cors,X19r1r2w_cSNV_post_lib_ratio_cadd_cors,X19r1r2w_cSNV_post_pre_ratio_cadd_cors,X19r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X19r2_cSNV_pre_lib_cors = cor(log2(X19r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X19r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19r2_tSNV_pre_lib_cors = cor(log2(X19r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19r2_cSNV_post_lib_cors = cor(log2(X19r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X19r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X19r2_tSNV_post_lib_cors = cor(log2(X19r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X19r2_cSNV_post_pre_cors = cor(log2(X19r2_prog_map_thresh5_df$post_pseudo_freq),log2(X19r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19r2_tSNV_post_pre_cors = cor(log2(X19r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X19r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19r2_cSNV_rna_lib_cors = cor(log2(X19r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X19r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19r2_tSNV_rna_lib_cors = cor(log2(X19r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X19r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X19r2_cSNV_rna_pre_cors = cor(log2(X19r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X19r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19r2_tSNV_rna_pre_cors = cor(log2(X19r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X19r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X19r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X19r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X19r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X19r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X19r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X19r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X19r2_cors <- c("X19r2",X19r2_cSNV_pre_lib_cors,X19r2_tSNV_pre_lib_cors,X19r2_cSNV_post_lib_cors,X19r2_tSNV_post_lib_cors,X19r2_cSNV_post_pre_cors,X19r2_tSNV_post_pre_cors,X19r2_cSNV_rna_lib_cors,X19r2_tSNV_rna_lib_cors,X19r2_cSNV_rna_pre_cors,X19r2_tSNV_rna_pre_cors,X19r1r2_cSNV_pre_cors,X19r1r2_tSNV_pre_cors,X19r1r2_cSNV_pre_lib_ratio_cors,X19r1r2_tSNV_pre_lib_ratio_cors,X19r1r2_cSNV_post_cors,X19r1r2_tSNV_post_cors,X19r1r2_cSNV_post_lib_ratio_cors,X19r1r2_tSNV_post_lib_ratio_cors,X19r1r2_cSNV_post_pre_ratio_cors,X19r1r2_tSNV_post_pre_ratio_cors,X19r1r2_cSNV_rna_cors,X19r1r2_tSNV_rna_cors,X19r1r2_tSNV_rna_pre_ratio_cors,X19r2_cSNV_pre_lib_ratio_cadd_cors,X19r2_tSNV_pre_lib_ratio_cadd_cors,X19r2_cSNV_post_lib_ratio_cadd_cors,X19r2_tSNV_post_lib_ratio_cadd_cors,X19r2_cSNV_post_pre_ratio_cadd_cors,X19r2_tSNV_post_pre_ratio_cadd_cors,X19r2_cSNV_post_pre_ratio_cadd_missense_cors,X19r2_tSNV_post_pre_ratio_cadd_missense_cors,X19r2_cSNV_post_pre_ratio_polyphen_missense_cors,X19r2_tSNV_post_pre_ratio_polyphen_missense_cors,X19r2_cSNV_post_pre_ratio_grantham_missense_cors,X19r2_tSNV_post_pre_ratio_grantham_missense_cors,X19r1r2a_cSNV_pre_lib_ratio_cadd_cors,X19r1r2a_tSNV_pre_lib_ratio_cadd_cors,X19r1r2a_cSNV_post_lib_ratio_cadd_cors,X19r1r2a_tSNV_post_lib_ratio_cadd_cors,X19r1r2a_cSNV_post_pre_ratio_cadd_cors,X19r1r2a_tSNV_post_pre_ratio_cadd_cors,X19r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X19r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X19r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X19r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X19r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X19r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X19r1r2w_cSNV_pre_lib_ratio_cadd_cors,X19r1r2w_cSNV_post_lib_ratio_cadd_cors,X19r1r2w_cSNV_post_pre_ratio_cadd_cors,X19r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X19r1)
rm(X19r2)
gc()

#subbed in cleaner 3rd replicate for below QC first replicate here!!
X20r1_file <- paste(experiment_dir_171011,'X20r2','_annotated.txt',sep='')
X20r2_file <- paste(experiment_dir_171011,'X20r3','_annotated.txt',sep='')
X20r1 <- read.table(X20r1_file, header=TRUE, sep="\t")
X20r2 <- read.table(X20r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X20 <- editing_info[which(editing_info$amplicon == 'X20'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X20_HDR_5_SNV = as.character(editing_info_X20$HDR_5_SNV)
X20_HDR_3_SNV = as.character(editing_info_X20$HDR_3_SNV)
#X20_cut_pos = as.character(editing_info_X20$cut_pos)
X20_cut_end = as.character(editing_info_X20$cut_end)
X20_mut_start = as.character(editing_info_X20$mut_start)
X20_mut_end = as.character(editing_info_X20$mut_end)
### Replicate 1
X20r1_cSNV_all <- which(X20r1[,'c_hdr_snv']=='True')
X20r1_cSNV_all_df = X20r1[X20r1_cSNV_all,]
X20r1_prog_var_all <- which(X20r1[,'all_hdr_variant']=='True' & X20r1[,'edit_string']!='-WT')
X20r1_prog_var_all_df = X20r1[X20r1_prog_var_all,]
X20r1_prog_map_all = which(X20r1_prog_var_all_df[,'pos']!='REF')
X20r1_prog_map_all_df = X20r1_prog_var_all_df[X20r1_prog_map_all,]
X20r1_prog_map_exon_all = which(X20r1_prog_map_all_df[,'cDNApos']!='REF' & X20r1_prog_map_all_df[,'cDNApos']!='NA')
X20r1_prog_map_exon_all_df = X20r1_prog_map_all_df[X20r1_prog_map_exon_all,]
X20r1_prog_map_CADD = which(X20r1_prog_map_all_df[,'CADD.phred']!='NA')
X20r1_prog_map_CADD_df = X20r1_prog_map_all_df[X20r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X20r1_prog_var_thresh5 <- which(as.numeric(as.character(X20r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X20r1_prog_var_thresh5_df = X20r1_prog_var_all_df[X20r1_prog_var_thresh5,]
X20r1_prog_map_thresh5 <- which(as.numeric(as.character(X20r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X20r1_prog_map_thresh5_df = X20r1_prog_map_all_df[X20r1_prog_map_thresh5,]
X20r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X20r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X20r1_prog_map_exon_thresh5_df = X20r1_prog_map_exon_all_df[X20r1_prog_map_exon_thresh5,]
X20r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X20r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X20r1_prog_map_CADD_thresh5_df = X20r1_prog_map_CADD_df[X20r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X20r1_prog_var_all_lib_count = length(X20r1_prog_var_all_df$lib)
X20r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X20r1_prog_var_all_min_lib_counts = min(X20r1_prog_var_all_df$lib)
X20r1_prog_var_all_min_lib_counts
X20r1_prog_var_all_max_lib_counts = max(X20r1_prog_var_all_df$lib)
X20r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X20r1_prog_map_all_lib_count = length(X20r1_prog_map_all_df$lib)
X20r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X20r1_prog_map_all_min_lib_counts = min(X20r1_prog_map_all_df$lib)
X20r1_prog_map_all_min_lib_counts
X20r1_prog_map_all_max_lib_counts = max(X20r1_prog_map_all_df$lib)
X20r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X20r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X20r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X20r1_prog_var_all_pre_count = length(X20r1_prog_var_all_df$pre)
X20r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X20r1_prog_var_all_min_pre_counts = min(X20r1_prog_var_all_df$pre)
X20r1_prog_var_all_min_pre_counts
X20r1_prog_var_all_max_pre_counts = max(X20r1_prog_var_all_df$pre)
X20r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X20r1_prog_map_all_pre_count = length(X20r1_prog_map_all_df$pre)
X20r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X20r1_prog_map_all_min_pre_counts = min(X20r1_prog_map_all_df$pre)
X20r1_prog_map_all_min_pre_counts
X20r1_prog_map_all_max_pre_counts = max(X20r1_prog_map_all_df$pre)
X20r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X20r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X20r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X20r1_prog_map_all_post_count = length(X20r1_prog_map_all_df$post)
X20r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X20r1_prog_map_all_min_post_counts = min(X20r1_prog_map_all_df$post)
X20r1_prog_map_all_min_post_counts
X20r1_prog_map_all_max_post_counts = max(X20r1_prog_map_all_df$post)
X20r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X20r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X20r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X20r1_prog_map_all_syn_df <- X20r1_prog_map_all_df[which(X20r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X20r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X20r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X20r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X20r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X20r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X20r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X20r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X20r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X20r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X20r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X20r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X20r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X20r1_prog_map_all_min_rna_counts = min(X20r1_prog_map_exon_all_df$tHDR_rna)
X20r1_prog_map_all_min_rna_counts
X20r1_prog_map_all_max_rna_counts = max(X20r1_prog_map_exon_all_df$tHDR_rna)
X20r1_prog_map_all_max_rna_counts
X20r1_prog_map_all_min_rna_pseudo_freq = min(X20r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20r1_prog_map_all_min_rna_pseudo_freq
X20r1_prog_map_all_max_rna_pseudo_freq = max(X20r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20r1_prog_map_all_max_rna_pseudo_freq
X20r1_prog_map_all_min_rna_pre_ratio = min(X20r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20r1_prog_map_all_min_rna_pre_ratio
X20r1_prog_map_all_max_rna_pre_ratio = max(X20r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20r1_prog_map_all_max_rna_pre_ratio
X20r1_prog_map_all_min_rna_post_ratio = min(X20r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20r1_prog_map_all_min_rna_post_ratio
X20r1_prog_map_all_max_rna_post_ratio = max(X20r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X20r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X20r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X20r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X20r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X20r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X20r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X20r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X20r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X20r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X20r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X20r1_prog_map_all_df$post_pre_ratio),log2(X20r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X20r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X20r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X20r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X20r1_cSNV_all_corr_pre_count = length(X20r1_cSNV_all_df$corr_pre)
X20r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X20r1_cSNV_all_min_corr_pre_counts = min(X20r1_cSNV_all_df$corr_pre)
X20r1_cSNV_all_min_corr_pre_counts
X20r1_cSNV_all_max_corr_pre_counts = max(X20r1_cSNV_all_df$corr_pre)
X20r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X20r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X20r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X20r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X20r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X20r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_cSNV_all_corr_post_count = length(X20r1_cSNV_all_df$corr_post)
X20r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X20r1_cSNV_all_min_corr_post_counts = min(X20r1_cSNV_all_df$corr_post)
X20r1_cSNV_all_min_corr_post_counts
X20r1_cSNV_all_max_corr_post_counts = max(X20r1_cSNV_all_df$corr_post)
X20r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X20r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X20r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X20r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X20r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X20r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X20r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X20_p_hdr_snv = paste('p_hdr_',X20_cut_end,'_snv',sep='')
X20r1_pSNV_all <- which(X20r1[,X20_p_hdr_snv]=='True')
X20r1_pSNV_all_df = X20r1[X20r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_pSNV_all_lib_count = length(X20r1_pSNV_all_df$lib)
X20r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X20r1_pSNV_all_min_lib_counts = min(X20r1_pSNV_all_df$lib)
X20r1_pSNV_all_min_lib_counts
X20r1_pSNV_all_max_lib_counts = max(X20r1_pSNV_all_df$lib)
X20r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X20r1_pSNV_all_pre_count = length(X20r1_pSNV_all_df$pre)
X20r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X20r1_pSNV_all_min_pre_counts = min(X20r1_pSNV_all_df$pre)
X20r1_pSNV_all_min_pre_counts
X20r1_pSNV_all_max_pre_counts = max(X20r1_pSNV_all_df$pre)
X20r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X20r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X20r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_pSNV_all_post_count = length(X20r1_pSNV_all_df$post)
X20r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X20r1_pSNV_all_min_post_counts = min(X20r1_pSNV_all_df$post)
X20r1_pSNV_all_min_post_counts
X20r1_pSNV_all_max_post_counts = max(X20r1_pSNV_all_df$post)
X20r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X20r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X20r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_prog_map_thresh5_lib_count = length(X20r1_prog_map_thresh5_df$lib)
X20r1_prog_map_thresh5_lib_count
X20r1_prog_map_thresh5_min_lib_counts = min(X20r1_prog_map_thresh5_df$lib)
X20r1_prog_map_thresh5_min_lib_counts
X20r1_prog_map_thresh5_max_lib_counts = max(X20r1_prog_map_thresh5_df$lib)
X20r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X20r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X20r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_prog_map_thresh5_pre_count = length(X20r1_prog_map_thresh5_df$pre)
X20r1_prog_map_thresh5_pre_count
X20r1_prog_map_thresh5_min_pre_counts = min(X20r1_prog_map_thresh5_df$pre)
X20r1_prog_map_thresh5_min_pre_counts
X20r1_prog_map_thresh5_max_pre_counts = max(X20r1_prog_map_thresh5_df$pre)
X20r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r1_prog_map_thresh5_post_count = length(X20r1_prog_map_thresh5_df$post)
X20r1_prog_map_thresh5_post_count
X20r1_prog_map_thresh5_min_post_counts = min(X20r1_prog_map_thresh5_df$post)
X20r1_prog_map_thresh5_min_post_counts
X20r1_prog_map_thresh5_max_post_counts = max(X20r1_prog_map_thresh5_df$post)
X20r1_prog_map_thresh5_max_post_counts
X20r1_prog_map_thresh5_corr_post_count = length(X20r1_cSNV_all_df$corr_post)
X20r1_prog_map_thresh5_corr_post_count
X20r1_prog_map_thresh5_min_corr_post_counts = min(X20r1_cSNV_all_df$corr_post)
X20r1_prog_map_thresh5_min_corr_post_counts
X20r1_prog_map_thresh5_max_corr_post_counts = max(X20r1_cSNV_all_df$corr_post)
X20r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X20r1_pSNV_thresh5 <- which(X20r1[,X20_p_hdr_snv]=='True' & as.numeric(as.character(X20r1[,'pre_freq']))>=0.00001)
X20r1_pSNV_thresh5_df = X20r1[X20r1_pSNV_thresh5,]
X20r1_pSNV_thresh5_lib_count = length(X20r1_pSNV_thresh5_df$lib)
X20r1_pSNV_thresh5_lib_count
X20r1_pSNV_thresh5_min_lib_counts = min(X20r1_pSNV_thresh5_df$lib)
X20r1_pSNV_thresh5_min_lib_counts
X20r1_pSNV_thresh5_max_lib_counts = max(X20r1_pSNV_thresh5_df$lib)
X20r1_pSNV_thresh5_max_lib_counts
X20r1_pSNV_thresh5_pre_count = length(X20r1_pSNV_thresh5_df$pre)
X20r1_pSNV_thresh5_pre_count
X20r1_pSNV_thresh5_min_pre_counts = min(X20r1_pSNV_thresh5_df$pre)
X20r1_pSNV_thresh5_min_pre_counts
X20r1_pSNV_thresh5_max_pre_counts = max(X20r1_pSNV_thresh5_df$pre)
X20r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X20r1_pSNV_thresh5_post_count = length(X20r1_pSNV_thresh5_df$post)
X20r1_pSNV_thresh5_post_count
X20r1_pSNV_thresh5_min_post_counts = min(X20r1_pSNV_thresh5_df$post)
X20r1_pSNV_thresh5_min_post_counts
X20r1_pSNV_thresh5_max_post_counts = max(X20r1_pSNV_thresh5_df$post)
X20r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X20r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X20r1_pSNV_thresh5_post_pos

### Replicate 2
X20r2_cSNV_all <- which(X20r2[,'c_hdr_snv']=='True')
X20r2_cSNV_all_df = X20r2[X20r2_cSNV_all,]
X20r2_prog_var_all <- which(X20r2[,'all_hdr_variant']=='True' & X20r2[,'edit_string']!='-WT')
X20r2_prog_var_all_df = X20r2[X20r2_prog_var_all,]
X20r2_prog_map_all = which(X20r2_prog_var_all_df[,'pos']!='REF')
X20r2_prog_map_all_df = X20r2_prog_var_all_df[X20r2_prog_map_all,]
X20r2_prog_map_exon_all = which(X20r2_prog_map_all_df[,'cDNApos']!='REF' & X20r2_prog_map_all_df[,'cDNApos']!='NA')
X20r2_prog_map_exon_all_df = X20r2_prog_map_all_df[X20r2_prog_map_exon_all,]
X20r2_prog_map_CADD = which(X20r2_prog_map_all_df[,'CADD.phred']!='NA')
X20r2_prog_map_CADD_df = X20r2_prog_map_all_df[X20r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X20r2_prog_var_thresh5 <- which(as.numeric(as.character(X20r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X20r2_prog_var_thresh5_df = X20r2_prog_var_all_df[X20r2_prog_var_thresh5,]
X20r2_prog_map_thresh5 <- which(as.numeric(as.character(X20r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X20r2_prog_map_thresh5_df = X20r2_prog_map_all_df[X20r2_prog_map_thresh5,]
X20r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X20r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X20r2_prog_map_exon_thresh5_df = X20r2_prog_map_exon_all_df[X20r2_prog_map_exon_thresh5,]
X20r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X20r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X20r2_prog_map_CADD_thresh5_df = X20r2_prog_map_CADD_df[X20r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X20r2_prog_var_all_lib_count = length(X20r2_prog_var_all_df$lib)
X20r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X20r2_prog_var_all_min_lib_counts = min(X20r2_prog_var_all_df$lib)
X20r2_prog_var_all_min_lib_counts
X20r2_prog_var_all_max_lib_counts = max(X20r2_prog_var_all_df$lib)
X20r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X20r2_prog_map_all_lib_count = length(X20r2_prog_map_all_df$lib)
X20r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X20r2_prog_map_all_min_lib_counts = min(X20r2_prog_map_all_df$lib)
X20r2_prog_map_all_min_lib_counts
X20r2_prog_map_all_max_lib_counts = max(X20r2_prog_map_all_df$lib)
X20r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X20r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X20r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X20r2_prog_var_all_pre_count = length(X20r2_prog_var_all_df$pre)
X20r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X20r2_prog_var_all_min_pre_counts = min(X20r2_prog_var_all_df$pre)
X20r2_prog_var_all_min_pre_counts
X20r2_prog_var_all_max_pre_counts = max(X20r2_prog_var_all_df$pre)
X20r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X20r2_prog_map_all_pre_count = length(X20r2_prog_map_all_df$pre)
X20r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X20r2_prog_map_all_min_pre_counts = min(X20r2_prog_map_all_df$pre)
X20r2_prog_map_all_min_pre_counts
X20r2_prog_map_all_max_pre_counts = max(X20r2_prog_map_all_df$pre)
X20r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X20r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X20r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X20r2_prog_map_all_post_count = length(X20r2_prog_map_all_df$post)
X20r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X20r2_prog_map_all_min_post_counts = min(X20r2_prog_map_all_df$post)
X20r2_prog_map_all_min_post_counts
X20r2_prog_map_all_max_post_counts = max(X20r2_prog_map_all_df$post)
X20r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X20r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X20r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X20r2_prog_map_all_syn_df <- X20r2_prog_map_all_df[which(X20r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X20r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X20r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X20r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X20r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X20r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X20r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X20r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X20r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X20r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X20r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X20r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X20r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X20r2_prog_map_all_min_rna_counts = min(X20r2_prog_map_exon_all_df$tHDR_rna)
X20r2_prog_map_all_min_rna_counts
X20r2_prog_map_all_max_rna_counts = max(X20r2_prog_map_exon_all_df$tHDR_rna)
X20r2_prog_map_all_max_rna_counts
X20r2_prog_map_all_min_rna_pseudo_freq = min(X20r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20r2_prog_map_all_min_rna_pseudo_freq
X20r2_prog_map_all_max_rna_pseudo_freq = max(X20r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20r2_prog_map_all_max_rna_pseudo_freq
X20r2_prog_map_all_min_rna_pre_ratio = min(X20r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20r2_prog_map_all_min_rna_pre_ratio
X20r2_prog_map_all_max_rna_pre_ratio = max(X20r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20r2_prog_map_all_max_rna_pre_ratio
X20r2_prog_map_all_min_rna_post_ratio = min(X20r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20r2_prog_map_all_min_rna_post_ratio
X20r2_prog_map_all_max_rna_post_ratio = max(X20r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X20r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X20r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X20r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X20r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X20r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X20r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X20r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X20r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X20r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X20r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X20r2_prog_map_all_df$post_pre_ratio),log2(X20r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X20r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X20r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X20r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X20r2_cSNV_all_corr_pre_count = length(X20r2_cSNV_all_df$corr_pre)
X20r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X20r2_cSNV_all_min_corr_pre_counts = min(X20r2_cSNV_all_df$corr_pre)
X20r2_cSNV_all_min_corr_pre_counts
X20r2_cSNV_all_max_corr_pre_counts = max(X20r2_cSNV_all_df$corr_pre)
X20r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X20r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X20r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X20r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X20r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X20r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_cSNV_all_corr_post_count = length(X20r2_cSNV_all_df$corr_post)
X20r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X20r2_cSNV_all_min_corr_post_counts = min(X20r2_cSNV_all_df$corr_post)
X20r2_cSNV_all_min_corr_post_counts
X20r2_cSNV_all_max_corr_post_counts = max(X20r2_cSNV_all_df$corr_post)
X20r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X20r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X20r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X20r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X20r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X20r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X20r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X20_p_hdr_snv = paste('p_hdr_',X20_cut_end,'_snv',sep='')
X20r2_pSNV_all <- which(X20r2[,X20_p_hdr_snv]=='True')
X20r2_pSNV_all_df = X20r2[X20r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_pSNV_all_lib_count = length(X20r2_pSNV_all_df$lib)
X20r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X20r2_pSNV_all_min_lib_counts = min(X20r2_pSNV_all_df$lib)
X20r2_pSNV_all_min_lib_counts
X20r2_pSNV_all_max_lib_counts = max(X20r2_pSNV_all_df$lib)
X20r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X20r2_pSNV_all_pre_count = length(X20r2_pSNV_all_df$pre)
X20r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X20r2_pSNV_all_min_pre_counts = min(X20r2_pSNV_all_df$pre)
X20r2_pSNV_all_min_pre_counts
X20r2_pSNV_all_max_pre_counts = max(X20r2_pSNV_all_df$pre)
X20r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X20r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X20r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_pSNV_all_post_count = length(X20r2_pSNV_all_df$post)
X20r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X20r2_pSNV_all_min_post_counts = min(X20r2_pSNV_all_df$post)
X20r2_pSNV_all_min_post_counts
X20r2_pSNV_all_max_post_counts = max(X20r2_pSNV_all_df$post)
X20r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X20r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X20r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_prog_map_thresh5_lib_count = length(X20r2_prog_map_thresh5_df$lib)
X20r2_prog_map_thresh5_lib_count
X20r2_prog_map_thresh5_min_lib_counts = min(X20r2_prog_map_thresh5_df$lib)
X20r2_prog_map_thresh5_min_lib_counts
X20r2_prog_map_thresh5_max_lib_counts = max(X20r2_prog_map_thresh5_df$lib)
X20r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X20r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X20r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_prog_map_thresh5_pre_count = length(X20r2_prog_map_thresh5_df$pre)
X20r2_prog_map_thresh5_pre_count
X20r2_prog_map_thresh5_min_pre_counts = min(X20r2_prog_map_thresh5_df$pre)
X20r2_prog_map_thresh5_min_pre_counts
X20r2_prog_map_thresh5_max_pre_counts = max(X20r2_prog_map_thresh5_df$pre)
X20r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20r2_prog_map_thresh5_post_count = length(X20r2_prog_map_thresh5_df$post)
X20r2_prog_map_thresh5_post_count
X20r2_prog_map_thresh5_min_post_counts = min(X20r2_prog_map_thresh5_df$post)
X20r2_prog_map_thresh5_min_post_counts
X20r2_prog_map_thresh5_max_post_counts = max(X20r2_prog_map_thresh5_df$post)
X20r2_prog_map_thresh5_max_post_counts
X20r2_prog_map_thresh5_corr_post_count = length(X20r2_prog_map_thresh5_df$corr_post)
X20r2_prog_map_thresh5_corr_post_count
X20r2_prog_map_thresh5_min_corr_post_counts = min(X20r2_prog_map_thresh5_df$corr_post)
X20r2_prog_map_thresh5_min_corr_post_counts
X20r2_prog_map_thresh5_max_corr_post_counts = max(X20r2_prog_map_thresh5_df$corr_post)
X20r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X20r2_pSNV_thresh5 <- which(X20r2[,X20_p_hdr_snv]=='True' & as.numeric(as.character(X20r2[,'pre_freq']))>=0.00001)
X20r2_pSNV_thresh5_df = X20r2[X20r2_pSNV_thresh5,]
X20r2_pSNV_thresh5_lib_count = length(X20r2_pSNV_thresh5_df$lib)
X20r2_pSNV_thresh5_lib_count
X20r2_pSNV_thresh5_min_lib_counts = min(X20r2_pSNV_thresh5_df$lib)
X20r2_pSNV_thresh5_min_lib_counts
X20r2_pSNV_thresh5_max_lib_counts = max(X20r2_pSNV_thresh5_df$lib)
X20r2_pSNV_thresh5_max_lib_counts
X20r2_pSNV_thresh5_pre_count = length(X20r2_pSNV_thresh5_df$pre)
X20r2_pSNV_thresh5_pre_count
X20r2_pSNV_thresh5_min_pre_counts = min(X20r2_pSNV_thresh5_df$pre)
X20r2_pSNV_thresh5_min_pre_counts
X20r2_pSNV_thresh5_max_pre_counts = max(X20r2_pSNV_thresh5_df$pre)
X20r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X20r2_pSNV_thresh5_post_count = length(X20r2_pSNV_thresh5_df$post)
X20r2_pSNV_thresh5_post_count
X20r2_pSNV_thresh5_min_post_counts = min(X20r2_pSNV_thresh5_df$post)
X20r2_pSNV_thresh5_min_post_counts
X20r2_pSNV_thresh5_max_post_counts = max(X20r2_pSNV_thresh5_df$post)
X20r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X20r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X20r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X20r1_prog_var_thresh5_df:
X20r1_prog_var_thresh5_df_r2_int <- X20r1_prog_var_thresh5_df[which(X20r1_prog_var_thresh5_df$variant %in% X20r2_prog_var_thresh5_df$variant),]
#Intersection variants of X20r2_prog_var_thresh5_df:
X20r2_prog_var_thresh5_df_r1_int <- X20r2_prog_var_thresh5_df[which(X20r2_prog_var_thresh5_df$variant %in% X20r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X20r1_prog_var_thresh5_df_r2_int_ord <- X20r1_prog_var_thresh5_df_r2_int[order(X20r1_prog_var_thresh5_df_r2_int$variant),]
X20r2_prog_var_thresh5_df_r1_int_ord <- X20r2_prog_var_thresh5_df_r1_int[order(X20r2_prog_var_thresh5_df_r1_int$variant),]

dim(X20r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X20r1r2int_prog_var_thresh5_pre_count <- dim(X20r1_prog_var_thresh5_df_r2_int)[1] 
X20r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X20r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X20r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X20r2_prog_var_thresh5_df_r1_int_ord$pre
X20r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X20r2_prog_var_thresh5_df_r1_int_ord$lib
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X20r2_prog_var_thresh5_df_r1_int_ord$post
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X20r2_prog_var_thresh5_df_r1_int_ord$rna
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X20r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X20r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X20r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$post_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X20r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X20r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X20r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X20r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X20r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X20r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X20r2_prog_var_thresh5_df_r1_int_ord$corr_post
X20r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X20r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X20r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X20r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X20r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X20r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X20r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X20r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X20r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X20r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X20r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X20r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X20r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X20r1_cSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X20r1_cSNV_missense_post_pre_med <- unname(X20r1_cSNV_missense_post_pre_quarts[3])
X20r1_cSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X20r1_cSNV_syn_post_pre_med <- unname(X20r1_cSNV_syn_post_pre_quarts[3])
X20r1_cSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X20r1_cSNV_nonsense_post_pre_med <- unname(X20r1_cSNV_nonsense_post_pre_quarts[3])
X20r1_cSNV_syn_to_non_post_pre_spread <- X20r1_cSNV_syn_post_pre_med - X20r1_cSNV_nonsense_post_pre_med

X20r2_cSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X20r2_cSNV_missense_post_pre_med <- unname(X20r2_cSNV_missense_post_pre_quarts[3])
X20r2_cSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X20r2_cSNV_syn_post_pre_med <- unname(X20r2_cSNV_syn_post_pre_quarts[3])
X20r2_cSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X20r2_cSNV_nonsense_post_pre_med <- unname(X20r2_cSNV_nonsense_post_pre_quarts[3])
X20r2_cSNV_syn_to_non_post_pre_spread <- X20r2_cSNV_syn_post_pre_med - X20r2_cSNV_nonsense_post_pre_med

X20r1r2a_cSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X20r1r2a_cSNV_missense_post_pre_med <- unname(X20r1r2a_cSNV_missense_post_pre_quarts[3])
X20r1r2a_cSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X20r1r2a_cSNV_syn_post_pre_med <- unname(X20r1r2a_cSNV_syn_post_pre_quarts[3])
X20r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X20r1r2a_cSNV_nonsense_post_pre_med <- unname(X20r1r2a_cSNV_nonsense_post_pre_quarts[3])
X20r1r2a_cSNV_syn_to_non_post_pre_spread <- X20r1r2a_cSNV_syn_post_pre_med - X20r1r2a_cSNV_nonsense_post_pre_med

X20r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_cSNV_missense_post_pre_med <- unname(X20r1r2pw_cSNV_missense_post_pre_quarts[3])
X20r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_cSNV_syn_post_pre_med <- unname(X20r1r2pw_cSNV_syn_post_pre_quarts[3])
X20r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_cSNV_nonsense_post_pre_med <- unname(X20r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X20r1r2pw_cSNV_syn_to_non_post_pre_spread <- X20r1r2pw_cSNV_syn_post_pre_med - X20r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X20r1_tSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X20r1_tSNV_missense_post_pre_med <- unname(X20r1_tSNV_missense_post_pre_quarts[3])
X20r1_tSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X20r1_tSNV_syn_post_pre_med <- unname(X20r1_tSNV_syn_post_pre_quarts[3])
X20r1_tSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X20r1_tSNV_nonsense_post_pre_med <- unname(X20r1_tSNV_nonsense_post_pre_quarts[3])
X20r1_tSNV_syn_to_non_post_pre_spread <- X20r1_tSNV_syn_post_pre_med - X20r1_tSNV_nonsense_post_pre_med

X20r2_tSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X20r2_tSNV_missense_post_pre_med <- unname(X20r2_tSNV_missense_post_pre_quarts[3])
X20r2_tSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X20r2_tSNV_syn_post_pre_med <- unname(X20r2_tSNV_syn_post_pre_quarts[3])
X20r2_tSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X20r2_tSNV_nonsense_post_pre_med <- unname(X20r2_tSNV_nonsense_post_pre_quarts[3])
X20r2_tSNV_syn_to_non_post_pre_spread <- X20r2_tSNV_syn_post_pre_med - X20r2_tSNV_nonsense_post_pre_med

X20r1r2a_tSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X20r1r2a_tSNV_missense_post_pre_med <- unname(X20r1r2a_tSNV_missense_post_pre_quarts[3])
X20r1r2a_tSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X20r1r2a_tSNV_syn_post_pre_med <- unname(X20r1r2a_tSNV_syn_post_pre_quarts[3])
X20r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X20r1r2a_tSNV_nonsense_post_pre_med <- unname(X20r1r2a_tSNV_nonsense_post_pre_quarts[3])
X20r1r2a_tSNV_syn_to_non_post_pre_spread <- X20r1r2a_tSNV_syn_post_pre_med - X20r1r2a_tSNV_nonsense_post_pre_med

X20r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_tSNV_missense_post_pre_med <- unname(X20r1r2pw_tSNV_missense_post_pre_quarts[3])
X20r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_tSNV_syn_post_pre_med <- unname(X20r1r2pw_tSNV_syn_post_pre_quarts[3])
X20r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X20r1r2pw_tSNV_nonsense_post_pre_med <- unname(X20r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X20r1r2pw_tSNV_syn_to_non_post_pre_spread <- X20r1r2pw_tSNV_syn_post_pre_med - X20r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X20r1_cSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X20r1_cSNV_missense_post_lib_med <- unname(X20r1_cSNV_missense_post_lib_quarts[3])
X20r1_cSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X20r1_cSNV_syn_post_lib_med <- unname(X20r1_cSNV_syn_post_lib_quarts[3])
X20r1_cSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X20r1_cSNV_nonsense_post_lib_med <- unname(X20r1_cSNV_nonsense_post_lib_quarts[3])
X20r1_cSNV_syn_to_non_post_lib_spread <- X20r1_cSNV_syn_post_lib_med - X20r1_cSNV_nonsense_post_lib_med

X20r2_cSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X20r2_cSNV_missense_post_lib_med <- unname(X20r2_cSNV_missense_post_lib_quarts[3])
X20r2_cSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X20r2_cSNV_syn_post_lib_med <- unname(X20r2_cSNV_syn_post_lib_quarts[3])
X20r2_cSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X20r2_cSNV_nonsense_post_lib_med <- unname(X20r2_cSNV_nonsense_post_lib_quarts[3])
X20r2_cSNV_syn_to_non_post_lib_spread <- X20r2_cSNV_syn_post_lib_med - X20r2_cSNV_nonsense_post_lib_med

X20r1r2a_cSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_missense_post_lib_med <- unname(X20r1r2a_cSNV_missense_post_lib_quarts[3])
X20r1r2a_cSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_syn_post_lib_med <- unname(X20r1r2a_cSNV_syn_post_lib_quarts[3])
X20r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_nonsense_post_lib_med <- unname(X20r1r2a_cSNV_nonsense_post_lib_quarts[3])
X20r1r2a_cSNV_syn_to_non_post_lib_spread <- X20r1r2a_cSNV_syn_post_lib_med - X20r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X20r1_tSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X20r1_tSNV_missense_post_lib_med <- unname(X20r1_tSNV_missense_post_lib_quarts[3])
X20r1_tSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X20r1_tSNV_syn_post_lib_med <- unname(X20r1_tSNV_syn_post_lib_quarts[3])
X20r1_tSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X20r1_tSNV_nonsense_post_lib_med <- unname(X20r1_tSNV_nonsense_post_lib_quarts[3])
X20r1_tSNV_syn_to_non_post_lib_spread <- X20r1_tSNV_syn_post_lib_med - X20r1_tSNV_nonsense_post_lib_med

X20r2_tSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X20r2_tSNV_missense_post_lib_med <- unname(X20r2_tSNV_missense_post_lib_quarts[3])
X20r2_tSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X20r2_tSNV_syn_post_lib_med <- unname(X20r2_tSNV_syn_post_lib_quarts[3])
X20r2_tSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X20r2_tSNV_nonsense_post_lib_med <- unname(X20r2_tSNV_nonsense_post_lib_quarts[3])
X20r2_tSNV_syn_to_non_post_lib_spread <- X20r2_tSNV_syn_post_lib_med - X20r2_tSNV_nonsense_post_lib_med

X20r1r2a_tSNV_missense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_missense_post_lib_med <- unname(X20r1r2a_tSNV_missense_post_lib_quarts[3])
X20r1r2a_tSNV_syn_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_syn_post_lib_med <- unname(X20r1r2a_tSNV_syn_post_lib_quarts[3])
X20r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_nonsense_post_lib_med <- unname(X20r1r2a_tSNV_nonsense_post_lib_quarts[3])
X20r1r2a_tSNV_syn_to_non_post_lib_spread <- X20r1r2a_tSNV_syn_post_lib_med - X20r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X20r1_cSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X20r1_cSNV_missense_pre_lib_med <- unname(X20r1_cSNV_missense_pre_lib_quarts[3])
X20r1_cSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X20r1_cSNV_syn_pre_lib_med <- unname(X20r1_cSNV_syn_pre_lib_quarts[3])
X20r1_cSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X20r1_cSNV_nonsense_pre_lib_med <- unname(X20r1_cSNV_nonsense_pre_lib_quarts[3])
X20r1_cSNV_syn_to_non_pre_lib_spread <- X20r1_cSNV_syn_pre_lib_med - X20r1_cSNV_nonsense_pre_lib_med

X20r2_cSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X20r2_cSNV_missense_pre_lib_med <- unname(X20r2_cSNV_missense_pre_lib_quarts[3])
X20r2_cSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X20r2_cSNV_syn_pre_lib_med <- unname(X20r2_cSNV_syn_pre_lib_quarts[3])
X20r2_cSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X20r2_cSNV_nonsense_pre_lib_med <- unname(X20r2_cSNV_nonsense_pre_lib_quarts[3])
X20r2_cSNV_syn_to_non_pre_lib_spread <- X20r2_cSNV_syn_pre_lib_med - X20r2_cSNV_nonsense_pre_lib_med

X20r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_missense_pre_lib_med <- unname(X20r1r2a_cSNV_missense_pre_lib_quarts[3])
X20r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_syn_pre_lib_med <- unname(X20r1r2a_cSNV_syn_pre_lib_quarts[3])
X20r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X20r1r2a_cSNV_nonsense_pre_lib_med <- unname(X20r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X20r1r2a_cSNV_syn_to_non_pre_lib_spread <- X20r1r2a_cSNV_syn_pre_lib_med - X20r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X20r1_tSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X20r1_tSNV_missense_pre_lib_med <- unname(X20r1_tSNV_missense_pre_lib_quarts[3])
X20r1_tSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X20r1_tSNV_syn_pre_lib_med <- unname(X20r1_tSNV_syn_pre_lib_quarts[3])
X20r1_tSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X20r1_tSNV_nonsense_pre_lib_med <- unname(X20r1_tSNV_nonsense_pre_lib_quarts[3])
X20r1_tSNV_syn_to_non_pre_lib_spread <- X20r1_tSNV_syn_pre_lib_med - X20r1_tSNV_nonsense_pre_lib_med

X20r2_tSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X20r2_tSNV_missense_pre_lib_med <- unname(X20r2_tSNV_missense_pre_lib_quarts[3])
X20r2_tSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X20r2_tSNV_syn_pre_lib_med <- unname(X20r2_tSNV_syn_pre_lib_quarts[3])
X20r2_tSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X20r2_tSNV_nonsense_pre_lib_med <- unname(X20r2_tSNV_nonsense_pre_lib_quarts[3])
X20r2_tSNV_syn_to_non_pre_lib_spread <- X20r2_tSNV_syn_pre_lib_med - X20r2_tSNV_nonsense_pre_lib_med

X20r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_missense_pre_lib_med <- unname(X20r1r2a_tSNV_missense_pre_lib_quarts[3])
X20r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_syn_pre_lib_med <- unname(X20r1r2a_tSNV_syn_pre_lib_quarts[3])
X20r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X20r1r2a_tSNV_nonsense_pre_lib_med <- unname(X20r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X20r1r2a_tSNV_syn_to_non_pre_lib_spread <- X20r1r2a_tSNV_syn_pre_lib_med - X20r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X20r1_tSNV_syn_rna_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X20r1_tSNV_syn_rna_pre_med <- unname(X20r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X20r1_tSNV_syn_rna_post_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X20r1_tSNV_syn_rna_post_med <- unname(X20r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X20r2_tSNV_syn_rna_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X20r2_tSNV_syn_rna_pre_med <- unname(X20r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X20r2_tSNV_syn_rna_post_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X20r2_tSNV_syn_rna_post_med <- unname(X20r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X20r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X20r1r2a_tSNV_syn_rna_pre_med <- unname(X20r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X20r1r2a_tSNV_syn_rna_post_quarts <- quantile(X20r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X20r1r2a_tSNV_syn_rna_post_med <- unname(X20r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X20r1_cSNV_syn_pre_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X20r1_cSNV_syn_post_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X20r1_cSNV_syn_post_lib_med
# tHDR
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X20r1_tSNV_syn_pre_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X20r1_tSNV_syn_post_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X20r1_tSNV_syn_post_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X20r1_tSNV_syn_rna_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X20r1_tSNV_syn_rna_post_med

#r2
X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X20r2_cSNV_syn_pre_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X20r2_cSNV_syn_post_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X20r2_cSNV_syn_post_lib_med
# tHDR
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X20r2_tSNV_syn_pre_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X20r2_tSNV_syn_post_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X20r2_tSNV_syn_post_lib_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X20r2_tSNV_syn_rna_pre_med
X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X20r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X20r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X20r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X20r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X20r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X20r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X20r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X20r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X20r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X20r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X20r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X20r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X20r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X20r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X20r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X20r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X20r1_prog_var_thresh5_df_r2_int_ord[which(X20r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X20r1_prog_var_thresh5_df_r2_int_ord
X20r1_prog_map_thresh5_df_r2_int_ord = which(X20r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X20r1_prog_map_thresh5_df_r2_int_ord_df = X20r1_prog_var_thresh5_df_r2_int_ord[X20r1_prog_map_thresh5_df_r2_int_ord,]
X20r1_prog_map_exon_thresh5_df_r2_int_ord = which(X20r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X20r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X20r1_prog_map_exon_thresh5_df_r2_int_ord_df = X20r1_prog_map_thresh5_df_r2_int_ord_df[X20r1_prog_map_exon_thresh5_df_r2_int_ord,]
X20r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X20r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X20r1_prog_map_thresh5_df_r2_int_ord_df[X20r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X20r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X20r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X20r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X20r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X20r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X20r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X20r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X20r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X20r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X20r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X20r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X20r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X20r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X20r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X20r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X20r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X20r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X20r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X20r1r2_cSNV_r1_post_by_r2_post_cor_s
X20r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X20r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X20r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X20r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X20r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X20r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X20r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X20r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X20r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X20r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X20r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X20r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X20r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X20r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X20r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X20r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X20r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X20r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1_cSNV_post_pre_by_cadd_cor_s
#X20r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X20r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r2_cSNV_post_pre_by_cadd_cor_s

#X20r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X20r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1_cSNV_post_lib_by_cadd_cor_s
#X20r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X20r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X20r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X20r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1_tSNV_post_pre_by_cadd_cor_s
#X20r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X20r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r2_tSNV_post_pre_by_cadd_cor_s

#X20r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X20r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1_tSNV_post_lib_by_cadd_cor_s
#X20r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X20r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X20r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X20r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X20r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X20r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X20r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X20r1_prog_var_all_lib_count
X20r1_prog_var_all_pre_count
X20r2_prog_var_all_pre_count
X20r1_prog_map_thresh5_lib_count
X20r1_prog_map_thresh5_pre_count
X20r2_prog_map_thresh5_pre_count
X20r1_prog_map_thresh5_post_count
X20r2_prog_map_thresh5_post_count
X20r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X20r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X20r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X20r1r2_cSNV_r1_post_by_r2_post_cor_s
X20r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X20r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X20r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X20r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X20r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X20r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X20r1_cSNV_post_pre_by_cadd_cor_s
X20r2_cSNV_post_pre_by_cadd_cor_s
X20r1_cSNV_post_lib_by_cadd_cor_s
X20r2_cSNV_post_lib_by_cadd_cor_s
X20r1_tSNV_post_pre_by_cadd_cor_s
X20r2_tSNV_post_pre_by_cadd_cor_s
X20r1_tSNV_post_lib_by_cadd_cor_s
X20r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X20r1r2a_cSNV_post_pre_by_cadd_cor_s
X20r1r2w_cSNV_post_pre_by_cadd_cor_s
X20r1r2a_cSNV_post_lib_by_cadd_cor_s
X20r1r2w_cSNV_post_lib_by_cadd_cor_s
X20r1r2a_tSNV_post_pre_by_cadd_cor_s
X20r1r2w_tSNV_post_pre_by_cadd_cor_s
X20r1r2a_tSNV_post_lib_by_cadd_cor_s
X20r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X20r1_cSNV_syn_to_non_post_pre_spread
X20r2_cSNV_syn_to_non_post_pre_spread
X20r1r2a_cSNV_syn_to_non_post_pre_spread
X20r1_cSNV_syn_to_non_post_lib_spread
X20r2_cSNV_syn_to_non_post_lib_spread
X20r1r2a_cSNV_syn_to_non_post_lib_spread
X20r1_tSNV_syn_to_non_post_pre_spread
X20r2_tSNV_syn_to_non_post_pre_spread
X20r1r2a_tSNV_syn_to_non_post_pre_spread
X20r1_tSNV_syn_to_non_post_lib_spread
X20r2_tSNV_syn_to_non_post_lib_spread
X20r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X20r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X20r1_prog_map_thresh5_df_r2_int_ord_df[which(X20r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X20r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df[which(X20r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df[which(X20r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df[which(X20r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X20r1_cSNV_pre_lib_cors = cor(log2(X20r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X20r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20r1_tSNV_pre_lib_cors = cor(log2(X20r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20r1_cSNV_post_lib_cors = cor(log2(X20r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X20r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X20r1_tSNV_post_lib_cors = cor(log2(X20r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X20r1_cSNV_post_pre_cors = cor(log2(X20r1_prog_map_thresh5_df$post_pseudo_freq),log2(X20r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20r1_tSNV_post_pre_cors = cor(log2(X20r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X20r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20r1_cSNV_rna_lib_cors = cor(log2(X20r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X20r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20r1_tSNV_rna_lib_cors = cor(log2(X20r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X20r1_cSNV_rna_pre_cors = cor(log2(X20r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X20r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20r1_tSNV_rna_pre_cors = cor(log2(X20r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X20r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20r1r2_cSNV_pre_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X20r1r2_tSNV_pre_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X20r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X20r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X20r1r2_cSNV_post_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X20r1r2_tSNV_post_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X20r1r2_cSNV_post_lib_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X20r1r2_tSNV_post_lib_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X20r1r2_cSNV_post_pre_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X20r1r2_tSNV_post_pre_ratio_cors = cor(log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X20r1r2_cSNV_rna_cors = cor(log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X20r1r2_tSNV_rna_cors = cor(log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X20r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X20r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X20r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X20r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X20r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X20r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X20r1_cors <- c("X20r1",X20r1_cSNV_pre_lib_cors,X20r1_tSNV_pre_lib_cors,X20r1_cSNV_post_lib_cors,X20r1_tSNV_post_lib_cors,X20r1_cSNV_post_pre_cors,X20r1_tSNV_post_pre_cors,X20r1_cSNV_rna_lib_cors,X20r1_tSNV_rna_lib_cors,X20r1_cSNV_rna_pre_cors,X20r1_tSNV_rna_pre_cors,X20r1r2_cSNV_pre_cors,X20r1r2_tSNV_pre_cors,X20r1r2_cSNV_pre_lib_ratio_cors,X20r1r2_tSNV_pre_lib_ratio_cors,X20r1r2_cSNV_post_cors,X20r1r2_tSNV_post_cors,X20r1r2_cSNV_post_lib_ratio_cors,X20r1r2_tSNV_post_lib_ratio_cors,X20r1r2_cSNV_post_pre_ratio_cors,X20r1r2_tSNV_post_pre_ratio_cors,X20r1r2_cSNV_rna_cors,X20r1r2_tSNV_rna_cors,X20r1r2_tSNV_rna_pre_ratio_cors,X20r1_cSNV_pre_lib_ratio_cadd_cors,X20r1_tSNV_pre_lib_ratio_cadd_cors,X20r1_cSNV_post_lib_ratio_cadd_cors,X20r1_tSNV_post_lib_ratio_cadd_cors,X20r1_cSNV_post_pre_ratio_cadd_cors,X20r1_tSNV_post_pre_ratio_cadd_cors,X20r1_cSNV_post_pre_ratio_cadd_missense_cors,X20r1_tSNV_post_pre_ratio_cadd_missense_cors,X20r1_cSNV_post_pre_ratio_polyphen_missense_cors,X20r1_tSNV_post_pre_ratio_polyphen_missense_cors,X20r1_cSNV_post_pre_ratio_grantham_missense_cors,X20r1_tSNV_post_pre_ratio_grantham_missense_cors,X20r1r2a_cSNV_pre_lib_ratio_cadd_cors,X20r1r2a_tSNV_pre_lib_ratio_cadd_cors,X20r1r2a_cSNV_post_lib_ratio_cadd_cors,X20r1r2a_tSNV_post_lib_ratio_cadd_cors,X20r1r2a_cSNV_post_pre_ratio_cadd_cors,X20r1r2a_tSNV_post_pre_ratio_cadd_cors,X20r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X20r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X20r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X20r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X20r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X20r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X20r1r2w_cSNV_pre_lib_ratio_cadd_cors,X20r1r2w_cSNV_post_lib_ratio_cadd_cors,X20r1r2w_cSNV_post_pre_ratio_cadd_cors,X20r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X20r2_cSNV_pre_lib_cors = cor(log2(X20r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X20r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20r2_tSNV_pre_lib_cors = cor(log2(X20r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20r2_cSNV_post_lib_cors = cor(log2(X20r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X20r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X20r2_tSNV_post_lib_cors = cor(log2(X20r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X20r2_cSNV_post_pre_cors = cor(log2(X20r2_prog_map_thresh5_df$post_pseudo_freq),log2(X20r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20r2_tSNV_post_pre_cors = cor(log2(X20r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X20r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20r2_cSNV_rna_lib_cors = cor(log2(X20r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X20r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20r2_tSNV_rna_lib_cors = cor(log2(X20r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X20r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X20r2_cSNV_rna_pre_cors = cor(log2(X20r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X20r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20r2_tSNV_rna_pre_cors = cor(log2(X20r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X20r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X20r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X20r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X20r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X20r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X20r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X20r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X20r2_cors <- c("X20r2",X20r2_cSNV_pre_lib_cors,X20r2_tSNV_pre_lib_cors,X20r2_cSNV_post_lib_cors,X20r2_tSNV_post_lib_cors,X20r2_cSNV_post_pre_cors,X20r2_tSNV_post_pre_cors,X20r2_cSNV_rna_lib_cors,X20r2_tSNV_rna_lib_cors,X20r2_cSNV_rna_pre_cors,X20r2_tSNV_rna_pre_cors,X20r1r2_cSNV_pre_cors,X20r1r2_tSNV_pre_cors,X20r1r2_cSNV_pre_lib_ratio_cors,X20r1r2_tSNV_pre_lib_ratio_cors,X20r1r2_cSNV_post_cors,X20r1r2_tSNV_post_cors,X20r1r2_cSNV_post_lib_ratio_cors,X20r1r2_tSNV_post_lib_ratio_cors,X20r1r2_cSNV_post_pre_ratio_cors,X20r1r2_tSNV_post_pre_ratio_cors,X20r1r2_cSNV_rna_cors,X20r1r2_tSNV_rna_cors,X20r1r2_tSNV_rna_pre_ratio_cors,X20r2_cSNV_pre_lib_ratio_cadd_cors,X20r2_tSNV_pre_lib_ratio_cadd_cors,X20r2_cSNV_post_lib_ratio_cadd_cors,X20r2_tSNV_post_lib_ratio_cadd_cors,X20r2_cSNV_post_pre_ratio_cadd_cors,X20r2_tSNV_post_pre_ratio_cadd_cors,X20r2_cSNV_post_pre_ratio_cadd_missense_cors,X20r2_tSNV_post_pre_ratio_cadd_missense_cors,X20r2_cSNV_post_pre_ratio_polyphen_missense_cors,X20r2_tSNV_post_pre_ratio_polyphen_missense_cors,X20r2_cSNV_post_pre_ratio_grantham_missense_cors,X20r2_tSNV_post_pre_ratio_grantham_missense_cors,X20r1r2a_cSNV_pre_lib_ratio_cadd_cors,X20r1r2a_tSNV_pre_lib_ratio_cadd_cors,X20r1r2a_cSNV_post_lib_ratio_cadd_cors,X20r1r2a_tSNV_post_lib_ratio_cadd_cors,X20r1r2a_cSNV_post_pre_ratio_cadd_cors,X20r1r2a_tSNV_post_pre_ratio_cadd_cors,X20r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X20r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X20r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X20r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X20r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X20r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X20r1r2w_cSNV_pre_lib_ratio_cadd_cors,X20r1r2w_cSNV_post_lib_ratio_cadd_cors,X20r1r2w_cSNV_post_pre_ratio_cadd_cors,X20r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X20r1)
rm(X20r2)
gc()
X21r1_file <- paste(experiment_dir_171011,'X21r3','_annotated.txt',sep='')
X21r2_file <- paste(experiment_dir_171011,'X21r4','_annotated.txt',sep='')
X21r1 <- read.table(X21r1_file, header=TRUE, sep="\t")
X21r2 <- read.table(X21r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X21 <- editing_info[which(editing_info$amplicon == 'X21'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X21_HDR_5_SNV = as.character(editing_info_X21$HDR_5_SNV)
X21_HDR_3_SNV = as.character(editing_info_X21$HDR_3_SNV)
#X21_cut_pos = as.character(editing_info_X21$cut_pos)
X21_cut_end = as.character(editing_info_X21$cut_end)
X21_mut_start = as.character(editing_info_X21$mut_start)
X21_mut_end = as.character(editing_info_X21$mut_end)
### Replicate 1
X21r1_cSNV_all <- which(X21r1[,'c_hdr_snv']=='True')
X21r1_cSNV_all_df = X21r1[X21r1_cSNV_all,]
X21r1_prog_var_all <- which(X21r1[,'all_hdr_variant']=='True' & X21r1[,'edit_string']!='-WT')
X21r1_prog_var_all_df = X21r1[X21r1_prog_var_all,]
X21r1_prog_map_all = which(X21r1_prog_var_all_df[,'pos']!='REF')
X21r1_prog_map_all_df = X21r1_prog_var_all_df[X21r1_prog_map_all,]
X21r1_prog_map_exon_all = which(X21r1_prog_map_all_df[,'cDNApos']!='REF' & X21r1_prog_map_all_df[,'cDNApos']!='NA')
X21r1_prog_map_exon_all_df = X21r1_prog_map_all_df[X21r1_prog_map_exon_all,]
X21r1_prog_map_CADD = which(X21r1_prog_map_all_df[,'CADD.phred']!='NA')
X21r1_prog_map_CADD_df = X21r1_prog_map_all_df[X21r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X21r1_prog_var_thresh5 <- which(as.numeric(as.character(X21r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X21r1_prog_var_thresh5_df = X21r1_prog_var_all_df[X21r1_prog_var_thresh5,]
X21r1_prog_map_thresh5 <- which(as.numeric(as.character(X21r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X21r1_prog_map_thresh5_df = X21r1_prog_map_all_df[X21r1_prog_map_thresh5,]
X21r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X21r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X21r1_prog_map_exon_thresh5_df = X21r1_prog_map_exon_all_df[X21r1_prog_map_exon_thresh5,]
X21r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X21r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X21r1_prog_map_CADD_thresh5_df = X21r1_prog_map_CADD_df[X21r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X21r1_prog_var_all_lib_count = length(X21r1_prog_var_all_df$lib)
X21r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X21r1_prog_var_all_min_lib_counts = min(X21r1_prog_var_all_df$lib)
X21r1_prog_var_all_min_lib_counts
X21r1_prog_var_all_max_lib_counts = max(X21r1_prog_var_all_df$lib)
X21r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X21r1_prog_map_all_lib_count = length(X21r1_prog_map_all_df$lib)
X21r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X21r1_prog_map_all_min_lib_counts = min(X21r1_prog_map_all_df$lib)
X21r1_prog_map_all_min_lib_counts
X21r1_prog_map_all_max_lib_counts = max(X21r1_prog_map_all_df$lib)
X21r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X21r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X21r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X21r1_prog_var_all_pre_count = length(X21r1_prog_var_all_df$pre)
X21r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X21r1_prog_var_all_min_pre_counts = min(X21r1_prog_var_all_df$pre)
X21r1_prog_var_all_min_pre_counts
X21r1_prog_var_all_max_pre_counts = max(X21r1_prog_var_all_df$pre)
X21r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X21r1_prog_map_all_pre_count = length(X21r1_prog_map_all_df$pre)
X21r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X21r1_prog_map_all_min_pre_counts = min(X21r1_prog_map_all_df$pre)
X21r1_prog_map_all_min_pre_counts
X21r1_prog_map_all_max_pre_counts = max(X21r1_prog_map_all_df$pre)
X21r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X21r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X21r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X21r1_prog_map_all_post_count = length(X21r1_prog_map_all_df$post)
X21r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X21r1_prog_map_all_min_post_counts = min(X21r1_prog_map_all_df$post)
X21r1_prog_map_all_min_post_counts
X21r1_prog_map_all_max_post_counts = max(X21r1_prog_map_all_df$post)
X21r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X21r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X21r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X21r1_prog_map_all_syn_df <- X21r1_prog_map_all_df[which(X21r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X21r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X21r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X21r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X21r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X21r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X21r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X21r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X21r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X21r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X21r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X21r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X21r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X21r1_prog_map_all_min_rna_counts = min(X21r1_prog_map_exon_all_df$tHDR_rna)
X21r1_prog_map_all_min_rna_counts
X21r1_prog_map_all_max_rna_counts = max(X21r1_prog_map_exon_all_df$tHDR_rna)
X21r1_prog_map_all_max_rna_counts
X21r1_prog_map_all_min_rna_pseudo_freq = min(X21r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21r1_prog_map_all_min_rna_pseudo_freq
X21r1_prog_map_all_max_rna_pseudo_freq = max(X21r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21r1_prog_map_all_max_rna_pseudo_freq
X21r1_prog_map_all_min_rna_pre_ratio = min(X21r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21r1_prog_map_all_min_rna_pre_ratio
X21r1_prog_map_all_max_rna_pre_ratio = max(X21r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21r1_prog_map_all_max_rna_pre_ratio
X21r1_prog_map_all_min_rna_post_ratio = min(X21r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21r1_prog_map_all_min_rna_post_ratio
X21r1_prog_map_all_max_rna_post_ratio = max(X21r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X21r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X21r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X21r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X21r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X21r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X21r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X21r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X21r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X21r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X21r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X21r1_prog_map_all_df$post_pre_ratio),log2(X21r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X21r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X21r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X21r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X21r1_cSNV_all_corr_pre_count = length(X21r1_cSNV_all_df$corr_pre)
X21r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X21r1_cSNV_all_min_corr_pre_counts = min(X21r1_cSNV_all_df$corr_pre)
X21r1_cSNV_all_min_corr_pre_counts
X21r1_cSNV_all_max_corr_pre_counts = max(X21r1_cSNV_all_df$corr_pre)
X21r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X21r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X21r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X21r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X21r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X21r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_cSNV_all_corr_post_count = length(X21r1_cSNV_all_df$corr_post)
X21r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X21r1_cSNV_all_min_corr_post_counts = min(X21r1_cSNV_all_df$corr_post)
X21r1_cSNV_all_min_corr_post_counts
X21r1_cSNV_all_max_corr_post_counts = max(X21r1_cSNV_all_df$corr_post)
X21r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X21r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X21r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X21r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X21r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X21r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X21r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X21_p_hdr_snv = paste('p_hdr_',X21_cut_end,'_snv',sep='')
X21r1_pSNV_all <- which(X21r1[,X21_p_hdr_snv]=='True')
X21r1_pSNV_all_df = X21r1[X21r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_pSNV_all_lib_count = length(X21r1_pSNV_all_df$lib)
X21r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X21r1_pSNV_all_min_lib_counts = min(X21r1_pSNV_all_df$lib)
X21r1_pSNV_all_min_lib_counts
X21r1_pSNV_all_max_lib_counts = max(X21r1_pSNV_all_df$lib)
X21r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X21r1_pSNV_all_pre_count = length(X21r1_pSNV_all_df$pre)
X21r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X21r1_pSNV_all_min_pre_counts = min(X21r1_pSNV_all_df$pre)
X21r1_pSNV_all_min_pre_counts
X21r1_pSNV_all_max_pre_counts = max(X21r1_pSNV_all_df$pre)
X21r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X21r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X21r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_pSNV_all_post_count = length(X21r1_pSNV_all_df$post)
X21r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X21r1_pSNV_all_min_post_counts = min(X21r1_pSNV_all_df$post)
X21r1_pSNV_all_min_post_counts
X21r1_pSNV_all_max_post_counts = max(X21r1_pSNV_all_df$post)
X21r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X21r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X21r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_prog_map_thresh5_lib_count = length(X21r1_prog_map_thresh5_df$lib)
X21r1_prog_map_thresh5_lib_count
X21r1_prog_map_thresh5_min_lib_counts = min(X21r1_prog_map_thresh5_df$lib)
X21r1_prog_map_thresh5_min_lib_counts
X21r1_prog_map_thresh5_max_lib_counts = max(X21r1_prog_map_thresh5_df$lib)
X21r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X21r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X21r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_prog_map_thresh5_pre_count = length(X21r1_prog_map_thresh5_df$pre)
X21r1_prog_map_thresh5_pre_count
X21r1_prog_map_thresh5_min_pre_counts = min(X21r1_prog_map_thresh5_df$pre)
X21r1_prog_map_thresh5_min_pre_counts
X21r1_prog_map_thresh5_max_pre_counts = max(X21r1_prog_map_thresh5_df$pre)
X21r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r1_prog_map_thresh5_post_count = length(X21r1_prog_map_thresh5_df$post)
X21r1_prog_map_thresh5_post_count
X21r1_prog_map_thresh5_min_post_counts = min(X21r1_prog_map_thresh5_df$post)
X21r1_prog_map_thresh5_min_post_counts
X21r1_prog_map_thresh5_max_post_counts = max(X21r1_prog_map_thresh5_df$post)
X21r1_prog_map_thresh5_max_post_counts
X21r1_prog_map_thresh5_corr_post_count = length(X21r1_cSNV_all_df$corr_post)
X21r1_prog_map_thresh5_corr_post_count
X21r1_prog_map_thresh5_min_corr_post_counts = min(X21r1_cSNV_all_df$corr_post)
X21r1_prog_map_thresh5_min_corr_post_counts
X21r1_prog_map_thresh5_max_corr_post_counts = max(X21r1_cSNV_all_df$corr_post)
X21r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X21r1_pSNV_thresh5 <- which(X21r1[,X21_p_hdr_snv]=='True' & as.numeric(as.character(X21r1[,'pre_freq']))>=0.00001)
X21r1_pSNV_thresh5_df = X21r1[X21r1_pSNV_thresh5,]
X21r1_pSNV_thresh5_lib_count = length(X21r1_pSNV_thresh5_df$lib)
X21r1_pSNV_thresh5_lib_count
X21r1_pSNV_thresh5_min_lib_counts = min(X21r1_pSNV_thresh5_df$lib)
X21r1_pSNV_thresh5_min_lib_counts
X21r1_pSNV_thresh5_max_lib_counts = max(X21r1_pSNV_thresh5_df$lib)
X21r1_pSNV_thresh5_max_lib_counts
X21r1_pSNV_thresh5_pre_count = length(X21r1_pSNV_thresh5_df$pre)
X21r1_pSNV_thresh5_pre_count
X21r1_pSNV_thresh5_min_pre_counts = min(X21r1_pSNV_thresh5_df$pre)
X21r1_pSNV_thresh5_min_pre_counts
X21r1_pSNV_thresh5_max_pre_counts = max(X21r1_pSNV_thresh5_df$pre)
X21r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X21r1_pSNV_thresh5_post_count = length(X21r1_pSNV_thresh5_df$post)
X21r1_pSNV_thresh5_post_count
X21r1_pSNV_thresh5_min_post_counts = min(X21r1_pSNV_thresh5_df$post)
X21r1_pSNV_thresh5_min_post_counts
X21r1_pSNV_thresh5_max_post_counts = max(X21r1_pSNV_thresh5_df$post)
X21r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X21r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X21r1_pSNV_thresh5_post_pos

### Replicate 2
X21r2_cSNV_all <- which(X21r2[,'c_hdr_snv']=='True')
X21r2_cSNV_all_df = X21r2[X21r2_cSNV_all,]
X21r2_prog_var_all <- which(X21r2[,'all_hdr_variant']=='True' & X21r2[,'edit_string']!='-WT')
X21r2_prog_var_all_df = X21r2[X21r2_prog_var_all,]
X21r2_prog_map_all = which(X21r2_prog_var_all_df[,'pos']!='REF')
X21r2_prog_map_all_df = X21r2_prog_var_all_df[X21r2_prog_map_all,]
X21r2_prog_map_exon_all = which(X21r2_prog_map_all_df[,'cDNApos']!='REF' & X21r2_prog_map_all_df[,'cDNApos']!='NA')
X21r2_prog_map_exon_all_df = X21r2_prog_map_all_df[X21r2_prog_map_exon_all,]
X21r2_prog_map_CADD = which(X21r2_prog_map_all_df[,'CADD.phred']!='NA')
X21r2_prog_map_CADD_df = X21r2_prog_map_all_df[X21r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X21r2_prog_var_thresh5 <- which(as.numeric(as.character(X21r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X21r2_prog_var_thresh5_df = X21r2_prog_var_all_df[X21r2_prog_var_thresh5,]
X21r2_prog_map_thresh5 <- which(as.numeric(as.character(X21r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X21r2_prog_map_thresh5_df = X21r2_prog_map_all_df[X21r2_prog_map_thresh5,]
X21r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X21r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X21r2_prog_map_exon_thresh5_df = X21r2_prog_map_exon_all_df[X21r2_prog_map_exon_thresh5,]
X21r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X21r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X21r2_prog_map_CADD_thresh5_df = X21r2_prog_map_CADD_df[X21r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X21r2_prog_var_all_lib_count = length(X21r2_prog_var_all_df$lib)
X21r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X21r2_prog_var_all_min_lib_counts = min(X21r2_prog_var_all_df$lib)
X21r2_prog_var_all_min_lib_counts
X21r2_prog_var_all_max_lib_counts = max(X21r2_prog_var_all_df$lib)
X21r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X21r2_prog_map_all_lib_count = length(X21r2_prog_map_all_df$lib)
X21r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X21r2_prog_map_all_min_lib_counts = min(X21r2_prog_map_all_df$lib)
X21r2_prog_map_all_min_lib_counts
X21r2_prog_map_all_max_lib_counts = max(X21r2_prog_map_all_df$lib)
X21r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X21r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X21r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X21r2_prog_var_all_pre_count = length(X21r2_prog_var_all_df$pre)
X21r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X21r2_prog_var_all_min_pre_counts = min(X21r2_prog_var_all_df$pre)
X21r2_prog_var_all_min_pre_counts
X21r2_prog_var_all_max_pre_counts = max(X21r2_prog_var_all_df$pre)
X21r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X21r2_prog_map_all_pre_count = length(X21r2_prog_map_all_df$pre)
X21r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X21r2_prog_map_all_min_pre_counts = min(X21r2_prog_map_all_df$pre)
X21r2_prog_map_all_min_pre_counts
X21r2_prog_map_all_max_pre_counts = max(X21r2_prog_map_all_df$pre)
X21r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X21r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X21r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X21r2_prog_map_all_post_count = length(X21r2_prog_map_all_df$post)
X21r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X21r2_prog_map_all_min_post_counts = min(X21r2_prog_map_all_df$post)
X21r2_prog_map_all_min_post_counts
X21r2_prog_map_all_max_post_counts = max(X21r2_prog_map_all_df$post)
X21r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X21r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X21r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X21r2_prog_map_all_syn_df <- X21r2_prog_map_all_df[which(X21r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X21r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X21r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X21r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X21r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X21r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X21r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X21r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X21r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X21r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X21r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X21r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X21r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X21r2_prog_map_all_min_rna_counts = min(X21r2_prog_map_exon_all_df$tHDR_rna)
X21r2_prog_map_all_min_rna_counts
X21r2_prog_map_all_max_rna_counts = max(X21r2_prog_map_exon_all_df$tHDR_rna)
X21r2_prog_map_all_max_rna_counts
X21r2_prog_map_all_min_rna_pseudo_freq = min(X21r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21r2_prog_map_all_min_rna_pseudo_freq
X21r2_prog_map_all_max_rna_pseudo_freq = max(X21r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21r2_prog_map_all_max_rna_pseudo_freq
X21r2_prog_map_all_min_rna_pre_ratio = min(X21r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21r2_prog_map_all_min_rna_pre_ratio
X21r2_prog_map_all_max_rna_pre_ratio = max(X21r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21r2_prog_map_all_max_rna_pre_ratio
X21r2_prog_map_all_min_rna_post_ratio = min(X21r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21r2_prog_map_all_min_rna_post_ratio
X21r2_prog_map_all_max_rna_post_ratio = max(X21r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X21r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X21r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X21r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X21r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X21r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X21r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X21r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X21r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X21r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X21r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X21r2_prog_map_all_df$post_pre_ratio),log2(X21r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X21r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X21r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X21r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X21r2_cSNV_all_corr_pre_count = length(X21r2_cSNV_all_df$corr_pre)
X21r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X21r2_cSNV_all_min_corr_pre_counts = min(X21r2_cSNV_all_df$corr_pre)
X21r2_cSNV_all_min_corr_pre_counts
X21r2_cSNV_all_max_corr_pre_counts = max(X21r2_cSNV_all_df$corr_pre)
X21r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X21r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X21r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X21r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X21r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X21r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_cSNV_all_corr_post_count = length(X21r2_cSNV_all_df$corr_post)
X21r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X21r2_cSNV_all_min_corr_post_counts = min(X21r2_cSNV_all_df$corr_post)
X21r2_cSNV_all_min_corr_post_counts
X21r2_cSNV_all_max_corr_post_counts = max(X21r2_cSNV_all_df$corr_post)
X21r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X21r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X21r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X21r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X21r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X21r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X21r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X21_p_hdr_snv = paste('p_hdr_',X21_cut_end,'_snv',sep='')
X21r2_pSNV_all <- which(X21r2[,X21_p_hdr_snv]=='True')
X21r2_pSNV_all_df = X21r2[X21r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_pSNV_all_lib_count = length(X21r2_pSNV_all_df$lib)
X21r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X21r2_pSNV_all_min_lib_counts = min(X21r2_pSNV_all_df$lib)
X21r2_pSNV_all_min_lib_counts
X21r2_pSNV_all_max_lib_counts = max(X21r2_pSNV_all_df$lib)
X21r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X21r2_pSNV_all_pre_count = length(X21r2_pSNV_all_df$pre)
X21r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X21r2_pSNV_all_min_pre_counts = min(X21r2_pSNV_all_df$pre)
X21r2_pSNV_all_min_pre_counts
X21r2_pSNV_all_max_pre_counts = max(X21r2_pSNV_all_df$pre)
X21r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X21r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X21r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_pSNV_all_post_count = length(X21r2_pSNV_all_df$post)
X21r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X21r2_pSNV_all_min_post_counts = min(X21r2_pSNV_all_df$post)
X21r2_pSNV_all_min_post_counts
X21r2_pSNV_all_max_post_counts = max(X21r2_pSNV_all_df$post)
X21r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X21r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X21r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_prog_map_thresh5_lib_count = length(X21r2_prog_map_thresh5_df$lib)
X21r2_prog_map_thresh5_lib_count
X21r2_prog_map_thresh5_min_lib_counts = min(X21r2_prog_map_thresh5_df$lib)
X21r2_prog_map_thresh5_min_lib_counts
X21r2_prog_map_thresh5_max_lib_counts = max(X21r2_prog_map_thresh5_df$lib)
X21r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X21r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X21r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_prog_map_thresh5_pre_count = length(X21r2_prog_map_thresh5_df$pre)
X21r2_prog_map_thresh5_pre_count
X21r2_prog_map_thresh5_min_pre_counts = min(X21r2_prog_map_thresh5_df$pre)
X21r2_prog_map_thresh5_min_pre_counts
X21r2_prog_map_thresh5_max_pre_counts = max(X21r2_prog_map_thresh5_df$pre)
X21r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21r2_prog_map_thresh5_post_count = length(X21r2_prog_map_thresh5_df$post)
X21r2_prog_map_thresh5_post_count
X21r2_prog_map_thresh5_min_post_counts = min(X21r2_prog_map_thresh5_df$post)
X21r2_prog_map_thresh5_min_post_counts
X21r2_prog_map_thresh5_max_post_counts = max(X21r2_prog_map_thresh5_df$post)
X21r2_prog_map_thresh5_max_post_counts
X21r2_prog_map_thresh5_corr_post_count = length(X21r2_prog_map_thresh5_df$corr_post)
X21r2_prog_map_thresh5_corr_post_count
X21r2_prog_map_thresh5_min_corr_post_counts = min(X21r2_prog_map_thresh5_df$corr_post)
X21r2_prog_map_thresh5_min_corr_post_counts
X21r2_prog_map_thresh5_max_corr_post_counts = max(X21r2_prog_map_thresh5_df$corr_post)
X21r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X21r2_pSNV_thresh5 <- which(X21r2[,X21_p_hdr_snv]=='True' & as.numeric(as.character(X21r2[,'pre_freq']))>=0.00001)
X21r2_pSNV_thresh5_df = X21r2[X21r2_pSNV_thresh5,]
X21r2_pSNV_thresh5_lib_count = length(X21r2_pSNV_thresh5_df$lib)
X21r2_pSNV_thresh5_lib_count
X21r2_pSNV_thresh5_min_lib_counts = min(X21r2_pSNV_thresh5_df$lib)
X21r2_pSNV_thresh5_min_lib_counts
X21r2_pSNV_thresh5_max_lib_counts = max(X21r2_pSNV_thresh5_df$lib)
X21r2_pSNV_thresh5_max_lib_counts
X21r2_pSNV_thresh5_pre_count = length(X21r2_pSNV_thresh5_df$pre)
X21r2_pSNV_thresh5_pre_count
X21r2_pSNV_thresh5_min_pre_counts = min(X21r2_pSNV_thresh5_df$pre)
X21r2_pSNV_thresh5_min_pre_counts
X21r2_pSNV_thresh5_max_pre_counts = max(X21r2_pSNV_thresh5_df$pre)
X21r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X21r2_pSNV_thresh5_post_count = length(X21r2_pSNV_thresh5_df$post)
X21r2_pSNV_thresh5_post_count
X21r2_pSNV_thresh5_min_post_counts = min(X21r2_pSNV_thresh5_df$post)
X21r2_pSNV_thresh5_min_post_counts
X21r2_pSNV_thresh5_max_post_counts = max(X21r2_pSNV_thresh5_df$post)
X21r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X21r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X21r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X21r1_prog_var_thresh5_df:
X21r1_prog_var_thresh5_df_r2_int <- X21r1_prog_var_thresh5_df[which(X21r1_prog_var_thresh5_df$variant %in% X21r2_prog_var_thresh5_df$variant),]
#Intersection variants of X21r2_prog_var_thresh5_df:
X21r2_prog_var_thresh5_df_r1_int <- X21r2_prog_var_thresh5_df[which(X21r2_prog_var_thresh5_df$variant %in% X21r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X21r1_prog_var_thresh5_df_r2_int_ord <- X21r1_prog_var_thresh5_df_r2_int[order(X21r1_prog_var_thresh5_df_r2_int$variant),]
X21r2_prog_var_thresh5_df_r1_int_ord <- X21r2_prog_var_thresh5_df_r1_int[order(X21r2_prog_var_thresh5_df_r1_int$variant),]

dim(X21r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X21r1r2int_prog_var_thresh5_pre_count <- dim(X21r1_prog_var_thresh5_df_r2_int)[1] 
X21r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X21r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X21r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X21r2_prog_var_thresh5_df_r1_int_ord$pre
X21r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X21r2_prog_var_thresh5_df_r1_int_ord$lib
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X21r2_prog_var_thresh5_df_r1_int_ord$post
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X21r2_prog_var_thresh5_df_r1_int_ord$rna
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X21r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X21r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X21r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$post_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X21r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X21r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X21r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X21r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X21r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X21r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X21r2_prog_var_thresh5_df_r1_int_ord$corr_post
X21r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X21r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X21r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X21r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X21r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X21r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X21r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X21r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X21r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X21r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X21r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X21r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X21r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X21r1_cSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X21r1_cSNV_missense_post_pre_med <- unname(X21r1_cSNV_missense_post_pre_quarts[3])
X21r1_cSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X21r1_cSNV_syn_post_pre_med <- unname(X21r1_cSNV_syn_post_pre_quarts[3])
X21r1_cSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X21r1_cSNV_nonsense_post_pre_med <- unname(X21r1_cSNV_nonsense_post_pre_quarts[3])
X21r1_cSNV_syn_to_non_post_pre_spread <- X21r1_cSNV_syn_post_pre_med - X21r1_cSNV_nonsense_post_pre_med

X21r2_cSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X21r2_cSNV_missense_post_pre_med <- unname(X21r2_cSNV_missense_post_pre_quarts[3])
X21r2_cSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X21r2_cSNV_syn_post_pre_med <- unname(X21r2_cSNV_syn_post_pre_quarts[3])
X21r2_cSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X21r2_cSNV_nonsense_post_pre_med <- unname(X21r2_cSNV_nonsense_post_pre_quarts[3])
X21r2_cSNV_syn_to_non_post_pre_spread <- X21r2_cSNV_syn_post_pre_med - X21r2_cSNV_nonsense_post_pre_med

X21r1r2a_cSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X21r1r2a_cSNV_missense_post_pre_med <- unname(X21r1r2a_cSNV_missense_post_pre_quarts[3])
X21r1r2a_cSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X21r1r2a_cSNV_syn_post_pre_med <- unname(X21r1r2a_cSNV_syn_post_pre_quarts[3])
X21r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X21r1r2a_cSNV_nonsense_post_pre_med <- unname(X21r1r2a_cSNV_nonsense_post_pre_quarts[3])
X21r1r2a_cSNV_syn_to_non_post_pre_spread <- X21r1r2a_cSNV_syn_post_pre_med - X21r1r2a_cSNV_nonsense_post_pre_med

X21r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_cSNV_missense_post_pre_med <- unname(X21r1r2pw_cSNV_missense_post_pre_quarts[3])
X21r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_cSNV_syn_post_pre_med <- unname(X21r1r2pw_cSNV_syn_post_pre_quarts[3])
X21r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_cSNV_nonsense_post_pre_med <- unname(X21r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X21r1r2pw_cSNV_syn_to_non_post_pre_spread <- X21r1r2pw_cSNV_syn_post_pre_med - X21r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X21r1_tSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X21r1_tSNV_missense_post_pre_med <- unname(X21r1_tSNV_missense_post_pre_quarts[3])
X21r1_tSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X21r1_tSNV_syn_post_pre_med <- unname(X21r1_tSNV_syn_post_pre_quarts[3])
X21r1_tSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X21r1_tSNV_nonsense_post_pre_med <- unname(X21r1_tSNV_nonsense_post_pre_quarts[3])
X21r1_tSNV_syn_to_non_post_pre_spread <- X21r1_tSNV_syn_post_pre_med - X21r1_tSNV_nonsense_post_pre_med

X21r2_tSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X21r2_tSNV_missense_post_pre_med <- unname(X21r2_tSNV_missense_post_pre_quarts[3])
X21r2_tSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X21r2_tSNV_syn_post_pre_med <- unname(X21r2_tSNV_syn_post_pre_quarts[3])
X21r2_tSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X21r2_tSNV_nonsense_post_pre_med <- unname(X21r2_tSNV_nonsense_post_pre_quarts[3])
X21r2_tSNV_syn_to_non_post_pre_spread <- X21r2_tSNV_syn_post_pre_med - X21r2_tSNV_nonsense_post_pre_med

X21r1r2a_tSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X21r1r2a_tSNV_missense_post_pre_med <- unname(X21r1r2a_tSNV_missense_post_pre_quarts[3])
X21r1r2a_tSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X21r1r2a_tSNV_syn_post_pre_med <- unname(X21r1r2a_tSNV_syn_post_pre_quarts[3])
X21r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X21r1r2a_tSNV_nonsense_post_pre_med <- unname(X21r1r2a_tSNV_nonsense_post_pre_quarts[3])
X21r1r2a_tSNV_syn_to_non_post_pre_spread <- X21r1r2a_tSNV_syn_post_pre_med - X21r1r2a_tSNV_nonsense_post_pre_med

X21r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_tSNV_missense_post_pre_med <- unname(X21r1r2pw_tSNV_missense_post_pre_quarts[3])
X21r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_tSNV_syn_post_pre_med <- unname(X21r1r2pw_tSNV_syn_post_pre_quarts[3])
X21r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X21r1r2pw_tSNV_nonsense_post_pre_med <- unname(X21r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X21r1r2pw_tSNV_syn_to_non_post_pre_spread <- X21r1r2pw_tSNV_syn_post_pre_med - X21r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X21r1_cSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X21r1_cSNV_missense_post_lib_med <- unname(X21r1_cSNV_missense_post_lib_quarts[3])
X21r1_cSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X21r1_cSNV_syn_post_lib_med <- unname(X21r1_cSNV_syn_post_lib_quarts[3])
X21r1_cSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X21r1_cSNV_nonsense_post_lib_med <- unname(X21r1_cSNV_nonsense_post_lib_quarts[3])
X21r1_cSNV_syn_to_non_post_lib_spread <- X21r1_cSNV_syn_post_lib_med - X21r1_cSNV_nonsense_post_lib_med

X21r2_cSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X21r2_cSNV_missense_post_lib_med <- unname(X21r2_cSNV_missense_post_lib_quarts[3])
X21r2_cSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X21r2_cSNV_syn_post_lib_med <- unname(X21r2_cSNV_syn_post_lib_quarts[3])
X21r2_cSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X21r2_cSNV_nonsense_post_lib_med <- unname(X21r2_cSNV_nonsense_post_lib_quarts[3])
X21r2_cSNV_syn_to_non_post_lib_spread <- X21r2_cSNV_syn_post_lib_med - X21r2_cSNV_nonsense_post_lib_med

X21r1r2a_cSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_missense_post_lib_med <- unname(X21r1r2a_cSNV_missense_post_lib_quarts[3])
X21r1r2a_cSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_syn_post_lib_med <- unname(X21r1r2a_cSNV_syn_post_lib_quarts[3])
X21r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_nonsense_post_lib_med <- unname(X21r1r2a_cSNV_nonsense_post_lib_quarts[3])
X21r1r2a_cSNV_syn_to_non_post_lib_spread <- X21r1r2a_cSNV_syn_post_lib_med - X21r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X21r1_tSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X21r1_tSNV_missense_post_lib_med <- unname(X21r1_tSNV_missense_post_lib_quarts[3])
X21r1_tSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X21r1_tSNV_syn_post_lib_med <- unname(X21r1_tSNV_syn_post_lib_quarts[3])
X21r1_tSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X21r1_tSNV_nonsense_post_lib_med <- unname(X21r1_tSNV_nonsense_post_lib_quarts[3])
X21r1_tSNV_syn_to_non_post_lib_spread <- X21r1_tSNV_syn_post_lib_med - X21r1_tSNV_nonsense_post_lib_med

X21r2_tSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X21r2_tSNV_missense_post_lib_med <- unname(X21r2_tSNV_missense_post_lib_quarts[3])
X21r2_tSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X21r2_tSNV_syn_post_lib_med <- unname(X21r2_tSNV_syn_post_lib_quarts[3])
X21r2_tSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X21r2_tSNV_nonsense_post_lib_med <- unname(X21r2_tSNV_nonsense_post_lib_quarts[3])
X21r2_tSNV_syn_to_non_post_lib_spread <- X21r2_tSNV_syn_post_lib_med - X21r2_tSNV_nonsense_post_lib_med

X21r1r2a_tSNV_missense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_missense_post_lib_med <- unname(X21r1r2a_tSNV_missense_post_lib_quarts[3])
X21r1r2a_tSNV_syn_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_syn_post_lib_med <- unname(X21r1r2a_tSNV_syn_post_lib_quarts[3])
X21r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_nonsense_post_lib_med <- unname(X21r1r2a_tSNV_nonsense_post_lib_quarts[3])
X21r1r2a_tSNV_syn_to_non_post_lib_spread <- X21r1r2a_tSNV_syn_post_lib_med - X21r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X21r1_cSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X21r1_cSNV_missense_pre_lib_med <- unname(X21r1_cSNV_missense_pre_lib_quarts[3])
X21r1_cSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X21r1_cSNV_syn_pre_lib_med <- unname(X21r1_cSNV_syn_pre_lib_quarts[3])
X21r1_cSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X21r1_cSNV_nonsense_pre_lib_med <- unname(X21r1_cSNV_nonsense_pre_lib_quarts[3])
X21r1_cSNV_syn_to_non_pre_lib_spread <- X21r1_cSNV_syn_pre_lib_med - X21r1_cSNV_nonsense_pre_lib_med

X21r2_cSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X21r2_cSNV_missense_pre_lib_med <- unname(X21r2_cSNV_missense_pre_lib_quarts[3])
X21r2_cSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X21r2_cSNV_syn_pre_lib_med <- unname(X21r2_cSNV_syn_pre_lib_quarts[3])
X21r2_cSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X21r2_cSNV_nonsense_pre_lib_med <- unname(X21r2_cSNV_nonsense_pre_lib_quarts[3])
X21r2_cSNV_syn_to_non_pre_lib_spread <- X21r2_cSNV_syn_pre_lib_med - X21r2_cSNV_nonsense_pre_lib_med

X21r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_missense_pre_lib_med <- unname(X21r1r2a_cSNV_missense_pre_lib_quarts[3])
X21r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_syn_pre_lib_med <- unname(X21r1r2a_cSNV_syn_pre_lib_quarts[3])
X21r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X21r1r2a_cSNV_nonsense_pre_lib_med <- unname(X21r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X21r1r2a_cSNV_syn_to_non_pre_lib_spread <- X21r1r2a_cSNV_syn_pre_lib_med - X21r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X21r1_tSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X21r1_tSNV_missense_pre_lib_med <- unname(X21r1_tSNV_missense_pre_lib_quarts[3])
X21r1_tSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X21r1_tSNV_syn_pre_lib_med <- unname(X21r1_tSNV_syn_pre_lib_quarts[3])
X21r1_tSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X21r1_tSNV_nonsense_pre_lib_med <- unname(X21r1_tSNV_nonsense_pre_lib_quarts[3])
X21r1_tSNV_syn_to_non_pre_lib_spread <- X21r1_tSNV_syn_pre_lib_med - X21r1_tSNV_nonsense_pre_lib_med

X21r2_tSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X21r2_tSNV_missense_pre_lib_med <- unname(X21r2_tSNV_missense_pre_lib_quarts[3])
X21r2_tSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X21r2_tSNV_syn_pre_lib_med <- unname(X21r2_tSNV_syn_pre_lib_quarts[3])
X21r2_tSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X21r2_tSNV_nonsense_pre_lib_med <- unname(X21r2_tSNV_nonsense_pre_lib_quarts[3])
X21r2_tSNV_syn_to_non_pre_lib_spread <- X21r2_tSNV_syn_pre_lib_med - X21r2_tSNV_nonsense_pre_lib_med

X21r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_missense_pre_lib_med <- unname(X21r1r2a_tSNV_missense_pre_lib_quarts[3])
X21r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_syn_pre_lib_med <- unname(X21r1r2a_tSNV_syn_pre_lib_quarts[3])
X21r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X21r1r2a_tSNV_nonsense_pre_lib_med <- unname(X21r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X21r1r2a_tSNV_syn_to_non_pre_lib_spread <- X21r1r2a_tSNV_syn_pre_lib_med - X21r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X21r1_tSNV_syn_rna_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X21r1_tSNV_syn_rna_pre_med <- unname(X21r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X21r1_tSNV_syn_rna_post_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X21r1_tSNV_syn_rna_post_med <- unname(X21r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X21r2_tSNV_syn_rna_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X21r2_tSNV_syn_rna_pre_med <- unname(X21r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X21r2_tSNV_syn_rna_post_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X21r2_tSNV_syn_rna_post_med <- unname(X21r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X21r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X21r1r2a_tSNV_syn_rna_pre_med <- unname(X21r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X21r1r2a_tSNV_syn_rna_post_quarts <- quantile(X21r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X21r1r2a_tSNV_syn_rna_post_med <- unname(X21r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X21r1_cSNV_syn_pre_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X21r1_cSNV_syn_post_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X21r1_cSNV_syn_post_lib_med
# tHDR
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X21r1_tSNV_syn_pre_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X21r1_tSNV_syn_post_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X21r1_tSNV_syn_post_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X21r1_tSNV_syn_rna_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X21r1_tSNV_syn_rna_post_med

#r2
X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X21r2_cSNV_syn_pre_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X21r2_cSNV_syn_post_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X21r2_cSNV_syn_post_lib_med
# tHDR
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X21r2_tSNV_syn_pre_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X21r2_tSNV_syn_post_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X21r2_tSNV_syn_post_lib_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X21r2_tSNV_syn_rna_pre_med
X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X21r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X21r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X21r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X21r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X21r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X21r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X21r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X21r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X21r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X21r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X21r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X21r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X21r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X21r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X21r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X21r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X21r1_prog_var_thresh5_df_r2_int_ord[which(X21r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X21r1_prog_var_thresh5_df_r2_int_ord
X21r1_prog_map_thresh5_df_r2_int_ord = which(X21r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X21r1_prog_map_thresh5_df_r2_int_ord_df = X21r1_prog_var_thresh5_df_r2_int_ord[X21r1_prog_map_thresh5_df_r2_int_ord,]
X21r1_prog_map_exon_thresh5_df_r2_int_ord = which(X21r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X21r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X21r1_prog_map_exon_thresh5_df_r2_int_ord_df = X21r1_prog_map_thresh5_df_r2_int_ord_df[X21r1_prog_map_exon_thresh5_df_r2_int_ord,]
X21r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X21r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X21r1_prog_map_thresh5_df_r2_int_ord_df[X21r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X21r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X21r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X21r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X21r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X21r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X21r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X21r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X21r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X21r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X21r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X21r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X21r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X21r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X21r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X21r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X21r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X21r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X21r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X21r1r2_cSNV_r1_post_by_r2_post_cor_s
X21r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X21r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X21r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X21r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X21r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X21r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X21r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X21r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X21r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X21r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X21r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X21r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X21r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X21r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X21r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X21r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X21r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X21r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1_cSNV_post_pre_by_cadd_cor_s
#X21r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X21r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r2_cSNV_post_pre_by_cadd_cor_s

#X21r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X21r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1_cSNV_post_lib_by_cadd_cor_s
#X21r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X21r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X21r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X21r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1_tSNV_post_pre_by_cadd_cor_s
#X21r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X21r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r2_tSNV_post_pre_by_cadd_cor_s

#X21r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X21r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1_tSNV_post_lib_by_cadd_cor_s
#X21r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X21r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X21r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X21r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X21r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X21r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X21r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X21r1_prog_var_all_lib_count
X21r1_prog_var_all_pre_count
X21r2_prog_var_all_pre_count
X21r1_prog_map_thresh5_lib_count
X21r1_prog_map_thresh5_pre_count
X21r2_prog_map_thresh5_pre_count
X21r1_prog_map_thresh5_post_count
X21r2_prog_map_thresh5_post_count
X21r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X21r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X21r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X21r1r2_cSNV_r1_post_by_r2_post_cor_s
X21r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X21r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X21r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X21r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X21r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X21r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X21r1_cSNV_post_pre_by_cadd_cor_s
X21r2_cSNV_post_pre_by_cadd_cor_s
X21r1_cSNV_post_lib_by_cadd_cor_s
X21r2_cSNV_post_lib_by_cadd_cor_s
X21r1_tSNV_post_pre_by_cadd_cor_s
X21r2_tSNV_post_pre_by_cadd_cor_s
X21r1_tSNV_post_lib_by_cadd_cor_s
X21r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X21r1r2a_cSNV_post_pre_by_cadd_cor_s
X21r1r2w_cSNV_post_pre_by_cadd_cor_s
X21r1r2a_cSNV_post_lib_by_cadd_cor_s
X21r1r2w_cSNV_post_lib_by_cadd_cor_s
X21r1r2a_tSNV_post_pre_by_cadd_cor_s
X21r1r2w_tSNV_post_pre_by_cadd_cor_s
X21r1r2a_tSNV_post_lib_by_cadd_cor_s
X21r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X21r1_cSNV_syn_to_non_post_pre_spread
X21r2_cSNV_syn_to_non_post_pre_spread
X21r1r2a_cSNV_syn_to_non_post_pre_spread
X21r1_cSNV_syn_to_non_post_lib_spread
X21r2_cSNV_syn_to_non_post_lib_spread
X21r1r2a_cSNV_syn_to_non_post_lib_spread
X21r1_tSNV_syn_to_non_post_pre_spread
X21r2_tSNV_syn_to_non_post_pre_spread
X21r1r2a_tSNV_syn_to_non_post_pre_spread
X21r1_tSNV_syn_to_non_post_lib_spread
X21r2_tSNV_syn_to_non_post_lib_spread
X21r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X21r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X21r1_prog_map_thresh5_df_r2_int_ord_df[which(X21r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X21r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df[which(X21r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df[which(X21r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df[which(X21r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X21r1_cSNV_pre_lib_cors = cor(log2(X21r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X21r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21r1_tSNV_pre_lib_cors = cor(log2(X21r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21r1_cSNV_post_lib_cors = cor(log2(X21r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X21r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X21r1_tSNV_post_lib_cors = cor(log2(X21r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X21r1_cSNV_post_pre_cors = cor(log2(X21r1_prog_map_thresh5_df$post_pseudo_freq),log2(X21r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21r1_tSNV_post_pre_cors = cor(log2(X21r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X21r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21r1_cSNV_rna_lib_cors = cor(log2(X21r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X21r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21r1_tSNV_rna_lib_cors = cor(log2(X21r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X21r1_cSNV_rna_pre_cors = cor(log2(X21r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X21r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21r1_tSNV_rna_pre_cors = cor(log2(X21r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X21r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21r1r2_cSNV_pre_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X21r1r2_tSNV_pre_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X21r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X21r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X21r1r2_cSNV_post_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X21r1r2_tSNV_post_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X21r1r2_cSNV_post_lib_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X21r1r2_tSNV_post_lib_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X21r1r2_cSNV_post_pre_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X21r1r2_tSNV_post_pre_ratio_cors = cor(log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X21r1r2_cSNV_rna_cors = cor(log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X21r1r2_tSNV_rna_cors = cor(log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X21r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X21r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X21r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X21r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X21r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X21r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X21r1_cors <- c("X21r1",X21r1_cSNV_pre_lib_cors,X21r1_tSNV_pre_lib_cors,X21r1_cSNV_post_lib_cors,X21r1_tSNV_post_lib_cors,X21r1_cSNV_post_pre_cors,X21r1_tSNV_post_pre_cors,X21r1_cSNV_rna_lib_cors,X21r1_tSNV_rna_lib_cors,X21r1_cSNV_rna_pre_cors,X21r1_tSNV_rna_pre_cors,X21r1r2_cSNV_pre_cors,X21r1r2_tSNV_pre_cors,X21r1r2_cSNV_pre_lib_ratio_cors,X21r1r2_tSNV_pre_lib_ratio_cors,X21r1r2_cSNV_post_cors,X21r1r2_tSNV_post_cors,X21r1r2_cSNV_post_lib_ratio_cors,X21r1r2_tSNV_post_lib_ratio_cors,X21r1r2_cSNV_post_pre_ratio_cors,X21r1r2_tSNV_post_pre_ratio_cors,X21r1r2_cSNV_rna_cors,X21r1r2_tSNV_rna_cors,X21r1r2_tSNV_rna_pre_ratio_cors,X21r1_cSNV_pre_lib_ratio_cadd_cors,X21r1_tSNV_pre_lib_ratio_cadd_cors,X21r1_cSNV_post_lib_ratio_cadd_cors,X21r1_tSNV_post_lib_ratio_cadd_cors,X21r1_cSNV_post_pre_ratio_cadd_cors,X21r1_tSNV_post_pre_ratio_cadd_cors,X21r1_cSNV_post_pre_ratio_cadd_missense_cors,X21r1_tSNV_post_pre_ratio_cadd_missense_cors,X21r1_cSNV_post_pre_ratio_polyphen_missense_cors,X21r1_tSNV_post_pre_ratio_polyphen_missense_cors,X21r1_cSNV_post_pre_ratio_grantham_missense_cors,X21r1_tSNV_post_pre_ratio_grantham_missense_cors,X21r1r2a_cSNV_pre_lib_ratio_cadd_cors,X21r1r2a_tSNV_pre_lib_ratio_cadd_cors,X21r1r2a_cSNV_post_lib_ratio_cadd_cors,X21r1r2a_tSNV_post_lib_ratio_cadd_cors,X21r1r2a_cSNV_post_pre_ratio_cadd_cors,X21r1r2a_tSNV_post_pre_ratio_cadd_cors,X21r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X21r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X21r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X21r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X21r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X21r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X21r1r2w_cSNV_pre_lib_ratio_cadd_cors,X21r1r2w_cSNV_post_lib_ratio_cadd_cors,X21r1r2w_cSNV_post_pre_ratio_cadd_cors,X21r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X21r2_cSNV_pre_lib_cors = cor(log2(X21r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X21r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21r2_tSNV_pre_lib_cors = cor(log2(X21r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21r2_cSNV_post_lib_cors = cor(log2(X21r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X21r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X21r2_tSNV_post_lib_cors = cor(log2(X21r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X21r2_cSNV_post_pre_cors = cor(log2(X21r2_prog_map_thresh5_df$post_pseudo_freq),log2(X21r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21r2_tSNV_post_pre_cors = cor(log2(X21r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X21r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21r2_cSNV_rna_lib_cors = cor(log2(X21r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X21r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21r2_tSNV_rna_lib_cors = cor(log2(X21r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X21r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X21r2_cSNV_rna_pre_cors = cor(log2(X21r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X21r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21r2_tSNV_rna_pre_cors = cor(log2(X21r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X21r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X21r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X21r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X21r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X21r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X21r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X21r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X21r2_cors <- c("X21r2",X21r2_cSNV_pre_lib_cors,X21r2_tSNV_pre_lib_cors,X21r2_cSNV_post_lib_cors,X21r2_tSNV_post_lib_cors,X21r2_cSNV_post_pre_cors,X21r2_tSNV_post_pre_cors,X21r2_cSNV_rna_lib_cors,X21r2_tSNV_rna_lib_cors,X21r2_cSNV_rna_pre_cors,X21r2_tSNV_rna_pre_cors,X21r1r2_cSNV_pre_cors,X21r1r2_tSNV_pre_cors,X21r1r2_cSNV_pre_lib_ratio_cors,X21r1r2_tSNV_pre_lib_ratio_cors,X21r1r2_cSNV_post_cors,X21r1r2_tSNV_post_cors,X21r1r2_cSNV_post_lib_ratio_cors,X21r1r2_tSNV_post_lib_ratio_cors,X21r1r2_cSNV_post_pre_ratio_cors,X21r1r2_tSNV_post_pre_ratio_cors,X21r1r2_cSNV_rna_cors,X21r1r2_tSNV_rna_cors,X21r1r2_tSNV_rna_pre_ratio_cors,X21r2_cSNV_pre_lib_ratio_cadd_cors,X21r2_tSNV_pre_lib_ratio_cadd_cors,X21r2_cSNV_post_lib_ratio_cadd_cors,X21r2_tSNV_post_lib_ratio_cadd_cors,X21r2_cSNV_post_pre_ratio_cadd_cors,X21r2_tSNV_post_pre_ratio_cadd_cors,X21r2_cSNV_post_pre_ratio_cadd_missense_cors,X21r2_tSNV_post_pre_ratio_cadd_missense_cors,X21r2_cSNV_post_pre_ratio_polyphen_missense_cors,X21r2_tSNV_post_pre_ratio_polyphen_missense_cors,X21r2_cSNV_post_pre_ratio_grantham_missense_cors,X21r2_tSNV_post_pre_ratio_grantham_missense_cors,X21r1r2a_cSNV_pre_lib_ratio_cadd_cors,X21r1r2a_tSNV_pre_lib_ratio_cadd_cors,X21r1r2a_cSNV_post_lib_ratio_cadd_cors,X21r1r2a_tSNV_post_lib_ratio_cadd_cors,X21r1r2a_cSNV_post_pre_ratio_cadd_cors,X21r1r2a_tSNV_post_pre_ratio_cadd_cors,X21r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X21r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X21r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X21r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X21r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X21r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X21r1r2w_cSNV_pre_lib_ratio_cadd_cors,X21r1r2w_cSNV_post_lib_ratio_cadd_cors,X21r1r2w_cSNV_post_pre_ratio_cadd_cors,X21r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X21r1)
rm(X21r2)
gc()
X22r1_file <- paste(experiment_dir_171011,'X22r1','_annotated.txt',sep='')
X22r2_file <- paste(experiment_dir_171011,'X22r2','_annotated.txt',sep='')
X22r1 <- read.table(X22r1_file, header=TRUE, sep="\t")
X22r2 <- read.table(X22r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X22 <- editing_info[which(editing_info$amplicon == 'X22'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X22_HDR_5_SNV = as.character(editing_info_X22$HDR_5_SNV)
X22_HDR_3_SNV = as.character(editing_info_X22$HDR_3_SNV)
#X22_cut_pos = as.character(editing_info_X22$cut_pos)
X22_cut_end = as.character(editing_info_X22$cut_end)
X22_mut_start = as.character(editing_info_X22$mut_start)
X22_mut_end = as.character(editing_info_X22$mut_end)
### Replicate 1
X22r1_cSNV_all <- which(X22r1[,'c_hdr_snv']=='True')
X22r1_cSNV_all_df = X22r1[X22r1_cSNV_all,]
X22r1_prog_var_all <- which(X22r1[,'all_hdr_variant']=='True' & X22r1[,'edit_string']!='-WT')
X22r1_prog_var_all_df = X22r1[X22r1_prog_var_all,]
X22r1_prog_map_all = which(X22r1_prog_var_all_df[,'pos']!='REF')
X22r1_prog_map_all_df = X22r1_prog_var_all_df[X22r1_prog_map_all,]
X22r1_prog_map_exon_all = which(X22r1_prog_map_all_df[,'cDNApos']!='REF' & X22r1_prog_map_all_df[,'cDNApos']!='NA')
X22r1_prog_map_exon_all_df = X22r1_prog_map_all_df[X22r1_prog_map_exon_all,]
X22r1_prog_map_CADD = which(X22r1_prog_map_all_df[,'CADD.phred']!='NA')
X22r1_prog_map_CADD_df = X22r1_prog_map_all_df[X22r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X22r1_prog_var_thresh5 <- which(as.numeric(as.character(X22r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X22r1_prog_var_thresh5_df = X22r1_prog_var_all_df[X22r1_prog_var_thresh5,]
X22r1_prog_map_thresh5 <- which(as.numeric(as.character(X22r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X22r1_prog_map_thresh5_df = X22r1_prog_map_all_df[X22r1_prog_map_thresh5,]
X22r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X22r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X22r1_prog_map_exon_thresh5_df = X22r1_prog_map_exon_all_df[X22r1_prog_map_exon_thresh5,]
X22r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X22r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X22r1_prog_map_CADD_thresh5_df = X22r1_prog_map_CADD_df[X22r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X22r1_prog_var_all_lib_count = length(X22r1_prog_var_all_df$lib)
X22r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X22r1_prog_var_all_min_lib_counts = min(X22r1_prog_var_all_df$lib)
X22r1_prog_var_all_min_lib_counts
X22r1_prog_var_all_max_lib_counts = max(X22r1_prog_var_all_df$lib)
X22r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X22r1_prog_map_all_lib_count = length(X22r1_prog_map_all_df$lib)
X22r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X22r1_prog_map_all_min_lib_counts = min(X22r1_prog_map_all_df$lib)
X22r1_prog_map_all_min_lib_counts
X22r1_prog_map_all_max_lib_counts = max(X22r1_prog_map_all_df$lib)
X22r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X22r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X22r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X22r1_prog_var_all_pre_count = length(X22r1_prog_var_all_df$pre)
X22r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X22r1_prog_var_all_min_pre_counts = min(X22r1_prog_var_all_df$pre)
X22r1_prog_var_all_min_pre_counts
X22r1_prog_var_all_max_pre_counts = max(X22r1_prog_var_all_df$pre)
X22r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X22r1_prog_map_all_pre_count = length(X22r1_prog_map_all_df$pre)
X22r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X22r1_prog_map_all_min_pre_counts = min(X22r1_prog_map_all_df$pre)
X22r1_prog_map_all_min_pre_counts
X22r1_prog_map_all_max_pre_counts = max(X22r1_prog_map_all_df$pre)
X22r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X22r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X22r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X22r1_prog_map_all_post_count = length(X22r1_prog_map_all_df$post)
X22r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X22r1_prog_map_all_min_post_counts = min(X22r1_prog_map_all_df$post)
X22r1_prog_map_all_min_post_counts
X22r1_prog_map_all_max_post_counts = max(X22r1_prog_map_all_df$post)
X22r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X22r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X22r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X22r1_prog_map_all_syn_df <- X22r1_prog_map_all_df[which(X22r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X22r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X22r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X22r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X22r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X22r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X22r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X22r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X22r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X22r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X22r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X22r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X22r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X22r1_prog_map_all_min_rna_counts = min(X22r1_prog_map_exon_all_df$tHDR_rna)
X22r1_prog_map_all_min_rna_counts
X22r1_prog_map_all_max_rna_counts = max(X22r1_prog_map_exon_all_df$tHDR_rna)
X22r1_prog_map_all_max_rna_counts
X22r1_prog_map_all_min_rna_pseudo_freq = min(X22r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22r1_prog_map_all_min_rna_pseudo_freq
X22r1_prog_map_all_max_rna_pseudo_freq = max(X22r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22r1_prog_map_all_max_rna_pseudo_freq
X22r1_prog_map_all_min_rna_pre_ratio = min(X22r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22r1_prog_map_all_min_rna_pre_ratio
X22r1_prog_map_all_max_rna_pre_ratio = max(X22r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22r1_prog_map_all_max_rna_pre_ratio
X22r1_prog_map_all_min_rna_post_ratio = min(X22r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22r1_prog_map_all_min_rna_post_ratio
X22r1_prog_map_all_max_rna_post_ratio = max(X22r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X22r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X22r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X22r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X22r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X22r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X22r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X22r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X22r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X22r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X22r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X22r1_prog_map_all_df$post_pre_ratio),log2(X22r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X22r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X22r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X22r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X22r1_cSNV_all_corr_pre_count = length(X22r1_cSNV_all_df$corr_pre)
X22r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X22r1_cSNV_all_min_corr_pre_counts = min(X22r1_cSNV_all_df$corr_pre)
X22r1_cSNV_all_min_corr_pre_counts
X22r1_cSNV_all_max_corr_pre_counts = max(X22r1_cSNV_all_df$corr_pre)
X22r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X22r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X22r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X22r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X22r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X22r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_cSNV_all_corr_post_count = length(X22r1_cSNV_all_df$corr_post)
X22r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X22r1_cSNV_all_min_corr_post_counts = min(X22r1_cSNV_all_df$corr_post)
X22r1_cSNV_all_min_corr_post_counts
X22r1_cSNV_all_max_corr_post_counts = max(X22r1_cSNV_all_df$corr_post)
X22r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X22r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X22r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X22r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X22r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X22r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X22r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X22_p_hdr_snv = paste('p_hdr_',X22_cut_end,'_snv',sep='')
X22r1_pSNV_all <- which(X22r1[,X22_p_hdr_snv]=='True')
X22r1_pSNV_all_df = X22r1[X22r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_pSNV_all_lib_count = length(X22r1_pSNV_all_df$lib)
X22r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X22r1_pSNV_all_min_lib_counts = min(X22r1_pSNV_all_df$lib)
X22r1_pSNV_all_min_lib_counts
X22r1_pSNV_all_max_lib_counts = max(X22r1_pSNV_all_df$lib)
X22r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X22r1_pSNV_all_pre_count = length(X22r1_pSNV_all_df$pre)
X22r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X22r1_pSNV_all_min_pre_counts = min(X22r1_pSNV_all_df$pre)
X22r1_pSNV_all_min_pre_counts
X22r1_pSNV_all_max_pre_counts = max(X22r1_pSNV_all_df$pre)
X22r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X22r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X22r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_pSNV_all_post_count = length(X22r1_pSNV_all_df$post)
X22r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X22r1_pSNV_all_min_post_counts = min(X22r1_pSNV_all_df$post)
X22r1_pSNV_all_min_post_counts
X22r1_pSNV_all_max_post_counts = max(X22r1_pSNV_all_df$post)
X22r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X22r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X22r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_prog_map_thresh5_lib_count = length(X22r1_prog_map_thresh5_df$lib)
X22r1_prog_map_thresh5_lib_count
X22r1_prog_map_thresh5_min_lib_counts = min(X22r1_prog_map_thresh5_df$lib)
X22r1_prog_map_thresh5_min_lib_counts
X22r1_prog_map_thresh5_max_lib_counts = max(X22r1_prog_map_thresh5_df$lib)
X22r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X22r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X22r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_prog_map_thresh5_pre_count = length(X22r1_prog_map_thresh5_df$pre)
X22r1_prog_map_thresh5_pre_count
X22r1_prog_map_thresh5_min_pre_counts = min(X22r1_prog_map_thresh5_df$pre)
X22r1_prog_map_thresh5_min_pre_counts
X22r1_prog_map_thresh5_max_pre_counts = max(X22r1_prog_map_thresh5_df$pre)
X22r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r1_prog_map_thresh5_post_count = length(X22r1_prog_map_thresh5_df$post)
X22r1_prog_map_thresh5_post_count
X22r1_prog_map_thresh5_min_post_counts = min(X22r1_prog_map_thresh5_df$post)
X22r1_prog_map_thresh5_min_post_counts
X22r1_prog_map_thresh5_max_post_counts = max(X22r1_prog_map_thresh5_df$post)
X22r1_prog_map_thresh5_max_post_counts
X22r1_prog_map_thresh5_corr_post_count = length(X22r1_cSNV_all_df$corr_post)
X22r1_prog_map_thresh5_corr_post_count
X22r1_prog_map_thresh5_min_corr_post_counts = min(X22r1_cSNV_all_df$corr_post)
X22r1_prog_map_thresh5_min_corr_post_counts
X22r1_prog_map_thresh5_max_corr_post_counts = max(X22r1_cSNV_all_df$corr_post)
X22r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X22r1_pSNV_thresh5 <- which(X22r1[,X22_p_hdr_snv]=='True' & as.numeric(as.character(X22r1[,'pre_freq']))>=0.00001)
X22r1_pSNV_thresh5_df = X22r1[X22r1_pSNV_thresh5,]
X22r1_pSNV_thresh5_lib_count = length(X22r1_pSNV_thresh5_df$lib)
X22r1_pSNV_thresh5_lib_count
X22r1_pSNV_thresh5_min_lib_counts = min(X22r1_pSNV_thresh5_df$lib)
X22r1_pSNV_thresh5_min_lib_counts
X22r1_pSNV_thresh5_max_lib_counts = max(X22r1_pSNV_thresh5_df$lib)
X22r1_pSNV_thresh5_max_lib_counts
X22r1_pSNV_thresh5_pre_count = length(X22r1_pSNV_thresh5_df$pre)
X22r1_pSNV_thresh5_pre_count
X22r1_pSNV_thresh5_min_pre_counts = min(X22r1_pSNV_thresh5_df$pre)
X22r1_pSNV_thresh5_min_pre_counts
X22r1_pSNV_thresh5_max_pre_counts = max(X22r1_pSNV_thresh5_df$pre)
X22r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X22r1_pSNV_thresh5_post_count = length(X22r1_pSNV_thresh5_df$post)
X22r1_pSNV_thresh5_post_count
X22r1_pSNV_thresh5_min_post_counts = min(X22r1_pSNV_thresh5_df$post)
X22r1_pSNV_thresh5_min_post_counts
X22r1_pSNV_thresh5_max_post_counts = max(X22r1_pSNV_thresh5_df$post)
X22r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X22r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X22r1_pSNV_thresh5_post_pos

### Replicate 2
X22r2_cSNV_all <- which(X22r2[,'c_hdr_snv']=='True')
X22r2_cSNV_all_df = X22r2[X22r2_cSNV_all,]
X22r2_prog_var_all <- which(X22r2[,'all_hdr_variant']=='True' & X22r2[,'edit_string']!='-WT')
X22r2_prog_var_all_df = X22r2[X22r2_prog_var_all,]
X22r2_prog_map_all = which(X22r2_prog_var_all_df[,'pos']!='REF')
X22r2_prog_map_all_df = X22r2_prog_var_all_df[X22r2_prog_map_all,]
X22r2_prog_map_exon_all = which(X22r2_prog_map_all_df[,'cDNApos']!='REF' & X22r2_prog_map_all_df[,'cDNApos']!='NA')
X22r2_prog_map_exon_all_df = X22r2_prog_map_all_df[X22r2_prog_map_exon_all,]
X22r2_prog_map_CADD = which(X22r2_prog_map_all_df[,'CADD.phred']!='NA')
X22r2_prog_map_CADD_df = X22r2_prog_map_all_df[X22r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X22r2_prog_var_thresh5 <- which(as.numeric(as.character(X22r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X22r2_prog_var_thresh5_df = X22r2_prog_var_all_df[X22r2_prog_var_thresh5,]
X22r2_prog_map_thresh5 <- which(as.numeric(as.character(X22r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X22r2_prog_map_thresh5_df = X22r2_prog_map_all_df[X22r2_prog_map_thresh5,]
X22r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X22r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X22r2_prog_map_exon_thresh5_df = X22r2_prog_map_exon_all_df[X22r2_prog_map_exon_thresh5,]
X22r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X22r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X22r2_prog_map_CADD_thresh5_df = X22r2_prog_map_CADD_df[X22r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X22r2_prog_var_all_lib_count = length(X22r2_prog_var_all_df$lib)
X22r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X22r2_prog_var_all_min_lib_counts = min(X22r2_prog_var_all_df$lib)
X22r2_prog_var_all_min_lib_counts
X22r2_prog_var_all_max_lib_counts = max(X22r2_prog_var_all_df$lib)
X22r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X22r2_prog_map_all_lib_count = length(X22r2_prog_map_all_df$lib)
X22r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X22r2_prog_map_all_min_lib_counts = min(X22r2_prog_map_all_df$lib)
X22r2_prog_map_all_min_lib_counts
X22r2_prog_map_all_max_lib_counts = max(X22r2_prog_map_all_df$lib)
X22r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X22r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X22r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X22r2_prog_var_all_pre_count = length(X22r2_prog_var_all_df$pre)
X22r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X22r2_prog_var_all_min_pre_counts = min(X22r2_prog_var_all_df$pre)
X22r2_prog_var_all_min_pre_counts
X22r2_prog_var_all_max_pre_counts = max(X22r2_prog_var_all_df$pre)
X22r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X22r2_prog_map_all_pre_count = length(X22r2_prog_map_all_df$pre)
X22r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X22r2_prog_map_all_min_pre_counts = min(X22r2_prog_map_all_df$pre)
X22r2_prog_map_all_min_pre_counts
X22r2_prog_map_all_max_pre_counts = max(X22r2_prog_map_all_df$pre)
X22r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X22r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X22r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X22r2_prog_map_all_post_count = length(X22r2_prog_map_all_df$post)
X22r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X22r2_prog_map_all_min_post_counts = min(X22r2_prog_map_all_df$post)
X22r2_prog_map_all_min_post_counts
X22r2_prog_map_all_max_post_counts = max(X22r2_prog_map_all_df$post)
X22r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X22r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X22r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X22r2_prog_map_all_syn_df <- X22r2_prog_map_all_df[which(X22r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X22r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X22r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X22r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X22r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X22r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X22r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X22r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X22r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X22r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X22r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X22r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X22r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X22r2_prog_map_all_min_rna_counts = min(X22r2_prog_map_exon_all_df$tHDR_rna)
X22r2_prog_map_all_min_rna_counts
X22r2_prog_map_all_max_rna_counts = max(X22r2_prog_map_exon_all_df$tHDR_rna)
X22r2_prog_map_all_max_rna_counts
X22r2_prog_map_all_min_rna_pseudo_freq = min(X22r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22r2_prog_map_all_min_rna_pseudo_freq
X22r2_prog_map_all_max_rna_pseudo_freq = max(X22r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22r2_prog_map_all_max_rna_pseudo_freq
X22r2_prog_map_all_min_rna_pre_ratio = min(X22r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22r2_prog_map_all_min_rna_pre_ratio
X22r2_prog_map_all_max_rna_pre_ratio = max(X22r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22r2_prog_map_all_max_rna_pre_ratio
X22r2_prog_map_all_min_rna_post_ratio = min(X22r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22r2_prog_map_all_min_rna_post_ratio
X22r2_prog_map_all_max_rna_post_ratio = max(X22r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X22r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X22r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X22r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X22r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X22r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X22r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X22r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X22r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X22r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X22r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X22r2_prog_map_all_df$post_pre_ratio),log2(X22r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X22r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X22r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X22r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X22r2_cSNV_all_corr_pre_count = length(X22r2_cSNV_all_df$corr_pre)
X22r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X22r2_cSNV_all_min_corr_pre_counts = min(X22r2_cSNV_all_df$corr_pre)
X22r2_cSNV_all_min_corr_pre_counts
X22r2_cSNV_all_max_corr_pre_counts = max(X22r2_cSNV_all_df$corr_pre)
X22r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X22r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X22r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X22r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X22r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X22r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_cSNV_all_corr_post_count = length(X22r2_cSNV_all_df$corr_post)
X22r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X22r2_cSNV_all_min_corr_post_counts = min(X22r2_cSNV_all_df$corr_post)
X22r2_cSNV_all_min_corr_post_counts
X22r2_cSNV_all_max_corr_post_counts = max(X22r2_cSNV_all_df$corr_post)
X22r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X22r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X22r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X22r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X22r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X22r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X22r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X22_p_hdr_snv = paste('p_hdr_',X22_cut_end,'_snv',sep='')
X22r2_pSNV_all <- which(X22r2[,X22_p_hdr_snv]=='True')
X22r2_pSNV_all_df = X22r2[X22r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_pSNV_all_lib_count = length(X22r2_pSNV_all_df$lib)
X22r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X22r2_pSNV_all_min_lib_counts = min(X22r2_pSNV_all_df$lib)
X22r2_pSNV_all_min_lib_counts
X22r2_pSNV_all_max_lib_counts = max(X22r2_pSNV_all_df$lib)
X22r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X22r2_pSNV_all_pre_count = length(X22r2_pSNV_all_df$pre)
X22r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X22r2_pSNV_all_min_pre_counts = min(X22r2_pSNV_all_df$pre)
X22r2_pSNV_all_min_pre_counts
X22r2_pSNV_all_max_pre_counts = max(X22r2_pSNV_all_df$pre)
X22r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X22r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X22r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_pSNV_all_post_count = length(X22r2_pSNV_all_df$post)
X22r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X22r2_pSNV_all_min_post_counts = min(X22r2_pSNV_all_df$post)
X22r2_pSNV_all_min_post_counts
X22r2_pSNV_all_max_post_counts = max(X22r2_pSNV_all_df$post)
X22r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X22r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X22r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_prog_map_thresh5_lib_count = length(X22r2_prog_map_thresh5_df$lib)
X22r2_prog_map_thresh5_lib_count
X22r2_prog_map_thresh5_min_lib_counts = min(X22r2_prog_map_thresh5_df$lib)
X22r2_prog_map_thresh5_min_lib_counts
X22r2_prog_map_thresh5_max_lib_counts = max(X22r2_prog_map_thresh5_df$lib)
X22r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X22r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X22r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_prog_map_thresh5_pre_count = length(X22r2_prog_map_thresh5_df$pre)
X22r2_prog_map_thresh5_pre_count
X22r2_prog_map_thresh5_min_pre_counts = min(X22r2_prog_map_thresh5_df$pre)
X22r2_prog_map_thresh5_min_pre_counts
X22r2_prog_map_thresh5_max_pre_counts = max(X22r2_prog_map_thresh5_df$pre)
X22r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22r2_prog_map_thresh5_post_count = length(X22r2_prog_map_thresh5_df$post)
X22r2_prog_map_thresh5_post_count
X22r2_prog_map_thresh5_min_post_counts = min(X22r2_prog_map_thresh5_df$post)
X22r2_prog_map_thresh5_min_post_counts
X22r2_prog_map_thresh5_max_post_counts = max(X22r2_prog_map_thresh5_df$post)
X22r2_prog_map_thresh5_max_post_counts
X22r2_prog_map_thresh5_corr_post_count = length(X22r2_prog_map_thresh5_df$corr_post)
X22r2_prog_map_thresh5_corr_post_count
X22r2_prog_map_thresh5_min_corr_post_counts = min(X22r2_prog_map_thresh5_df$corr_post)
X22r2_prog_map_thresh5_min_corr_post_counts
X22r2_prog_map_thresh5_max_corr_post_counts = max(X22r2_prog_map_thresh5_df$corr_post)
X22r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X22r2_pSNV_thresh5 <- which(X22r2[,X22_p_hdr_snv]=='True' & as.numeric(as.character(X22r2[,'pre_freq']))>=0.00001)
X22r2_pSNV_thresh5_df = X22r2[X22r2_pSNV_thresh5,]
X22r2_pSNV_thresh5_lib_count = length(X22r2_pSNV_thresh5_df$lib)
X22r2_pSNV_thresh5_lib_count
X22r2_pSNV_thresh5_min_lib_counts = min(X22r2_pSNV_thresh5_df$lib)
X22r2_pSNV_thresh5_min_lib_counts
X22r2_pSNV_thresh5_max_lib_counts = max(X22r2_pSNV_thresh5_df$lib)
X22r2_pSNV_thresh5_max_lib_counts
X22r2_pSNV_thresh5_pre_count = length(X22r2_pSNV_thresh5_df$pre)
X22r2_pSNV_thresh5_pre_count
X22r2_pSNV_thresh5_min_pre_counts = min(X22r2_pSNV_thresh5_df$pre)
X22r2_pSNV_thresh5_min_pre_counts
X22r2_pSNV_thresh5_max_pre_counts = max(X22r2_pSNV_thresh5_df$pre)
X22r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X22r2_pSNV_thresh5_post_count = length(X22r2_pSNV_thresh5_df$post)
X22r2_pSNV_thresh5_post_count
X22r2_pSNV_thresh5_min_post_counts = min(X22r2_pSNV_thresh5_df$post)
X22r2_pSNV_thresh5_min_post_counts
X22r2_pSNV_thresh5_max_post_counts = max(X22r2_pSNV_thresh5_df$post)
X22r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X22r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X22r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X22r1_prog_var_thresh5_df:
X22r1_prog_var_thresh5_df_r2_int <- X22r1_prog_var_thresh5_df[which(X22r1_prog_var_thresh5_df$variant %in% X22r2_prog_var_thresh5_df$variant),]
#Intersection variants of X22r2_prog_var_thresh5_df:
X22r2_prog_var_thresh5_df_r1_int <- X22r2_prog_var_thresh5_df[which(X22r2_prog_var_thresh5_df$variant %in% X22r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X22r1_prog_var_thresh5_df_r2_int_ord <- X22r1_prog_var_thresh5_df_r2_int[order(X22r1_prog_var_thresh5_df_r2_int$variant),]
X22r2_prog_var_thresh5_df_r1_int_ord <- X22r2_prog_var_thresh5_df_r1_int[order(X22r2_prog_var_thresh5_df_r1_int$variant),]

dim(X22r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X22r1r2int_prog_var_thresh5_pre_count <- dim(X22r1_prog_var_thresh5_df_r2_int)[1] 
X22r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X22r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X22r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X22r2_prog_var_thresh5_df_r1_int_ord$pre
X22r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X22r2_prog_var_thresh5_df_r1_int_ord$lib
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X22r2_prog_var_thresh5_df_r1_int_ord$post
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X22r2_prog_var_thresh5_df_r1_int_ord$rna
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X22r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X22r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X22r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$post_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X22r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X22r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X22r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X22r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X22r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X22r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X22r2_prog_var_thresh5_df_r1_int_ord$corr_post
X22r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X22r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X22r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X22r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X22r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X22r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X22r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X22r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X22r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X22r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X22r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X22r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X22r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X22r1_cSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X22r1_cSNV_missense_post_pre_med <- unname(X22r1_cSNV_missense_post_pre_quarts[3])
X22r1_cSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X22r1_cSNV_syn_post_pre_med <- unname(X22r1_cSNV_syn_post_pre_quarts[3])
X22r1_cSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X22r1_cSNV_nonsense_post_pre_med <- unname(X22r1_cSNV_nonsense_post_pre_quarts[3])
X22r1_cSNV_syn_to_non_post_pre_spread <- X22r1_cSNV_syn_post_pre_med - X22r1_cSNV_nonsense_post_pre_med

X22r2_cSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X22r2_cSNV_missense_post_pre_med <- unname(X22r2_cSNV_missense_post_pre_quarts[3])
X22r2_cSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X22r2_cSNV_syn_post_pre_med <- unname(X22r2_cSNV_syn_post_pre_quarts[3])
X22r2_cSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X22r2_cSNV_nonsense_post_pre_med <- unname(X22r2_cSNV_nonsense_post_pre_quarts[3])
X22r2_cSNV_syn_to_non_post_pre_spread <- X22r2_cSNV_syn_post_pre_med - X22r2_cSNV_nonsense_post_pre_med

X22r1r2a_cSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X22r1r2a_cSNV_missense_post_pre_med <- unname(X22r1r2a_cSNV_missense_post_pre_quarts[3])
X22r1r2a_cSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X22r1r2a_cSNV_syn_post_pre_med <- unname(X22r1r2a_cSNV_syn_post_pre_quarts[3])
X22r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X22r1r2a_cSNV_nonsense_post_pre_med <- unname(X22r1r2a_cSNV_nonsense_post_pre_quarts[3])
X22r1r2a_cSNV_syn_to_non_post_pre_spread <- X22r1r2a_cSNV_syn_post_pre_med - X22r1r2a_cSNV_nonsense_post_pre_med

X22r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_cSNV_missense_post_pre_med <- unname(X22r1r2pw_cSNV_missense_post_pre_quarts[3])
X22r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_cSNV_syn_post_pre_med <- unname(X22r1r2pw_cSNV_syn_post_pre_quarts[3])
X22r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_cSNV_nonsense_post_pre_med <- unname(X22r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X22r1r2pw_cSNV_syn_to_non_post_pre_spread <- X22r1r2pw_cSNV_syn_post_pre_med - X22r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X22r1_tSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X22r1_tSNV_missense_post_pre_med <- unname(X22r1_tSNV_missense_post_pre_quarts[3])
X22r1_tSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X22r1_tSNV_syn_post_pre_med <- unname(X22r1_tSNV_syn_post_pre_quarts[3])
X22r1_tSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X22r1_tSNV_nonsense_post_pre_med <- unname(X22r1_tSNV_nonsense_post_pre_quarts[3])
X22r1_tSNV_syn_to_non_post_pre_spread <- X22r1_tSNV_syn_post_pre_med - X22r1_tSNV_nonsense_post_pre_med

X22r2_tSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X22r2_tSNV_missense_post_pre_med <- unname(X22r2_tSNV_missense_post_pre_quarts[3])
X22r2_tSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X22r2_tSNV_syn_post_pre_med <- unname(X22r2_tSNV_syn_post_pre_quarts[3])
X22r2_tSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X22r2_tSNV_nonsense_post_pre_med <- unname(X22r2_tSNV_nonsense_post_pre_quarts[3])
X22r2_tSNV_syn_to_non_post_pre_spread <- X22r2_tSNV_syn_post_pre_med - X22r2_tSNV_nonsense_post_pre_med

X22r1r2a_tSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X22r1r2a_tSNV_missense_post_pre_med <- unname(X22r1r2a_tSNV_missense_post_pre_quarts[3])
X22r1r2a_tSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X22r1r2a_tSNV_syn_post_pre_med <- unname(X22r1r2a_tSNV_syn_post_pre_quarts[3])
X22r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X22r1r2a_tSNV_nonsense_post_pre_med <- unname(X22r1r2a_tSNV_nonsense_post_pre_quarts[3])
X22r1r2a_tSNV_syn_to_non_post_pre_spread <- X22r1r2a_tSNV_syn_post_pre_med - X22r1r2a_tSNV_nonsense_post_pre_med

X22r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_tSNV_missense_post_pre_med <- unname(X22r1r2pw_tSNV_missense_post_pre_quarts[3])
X22r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_tSNV_syn_post_pre_med <- unname(X22r1r2pw_tSNV_syn_post_pre_quarts[3])
X22r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X22r1r2pw_tSNV_nonsense_post_pre_med <- unname(X22r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X22r1r2pw_tSNV_syn_to_non_post_pre_spread <- X22r1r2pw_tSNV_syn_post_pre_med - X22r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X22r1_cSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X22r1_cSNV_missense_post_lib_med <- unname(X22r1_cSNV_missense_post_lib_quarts[3])
X22r1_cSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X22r1_cSNV_syn_post_lib_med <- unname(X22r1_cSNV_syn_post_lib_quarts[3])
X22r1_cSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X22r1_cSNV_nonsense_post_lib_med <- unname(X22r1_cSNV_nonsense_post_lib_quarts[3])
X22r1_cSNV_syn_to_non_post_lib_spread <- X22r1_cSNV_syn_post_lib_med - X22r1_cSNV_nonsense_post_lib_med

X22r2_cSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X22r2_cSNV_missense_post_lib_med <- unname(X22r2_cSNV_missense_post_lib_quarts[3])
X22r2_cSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X22r2_cSNV_syn_post_lib_med <- unname(X22r2_cSNV_syn_post_lib_quarts[3])
X22r2_cSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X22r2_cSNV_nonsense_post_lib_med <- unname(X22r2_cSNV_nonsense_post_lib_quarts[3])
X22r2_cSNV_syn_to_non_post_lib_spread <- X22r2_cSNV_syn_post_lib_med - X22r2_cSNV_nonsense_post_lib_med

X22r1r2a_cSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_missense_post_lib_med <- unname(X22r1r2a_cSNV_missense_post_lib_quarts[3])
X22r1r2a_cSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_syn_post_lib_med <- unname(X22r1r2a_cSNV_syn_post_lib_quarts[3])
X22r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_nonsense_post_lib_med <- unname(X22r1r2a_cSNV_nonsense_post_lib_quarts[3])
X22r1r2a_cSNV_syn_to_non_post_lib_spread <- X22r1r2a_cSNV_syn_post_lib_med - X22r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X22r1_tSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X22r1_tSNV_missense_post_lib_med <- unname(X22r1_tSNV_missense_post_lib_quarts[3])
X22r1_tSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X22r1_tSNV_syn_post_lib_med <- unname(X22r1_tSNV_syn_post_lib_quarts[3])
X22r1_tSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X22r1_tSNV_nonsense_post_lib_med <- unname(X22r1_tSNV_nonsense_post_lib_quarts[3])
X22r1_tSNV_syn_to_non_post_lib_spread <- X22r1_tSNV_syn_post_lib_med - X22r1_tSNV_nonsense_post_lib_med

X22r2_tSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X22r2_tSNV_missense_post_lib_med <- unname(X22r2_tSNV_missense_post_lib_quarts[3])
X22r2_tSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X22r2_tSNV_syn_post_lib_med <- unname(X22r2_tSNV_syn_post_lib_quarts[3])
X22r2_tSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X22r2_tSNV_nonsense_post_lib_med <- unname(X22r2_tSNV_nonsense_post_lib_quarts[3])
X22r2_tSNV_syn_to_non_post_lib_spread <- X22r2_tSNV_syn_post_lib_med - X22r2_tSNV_nonsense_post_lib_med

X22r1r2a_tSNV_missense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_missense_post_lib_med <- unname(X22r1r2a_tSNV_missense_post_lib_quarts[3])
X22r1r2a_tSNV_syn_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_syn_post_lib_med <- unname(X22r1r2a_tSNV_syn_post_lib_quarts[3])
X22r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_nonsense_post_lib_med <- unname(X22r1r2a_tSNV_nonsense_post_lib_quarts[3])
X22r1r2a_tSNV_syn_to_non_post_lib_spread <- X22r1r2a_tSNV_syn_post_lib_med - X22r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X22r1_cSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X22r1_cSNV_missense_pre_lib_med <- unname(X22r1_cSNV_missense_pre_lib_quarts[3])
X22r1_cSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X22r1_cSNV_syn_pre_lib_med <- unname(X22r1_cSNV_syn_pre_lib_quarts[3])
X22r1_cSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X22r1_cSNV_nonsense_pre_lib_med <- unname(X22r1_cSNV_nonsense_pre_lib_quarts[3])
X22r1_cSNV_syn_to_non_pre_lib_spread <- X22r1_cSNV_syn_pre_lib_med - X22r1_cSNV_nonsense_pre_lib_med

X22r2_cSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X22r2_cSNV_missense_pre_lib_med <- unname(X22r2_cSNV_missense_pre_lib_quarts[3])
X22r2_cSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X22r2_cSNV_syn_pre_lib_med <- unname(X22r2_cSNV_syn_pre_lib_quarts[3])
X22r2_cSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X22r2_cSNV_nonsense_pre_lib_med <- unname(X22r2_cSNV_nonsense_pre_lib_quarts[3])
X22r2_cSNV_syn_to_non_pre_lib_spread <- X22r2_cSNV_syn_pre_lib_med - X22r2_cSNV_nonsense_pre_lib_med

X22r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_missense_pre_lib_med <- unname(X22r1r2a_cSNV_missense_pre_lib_quarts[3])
X22r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_syn_pre_lib_med <- unname(X22r1r2a_cSNV_syn_pre_lib_quarts[3])
X22r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X22r1r2a_cSNV_nonsense_pre_lib_med <- unname(X22r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X22r1r2a_cSNV_syn_to_non_pre_lib_spread <- X22r1r2a_cSNV_syn_pre_lib_med - X22r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X22r1_tSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X22r1_tSNV_missense_pre_lib_med <- unname(X22r1_tSNV_missense_pre_lib_quarts[3])
X22r1_tSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X22r1_tSNV_syn_pre_lib_med <- unname(X22r1_tSNV_syn_pre_lib_quarts[3])
X22r1_tSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X22r1_tSNV_nonsense_pre_lib_med <- unname(X22r1_tSNV_nonsense_pre_lib_quarts[3])
X22r1_tSNV_syn_to_non_pre_lib_spread <- X22r1_tSNV_syn_pre_lib_med - X22r1_tSNV_nonsense_pre_lib_med

X22r2_tSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X22r2_tSNV_missense_pre_lib_med <- unname(X22r2_tSNV_missense_pre_lib_quarts[3])
X22r2_tSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X22r2_tSNV_syn_pre_lib_med <- unname(X22r2_tSNV_syn_pre_lib_quarts[3])
X22r2_tSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X22r2_tSNV_nonsense_pre_lib_med <- unname(X22r2_tSNV_nonsense_pre_lib_quarts[3])
X22r2_tSNV_syn_to_non_pre_lib_spread <- X22r2_tSNV_syn_pre_lib_med - X22r2_tSNV_nonsense_pre_lib_med

X22r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_missense_pre_lib_med <- unname(X22r1r2a_tSNV_missense_pre_lib_quarts[3])
X22r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_syn_pre_lib_med <- unname(X22r1r2a_tSNV_syn_pre_lib_quarts[3])
X22r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X22r1r2a_tSNV_nonsense_pre_lib_med <- unname(X22r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X22r1r2a_tSNV_syn_to_non_pre_lib_spread <- X22r1r2a_tSNV_syn_pre_lib_med - X22r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X22r1_tSNV_syn_rna_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X22r1_tSNV_syn_rna_pre_med <- unname(X22r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X22r1_tSNV_syn_rna_post_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X22r1_tSNV_syn_rna_post_med <- unname(X22r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X22r2_tSNV_syn_rna_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X22r2_tSNV_syn_rna_pre_med <- unname(X22r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X22r2_tSNV_syn_rna_post_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X22r2_tSNV_syn_rna_post_med <- unname(X22r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X22r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X22r1r2a_tSNV_syn_rna_pre_med <- unname(X22r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X22r1r2a_tSNV_syn_rna_post_quarts <- quantile(X22r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X22r1r2a_tSNV_syn_rna_post_med <- unname(X22r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X22r1_cSNV_syn_pre_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X22r1_cSNV_syn_post_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X22r1_cSNV_syn_post_lib_med
# tHDR
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X22r1_tSNV_syn_pre_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X22r1_tSNV_syn_post_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X22r1_tSNV_syn_post_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X22r1_tSNV_syn_rna_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X22r1_tSNV_syn_rna_post_med

#r2
X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X22r2_cSNV_syn_pre_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X22r2_cSNV_syn_post_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X22r2_cSNV_syn_post_lib_med
# tHDR
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X22r2_tSNV_syn_pre_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X22r2_tSNV_syn_post_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X22r2_tSNV_syn_post_lib_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X22r2_tSNV_syn_rna_pre_med
X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X22r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X22r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X22r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X22r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X22r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X22r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X22r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X22r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X22r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X22r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X22r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X22r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X22r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X22r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X22r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X22r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X22r1_prog_var_thresh5_df_r2_int_ord[which(X22r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X22r1_prog_var_thresh5_df_r2_int_ord
X22r1_prog_map_thresh5_df_r2_int_ord = which(X22r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X22r1_prog_map_thresh5_df_r2_int_ord_df = X22r1_prog_var_thresh5_df_r2_int_ord[X22r1_prog_map_thresh5_df_r2_int_ord,]
X22r1_prog_map_exon_thresh5_df_r2_int_ord = which(X22r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X22r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X22r1_prog_map_exon_thresh5_df_r2_int_ord_df = X22r1_prog_map_thresh5_df_r2_int_ord_df[X22r1_prog_map_exon_thresh5_df_r2_int_ord,]
X22r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X22r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X22r1_prog_map_thresh5_df_r2_int_ord_df[X22r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X22r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X22r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X22r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X22r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X22r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X22r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X22r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X22r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X22r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X22r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X22r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X22r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X22r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X22r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X22r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X22r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X22r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X22r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X22r1r2_cSNV_r1_post_by_r2_post_cor_s
X22r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X22r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X22r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X22r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X22r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X22r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X22r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X22r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X22r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X22r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X22r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X22r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X22r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X22r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X22r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X22r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X22r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X22r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1_cSNV_post_pre_by_cadd_cor_s
#X22r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X22r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r2_cSNV_post_pre_by_cadd_cor_s

#X22r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X22r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1_cSNV_post_lib_by_cadd_cor_s
#X22r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X22r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X22r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X22r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1_tSNV_post_pre_by_cadd_cor_s
#X22r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X22r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r2_tSNV_post_pre_by_cadd_cor_s

#X22r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X22r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1_tSNV_post_lib_by_cadd_cor_s
#X22r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X22r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X22r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X22r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X22r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X22r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X22r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X22r1_prog_var_all_lib_count
X22r1_prog_var_all_pre_count
X22r2_prog_var_all_pre_count
X22r1_prog_map_thresh5_lib_count
X22r1_prog_map_thresh5_pre_count
X22r2_prog_map_thresh5_pre_count
X22r1_prog_map_thresh5_post_count
X22r2_prog_map_thresh5_post_count
X22r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X22r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X22r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X22r1r2_cSNV_r1_post_by_r2_post_cor_s
X22r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X22r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X22r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X22r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X22r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X22r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X22r1_cSNV_post_pre_by_cadd_cor_s
X22r2_cSNV_post_pre_by_cadd_cor_s
X22r1_cSNV_post_lib_by_cadd_cor_s
X22r2_cSNV_post_lib_by_cadd_cor_s
X22r1_tSNV_post_pre_by_cadd_cor_s
X22r2_tSNV_post_pre_by_cadd_cor_s
X22r1_tSNV_post_lib_by_cadd_cor_s
X22r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X22r1r2a_cSNV_post_pre_by_cadd_cor_s
X22r1r2w_cSNV_post_pre_by_cadd_cor_s
X22r1r2a_cSNV_post_lib_by_cadd_cor_s
X22r1r2w_cSNV_post_lib_by_cadd_cor_s
X22r1r2a_tSNV_post_pre_by_cadd_cor_s
X22r1r2w_tSNV_post_pre_by_cadd_cor_s
X22r1r2a_tSNV_post_lib_by_cadd_cor_s
X22r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X22r1_cSNV_syn_to_non_post_pre_spread
X22r2_cSNV_syn_to_non_post_pre_spread
X22r1r2a_cSNV_syn_to_non_post_pre_spread
X22r1_cSNV_syn_to_non_post_lib_spread
X22r2_cSNV_syn_to_non_post_lib_spread
X22r1r2a_cSNV_syn_to_non_post_lib_spread
X22r1_tSNV_syn_to_non_post_pre_spread
X22r2_tSNV_syn_to_non_post_pre_spread
X22r1r2a_tSNV_syn_to_non_post_pre_spread
X22r1_tSNV_syn_to_non_post_lib_spread
X22r2_tSNV_syn_to_non_post_lib_spread
X22r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X22r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X22r1_prog_map_thresh5_df_r2_int_ord_df[which(X22r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X22r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df[which(X22r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df[which(X22r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df[which(X22r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X22r1_cSNV_pre_lib_cors = cor(log2(X22r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X22r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22r1_tSNV_pre_lib_cors = cor(log2(X22r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22r1_cSNV_post_lib_cors = cor(log2(X22r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X22r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X22r1_tSNV_post_lib_cors = cor(log2(X22r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X22r1_cSNV_post_pre_cors = cor(log2(X22r1_prog_map_thresh5_df$post_pseudo_freq),log2(X22r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22r1_tSNV_post_pre_cors = cor(log2(X22r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X22r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22r1_cSNV_rna_lib_cors = cor(log2(X22r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X22r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22r1_tSNV_rna_lib_cors = cor(log2(X22r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X22r1_cSNV_rna_pre_cors = cor(log2(X22r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X22r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22r1_tSNV_rna_pre_cors = cor(log2(X22r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X22r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22r1r2_cSNV_pre_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X22r1r2_tSNV_pre_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X22r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X22r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X22r1r2_cSNV_post_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X22r1r2_tSNV_post_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X22r1r2_cSNV_post_lib_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X22r1r2_tSNV_post_lib_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X22r1r2_cSNV_post_pre_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X22r1r2_tSNV_post_pre_ratio_cors = cor(log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X22r1r2_cSNV_rna_cors = cor(log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X22r1r2_tSNV_rna_cors = cor(log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X22r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X22r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X22r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X22r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X22r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X22r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X22r1_cors <- c("X22r1",X22r1_cSNV_pre_lib_cors,X22r1_tSNV_pre_lib_cors,X22r1_cSNV_post_lib_cors,X22r1_tSNV_post_lib_cors,X22r1_cSNV_post_pre_cors,X22r1_tSNV_post_pre_cors,X22r1_cSNV_rna_lib_cors,X22r1_tSNV_rna_lib_cors,X22r1_cSNV_rna_pre_cors,X22r1_tSNV_rna_pre_cors,X22r1r2_cSNV_pre_cors,X22r1r2_tSNV_pre_cors,X22r1r2_cSNV_pre_lib_ratio_cors,X22r1r2_tSNV_pre_lib_ratio_cors,X22r1r2_cSNV_post_cors,X22r1r2_tSNV_post_cors,X22r1r2_cSNV_post_lib_ratio_cors,X22r1r2_tSNV_post_lib_ratio_cors,X22r1r2_cSNV_post_pre_ratio_cors,X22r1r2_tSNV_post_pre_ratio_cors,X22r1r2_cSNV_rna_cors,X22r1r2_tSNV_rna_cors,X22r1r2_tSNV_rna_pre_ratio_cors,X22r1_cSNV_pre_lib_ratio_cadd_cors,X22r1_tSNV_pre_lib_ratio_cadd_cors,X22r1_cSNV_post_lib_ratio_cadd_cors,X22r1_tSNV_post_lib_ratio_cadd_cors,X22r1_cSNV_post_pre_ratio_cadd_cors,X22r1_tSNV_post_pre_ratio_cadd_cors,X22r1_cSNV_post_pre_ratio_cadd_missense_cors,X22r1_tSNV_post_pre_ratio_cadd_missense_cors,X22r1_cSNV_post_pre_ratio_polyphen_missense_cors,X22r1_tSNV_post_pre_ratio_polyphen_missense_cors,X22r1_cSNV_post_pre_ratio_grantham_missense_cors,X22r1_tSNV_post_pre_ratio_grantham_missense_cors,X22r1r2a_cSNV_pre_lib_ratio_cadd_cors,X22r1r2a_tSNV_pre_lib_ratio_cadd_cors,X22r1r2a_cSNV_post_lib_ratio_cadd_cors,X22r1r2a_tSNV_post_lib_ratio_cadd_cors,X22r1r2a_cSNV_post_pre_ratio_cadd_cors,X22r1r2a_tSNV_post_pre_ratio_cadd_cors,X22r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X22r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X22r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X22r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X22r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X22r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X22r1r2w_cSNV_pre_lib_ratio_cadd_cors,X22r1r2w_cSNV_post_lib_ratio_cadd_cors,X22r1r2w_cSNV_post_pre_ratio_cadd_cors,X22r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X22r2_cSNV_pre_lib_cors = cor(log2(X22r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X22r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22r2_tSNV_pre_lib_cors = cor(log2(X22r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22r2_cSNV_post_lib_cors = cor(log2(X22r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X22r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X22r2_tSNV_post_lib_cors = cor(log2(X22r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X22r2_cSNV_post_pre_cors = cor(log2(X22r2_prog_map_thresh5_df$post_pseudo_freq),log2(X22r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22r2_tSNV_post_pre_cors = cor(log2(X22r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X22r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22r2_cSNV_rna_lib_cors = cor(log2(X22r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X22r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22r2_tSNV_rna_lib_cors = cor(log2(X22r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X22r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X22r2_cSNV_rna_pre_cors = cor(log2(X22r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X22r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22r2_tSNV_rna_pre_cors = cor(log2(X22r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X22r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X22r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X22r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X22r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X22r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X22r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X22r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X22r2_cors <- c("X22r2",X22r2_cSNV_pre_lib_cors,X22r2_tSNV_pre_lib_cors,X22r2_cSNV_post_lib_cors,X22r2_tSNV_post_lib_cors,X22r2_cSNV_post_pre_cors,X22r2_tSNV_post_pre_cors,X22r2_cSNV_rna_lib_cors,X22r2_tSNV_rna_lib_cors,X22r2_cSNV_rna_pre_cors,X22r2_tSNV_rna_pre_cors,X22r1r2_cSNV_pre_cors,X22r1r2_tSNV_pre_cors,X22r1r2_cSNV_pre_lib_ratio_cors,X22r1r2_tSNV_pre_lib_ratio_cors,X22r1r2_cSNV_post_cors,X22r1r2_tSNV_post_cors,X22r1r2_cSNV_post_lib_ratio_cors,X22r1r2_tSNV_post_lib_ratio_cors,X22r1r2_cSNV_post_pre_ratio_cors,X22r1r2_tSNV_post_pre_ratio_cors,X22r1r2_cSNV_rna_cors,X22r1r2_tSNV_rna_cors,X22r1r2_tSNV_rna_pre_ratio_cors,X22r2_cSNV_pre_lib_ratio_cadd_cors,X22r2_tSNV_pre_lib_ratio_cadd_cors,X22r2_cSNV_post_lib_ratio_cadd_cors,X22r2_tSNV_post_lib_ratio_cadd_cors,X22r2_cSNV_post_pre_ratio_cadd_cors,X22r2_tSNV_post_pre_ratio_cadd_cors,X22r2_cSNV_post_pre_ratio_cadd_missense_cors,X22r2_tSNV_post_pre_ratio_cadd_missense_cors,X22r2_cSNV_post_pre_ratio_polyphen_missense_cors,X22r2_tSNV_post_pre_ratio_polyphen_missense_cors,X22r2_cSNV_post_pre_ratio_grantham_missense_cors,X22r2_tSNV_post_pre_ratio_grantham_missense_cors,X22r1r2a_cSNV_pre_lib_ratio_cadd_cors,X22r1r2a_tSNV_pre_lib_ratio_cadd_cors,X22r1r2a_cSNV_post_lib_ratio_cadd_cors,X22r1r2a_tSNV_post_lib_ratio_cadd_cors,X22r1r2a_cSNV_post_pre_ratio_cadd_cors,X22r1r2a_tSNV_post_pre_ratio_cadd_cors,X22r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X22r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X22r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X22r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X22r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X22r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X22r1r2w_cSNV_pre_lib_ratio_cadd_cors,X22r1r2w_cSNV_post_lib_ratio_cadd_cors,X22r1r2w_cSNV_post_pre_ratio_cadd_cors,X22r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X22r1)
rm(X22r2)
gc()
X23r1_file <- paste(experiment_dir_171011,'X23r1','_annotated.txt',sep='')
X23r2_file <- paste(experiment_dir_171011,'X23r2','_annotated.txt',sep='')
X23r1 <- read.table(X23r1_file, header=TRUE, sep="\t")
X23r2 <- read.table(X23r2_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X23 <- editing_info[which(editing_info$amplicon == 'X23'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X23_HDR_5_SNV = as.character(editing_info_X23$HDR_5_SNV)
X23_HDR_3_SNV = as.character(editing_info_X23$HDR_3_SNV)
#X23_cut_pos = as.character(editing_info_X23$cut_pos)
X23_cut_end = as.character(editing_info_X23$cut_end)
X23_mut_start = as.character(editing_info_X23$mut_start)
X23_mut_end = as.character(editing_info_X23$mut_end)
### Replicate 1
X23r1_cSNV_all <- which(X23r1[,'c_hdr_snv']=='True')
X23r1_cSNV_all_df = X23r1[X23r1_cSNV_all,]
X23r1_prog_var_all <- which(X23r1[,'all_hdr_variant']=='True' & X23r1[,'edit_string']!='-WT')
X23r1_prog_var_all_df = X23r1[X23r1_prog_var_all,]
X23r1_prog_map_all = which(X23r1_prog_var_all_df[,'pos']!='REF')
X23r1_prog_map_all_df = X23r1_prog_var_all_df[X23r1_prog_map_all,]
X23r1_prog_map_exon_all = which(X23r1_prog_map_all_df[,'cDNApos']!='REF' & X23r1_prog_map_all_df[,'cDNApos']!='NA')
X23r1_prog_map_exon_all_df = X23r1_prog_map_all_df[X23r1_prog_map_exon_all,]
X23r1_prog_map_CADD = which(X23r1_prog_map_all_df[,'CADD.phred']!='NA')
X23r1_prog_map_CADD_df = X23r1_prog_map_all_df[X23r1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X23r1_prog_var_thresh5 <- which(as.numeric(as.character(X23r1_prog_var_all_df[,'pre_freq']))>=0.00001)
X23r1_prog_var_thresh5_df = X23r1_prog_var_all_df[X23r1_prog_var_thresh5,]
X23r1_prog_map_thresh5 <- which(as.numeric(as.character(X23r1_prog_map_all_df[,'pre_freq']))>=0.00001)
X23r1_prog_map_thresh5_df = X23r1_prog_map_all_df[X23r1_prog_map_thresh5,]
X23r1_prog_map_exon_thresh5 <- which(as.numeric(as.character(X23r1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X23r1_prog_map_exon_thresh5_df = X23r1_prog_map_exon_all_df[X23r1_prog_map_exon_thresh5,]
X23r1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X23r1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X23r1_prog_map_CADD_thresh5_df = X23r1_prog_map_CADD_df[X23r1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X23r1_prog_var_all_lib_count = length(X23r1_prog_var_all_df$lib)
X23r1_prog_var_all_lib_count
# r1 Max and min reads for each variant
X23r1_prog_var_all_min_lib_counts = min(X23r1_prog_var_all_df$lib)
X23r1_prog_var_all_min_lib_counts
X23r1_prog_var_all_max_lib_counts = max(X23r1_prog_var_all_df$lib)
X23r1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X23r1_prog_map_all_lib_count = length(X23r1_prog_map_all_df$lib)
X23r1_prog_map_all_lib_count
# r1 Max and min reads for each variant
X23r1_prog_map_all_min_lib_counts = min(X23r1_prog_map_all_df$lib)
X23r1_prog_map_all_min_lib_counts
X23r1_prog_map_all_max_lib_counts = max(X23r1_prog_map_all_df$lib)
X23r1_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X23r1_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X23r1_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X23r1_prog_var_all_pre_count = length(X23r1_prog_var_all_df$pre)
X23r1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X23r1_prog_var_all_min_pre_counts = min(X23r1_prog_var_all_df$pre)
X23r1_prog_var_all_min_pre_counts
X23r1_prog_var_all_max_pre_counts = max(X23r1_prog_var_all_df$pre)
X23r1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X23r1_prog_map_all_pre_count = length(X23r1_prog_map_all_df$pre)
X23r1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X23r1_prog_map_all_min_pre_counts = min(X23r1_prog_map_all_df$pre)
X23r1_prog_map_all_min_pre_counts
X23r1_prog_map_all_max_pre_counts = max(X23r1_prog_map_all_df$pre)
X23r1_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X23r1_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X23r1_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X23r1_prog_map_all_post_count = length(X23r1_prog_map_all_df$post)
X23r1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X23r1_prog_map_all_min_post_counts = min(X23r1_prog_map_all_df$post)
X23r1_prog_map_all_min_post_counts
X23r1_prog_map_all_max_post_counts = max(X23r1_prog_map_all_df$post)
X23r1_prog_map_all_max_post_counts

# r1 histograms of post counts
X23r1_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X23r1_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X23r1_prog_map_all_syn_df <- X23r1_prog_map_all_df[which(X23r1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X23r1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X23r1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X23r1_prog_map_all_syn_tHDR_rna_pre_med <- unname(X23r1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X23r1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X23r1_prog_map_all_syn_df$tHDR_rna_post_ratio))
X23r1_prog_map_all_syn_tHDR_rna_post_med <- unname(X23r1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X23r1_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X23r1_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X23r1_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X23r1_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X23r1_prog_map_all_min_rna_counts = min(X23r1_prog_map_exon_all_df$tHDR_rna)
X23r1_prog_map_all_min_rna_counts
X23r1_prog_map_all_max_rna_counts = max(X23r1_prog_map_exon_all_df$tHDR_rna)
X23r1_prog_map_all_max_rna_counts
X23r1_prog_map_all_min_rna_pseudo_freq = min(X23r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23r1_prog_map_all_min_rna_pseudo_freq
X23r1_prog_map_all_max_rna_pseudo_freq = max(X23r1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23r1_prog_map_all_max_rna_pseudo_freq
X23r1_prog_map_all_min_rna_pre_ratio = min(X23r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23r1_prog_map_all_min_rna_pre_ratio
X23r1_prog_map_all_max_rna_pre_ratio = max(X23r1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23r1_prog_map_all_max_rna_pre_ratio
X23r1_prog_map_all_min_rna_post_ratio = min(X23r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23r1_prog_map_all_min_rna_post_ratio
X23r1_prog_map_all_max_rna_post_ratio = max(X23r1_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23r1_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X23r1_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X23r1_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X23r1_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X23r1_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X23r1_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X23r1_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X23r1_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X23r1_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X23r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_post_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X23r1_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X23r1_prog_map_all_df$post_pre_ratio),log2(X23r1_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_post_pre_ratio),log2(X23r1_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23r1_prog_map_all_df$tHDR_post_lib_ratio),log2(X23r1_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X23r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X23r1_cSNV_all_corr_pre_count = length(X23r1_cSNV_all_df$corr_pre)
X23r1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X23r1_cSNV_all_min_corr_pre_counts = min(X23r1_cSNV_all_df$corr_pre)
X23r1_cSNV_all_min_corr_pre_counts
X23r1_cSNV_all_max_corr_pre_counts = max(X23r1_cSNV_all_df$corr_pre)
X23r1_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X23r1_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X23r1_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X23r1_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X23r1_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X23r1_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_cSNV_all_corr_post_count = length(X23r1_cSNV_all_df$corr_post)
X23r1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X23r1_cSNV_all_min_corr_post_counts = min(X23r1_cSNV_all_df$corr_post)
X23r1_cSNV_all_min_corr_post_counts
X23r1_cSNV_all_max_corr_post_counts = max(X23r1_cSNV_all_df$corr_post)
X23r1_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X23r1_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X23r1_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X23r1_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X23r1_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X23r1_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X23r1_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X23_p_hdr_snv = paste('p_hdr_',X23_cut_end,'_snv',sep='')
X23r1_pSNV_all <- which(X23r1[,X23_p_hdr_snv]=='True')
X23r1_pSNV_all_df = X23r1[X23r1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_pSNV_all_lib_count = length(X23r1_pSNV_all_df$lib)
X23r1_pSNV_all_lib_count
# r1 Max and min reads for each variant
X23r1_pSNV_all_min_lib_counts = min(X23r1_pSNV_all_df$lib)
X23r1_pSNV_all_min_lib_counts
X23r1_pSNV_all_max_lib_counts = max(X23r1_pSNV_all_df$lib)
X23r1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X23r1_pSNV_all_pre_count = length(X23r1_pSNV_all_df$pre)
X23r1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X23r1_pSNV_all_min_pre_counts = min(X23r1_pSNV_all_df$pre)
X23r1_pSNV_all_min_pre_counts
X23r1_pSNV_all_max_pre_counts = max(X23r1_pSNV_all_df$pre)
X23r1_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X23r1_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X23r1_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_pSNV_all_post_count = length(X23r1_pSNV_all_df$post)
X23r1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X23r1_pSNV_all_min_post_counts = min(X23r1_pSNV_all_df$post)
X23r1_pSNV_all_min_post_counts
X23r1_pSNV_all_max_post_counts = max(X23r1_pSNV_all_df$post)
X23r1_pSNV_all_max_post_counts
# r1 histograms of post counts
X23r1_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X23r1_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_prog_map_thresh5_lib_count = length(X23r1_prog_map_thresh5_df$lib)
X23r1_prog_map_thresh5_lib_count
X23r1_prog_map_thresh5_min_lib_counts = min(X23r1_prog_map_thresh5_df$lib)
X23r1_prog_map_thresh5_min_lib_counts
X23r1_prog_map_thresh5_max_lib_counts = max(X23r1_prog_map_thresh5_df$lib)
X23r1_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X23r1_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X23r1_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_prog_map_thresh5_pre_count = length(X23r1_prog_map_thresh5_df$pre)
X23r1_prog_map_thresh5_pre_count
X23r1_prog_map_thresh5_min_pre_counts = min(X23r1_prog_map_thresh5_df$pre)
X23r1_prog_map_thresh5_min_pre_counts
X23r1_prog_map_thresh5_max_pre_counts = max(X23r1_prog_map_thresh5_df$pre)
X23r1_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r1_prog_map_thresh5_post_count = length(X23r1_prog_map_thresh5_df$post)
X23r1_prog_map_thresh5_post_count
X23r1_prog_map_thresh5_min_post_counts = min(X23r1_prog_map_thresh5_df$post)
X23r1_prog_map_thresh5_min_post_counts
X23r1_prog_map_thresh5_max_post_counts = max(X23r1_prog_map_thresh5_df$post)
X23r1_prog_map_thresh5_max_post_counts
X23r1_prog_map_thresh5_corr_post_count = length(X23r1_cSNV_all_df$corr_post)
X23r1_prog_map_thresh5_corr_post_count
X23r1_prog_map_thresh5_min_corr_post_counts = min(X23r1_cSNV_all_df$corr_post)
X23r1_prog_map_thresh5_min_corr_post_counts
X23r1_prog_map_thresh5_max_corr_post_counts = max(X23r1_cSNV_all_df$corr_post)
X23r1_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X23r1_pSNV_thresh5 <- which(X23r1[,X23_p_hdr_snv]=='True' & as.numeric(as.character(X23r1[,'pre_freq']))>=0.00001)
X23r1_pSNV_thresh5_df = X23r1[X23r1_pSNV_thresh5,]
X23r1_pSNV_thresh5_lib_count = length(X23r1_pSNV_thresh5_df$lib)
X23r1_pSNV_thresh5_lib_count
X23r1_pSNV_thresh5_min_lib_counts = min(X23r1_pSNV_thresh5_df$lib)
X23r1_pSNV_thresh5_min_lib_counts
X23r1_pSNV_thresh5_max_lib_counts = max(X23r1_pSNV_thresh5_df$lib)
X23r1_pSNV_thresh5_max_lib_counts
X23r1_pSNV_thresh5_pre_count = length(X23r1_pSNV_thresh5_df$pre)
X23r1_pSNV_thresh5_pre_count
X23r1_pSNV_thresh5_min_pre_counts = min(X23r1_pSNV_thresh5_df$pre)
X23r1_pSNV_thresh5_min_pre_counts
X23r1_pSNV_thresh5_max_pre_counts = max(X23r1_pSNV_thresh5_df$pre)
X23r1_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X23r1_pSNV_thresh5_post_count = length(X23r1_pSNV_thresh5_df$post)
X23r1_pSNV_thresh5_post_count
X23r1_pSNV_thresh5_min_post_counts = min(X23r1_pSNV_thresh5_df$post)
X23r1_pSNV_thresh5_min_post_counts
X23r1_pSNV_thresh5_max_post_counts = max(X23r1_pSNV_thresh5_df$post)
X23r1_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X23r1_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X23r1_pSNV_thresh5_post_pos

### Replicate 2
X23r2_cSNV_all <- which(X23r2[,'c_hdr_snv']=='True')
X23r2_cSNV_all_df = X23r2[X23r2_cSNV_all,]
X23r2_prog_var_all <- which(X23r2[,'all_hdr_variant']=='True' & X23r2[,'edit_string']!='-WT')
X23r2_prog_var_all_df = X23r2[X23r2_prog_var_all,]
X23r2_prog_map_all = which(X23r2_prog_var_all_df[,'pos']!='REF')
X23r2_prog_map_all_df = X23r2_prog_var_all_df[X23r2_prog_map_all,]
X23r2_prog_map_exon_all = which(X23r2_prog_map_all_df[,'cDNApos']!='REF' & X23r2_prog_map_all_df[,'cDNApos']!='NA')
X23r2_prog_map_exon_all_df = X23r2_prog_map_all_df[X23r2_prog_map_exon_all,]
X23r2_prog_map_CADD = which(X23r2_prog_map_all_df[,'CADD.phred']!='NA')
X23r2_prog_map_CADD_df = X23r2_prog_map_all_df[X23r2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X23r2_prog_var_thresh5 <- which(as.numeric(as.character(X23r2_prog_var_all_df[,'pre_freq']))>=0.00001)
X23r2_prog_var_thresh5_df = X23r2_prog_var_all_df[X23r2_prog_var_thresh5,]
X23r2_prog_map_thresh5 <- which(as.numeric(as.character(X23r2_prog_map_all_df[,'pre_freq']))>=0.00001)
X23r2_prog_map_thresh5_df = X23r2_prog_map_all_df[X23r2_prog_map_thresh5,]
X23r2_prog_map_exon_thresh5 <- which(as.numeric(as.character(X23r2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X23r2_prog_map_exon_thresh5_df = X23r2_prog_map_exon_all_df[X23r2_prog_map_exon_thresh5,]
X23r2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X23r2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X23r2_prog_map_CADD_thresh5_df = X23r2_prog_map_CADD_df[X23r2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X23r2_prog_var_all_lib_count = length(X23r2_prog_var_all_df$lib)
X23r2_prog_var_all_lib_count
# r2 Max and min reads for each variant
X23r2_prog_var_all_min_lib_counts = min(X23r2_prog_var_all_df$lib)
X23r2_prog_var_all_min_lib_counts
X23r2_prog_var_all_max_lib_counts = max(X23r2_prog_var_all_df$lib)
X23r2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X23r2_prog_map_all_lib_count = length(X23r2_prog_map_all_df$lib)
X23r2_prog_map_all_lib_count
# r2 Max and min reads for each variant
X23r2_prog_map_all_min_lib_counts = min(X23r2_prog_map_all_df$lib)
X23r2_prog_map_all_min_lib_counts
X23r2_prog_map_all_max_lib_counts = max(X23r2_prog_map_all_df$lib)
X23r2_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X23r2_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X23r2_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X23r2_prog_var_all_pre_count = length(X23r2_prog_var_all_df$pre)
X23r2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X23r2_prog_var_all_min_pre_counts = min(X23r2_prog_var_all_df$pre)
X23r2_prog_var_all_min_pre_counts
X23r2_prog_var_all_max_pre_counts = max(X23r2_prog_var_all_df$pre)
X23r2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X23r2_prog_map_all_pre_count = length(X23r2_prog_map_all_df$pre)
X23r2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X23r2_prog_map_all_min_pre_counts = min(X23r2_prog_map_all_df$pre)
X23r2_prog_map_all_min_pre_counts
X23r2_prog_map_all_max_pre_counts = max(X23r2_prog_map_all_df$pre)
X23r2_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X23r2_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X23r2_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X23r2_prog_map_all_post_count = length(X23r2_prog_map_all_df$post)
X23r2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X23r2_prog_map_all_min_post_counts = min(X23r2_prog_map_all_df$post)
X23r2_prog_map_all_min_post_counts
X23r2_prog_map_all_max_post_counts = max(X23r2_prog_map_all_df$post)
X23r2_prog_map_all_max_post_counts

# r2 histograms of post counts
X23r2_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X23r2_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X23r2_prog_map_all_syn_df <- X23r2_prog_map_all_df[which(X23r2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X23r2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X23r2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X23r2_prog_map_all_syn_tHDR_rna_pre_med <- unname(X23r2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X23r2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X23r2_prog_map_all_syn_df$tHDR_rna_post_ratio))
X23r2_prog_map_all_syn_tHDR_rna_post_med <- unname(X23r2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X23r2_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X23r2_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X23r2_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X23r2_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X23r2_prog_map_all_min_rna_counts = min(X23r2_prog_map_exon_all_df$tHDR_rna)
X23r2_prog_map_all_min_rna_counts
X23r2_prog_map_all_max_rna_counts = max(X23r2_prog_map_exon_all_df$tHDR_rna)
X23r2_prog_map_all_max_rna_counts
X23r2_prog_map_all_min_rna_pseudo_freq = min(X23r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23r2_prog_map_all_min_rna_pseudo_freq
X23r2_prog_map_all_max_rna_pseudo_freq = max(X23r2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23r2_prog_map_all_max_rna_pseudo_freq
X23r2_prog_map_all_min_rna_pre_ratio = min(X23r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23r2_prog_map_all_min_rna_pre_ratio
X23r2_prog_map_all_max_rna_pre_ratio = max(X23r2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23r2_prog_map_all_max_rna_pre_ratio
X23r2_prog_map_all_min_rna_post_ratio = min(X23r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23r2_prog_map_all_min_rna_post_ratio
X23r2_prog_map_all_max_rna_post_ratio = max(X23r2_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23r2_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X23r2_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X23r2_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X23r2_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X23r2_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X23r2_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X23r2_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X23r2_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X23r2_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X23r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_post_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X23r2_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X23r2_prog_map_all_df$post_pre_ratio),log2(X23r2_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_post_pre_ratio),log2(X23r2_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23r2_prog_map_all_df$tHDR_post_lib_ratio),log2(X23r2_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X23r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X23r2_cSNV_all_corr_pre_count = length(X23r2_cSNV_all_df$corr_pre)
X23r2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X23r2_cSNV_all_min_corr_pre_counts = min(X23r2_cSNV_all_df$corr_pre)
X23r2_cSNV_all_min_corr_pre_counts
X23r2_cSNV_all_max_corr_pre_counts = max(X23r2_cSNV_all_df$corr_pre)
X23r2_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X23r2_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X23r2_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X23r2_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X23r2_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X23r2_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_cSNV_all_corr_post_count = length(X23r2_cSNV_all_df$corr_post)
X23r2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X23r2_cSNV_all_min_corr_post_counts = min(X23r2_cSNV_all_df$corr_post)
X23r2_cSNV_all_min_corr_post_counts
X23r2_cSNV_all_max_corr_post_counts = max(X23r2_cSNV_all_df$corr_post)
X23r2_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X23r2_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X23r2_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X23r2_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X23r2_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X23r2_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X23r2_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X23_p_hdr_snv = paste('p_hdr_',X23_cut_end,'_snv',sep='')
X23r2_pSNV_all <- which(X23r2[,X23_p_hdr_snv]=='True')
X23r2_pSNV_all_df = X23r2[X23r2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_pSNV_all_lib_count = length(X23r2_pSNV_all_df$lib)
X23r2_pSNV_all_lib_count
# r2 Max and min reads for each variant
X23r2_pSNV_all_min_lib_counts = min(X23r2_pSNV_all_df$lib)
X23r2_pSNV_all_min_lib_counts
X23r2_pSNV_all_max_lib_counts = max(X23r2_pSNV_all_df$lib)
X23r2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X23r2_pSNV_all_pre_count = length(X23r2_pSNV_all_df$pre)
X23r2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X23r2_pSNV_all_min_pre_counts = min(X23r2_pSNV_all_df$pre)
X23r2_pSNV_all_min_pre_counts
X23r2_pSNV_all_max_pre_counts = max(X23r2_pSNV_all_df$pre)
X23r2_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X23r2_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X23r2_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_pSNV_all_post_count = length(X23r2_pSNV_all_df$post)
X23r2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X23r2_pSNV_all_min_post_counts = min(X23r2_pSNV_all_df$post)
X23r2_pSNV_all_min_post_counts
X23r2_pSNV_all_max_post_counts = max(X23r2_pSNV_all_df$post)
X23r2_pSNV_all_max_post_counts
# r2 histograms of post counts
X23r2_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X23r2_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_prog_map_thresh5_lib_count = length(X23r2_prog_map_thresh5_df$lib)
X23r2_prog_map_thresh5_lib_count
X23r2_prog_map_thresh5_min_lib_counts = min(X23r2_prog_map_thresh5_df$lib)
X23r2_prog_map_thresh5_min_lib_counts
X23r2_prog_map_thresh5_max_lib_counts = max(X23r2_prog_map_thresh5_df$lib)
X23r2_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X23r2_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X23r2_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_prog_map_thresh5_pre_count = length(X23r2_prog_map_thresh5_df$pre)
X23r2_prog_map_thresh5_pre_count
X23r2_prog_map_thresh5_min_pre_counts = min(X23r2_prog_map_thresh5_df$pre)
X23r2_prog_map_thresh5_min_pre_counts
X23r2_prog_map_thresh5_max_pre_counts = max(X23r2_prog_map_thresh5_df$pre)
X23r2_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23r2_prog_map_thresh5_post_count = length(X23r2_prog_map_thresh5_df$post)
X23r2_prog_map_thresh5_post_count
X23r2_prog_map_thresh5_min_post_counts = min(X23r2_prog_map_thresh5_df$post)
X23r2_prog_map_thresh5_min_post_counts
X23r2_prog_map_thresh5_max_post_counts = max(X23r2_prog_map_thresh5_df$post)
X23r2_prog_map_thresh5_max_post_counts
X23r2_prog_map_thresh5_corr_post_count = length(X23r2_prog_map_thresh5_df$corr_post)
X23r2_prog_map_thresh5_corr_post_count
X23r2_prog_map_thresh5_min_corr_post_counts = min(X23r2_prog_map_thresh5_df$corr_post)
X23r2_prog_map_thresh5_min_corr_post_counts
X23r2_prog_map_thresh5_max_corr_post_counts = max(X23r2_prog_map_thresh5_df$corr_post)
X23r2_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X23r2_pSNV_thresh5 <- which(X23r2[,X23_p_hdr_snv]=='True' & as.numeric(as.character(X23r2[,'pre_freq']))>=0.00001)
X23r2_pSNV_thresh5_df = X23r2[X23r2_pSNV_thresh5,]
X23r2_pSNV_thresh5_lib_count = length(X23r2_pSNV_thresh5_df$lib)
X23r2_pSNV_thresh5_lib_count
X23r2_pSNV_thresh5_min_lib_counts = min(X23r2_pSNV_thresh5_df$lib)
X23r2_pSNV_thresh5_min_lib_counts
X23r2_pSNV_thresh5_max_lib_counts = max(X23r2_pSNV_thresh5_df$lib)
X23r2_pSNV_thresh5_max_lib_counts
X23r2_pSNV_thresh5_pre_count = length(X23r2_pSNV_thresh5_df$pre)
X23r2_pSNV_thresh5_pre_count
X23r2_pSNV_thresh5_min_pre_counts = min(X23r2_pSNV_thresh5_df$pre)
X23r2_pSNV_thresh5_min_pre_counts
X23r2_pSNV_thresh5_max_pre_counts = max(X23r2_pSNV_thresh5_df$pre)
X23r2_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X23r2_pSNV_thresh5_post_count = length(X23r2_pSNV_thresh5_df$post)
X23r2_pSNV_thresh5_post_count
X23r2_pSNV_thresh5_min_post_counts = min(X23r2_pSNV_thresh5_df$post)
X23r2_pSNV_thresh5_min_post_counts
X23r2_pSNV_thresh5_max_post_counts = max(X23r2_pSNV_thresh5_df$post)
X23r2_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X23r2_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X23r2_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X23r1_prog_var_thresh5_df:
X23r1_prog_var_thresh5_df_r2_int <- X23r1_prog_var_thresh5_df[which(X23r1_prog_var_thresh5_df$variant %in% X23r2_prog_var_thresh5_df$variant),]
#Intersection variants of X23r2_prog_var_thresh5_df:
X23r2_prog_var_thresh5_df_r1_int <- X23r2_prog_var_thresh5_df[which(X23r2_prog_var_thresh5_df$variant %in% X23r1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X23r1_prog_var_thresh5_df_r2_int_ord <- X23r1_prog_var_thresh5_df_r2_int[order(X23r1_prog_var_thresh5_df_r2_int$variant),]
X23r2_prog_var_thresh5_df_r1_int_ord <- X23r2_prog_var_thresh5_df_r1_int[order(X23r2_prog_var_thresh5_df_r1_int$variant),]

dim(X23r1_prog_var_thresh5_df)[1] #Number of prog_vars in r1
X23r1r2int_prog_var_thresh5_pre_count <- dim(X23r1_prog_var_thresh5_df_r2_int)[1] 
X23r1r2int_prog_var_thresh5_pre_count #Number of prog_vars in r1 also in r2
dim(X23r2_prog_var_thresh5_df)[1] #Number of prog_vars in r2
dim(X23r2_prog_var_thresh5_df_r1_int)[1] #Number of prog_vars in r2 also in r1
#Add the following columns from the from r2 df to the r1 df:
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre <- X23r2_prog_var_thresh5_df_r1_int_ord$pre
X23r1_prog_var_thresh5_df_r2_int_ord$r2_lib <- X23r2_prog_var_thresh5_df_r1_int_ord$lib
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post <- X23r2_prog_var_thresh5_df_r1_int_ord$post
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna <- X23r2_prog_var_thresh5_df_r1_int_ord$rna
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo <- X23r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo <- X23r2_prog_var_thresh5_df_r1_int_ord$post_pseudo
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo <- X23r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$pre_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$post_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$rna_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$pre_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$post_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$rna_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$pre_lib_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$post_pre_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$post_lib_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna_pre_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$rna_pre_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_rna_post_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$rna_post_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_snv_error_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$pre_snv_error_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_snv_error_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$post_snv_error_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_pre <- X23r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_pre
X23r1_prog_var_thresh5_df_r2_int_ord$r2_exp_snv_error_reads_post <- X23r2_prog_var_thresh5_df_r1_int_ord$exp_snv_error_reads_post
X23r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre <- X23r2_prog_var_thresh5_df_r1_int_ord$corr_pre
X23r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post <- X23r2_prog_var_thresh5_df_r1_int_ord$corr_post
X23r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pre_pseudo <- X23r2_prog_var_thresh5_df_r1_int_ord$corr_pre_pseudo
X23r1_prog_var_thresh5_df_r2_int_ord$r2_corr_post_pseudo <- X23r2_prog_var_thresh5_df_r1_int_ord$corr_post_pseudo
X23r1_prog_var_thresh5_df_r2_int_ord$r2_corr_pseudo_post_pre_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_lib <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_lib
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_post
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pseudo_freq <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pseudo_freq
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_pre_lib_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_pre_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_post_lib_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_pre_ratio
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio <- X23r2_prog_var_thresh5_df_r1_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio)/2
#post_pre_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio)/2
#post_lib_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio)/2
#tHDR_pre_lib_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_r1r2_mean
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_pre_weighted <- ((X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq*X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq))+(X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq*X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)))/X23r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq
#r1 pre-freq weighting coefficient (r1_pre-freq / (r1 + r2 pre-freq's))
X23r1_prog_var_thresh5_df_r2_int_ord$pre_weight <- X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted <- (X23r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$pre_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#this will be weighted by denominator:  (r1_pof/lif')*(r1_prwc)+(r2_pof/lif)*(r2_prwc)
X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_pre_weighted <- (X23r1_prog_var_thresh5_df_r2_int_ord$post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$pre_weight)+(X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$lib_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_weight)
#r1 tHDR_pre-freq weighting coefficient (r1_tHDR_pre-freq / (r1 + r2 pre-freq's))
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#r2 tHDR_pre-freq weighting coefficient
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq/(X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq+X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (r1_pof/r1_prf)(r1_prwc)+(r2_pof/r2_prf)*(r2_prwc)
#tHDR_post_pre_ratio_r1r2_pre_weighted
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted <- (X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_weight)+(X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pseudo_freq/X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_pseudo_freq)*(X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X23r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X23r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X23r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X23r1_cSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio)
X23r1_cSNV_missense_post_pre_med <- unname(X23r1_cSNV_missense_post_pre_quarts[3])
X23r1_cSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio)
X23r1_cSNV_syn_post_pre_med <- unname(X23r1_cSNV_syn_post_pre_quarts[3])
X23r1_cSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio)
X23r1_cSNV_nonsense_post_pre_med <- unname(X23r1_cSNV_nonsense_post_pre_quarts[3])
X23r1_cSNV_syn_to_non_post_pre_spread <- X23r1_cSNV_syn_post_pre_med - X23r1_cSNV_nonsense_post_pre_med

X23r2_cSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio)
X23r2_cSNV_missense_post_pre_med <- unname(X23r2_cSNV_missense_post_pre_quarts[3])
X23r2_cSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_pre_ratio)
X23r2_cSNV_syn_post_pre_med <- unname(X23r2_cSNV_syn_post_pre_quarts[3])
X23r2_cSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_pre_ratio)
X23r2_cSNV_nonsense_post_pre_med <- unname(X23r2_cSNV_nonsense_post_pre_quarts[3])
X23r2_cSNV_syn_to_non_post_pre_spread <- X23r2_cSNV_syn_post_pre_med - X23r2_cSNV_nonsense_post_pre_med

X23r1r2a_cSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean)
X23r1r2a_cSNV_missense_post_pre_med <- unname(X23r1r2a_cSNV_missense_post_pre_quarts[3])
X23r1r2a_cSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_mean)
X23r1r2a_cSNV_syn_post_pre_med <- unname(X23r1r2a_cSNV_syn_post_pre_quarts[3])
X23r1r2a_cSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_mean)
X23r1r2a_cSNV_nonsense_post_pre_med <- unname(X23r1r2a_cSNV_nonsense_post_pre_quarts[3])
X23r1r2a_cSNV_syn_to_non_post_pre_spread <- X23r1r2a_cSNV_syn_post_pre_med - X23r1r2a_cSNV_nonsense_post_pre_med

X23r1r2pw_cSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_cSNV_missense_post_pre_med <- unname(X23r1r2pw_cSNV_missense_post_pre_quarts[3])
X23r1r2pw_cSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_cSNV_syn_post_pre_med <- unname(X23r1r2pw_cSNV_syn_post_pre_quarts[3])
X23r1r2pw_cSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_cSNV_nonsense_post_pre_med <- unname(X23r1r2pw_cSNV_nonsense_post_pre_quarts[3])
X23r1r2pw_cSNV_syn_to_non_post_pre_spread <- X23r1r2pw_cSNV_syn_post_pre_med - X23r1r2pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X23r1_tSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio)
X23r1_tSNV_missense_post_pre_med <- unname(X23r1_tSNV_missense_post_pre_quarts[3])
X23r1_tSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio)
X23r1_tSNV_syn_post_pre_med <- unname(X23r1_tSNV_syn_post_pre_quarts[3])
X23r1_tSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio)
X23r1_tSNV_nonsense_post_pre_med <- unname(X23r1_tSNV_nonsense_post_pre_quarts[3])
X23r1_tSNV_syn_to_non_post_pre_spread <- X23r1_tSNV_syn_post_pre_med - X23r1_tSNV_nonsense_post_pre_med

X23r2_tSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio)
X23r2_tSNV_missense_post_pre_med <- unname(X23r2_tSNV_missense_post_pre_quarts[3])
X23r2_tSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_pre_ratio)
X23r2_tSNV_syn_post_pre_med <- unname(X23r2_tSNV_syn_post_pre_quarts[3])
X23r2_tSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_pre_ratio)
X23r2_tSNV_nonsense_post_pre_med <- unname(X23r2_tSNV_nonsense_post_pre_quarts[3])
X23r2_tSNV_syn_to_non_post_pre_spread <- X23r2_tSNV_syn_post_pre_med - X23r2_tSNV_nonsense_post_pre_med

X23r1r2a_tSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean)
X23r1r2a_tSNV_missense_post_pre_med <- unname(X23r1r2a_tSNV_missense_post_pre_quarts[3])
X23r1r2a_tSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_mean)
X23r1r2a_tSNV_syn_post_pre_med <- unname(X23r1r2a_tSNV_syn_post_pre_quarts[3])
X23r1r2a_tSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_mean)
X23r1r2a_tSNV_nonsense_post_pre_med <- unname(X23r1r2a_tSNV_nonsense_post_pre_quarts[3])
X23r1r2a_tSNV_syn_to_non_post_pre_spread <- X23r1r2a_tSNV_syn_post_pre_med - X23r1r2a_tSNV_nonsense_post_pre_med

X23r1r2pw_tSNV_missense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_tSNV_missense_post_pre_med <- unname(X23r1r2pw_tSNV_missense_post_pre_quarts[3])
X23r1r2pw_tSNV_syn_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_tSNV_syn_post_pre_med <- unname(X23r1r2pw_tSNV_syn_post_pre_quarts[3])
X23r1r2pw_tSNV_nonsense_post_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_pre_ratio_r1r2_pre_weighted)
X23r1r2pw_tSNV_nonsense_post_pre_med <- unname(X23r1r2pw_tSNV_nonsense_post_pre_quarts[3])
X23r1r2pw_tSNV_syn_to_non_post_pre_spread <- X23r1r2pw_tSNV_syn_post_pre_med - X23r1r2pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X23r1_cSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio)
X23r1_cSNV_missense_post_lib_med <- unname(X23r1_cSNV_missense_post_lib_quarts[3])
X23r1_cSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio)
X23r1_cSNV_syn_post_lib_med <- unname(X23r1_cSNV_syn_post_lib_quarts[3])
X23r1_cSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio)
X23r1_cSNV_nonsense_post_lib_med <- unname(X23r1_cSNV_nonsense_post_lib_quarts[3])
X23r1_cSNV_syn_to_non_post_lib_spread <- X23r1_cSNV_syn_post_lib_med - X23r1_cSNV_nonsense_post_lib_med

X23r2_cSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_post_lib_ratio)
X23r2_cSNV_missense_post_lib_med <- unname(X23r2_cSNV_missense_post_lib_quarts[3])
X23r2_cSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_post_lib_ratio)
X23r2_cSNV_syn_post_lib_med <- unname(X23r2_cSNV_syn_post_lib_quarts[3])
X23r2_cSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_post_lib_ratio)
X23r2_cSNV_nonsense_post_lib_med <- unname(X23r2_cSNV_nonsense_post_lib_quarts[3])
X23r2_cSNV_syn_to_non_post_lib_spread <- X23r2_cSNV_syn_post_lib_med - X23r2_cSNV_nonsense_post_lib_med

X23r1r2a_cSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$post_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_missense_post_lib_med <- unname(X23r1r2a_cSNV_missense_post_lib_quarts[3])
X23r1r2a_cSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$post_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_syn_post_lib_med <- unname(X23r1r2a_cSNV_syn_post_lib_quarts[3])
X23r1r2a_cSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$post_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_nonsense_post_lib_med <- unname(X23r1r2a_cSNV_nonsense_post_lib_quarts[3])
X23r1r2a_cSNV_syn_to_non_post_lib_spread <- X23r1r2a_cSNV_syn_post_lib_med - X23r1r2a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X23r1_tSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio)
X23r1_tSNV_missense_post_lib_med <- unname(X23r1_tSNV_missense_post_lib_quarts[3])
X23r1_tSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio)
X23r1_tSNV_syn_post_lib_med <- unname(X23r1_tSNV_syn_post_lib_quarts[3])
X23r1_tSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio)
X23r1_tSNV_nonsense_post_lib_med <- unname(X23r1_tSNV_nonsense_post_lib_quarts[3])
X23r1_tSNV_syn_to_non_post_lib_spread <- X23r1_tSNV_syn_post_lib_med - X23r1_tSNV_nonsense_post_lib_med

X23r2_tSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_lib_ratio)
X23r2_tSNV_missense_post_lib_med <- unname(X23r2_tSNV_missense_post_lib_quarts[3])
X23r2_tSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_post_lib_ratio)
X23r2_tSNV_syn_post_lib_med <- unname(X23r2_tSNV_syn_post_lib_quarts[3])
X23r2_tSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_post_lib_ratio)
X23r2_tSNV_nonsense_post_lib_med <- unname(X23r2_tSNV_nonsense_post_lib_quarts[3])
X23r2_tSNV_syn_to_non_post_lib_spread <- X23r2_tSNV_syn_post_lib_med - X23r2_tSNV_nonsense_post_lib_med

X23r1r2a_tSNV_missense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_post_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_missense_post_lib_med <- unname(X23r1r2a_tSNV_missense_post_lib_quarts[3])
X23r1r2a_tSNV_syn_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_post_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_syn_post_lib_med <- unname(X23r1r2a_tSNV_syn_post_lib_quarts[3])
X23r1r2a_tSNV_nonsense_post_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_post_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_nonsense_post_lib_med <- unname(X23r1r2a_tSNV_nonsense_post_lib_quarts[3])
X23r1r2a_tSNV_syn_to_non_post_lib_spread <- X23r1r2a_tSNV_syn_post_lib_med - X23r1r2a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X23r1_cSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio)
X23r1_cSNV_missense_pre_lib_med <- unname(X23r1_cSNV_missense_pre_lib_quarts[3])
X23r1_cSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio)
X23r1_cSNV_syn_pre_lib_med <- unname(X23r1_cSNV_syn_pre_lib_quarts[3])
X23r1_cSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio)
X23r1_cSNV_nonsense_pre_lib_med <- unname(X23r1_cSNV_nonsense_pre_lib_quarts[3])
X23r1_cSNV_syn_to_non_pre_lib_spread <- X23r1_cSNV_syn_pre_lib_med - X23r1_cSNV_nonsense_pre_lib_med

X23r2_cSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_pre_lib_ratio)
X23r2_cSNV_missense_pre_lib_med <- unname(X23r2_cSNV_missense_pre_lib_quarts[3])
X23r2_cSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_pre_lib_ratio)
X23r2_cSNV_syn_pre_lib_med <- unname(X23r2_cSNV_syn_pre_lib_quarts[3])
X23r2_cSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_pre_lib_ratio)
X23r2_cSNV_nonsense_pre_lib_med <- unname(X23r2_cSNV_nonsense_pre_lib_quarts[3])
X23r2_cSNV_syn_to_non_pre_lib_spread <- X23r2_cSNV_syn_pre_lib_med - X23r2_cSNV_nonsense_pre_lib_med

X23r1r2a_cSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$pre_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_missense_pre_lib_med <- unname(X23r1r2a_cSNV_missense_pre_lib_quarts[3])
X23r1r2a_cSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$pre_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_syn_pre_lib_med <- unname(X23r1r2a_cSNV_syn_pre_lib_quarts[3])
X23r1r2a_cSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$pre_lib_ratio_r1r2_mean)
X23r1r2a_cSNV_nonsense_pre_lib_med <- unname(X23r1r2a_cSNV_nonsense_pre_lib_quarts[3])
X23r1r2a_cSNV_syn_to_non_pre_lib_spread <- X23r1r2a_cSNV_syn_pre_lib_med - X23r1r2a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X23r1_tSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio)
X23r1_tSNV_missense_pre_lib_med <- unname(X23r1_tSNV_missense_pre_lib_quarts[3])
X23r1_tSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio)
X23r1_tSNV_syn_pre_lib_med <- unname(X23r1_tSNV_syn_pre_lib_quarts[3])
X23r1_tSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X23r1_tSNV_nonsense_pre_lib_med <- unname(X23r1_tSNV_nonsense_pre_lib_quarts[3])
X23r1_tSNV_syn_to_non_pre_lib_spread <- X23r1_tSNV_syn_pre_lib_med - X23r1_tSNV_nonsense_pre_lib_med

X23r2_tSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$r2_tHDR_pre_lib_ratio)
X23r2_tSNV_missense_pre_lib_med <- unname(X23r2_tSNV_missense_pre_lib_quarts[3])
X23r2_tSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_pre_lib_ratio)
X23r2_tSNV_syn_pre_lib_med <- unname(X23r2_tSNV_syn_pre_lib_quarts[3])
X23r2_tSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$r2_tHDR_pre_lib_ratio)
X23r2_tSNV_nonsense_pre_lib_med <- unname(X23r2_tSNV_nonsense_pre_lib_quarts[3])
X23r2_tSNV_syn_to_non_pre_lib_spread <- X23r2_tSNV_syn_pre_lib_med - X23r2_tSNV_nonsense_pre_lib_med

X23r1r2a_tSNV_missense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_missense$tHDR_pre_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_missense_pre_lib_med <- unname(X23r1r2a_tSNV_missense_pre_lib_quarts[3])
X23r1r2a_tSNV_syn_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_pre_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_syn_pre_lib_med <- unname(X23r1r2a_tSNV_syn_pre_lib_quarts[3])
X23r1r2a_tSNV_nonsense_pre_lib_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense$tHDR_pre_lib_ratio_r1r2_mean)
X23r1r2a_tSNV_nonsense_pre_lib_med <- unname(X23r1r2a_tSNV_nonsense_pre_lib_quarts[3])
X23r1r2a_tSNV_syn_to_non_pre_lib_spread <- X23r1r2a_tSNV_syn_pre_lib_med - X23r1r2a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X23r1_tSNV_syn_rna_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio)
X23r1_tSNV_syn_rna_pre_med <- unname(X23r1_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X23r1_tSNV_syn_rna_post_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio)
X23r1_tSNV_syn_rna_post_med <- unname(X23r1_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X23r2_tSNV_syn_rna_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_pre_ratio)
X23r2_tSNV_syn_rna_pre_med <- unname(X23r2_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X23r2_tSNV_syn_rna_post_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$r2_tHDR_rna_post_ratio)
X23r2_tSNV_syn_rna_post_med <- unname(X23r2_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_r1r2_mean
X23r1r2a_tSNV_syn_rna_pre_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_pre_ratio_r1r2_mean)
X23r1r2a_tSNV_syn_rna_pre_med <- unname(X23r1r2a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_r1r2_mean
X23r1r2a_tSNV_syn_rna_post_quarts <- quantile(X23r1_prog_map_thresh5_df_r2_int_ord_df_syn$tHDR_rna_post_ratio_r1r2_mean)
X23r1r2a_tSNV_syn_rna_post_med <- unname(X23r1r2a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#r1
X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio/X23r1_cSNV_syn_pre_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio/X23r1_cSNV_syn_post_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio/X23r1_cSNV_syn_post_lib_med
# tHDR
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio/X23r1_tSNV_syn_pre_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio/X23r1_tSNV_syn_post_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio/X23r1_tSNV_syn_post_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio/X23r1_tSNV_syn_rna_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio/X23r1_tSNV_syn_rna_post_med

#r2
X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_pre_lib_ratio/X23r2_cSNV_syn_pre_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_pre_ratio/X23r2_cSNV_syn_post_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_post_lib_ratio/X23r2_cSNV_syn_post_lib_med
# tHDR
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_pre_lib_ratio/X23r2_tSNV_syn_pre_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_pre_ratio/X23r2_tSNV_syn_post_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_post_lib_ratio/X23r2_tSNV_syn_post_lib_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_pre_ratio/X23r2_tSNV_syn_rna_pre_med
X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$r2_tHDR_rna_post_ratio/X23r2_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$pre_lib_ratio_r1r2_mean/X23r1r2a_cSNV_syn_pre_lib_med
#post_pre_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_mean/X23r1r2a_cSNV_syn_post_pre_med
#post_lib_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$post_lib_ratio_r1r2_mean/X23r1r2a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_pre_lib_ratio_r1r2_mean/X23r1r2a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_mean/X23r1r2a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_lib_ratio_r1r2_mean/X23r1r2a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_pre_ratio_r1r2_mean/X23r1r2a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_r1r2_mean_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_rna_post_ratio_r1r2_mean/X23r1r2a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$tHDR_post_pre_ratio_r1r2_pre_weighted/X23r1r2pw_tSNV_syn_post_pre_med
#post_pre_ratio_r1r2_pre_weighted_synnorm
X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted_synnorm <- X23r1_prog_var_thresh5_df_r2_int_ord$post_pre_ratio_r1r2_pre_weighted/X23r1r2pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X23r1_prog_map_thresh5_df_r2_int_ord_df_missynstop <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS' | X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS' | X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X23r1_prog_map_thresh5_df_r2_int_ord_df_missense <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X23r1_prog_map_thresh5_df_r2_int_ord_df_syn <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='SYNONYMOUS'),]
X23r1_prog_map_thresh5_df_r2_int_ord_df_nonsense <- X23r1_prog_var_thresh5_df_r2_int_ord[which(X23r1_prog_var_thresh5_df_r2_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X23r1_prog_var_thresh5_df_r2_int_ord
X23r1_prog_map_thresh5_df_r2_int_ord = which(X23r1_prog_var_thresh5_df_r2_int_ord[,'pos']!='REF')
X23r1_prog_map_thresh5_df_r2_int_ord_df = X23r1_prog_var_thresh5_df_r2_int_ord[X23r1_prog_map_thresh5_df_r2_int_ord,]
X23r1_prog_map_exon_thresh5_df_r2_int_ord = which(X23r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='REF' & X23r1_prog_map_thresh5_df_r2_int_ord_df[,'cDNApos']!='NA')
X23r1_prog_map_exon_thresh5_df_r2_int_ord_df = X23r1_prog_map_thresh5_df_r2_int_ord_df[X23r1_prog_map_exon_thresh5_df_r2_int_ord,]
X23r1_prog_map_CADD_thresh5_df_r2_int_ord = which(X23r1_prog_map_thresh5_df_r2_int_ord_df[,'CADD.phred']!='NA')
X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df = X23r1_prog_map_thresh5_df_r2_int_ord_df[X23r1_prog_map_CADD_thresh5_df_r2_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X23r1r2_prog_map_r1_post_pre_by_r2_post_pre_alpha <-
#X23r1r2_prog_map_r1_post_pre_by_r2_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X23r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
X23r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='pearson')
X23r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23r1r2_cSNV_r1_post_lib_by_r2_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='pearson')
X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X23r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre_alpha <-
#X23r1r2_prog_map_r1_tHDR_post_pre_by_r2_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_s
X23r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='pearson')
X23r1r2_tSNV_r1_tHDR_post_pre_by_r2_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_s
X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='pearson')
X23r1r2_tSNV_r1_tHDR_post_lib_by_r2_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s <- cor(log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_s
X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p <- cor(log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='pearson')
X23r1r2_tSNV_r1_tHDR_rna_pre_by_r2_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X23r1r2_cSNV_r1_pre_by_r2_pre
#correlations between replicates, pre_freq reads:
X23r1r2_cSNV_r1_pre_by_r2_pre_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X23r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X23r1r2_cSNV_r1_pre_by_r2_pre_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='pearson')
X23r1r2_cSNV_r1_pre_by_r2_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X23r1r2_cSNV_r1_post_by_r2_post <-
#correlations between replicates, post_freq reads:
X23r1r2_cSNV_r1_post_by_r2_post_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X23r1r2_cSNV_r1_post_by_r2_post_cor_s
X23r1r2_cSNV_r1_post_by_r2_post_cor_p <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='pearson')
X23r1r2_cSNV_r1_post_by_r2_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='spearman')
X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p <-cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio_synnorm),method='pearson')
X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X23r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X23r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_r1r2_mean_synnorm) ~ pos,data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X23r1_prog_map_thresh5_df_r2_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X23r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X23r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X23r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X23r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s <- cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X23r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X23r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_r1r2_mean_synnorm) ~ pos, data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X23r1_prog_map_thresh5_df_r2_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_r1r2_mean_synnorm by position
X23r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[1]
X23r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_r1r2_mean_synnorm) ~ pos,data=X23r1_prog_map_thresh5_df_r2_int_ord_df))[2]
X23r1_prog_map_thresh5_df_r2_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X23r1_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using r1:
X23r1_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1_cSNV_post_pre_by_cadd_cor_s
#X23r2_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using r2:
X23r2_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r2_cSNV_post_pre_by_cadd_cor_s

#X23r1_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r1:
X23r1_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1_cSNV_post_lib_by_cadd_cor_s
#X23r2_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using r2:
X23r2_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r2_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X23r1_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r1:
X23r1_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1_tSNV_post_pre_by_cadd_cor_s
#X23r2_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using r2:
X23r2_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r2_tSNV_post_pre_by_cadd_cor_s

#X23r1_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r1:
X23r1_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1_tSNV_post_lib_by_cadd_cor_s
#X23r2_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using r2:
X23r2_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23r1r2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23r1r2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23r1r2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23r1r2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X23r1r2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_r1r2_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_r1r2_mean_synnorm density plots based on mean
#post_pre_ratio_r1r2_mean_synnorm density plot for only missynstop

#post_pre_ratio_r1r2_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X23r1_cSNV_thresh5_df_r2_int_ord_missynstop <- X23r1_cSNV_thresh5_df_r2_int_ord_missynstop
ordered_X23r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq <- factor(ordered_X23r1_cSNV_thresh5_df_r2_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense <- X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df[which(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X23r1_prog_var_all_lib_count
X23r1_prog_var_all_pre_count
X23r2_prog_var_all_pre_count
X23r1_prog_map_thresh5_lib_count
X23r1_prog_map_thresh5_pre_count
X23r2_prog_map_thresh5_pre_count
X23r1_prog_map_thresh5_post_count
X23r2_prog_map_thresh5_post_count
X23r1r2int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X23r1r2_cSNV_r1_pre_by_r2_pre_cor_s
X23r1r2_cSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X23r1r2_cSNV_r1_post_by_r2_post_cor_s
X23r1r2_cSNV_r1_post_lib_by_r2_post_lib_cor_s
X23r1r2_cSNV_r1_post_pre_by_r2_post_pre_cor_s
#add tSNV correlations...
X23r1r2_tSNV_r1_post_pre_by_r2_post_pre_cor_s
X23r1r2_tSNV_r1_pre_lib_by_r2_pre_lib_cor_s
X23r1r2_tSNV_r1_post_lib_by_r2_post_lib_cor_s
X23r1r2_tSNV_r1_rna_pre_by_r2_rna_pre_cor_s

#correlations with CADD for single replicates
X23r1_cSNV_post_pre_by_cadd_cor_s
X23r2_cSNV_post_pre_by_cadd_cor_s
X23r1_cSNV_post_lib_by_cadd_cor_s
X23r2_cSNV_post_lib_by_cadd_cor_s
X23r1_tSNV_post_pre_by_cadd_cor_s
X23r2_tSNV_post_pre_by_cadd_cor_s
X23r1_tSNV_post_lib_by_cadd_cor_s
X23r2_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X23r1r2a_cSNV_post_pre_by_cadd_cor_s
X23r1r2w_cSNV_post_pre_by_cadd_cor_s
X23r1r2a_cSNV_post_lib_by_cadd_cor_s
X23r1r2w_cSNV_post_lib_by_cadd_cor_s
X23r1r2a_tSNV_post_pre_by_cadd_cor_s
X23r1r2w_tSNV_post_pre_by_cadd_cor_s
X23r1r2a_tSNV_post_lib_by_cadd_cor_s
X23r1r2a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X23r1_cSNV_syn_to_non_post_pre_spread
X23r2_cSNV_syn_to_non_post_pre_spread
X23r1r2a_cSNV_syn_to_non_post_pre_spread
X23r1_cSNV_syn_to_non_post_lib_spread
X23r2_cSNV_syn_to_non_post_lib_spread
X23r1r2a_cSNV_syn_to_non_post_lib_spread
X23r1_tSNV_syn_to_non_post_pre_spread
X23r2_tSNV_syn_to_non_post_pre_spread
X23r1r2a_tSNV_syn_to_non_post_pre_spread
X23r1_tSNV_syn_to_non_post_lib_spread
X23r2_tSNV_syn_to_non_post_lib_spread
X23r1r2a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X23r1_prog_map_thresh5_df_r2_int_ord_df_synstop <- X23r1_prog_map_thresh5_df_r2_int_ord_df[which(X23r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='SYNONYMOUS' | X23r1_prog_map_thresh5_df_r2_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df[which(X23r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df[which(X23r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df[which(X23r1_prog_map_thresh5_df_r2_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_r1r2_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X23r1_cSNV_pre_lib_cors = cor(log2(X23r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X23r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23r1_tSNV_pre_lib_cors = cor(log2(X23r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23r1_cSNV_post_lib_cors = cor(log2(X23r1_prog_map_thresh5_df$lib_pseudo_freq),log2(X23r1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X23r1_tSNV_post_lib_cors = cor(log2(X23r1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X23r1_cSNV_post_pre_cors = cor(log2(X23r1_prog_map_thresh5_df$post_pseudo_freq),log2(X23r1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23r1_tSNV_post_pre_cors = cor(log2(X23r1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X23r1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23r1_cSNV_rna_lib_cors = cor(log2(X23r1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X23r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23r1_tSNV_rna_lib_cors = cor(log2(X23r1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X23r1_cSNV_rna_pre_cors = cor(log2(X23r1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X23r1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23r1_tSNV_rna_pre_cors = cor(log2(X23r1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X23r1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23r1r2_cSNV_pre_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_freq),method='spearman')
X23r1r2_tSNV_pre_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_pseudo_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_pseudo_freq),method='spearman')
X23r1r2_cSNV_pre_lib_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$pre_lib_ratio),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_pre_lib_ratio),method='spearman')
X23r1r2_tSNV_pre_lib_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_pre_lib_ratio),method='spearman')
X23r1r2_cSNV_post_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_freq),method='spearman')
X23r1r2_tSNV_post_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pseudo_freq),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pseudo_freq),method='spearman')
X23r1r2_cSNV_post_lib_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_lib_ratio_synnorm),method='spearman')
X23r1r2_tSNV_post_lib_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_lib_ratio_synnorm),method='spearman')
X23r1r2_cSNV_post_pre_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_post_pre_ratio_synnorm),method='spearman')
X23r1r2_tSNV_post_pre_ratio_cors = cor(log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23r1_prog_map_thresh5_df_r2_int_ord_df$r2_tHDR_post_pre_ratio_synnorm),method='spearman')
X23r1r2_cSNV_rna_cors = cor(log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$rna_freq),log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_rna_freq),method='spearman')
X23r1r2_tSNV_rna_cors = cor(log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pseudo_freq),log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pseudo_freq),method='spearman')
X23r1r2_tSNV_rna_pre_ratio_cors = cor(log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23r1_prog_map_exon_thresh5_df_r2_int_ord_df$r2_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23r1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X23r1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X23r1r2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_pre_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_lib_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r1r2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r1r2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X23r1r2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$tHDR_post_pre_ratio_r1r2_mean_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X23r1r2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$pre_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_lib_ratio_r1r2_pre_weighted),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')
X23r1r2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$tHDR_post_pre_ratio_r1r2_pre_weighted_synnorm),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df$CADD.phred)),method='spearman')

X23r1_cors <- c("X23r1",X23r1_cSNV_pre_lib_cors,X23r1_tSNV_pre_lib_cors,X23r1_cSNV_post_lib_cors,X23r1_tSNV_post_lib_cors,X23r1_cSNV_post_pre_cors,X23r1_tSNV_post_pre_cors,X23r1_cSNV_rna_lib_cors,X23r1_tSNV_rna_lib_cors,X23r1_cSNV_rna_pre_cors,X23r1_tSNV_rna_pre_cors,X23r1r2_cSNV_pre_cors,X23r1r2_tSNV_pre_cors,X23r1r2_cSNV_pre_lib_ratio_cors,X23r1r2_tSNV_pre_lib_ratio_cors,X23r1r2_cSNV_post_cors,X23r1r2_tSNV_post_cors,X23r1r2_cSNV_post_lib_ratio_cors,X23r1r2_tSNV_post_lib_ratio_cors,X23r1r2_cSNV_post_pre_ratio_cors,X23r1r2_tSNV_post_pre_ratio_cors,X23r1r2_cSNV_rna_cors,X23r1r2_tSNV_rna_cors,X23r1r2_tSNV_rna_pre_ratio_cors,X23r1_cSNV_pre_lib_ratio_cadd_cors,X23r1_tSNV_pre_lib_ratio_cadd_cors,X23r1_cSNV_post_lib_ratio_cadd_cors,X23r1_tSNV_post_lib_ratio_cadd_cors,X23r1_cSNV_post_pre_ratio_cadd_cors,X23r1_tSNV_post_pre_ratio_cadd_cors,X23r1_cSNV_post_pre_ratio_cadd_missense_cors,X23r1_tSNV_post_pre_ratio_cadd_missense_cors,X23r1_cSNV_post_pre_ratio_polyphen_missense_cors,X23r1_tSNV_post_pre_ratio_polyphen_missense_cors,X23r1_cSNV_post_pre_ratio_grantham_missense_cors,X23r1_tSNV_post_pre_ratio_grantham_missense_cors,X23r1r2a_cSNV_pre_lib_ratio_cadd_cors,X23r1r2a_tSNV_pre_lib_ratio_cadd_cors,X23r1r2a_cSNV_post_lib_ratio_cadd_cors,X23r1r2a_tSNV_post_lib_ratio_cadd_cors,X23r1r2a_cSNV_post_pre_ratio_cadd_cors,X23r1r2a_tSNV_post_pre_ratio_cadd_cors,X23r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X23r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X23r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X23r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X23r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X23r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X23r1r2w_cSNV_pre_lib_ratio_cadd_cors,X23r1r2w_cSNV_post_lib_ratio_cadd_cors,X23r1r2w_cSNV_post_pre_ratio_cadd_cors,X23r1r2w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for r2-specific scores...
X23r2_cSNV_pre_lib_cors = cor(log2(X23r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X23r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23r2_tSNV_pre_lib_cors = cor(log2(X23r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23r2_cSNV_post_lib_cors = cor(log2(X23r2_prog_map_thresh5_df$lib_pseudo_freq),log2(X23r2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X23r2_tSNV_post_lib_cors = cor(log2(X23r2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X23r2_cSNV_post_pre_cors = cor(log2(X23r2_prog_map_thresh5_df$post_pseudo_freq),log2(X23r2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23r2_tSNV_post_pre_cors = cor(log2(X23r2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X23r2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23r2_cSNV_rna_lib_cors = cor(log2(X23r2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X23r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23r2_tSNV_rna_lib_cors = cor(log2(X23r2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X23r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X23r2_cSNV_rna_pre_cors = cor(log2(X23r2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X23r2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23r2_tSNV_rna_pre_cors = cor(log2(X23r2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X23r2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# r2 switching to the df with CADD scores to make correlations with CADD
X23r2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23r2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23r2_prog_map_CADD_df$CADD.phred)),method='spearman')
X23r2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$CADD.phred)),method='spearman')
X23r2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$polyphen.val)),method='spearman')
X23r2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')
X23r2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$r2_tHDR_post_pre_ratio),as.numeric(as.character(X23r1_prog_map_CADD_thresh5_df_r2_int_ord_df_missense$Grantham)),method='spearman')

X23r2_cors <- c("X23r2",X23r2_cSNV_pre_lib_cors,X23r2_tSNV_pre_lib_cors,X23r2_cSNV_post_lib_cors,X23r2_tSNV_post_lib_cors,X23r2_cSNV_post_pre_cors,X23r2_tSNV_post_pre_cors,X23r2_cSNV_rna_lib_cors,X23r2_tSNV_rna_lib_cors,X23r2_cSNV_rna_pre_cors,X23r2_tSNV_rna_pre_cors,X23r1r2_cSNV_pre_cors,X23r1r2_tSNV_pre_cors,X23r1r2_cSNV_pre_lib_ratio_cors,X23r1r2_tSNV_pre_lib_ratio_cors,X23r1r2_cSNV_post_cors,X23r1r2_tSNV_post_cors,X23r1r2_cSNV_post_lib_ratio_cors,X23r1r2_tSNV_post_lib_ratio_cors,X23r1r2_cSNV_post_pre_ratio_cors,X23r1r2_tSNV_post_pre_ratio_cors,X23r1r2_cSNV_rna_cors,X23r1r2_tSNV_rna_cors,X23r1r2_tSNV_rna_pre_ratio_cors,X23r2_cSNV_pre_lib_ratio_cadd_cors,X23r2_tSNV_pre_lib_ratio_cadd_cors,X23r2_cSNV_post_lib_ratio_cadd_cors,X23r2_tSNV_post_lib_ratio_cadd_cors,X23r2_cSNV_post_pre_ratio_cadd_cors,X23r2_tSNV_post_pre_ratio_cadd_cors,X23r2_cSNV_post_pre_ratio_cadd_missense_cors,X23r2_tSNV_post_pre_ratio_cadd_missense_cors,X23r2_cSNV_post_pre_ratio_polyphen_missense_cors,X23r2_tSNV_post_pre_ratio_polyphen_missense_cors,X23r2_cSNV_post_pre_ratio_grantham_missense_cors,X23r2_tSNV_post_pre_ratio_grantham_missense_cors,X23r1r2a_cSNV_pre_lib_ratio_cadd_cors,X23r1r2a_tSNV_pre_lib_ratio_cadd_cors,X23r1r2a_cSNV_post_lib_ratio_cadd_cors,X23r1r2a_tSNV_post_lib_ratio_cadd_cors,X23r1r2a_cSNV_post_pre_ratio_cadd_cors,X23r1r2a_tSNV_post_pre_ratio_cadd_cors,X23r1r2a_cSNV_post_pre_ratio_cadd_missense_cors,X23r1r2a_tSNV_post_pre_ratio_cadd_missense_cors,X23r1r2a_cSNV_post_pre_ratio_polyphen_missense_cors,X23r1r2a_tSNV_post_pre_ratio_polyphen_missense_cors,X23r1r2a_cSNV_post_pre_ratio_grantham_missense_cors,X23r1r2a_tSNV_post_pre_ratio_grantham_missense_cors,X23r1r2w_cSNV_pre_lib_ratio_cadd_cors,X23r1r2w_cSNV_post_lib_ratio_cadd_cors,X23r1r2w_cSNV_post_pre_ratio_cadd_cors,X23r1r2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X23r1)
rm(X23r2)
gc()
