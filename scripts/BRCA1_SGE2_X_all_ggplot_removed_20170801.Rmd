```{r}
library(plyr)
library(ggplot2)
editing_info <- read.table("/mount/SGE/BRCA1/BRCA1_editing_data.txt",header=TRUE, sep="\t")
#must rename this for each experiment.
experiment_dir_170413 = "/mount/SGE/BRCA1/20170413_BRCA1_SGE1_X4_X5_X15_X16_X17_X171N_X17L4_X20/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170420 = "/mount/SGE/BRCA1/20170420_BRCA1_SGE1_X2_X3_X17_X18_X19_X21_X22_X23/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170506 = "/mount/SGE/BRCA1/20170506_BRCA1_SGE1_X17_RNA/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170524 = "/mount/SGE/BRCA1/ESHG17_analysis/variant_counts_no_thresh/final/"
experiment_dir_170529 = "/mount/SGE/BRCA1/20170529_BRCA1_SGE1_X4X16X17_RNA/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170630 = "/mount/SGE/BRCA1/20170630_BRCA1_SGE2_X2X3X15X18X20X22/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170722 = "/mount/SGE/BRCA1/20170722_BRCA1_SGE2_X4X5X16X17X19X21X23/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
experiment_dir_170731 = "/mount/SGE/BRCA1/20170731_BRCA1_SGE2_all/fastq/Seqprep/merged/no_Ns/sam/variant_counts_no_thresh/final/"
named_conseq_colors_clinvar_path.lp_benign = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

named_conseq_colors = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#3885DB", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000")

named_conseq_colors_full = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#013DD3","Conflicting interpretations of pathogenicity" = "#FFCB00","Likely benign" = "#2360F9","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#00A54D" )

named_conseq_colors_full_simple = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000","Pathogenic" = "#A40000","Likely pathogenic" = "#FA2039","Likely benign" = "#2360F9","Benign" = "#013DD3","Uncertain significance" = "#31947B","Conflicting interpretations of pathogenicity" = "#FFC927", "absent" = "#BFBCBC","Gray" = "#000000" )

named_missense_colors_by_polyphen = c("possibly_damaging" = "#00925B","probably_damaging" = "#007549", "benign" = "#00BA74")

named_conseq_colors_hide_missense = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#FFFFFF", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#47A300", "REF" = "#000000")

named_conseq_colors_highlight_mis = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#B0B2B3", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#B0B2B3", "SYNONYMOUS" = "#B0B2B3","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )

named_conseq_colors_highlight_syn_int = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#B0B2B3", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )

named_conseq_colors_clinvar_gray = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#EBEAEA","Pathogenic" = "#EBEAEA","Uncertain significance" = "#EBEAEA" )

named_conseq_colors_clinvar_path.lp = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

named_conseq_colors_clinvar_path.lp_benign.lb_confl.vus = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#FFB400","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#FFB400" )

named_conseq_colors_clinvar_path.lp_benign.lb = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#9D0012","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )

#changes these to be +1 due to 0-indexing vs. 1 indexing...
X2_cut_pos <- 41276033.5+1
X3_cut_pos <- 41267763.5+1
X4_cut_pos <- 41258518.5+1 
X5_cut_pos <- 41256892.5+1
X15_cut_pos <- 41222951.5+1
X16_cut_pos <- 41219676.5+1
X17_cut_pos <- 41215950.5+1
X18_cut_pos <- 41215377.5+1
X19_cut_pos <- 41209129.5+1
X20_cut_pos <- 41203127.5+1
X21_cut_pos <- 41201207.5+1
X22_cut_pos <- 41199706.5+1
X23_cut_pos <- 41197794.5+1

###CODE ABOVE HERE APPLIES TO ALL SGE REGIONS IN EXP.

#Current working analysis (expects rna-pre samples for each exon) -- generalized and applied to all Ligase-4 KO SGE exon experiments

X2rL41_file <- paste(experiment_dir_170731,'X2rL41','_annotated.txt',sep='')
X2rL42_file <- paste(experiment_dir_170731,'X2rL42','_annotated.txt',sep='')
X2rL41 <- read.table(X2rL41_file, header=TRUE, sep="\t")
X2rL42 <- read.table(X2rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X2 <- editing_info[which(editing_info$amplicon == 'X2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X2_HDR_5_SNV = as.character(editing_info_X2$HDR_5_SNV)
X2_HDR_3_SNV = as.character(editing_info_X2$HDR_3_SNV)
#X2_cut_pos = as.character(editing_info_X2$cut_pos)
X2_cut_end = as.character(editing_info_X2$cut_end)
X2_mut_start = as.character(editing_info_X2$mut_start)
X2_mut_end = as.character(editing_info_X2$mut_end)
### Replicate 1
X2rL41_cSNV_all <- which(X2rL41[,'c_hdr_snv']=='True')
X2rL41_cSNV_all_df = X2rL41[X2rL41_cSNV_all,]
X2rL41_prog_var_all <- which(X2rL41[,'all_hdr_variant']=='True' & X2rL41[,'edit_string']!='-WT')
X2rL41_prog_var_all_df = X2rL41[X2rL41_prog_var_all,]
X2rL41_prog_map_all = which(X2rL41_prog_var_all_df[,'pos']!='REF')
X2rL41_prog_map_all_df = X2rL41_prog_var_all_df[X2rL41_prog_map_all,]
X2rL41_prog_map_exon_all = which(X2rL41_prog_map_all_df[,'cDNApos']!='REF' & X2rL41_prog_map_all_df[,'cDNApos']!='NA')
X2rL41_prog_map_exon_all_df = X2rL41_prog_map_all_df[X2rL41_prog_map_exon_all,]
X2rL41_prog_map_CADD = which(X2rL41_prog_map_all_df[,'CADD.phred']!='NA')
X2rL41_prog_map_CADD_df = X2rL41_prog_map_all_df[X2rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X2rL41_prog_var_thresh5 <- which(as.numeric(as.character(X2rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X2rL41_prog_var_thresh5_df = X2rL41_prog_var_all_df[X2rL41_prog_var_thresh5,]
X2rL41_prog_map_thresh5 <- which(as.numeric(as.character(X2rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X2rL41_prog_map_thresh5_df = X2rL41_prog_map_all_df[X2rL41_prog_map_thresh5,]
X2rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X2rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X2rL41_prog_map_exon_thresh5_df = X2rL41_prog_map_exon_all_df[X2rL41_prog_map_exon_thresh5,]
X2rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X2rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X2rL41_prog_map_CADD_thresh5_df = X2rL41_prog_map_CADD_df[X2rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X2rL41_prog_var_all_lib_count = length(X2rL41_prog_var_all_df$lib)
X2rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X2rL41_prog_var_all_min_lib_counts = min(X2rL41_prog_var_all_df$lib)
X2rL41_prog_var_all_min_lib_counts
X2rL41_prog_var_all_max_lib_counts = max(X2rL41_prog_var_all_df$lib)
X2rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X2rL41_prog_map_all_lib_count = length(X2rL41_prog_map_all_df$lib)
X2rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X2rL41_prog_map_all_min_lib_counts = min(X2rL41_prog_map_all_df$lib)
X2rL41_prog_map_all_min_lib_counts
X2rL41_prog_map_all_max_lib_counts = max(X2rL41_prog_map_all_df$lib)
X2rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X2rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X2rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X2rL41_prog_var_all_pre_count = length(X2rL41_prog_var_all_df$pre)
X2rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X2rL41_prog_var_all_min_pre_counts = min(X2rL41_prog_var_all_df$pre)
X2rL41_prog_var_all_min_pre_counts
X2rL41_prog_var_all_max_pre_counts = max(X2rL41_prog_var_all_df$pre)
X2rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X2rL41_prog_map_all_pre_count = length(X2rL41_prog_map_all_df$pre)
X2rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X2rL41_prog_map_all_min_pre_counts = min(X2rL41_prog_map_all_df$pre)
X2rL41_prog_map_all_min_pre_counts
X2rL41_prog_map_all_max_pre_counts = max(X2rL41_prog_map_all_df$pre)
X2rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X2rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X2rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X2rL41_prog_map_all_post_count = length(X2rL41_prog_map_all_df$post)
X2rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X2rL41_prog_map_all_min_post_counts = min(X2rL41_prog_map_all_df$post)
X2rL41_prog_map_all_min_post_counts
X2rL41_prog_map_all_max_post_counts = max(X2rL41_prog_map_all_df$post)
X2rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X2rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X2rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X2rL41_prog_map_all_syn_df <- X2rL41_prog_map_all_df[which(X2rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X2rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X2rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X2rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X2rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X2rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X2rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X2rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X2rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X2rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X2rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X2rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X2rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X2rL41_prog_map_all_min_rna_counts = min(X2rL41_prog_map_exon_all_df$tHDR_rna)
X2rL41_prog_map_all_min_rna_counts
X2rL41_prog_map_all_max_rna_counts = max(X2rL41_prog_map_exon_all_df$tHDR_rna)
X2rL41_prog_map_all_max_rna_counts
X2rL41_prog_map_all_min_rna_pseudo_freq = min(X2rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2rL41_prog_map_all_min_rna_pseudo_freq
X2rL41_prog_map_all_max_rna_pseudo_freq = max(X2rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2rL41_prog_map_all_max_rna_pseudo_freq
X2rL41_prog_map_all_min_rna_pre_ratio = min(X2rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2rL41_prog_map_all_min_rna_pre_ratio
X2rL41_prog_map_all_max_rna_pre_ratio = max(X2rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2rL41_prog_map_all_max_rna_pre_ratio
X2rL41_prog_map_all_min_rna_post_ratio = min(X2rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2rL41_prog_map_all_min_rna_post_ratio
X2rL41_prog_map_all_max_rna_post_ratio = max(X2rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X2rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X2rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X2rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X2rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X2rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X2rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X2rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X2rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X2rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X2rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X2rL41_prog_map_all_df$post_pre_ratio),log2(X2rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X2rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X2rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X2rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X2rL41_cSNV_all_corr_pre_count = length(X2rL41_cSNV_all_df$corr_pre)
X2rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X2rL41_cSNV_all_min_corr_pre_counts = min(X2rL41_cSNV_all_df$corr_pre)
X2rL41_cSNV_all_min_corr_pre_counts
X2rL41_cSNV_all_max_corr_pre_counts = max(X2rL41_cSNV_all_df$corr_pre)
X2rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X2rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X2rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X2rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X2rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X2rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_cSNV_all_corr_post_count = length(X2rL41_cSNV_all_df$corr_post)
X2rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X2rL41_cSNV_all_min_corr_post_counts = min(X2rL41_cSNV_all_df$corr_post)
X2rL41_cSNV_all_min_corr_post_counts
X2rL41_cSNV_all_max_corr_post_counts = max(X2rL41_cSNV_all_df$corr_post)
X2rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X2rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X2rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X2rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X2rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X2rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X2rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X2_p_hdr_snv = paste('p_hdr_',X2_cut_end,'_snv',sep='')
X2rL41_pSNV_all <- which(X2rL41[,X2_p_hdr_snv]=='True')
X2rL41_pSNV_all_df = X2rL41[X2rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_pSNV_all_lib_count = length(X2rL41_pSNV_all_df$lib)
X2rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X2rL41_pSNV_all_min_lib_counts = min(X2rL41_pSNV_all_df$lib)
X2rL41_pSNV_all_min_lib_counts
X2rL41_pSNV_all_max_lib_counts = max(X2rL41_pSNV_all_df$lib)
X2rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X2rL41_pSNV_all_pre_count = length(X2rL41_pSNV_all_df$pre)
X2rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X2rL41_pSNV_all_min_pre_counts = min(X2rL41_pSNV_all_df$pre)
X2rL41_pSNV_all_min_pre_counts
X2rL41_pSNV_all_max_pre_counts = max(X2rL41_pSNV_all_df$pre)
X2rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X2rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X2rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_pSNV_all_post_count = length(X2rL41_pSNV_all_df$post)
X2rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X2rL41_pSNV_all_min_post_counts = min(X2rL41_pSNV_all_df$post)
X2rL41_pSNV_all_min_post_counts
X2rL41_pSNV_all_max_post_counts = max(X2rL41_pSNV_all_df$post)
X2rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X2rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X2rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_prog_map_thresh5_lib_count = length(X2rL41_prog_map_thresh5_df$lib)
X2rL41_prog_map_thresh5_lib_count
X2rL41_prog_map_thresh5_min_lib_counts = min(X2rL41_prog_map_thresh5_df$lib)
X2rL41_prog_map_thresh5_min_lib_counts
X2rL41_prog_map_thresh5_max_lib_counts = max(X2rL41_prog_map_thresh5_df$lib)
X2rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X2rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X2rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_prog_map_thresh5_pre_count = length(X2rL41_prog_map_thresh5_df$pre)
X2rL41_prog_map_thresh5_pre_count
X2rL41_prog_map_thresh5_min_pre_counts = min(X2rL41_prog_map_thresh5_df$pre)
X2rL41_prog_map_thresh5_min_pre_counts
X2rL41_prog_map_thresh5_max_pre_counts = max(X2rL41_prog_map_thresh5_df$pre)
X2rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL41_prog_map_thresh5_post_count = length(X2rL41_prog_map_thresh5_df$post)
X2rL41_prog_map_thresh5_post_count
X2rL41_prog_map_thresh5_min_post_counts = min(X2rL41_prog_map_thresh5_df$post)
X2rL41_prog_map_thresh5_min_post_counts
X2rL41_prog_map_thresh5_max_post_counts = max(X2rL41_prog_map_thresh5_df$post)
X2rL41_prog_map_thresh5_max_post_counts
X2rL41_prog_map_thresh5_corr_post_count = length(X2rL41_cSNV_all_df$corr_post)
X2rL41_prog_map_thresh5_corr_post_count
X2rL41_prog_map_thresh5_min_corr_post_counts = min(X2rL41_cSNV_all_df$corr_post)
X2rL41_prog_map_thresh5_min_corr_post_counts
X2rL41_prog_map_thresh5_max_corr_post_counts = max(X2rL41_cSNV_all_df$corr_post)
X2rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X2rL41_pSNV_thresh5 <- which(X2rL41[,X2_p_hdr_snv]=='True' & as.numeric(as.character(X2rL41[,'pre_freq']))>=0.00001)
X2rL41_pSNV_thresh5_df = X2rL41[X2rL41_pSNV_thresh5,]
X2rL41_pSNV_thresh5_lib_count = length(X2rL41_pSNV_thresh5_df$lib)
X2rL41_pSNV_thresh5_lib_count
X2rL41_pSNV_thresh5_min_lib_counts = min(X2rL41_pSNV_thresh5_df$lib)
X2rL41_pSNV_thresh5_min_lib_counts
X2rL41_pSNV_thresh5_max_lib_counts = max(X2rL41_pSNV_thresh5_df$lib)
X2rL41_pSNV_thresh5_max_lib_counts
X2rL41_pSNV_thresh5_pre_count = length(X2rL41_pSNV_thresh5_df$pre)
X2rL41_pSNV_thresh5_pre_count
X2rL41_pSNV_thresh5_min_pre_counts = min(X2rL41_pSNV_thresh5_df$pre)
X2rL41_pSNV_thresh5_min_pre_counts
X2rL41_pSNV_thresh5_max_pre_counts = max(X2rL41_pSNV_thresh5_df$pre)
X2rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X2rL41_pSNV_thresh5_post_count = length(X2rL41_pSNV_thresh5_df$post)
X2rL41_pSNV_thresh5_post_count
X2rL41_pSNV_thresh5_min_post_counts = min(X2rL41_pSNV_thresh5_df$post)
X2rL41_pSNV_thresh5_min_post_counts
X2rL41_pSNV_thresh5_max_post_counts = max(X2rL41_pSNV_thresh5_df$post)
X2rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X2rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X2rL41_pSNV_thresh5_post_pos

### Replicate 2
X2rL42_cSNV_all <- which(X2rL42[,'c_hdr_snv']=='True')
X2rL42_cSNV_all_df = X2rL42[X2rL42_cSNV_all,]
X2rL42_prog_var_all <- which(X2rL42[,'all_hdr_variant']=='True' & X2rL42[,'edit_string']!='-WT')
X2rL42_prog_var_all_df = X2rL42[X2rL42_prog_var_all,]
X2rL42_prog_map_all = which(X2rL42_prog_var_all_df[,'pos']!='REF')
X2rL42_prog_map_all_df = X2rL42_prog_var_all_df[X2rL42_prog_map_all,]
X2rL42_prog_map_exon_all = which(X2rL42_prog_map_all_df[,'cDNApos']!='REF' & X2rL42_prog_map_all_df[,'cDNApos']!='NA')
X2rL42_prog_map_exon_all_df = X2rL42_prog_map_all_df[X2rL42_prog_map_exon_all,]
X2rL42_prog_map_CADD = which(X2rL42_prog_map_all_df[,'CADD.phred']!='NA')
X2rL42_prog_map_CADD_df = X2rL42_prog_map_all_df[X2rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X2rL42_prog_var_thresh5 <- which(as.numeric(as.character(X2rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X2rL42_prog_var_thresh5_df = X2rL42_prog_var_all_df[X2rL42_prog_var_thresh5,]
X2rL42_prog_map_thresh5 <- which(as.numeric(as.character(X2rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X2rL42_prog_map_thresh5_df = X2rL42_prog_map_all_df[X2rL42_prog_map_thresh5,]
X2rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X2rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X2rL42_prog_map_exon_thresh5_df = X2rL42_prog_map_exon_all_df[X2rL42_prog_map_exon_thresh5,]
X2rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X2rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X2rL42_prog_map_CADD_thresh5_df = X2rL42_prog_map_CADD_df[X2rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X2rL42_prog_var_all_lib_count = length(X2rL42_prog_var_all_df$lib)
X2rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X2rL42_prog_var_all_min_lib_counts = min(X2rL42_prog_var_all_df$lib)
X2rL42_prog_var_all_min_lib_counts
X2rL42_prog_var_all_max_lib_counts = max(X2rL42_prog_var_all_df$lib)
X2rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X2rL42_prog_map_all_lib_count = length(X2rL42_prog_map_all_df$lib)
X2rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X2rL42_prog_map_all_min_lib_counts = min(X2rL42_prog_map_all_df$lib)
X2rL42_prog_map_all_min_lib_counts
X2rL42_prog_map_all_max_lib_counts = max(X2rL42_prog_map_all_df$lib)
X2rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X2rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X2rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X2rL42_prog_var_all_pre_count = length(X2rL42_prog_var_all_df$pre)
X2rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X2rL42_prog_var_all_min_pre_counts = min(X2rL42_prog_var_all_df$pre)
X2rL42_prog_var_all_min_pre_counts
X2rL42_prog_var_all_max_pre_counts = max(X2rL42_prog_var_all_df$pre)
X2rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X2rL42_prog_map_all_pre_count = length(X2rL42_prog_map_all_df$pre)
X2rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X2rL42_prog_map_all_min_pre_counts = min(X2rL42_prog_map_all_df$pre)
X2rL42_prog_map_all_min_pre_counts
X2rL42_prog_map_all_max_pre_counts = max(X2rL42_prog_map_all_df$pre)
X2rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X2rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X2rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X2rL42_prog_map_all_post_count = length(X2rL42_prog_map_all_df$post)
X2rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X2rL42_prog_map_all_min_post_counts = min(X2rL42_prog_map_all_df$post)
X2rL42_prog_map_all_min_post_counts
X2rL42_prog_map_all_max_post_counts = max(X2rL42_prog_map_all_df$post)
X2rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X2rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X2rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X2rL42_prog_map_all_syn_df <- X2rL42_prog_map_all_df[which(X2rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X2rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X2rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X2rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X2rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X2rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X2rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X2rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X2rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X2rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X2rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X2rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X2rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X2rL42_prog_map_all_min_rna_counts = min(X2rL42_prog_map_exon_all_df$tHDR_rna)
X2rL42_prog_map_all_min_rna_counts
X2rL42_prog_map_all_max_rna_counts = max(X2rL42_prog_map_exon_all_df$tHDR_rna)
X2rL42_prog_map_all_max_rna_counts
X2rL42_prog_map_all_min_rna_pseudo_freq = min(X2rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2rL42_prog_map_all_min_rna_pseudo_freq
X2rL42_prog_map_all_max_rna_pseudo_freq = max(X2rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X2rL42_prog_map_all_max_rna_pseudo_freq
X2rL42_prog_map_all_min_rna_pre_ratio = min(X2rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2rL42_prog_map_all_min_rna_pre_ratio
X2rL42_prog_map_all_max_rna_pre_ratio = max(X2rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X2rL42_prog_map_all_max_rna_pre_ratio
X2rL42_prog_map_all_min_rna_post_ratio = min(X2rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2rL42_prog_map_all_min_rna_post_ratio
X2rL42_prog_map_all_max_rna_post_ratio = max(X2rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X2rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X2rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X2rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X2rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X2rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X2rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X2rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X2rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X2rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X2rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X2rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X2rL42_prog_map_all_df$post_pre_ratio),log2(X2rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X2rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X2rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X2rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X2rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X2rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X2rL42_cSNV_all_corr_pre_count = length(X2rL42_cSNV_all_df$corr_pre)
X2rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X2rL42_cSNV_all_min_corr_pre_counts = min(X2rL42_cSNV_all_df$corr_pre)
X2rL42_cSNV_all_min_corr_pre_counts
X2rL42_cSNV_all_max_corr_pre_counts = max(X2rL42_cSNV_all_df$corr_pre)
X2rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X2rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X2rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X2rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X2rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X2rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_cSNV_all_corr_post_count = length(X2rL42_cSNV_all_df$corr_post)
X2rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X2rL42_cSNV_all_min_corr_post_counts = min(X2rL42_cSNV_all_df$corr_post)
X2rL42_cSNV_all_min_corr_post_counts
X2rL42_cSNV_all_max_corr_post_counts = max(X2rL42_cSNV_all_df$corr_post)
X2rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X2rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X2rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X2rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X2rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X2rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X2rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X2_p_hdr_snv = paste('p_hdr_',X2_cut_end,'_snv',sep='')
X2rL42_pSNV_all <- which(X2rL42[,X2_p_hdr_snv]=='True')
X2rL42_pSNV_all_df = X2rL42[X2rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_pSNV_all_lib_count = length(X2rL42_pSNV_all_df$lib)
X2rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X2rL42_pSNV_all_min_lib_counts = min(X2rL42_pSNV_all_df$lib)
X2rL42_pSNV_all_min_lib_counts
X2rL42_pSNV_all_max_lib_counts = max(X2rL42_pSNV_all_df$lib)
X2rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X2rL42_pSNV_all_pre_count = length(X2rL42_pSNV_all_df$pre)
X2rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X2rL42_pSNV_all_min_pre_counts = min(X2rL42_pSNV_all_df$pre)
X2rL42_pSNV_all_min_pre_counts
X2rL42_pSNV_all_max_pre_counts = max(X2rL42_pSNV_all_df$pre)
X2rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X2rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X2rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_pSNV_all_post_count = length(X2rL42_pSNV_all_df$post)
X2rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X2rL42_pSNV_all_min_post_counts = min(X2rL42_pSNV_all_df$post)
X2rL42_pSNV_all_min_post_counts
X2rL42_pSNV_all_max_post_counts = max(X2rL42_pSNV_all_df$post)
X2rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X2rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X2rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_prog_map_thresh5_lib_count = length(X2rL42_prog_map_thresh5_df$lib)
X2rL42_prog_map_thresh5_lib_count
X2rL42_prog_map_thresh5_min_lib_counts = min(X2rL42_prog_map_thresh5_df$lib)
X2rL42_prog_map_thresh5_min_lib_counts
X2rL42_prog_map_thresh5_max_lib_counts = max(X2rL42_prog_map_thresh5_df$lib)
X2rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X2rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X2rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_prog_map_thresh5_pre_count = length(X2rL42_prog_map_thresh5_df$pre)
X2rL42_prog_map_thresh5_pre_count
X2rL42_prog_map_thresh5_min_pre_counts = min(X2rL42_prog_map_thresh5_df$pre)
X2rL42_prog_map_thresh5_min_pre_counts
X2rL42_prog_map_thresh5_max_pre_counts = max(X2rL42_prog_map_thresh5_df$pre)
X2rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X2 less than SGE region length x 3 due to PAM edits
X2rL42_prog_map_thresh5_post_count = length(X2rL42_prog_map_thresh5_df$post)
X2rL42_prog_map_thresh5_post_count
X2rL42_prog_map_thresh5_min_post_counts = min(X2rL42_prog_map_thresh5_df$post)
X2rL42_prog_map_thresh5_min_post_counts
X2rL42_prog_map_thresh5_max_post_counts = max(X2rL42_prog_map_thresh5_df$post)
X2rL42_prog_map_thresh5_max_post_counts
X2rL42_prog_map_thresh5_corr_post_count = length(X2rL42_prog_map_thresh5_df$corr_post)
X2rL42_prog_map_thresh5_corr_post_count
X2rL42_prog_map_thresh5_min_corr_post_counts = min(X2rL42_prog_map_thresh5_df$corr_post)
X2rL42_prog_map_thresh5_min_corr_post_counts
X2rL42_prog_map_thresh5_max_corr_post_counts = max(X2rL42_prog_map_thresh5_df$corr_post)
X2rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X2rL42_pSNV_thresh5 <- which(X2rL42[,X2_p_hdr_snv]=='True' & as.numeric(as.character(X2rL42[,'pre_freq']))>=0.00001)
X2rL42_pSNV_thresh5_df = X2rL42[X2rL42_pSNV_thresh5,]
X2rL42_pSNV_thresh5_lib_count = length(X2rL42_pSNV_thresh5_df$lib)
X2rL42_pSNV_thresh5_lib_count
X2rL42_pSNV_thresh5_min_lib_counts = min(X2rL42_pSNV_thresh5_df$lib)
X2rL42_pSNV_thresh5_min_lib_counts
X2rL42_pSNV_thresh5_max_lib_counts = max(X2rL42_pSNV_thresh5_df$lib)
X2rL42_pSNV_thresh5_max_lib_counts
X2rL42_pSNV_thresh5_pre_count = length(X2rL42_pSNV_thresh5_df$pre)
X2rL42_pSNV_thresh5_pre_count
X2rL42_pSNV_thresh5_min_pre_counts = min(X2rL42_pSNV_thresh5_df$pre)
X2rL42_pSNV_thresh5_min_pre_counts
X2rL42_pSNV_thresh5_max_pre_counts = max(X2rL42_pSNV_thresh5_df$pre)
X2rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X2rL42_pSNV_thresh5_post_count = length(X2rL42_pSNV_thresh5_df$post)
X2rL42_pSNV_thresh5_post_count
X2rL42_pSNV_thresh5_min_post_counts = min(X2rL42_pSNV_thresh5_df$post)
X2rL42_pSNV_thresh5_min_post_counts
X2rL42_pSNV_thresh5_max_post_counts = max(X2rL42_pSNV_thresh5_df$post)
X2rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X2rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X2rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X2rL41_prog_var_thresh5_df:
X2rL41_prog_var_thresh5_df_rL42_int <- X2rL41_prog_var_thresh5_df[which(X2rL41_prog_var_thresh5_df$variant %in% X2rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X2rL42_prog_var_thresh5_df:
X2rL42_prog_var_thresh5_df_rL41_int <- X2rL42_prog_var_thresh5_df[which(X2rL42_prog_var_thresh5_df$variant %in% X2rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X2rL41_prog_var_thresh5_df_rL42_int_ord <- X2rL41_prog_var_thresh5_df_rL42_int[order(X2rL41_prog_var_thresh5_df_rL42_int$variant),]
X2rL42_prog_var_thresh5_df_rL41_int_ord <- X2rL42_prog_var_thresh5_df_rL41_int[order(X2rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X2rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X2rL41rL42int_prog_var_thresh5_pre_count <- dim(X2rL41_prog_var_thresh5_df_rL42_int)[1] 
X2rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X2rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X2rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X2rL42_prog_var_thresh5_df_rL41_int_ord$lib
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X2rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X2rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X2rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X2rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X2rL41_cSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X2rL41_cSNV_missense_post_pre_med <- unname(X2rL41_cSNV_missense_post_pre_quarts[3])
X2rL41_cSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X2rL41_cSNV_syn_post_pre_med <- unname(X2rL41_cSNV_syn_post_pre_quarts[3])
X2rL41_cSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X2rL41_cSNV_nonsense_post_pre_med <- unname(X2rL41_cSNV_nonsense_post_pre_quarts[3])
X2rL41_cSNV_syn_to_non_post_pre_spread <- X2rL41_cSNV_syn_post_pre_med - X2rL41_cSNV_nonsense_post_pre_med

X2rL42_cSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X2rL42_cSNV_missense_post_pre_med <- unname(X2rL42_cSNV_missense_post_pre_quarts[3])
X2rL42_cSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X2rL42_cSNV_syn_post_pre_med <- unname(X2rL42_cSNV_syn_post_pre_quarts[3])
X2rL42_cSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X2rL42_cSNV_nonsense_post_pre_med <- unname(X2rL42_cSNV_nonsense_post_pre_quarts[3])
X2rL42_cSNV_syn_to_non_post_pre_spread <- X2rL42_cSNV_syn_post_pre_med - X2rL42_cSNV_nonsense_post_pre_med

X2rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_missense_post_pre_med <- unname(X2rL41rL42a_cSNV_missense_post_pre_quarts[3])
X2rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_syn_post_pre_med <- unname(X2rL41rL42a_cSNV_syn_post_pre_quarts[3])
X2rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X2rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X2rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X2rL41rL42a_cSNV_syn_post_pre_med - X2rL41rL42a_cSNV_nonsense_post_pre_med

X2rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_cSNV_missense_post_pre_med <- unname(X2rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X2rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_cSNV_syn_post_pre_med <- unname(X2rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X2rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X2rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X2rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X2rL41rL42pw_cSNV_syn_post_pre_med - X2rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X2rL41_tSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X2rL41_tSNV_missense_post_pre_med <- unname(X2rL41_tSNV_missense_post_pre_quarts[3])
X2rL41_tSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X2rL41_tSNV_syn_post_pre_med <- unname(X2rL41_tSNV_syn_post_pre_quarts[3])
X2rL41_tSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X2rL41_tSNV_nonsense_post_pre_med <- unname(X2rL41_tSNV_nonsense_post_pre_quarts[3])
X2rL41_tSNV_syn_to_non_post_pre_spread <- X2rL41_tSNV_syn_post_pre_med - X2rL41_tSNV_nonsense_post_pre_med

X2rL42_tSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X2rL42_tSNV_missense_post_pre_med <- unname(X2rL42_tSNV_missense_post_pre_quarts[3])
X2rL42_tSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X2rL42_tSNV_syn_post_pre_med <- unname(X2rL42_tSNV_syn_post_pre_quarts[3])
X2rL42_tSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X2rL42_tSNV_nonsense_post_pre_med <- unname(X2rL42_tSNV_nonsense_post_pre_quarts[3])
X2rL42_tSNV_syn_to_non_post_pre_spread <- X2rL42_tSNV_syn_post_pre_med - X2rL42_tSNV_nonsense_post_pre_med

X2rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_missense_post_pre_med <- unname(X2rL41rL42a_tSNV_missense_post_pre_quarts[3])
X2rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_syn_post_pre_med <- unname(X2rL41rL42a_tSNV_syn_post_pre_quarts[3])
X2rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X2rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X2rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X2rL41rL42a_tSNV_syn_post_pre_med - X2rL41rL42a_tSNV_nonsense_post_pre_med

X2rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_tSNV_missense_post_pre_med <- unname(X2rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X2rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_tSNV_syn_post_pre_med <- unname(X2rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X2rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X2rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X2rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X2rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X2rL41rL42pw_tSNV_syn_post_pre_med - X2rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X2rL41_cSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X2rL41_cSNV_missense_post_lib_med <- unname(X2rL41_cSNV_missense_post_lib_quarts[3])
X2rL41_cSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X2rL41_cSNV_syn_post_lib_med <- unname(X2rL41_cSNV_syn_post_lib_quarts[3])
X2rL41_cSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X2rL41_cSNV_nonsense_post_lib_med <- unname(X2rL41_cSNV_nonsense_post_lib_quarts[3])
X2rL41_cSNV_syn_to_non_post_lib_spread <- X2rL41_cSNV_syn_post_lib_med - X2rL41_cSNV_nonsense_post_lib_med

X2rL42_cSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X2rL42_cSNV_missense_post_lib_med <- unname(X2rL42_cSNV_missense_post_lib_quarts[3])
X2rL42_cSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X2rL42_cSNV_syn_post_lib_med <- unname(X2rL42_cSNV_syn_post_lib_quarts[3])
X2rL42_cSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X2rL42_cSNV_nonsense_post_lib_med <- unname(X2rL42_cSNV_nonsense_post_lib_quarts[3])
X2rL42_cSNV_syn_to_non_post_lib_spread <- X2rL42_cSNV_syn_post_lib_med - X2rL42_cSNV_nonsense_post_lib_med

X2rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_missense_post_lib_med <- unname(X2rL41rL42a_cSNV_missense_post_lib_quarts[3])
X2rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_syn_post_lib_med <- unname(X2rL41rL42a_cSNV_syn_post_lib_quarts[3])
X2rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X2rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X2rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X2rL41rL42a_cSNV_syn_post_lib_med - X2rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X2rL41_tSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X2rL41_tSNV_missense_post_lib_med <- unname(X2rL41_tSNV_missense_post_lib_quarts[3])
X2rL41_tSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X2rL41_tSNV_syn_post_lib_med <- unname(X2rL41_tSNV_syn_post_lib_quarts[3])
X2rL41_tSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X2rL41_tSNV_nonsense_post_lib_med <- unname(X2rL41_tSNV_nonsense_post_lib_quarts[3])
X2rL41_tSNV_syn_to_non_post_lib_spread <- X2rL41_tSNV_syn_post_lib_med - X2rL41_tSNV_nonsense_post_lib_med

X2rL42_tSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X2rL42_tSNV_missense_post_lib_med <- unname(X2rL42_tSNV_missense_post_lib_quarts[3])
X2rL42_tSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X2rL42_tSNV_syn_post_lib_med <- unname(X2rL42_tSNV_syn_post_lib_quarts[3])
X2rL42_tSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X2rL42_tSNV_nonsense_post_lib_med <- unname(X2rL42_tSNV_nonsense_post_lib_quarts[3])
X2rL42_tSNV_syn_to_non_post_lib_spread <- X2rL42_tSNV_syn_post_lib_med - X2rL42_tSNV_nonsense_post_lib_med

X2rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_missense_post_lib_med <- unname(X2rL41rL42a_tSNV_missense_post_lib_quarts[3])
X2rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_syn_post_lib_med <- unname(X2rL41rL42a_tSNV_syn_post_lib_quarts[3])
X2rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X2rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X2rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X2rL41rL42a_tSNV_syn_post_lib_med - X2rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X2rL41_cSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X2rL41_cSNV_missense_pre_lib_med <- unname(X2rL41_cSNV_missense_pre_lib_quarts[3])
X2rL41_cSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X2rL41_cSNV_syn_pre_lib_med <- unname(X2rL41_cSNV_syn_pre_lib_quarts[3])
X2rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X2rL41_cSNV_nonsense_pre_lib_med <- unname(X2rL41_cSNV_nonsense_pre_lib_quarts[3])
X2rL41_cSNV_syn_to_non_pre_lib_spread <- X2rL41_cSNV_syn_pre_lib_med - X2rL41_cSNV_nonsense_pre_lib_med

X2rL42_cSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X2rL42_cSNV_missense_pre_lib_med <- unname(X2rL42_cSNV_missense_pre_lib_quarts[3])
X2rL42_cSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X2rL42_cSNV_syn_pre_lib_med <- unname(X2rL42_cSNV_syn_pre_lib_quarts[3])
X2rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X2rL42_cSNV_nonsense_pre_lib_med <- unname(X2rL42_cSNV_nonsense_pre_lib_quarts[3])
X2rL42_cSNV_syn_to_non_pre_lib_spread <- X2rL42_cSNV_syn_pre_lib_med - X2rL42_cSNV_nonsense_pre_lib_med

X2rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_missense_pre_lib_med <- unname(X2rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X2rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_syn_pre_lib_med <- unname(X2rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X2rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X2rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X2rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X2rL41rL42a_cSNV_syn_pre_lib_med - X2rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X2rL41_tSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X2rL41_tSNV_missense_pre_lib_med <- unname(X2rL41_tSNV_missense_pre_lib_quarts[3])
X2rL41_tSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X2rL41_tSNV_syn_pre_lib_med <- unname(X2rL41_tSNV_syn_pre_lib_quarts[3])
X2rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X2rL41_tSNV_nonsense_pre_lib_med <- unname(X2rL41_tSNV_nonsense_pre_lib_quarts[3])
X2rL41_tSNV_syn_to_non_pre_lib_spread <- X2rL41_tSNV_syn_pre_lib_med - X2rL41_tSNV_nonsense_pre_lib_med

X2rL42_tSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X2rL42_tSNV_missense_pre_lib_med <- unname(X2rL42_tSNV_missense_pre_lib_quarts[3])
X2rL42_tSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X2rL42_tSNV_syn_pre_lib_med <- unname(X2rL42_tSNV_syn_pre_lib_quarts[3])
X2rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X2rL42_tSNV_nonsense_pre_lib_med <- unname(X2rL42_tSNV_nonsense_pre_lib_quarts[3])
X2rL42_tSNV_syn_to_non_pre_lib_spread <- X2rL42_tSNV_syn_pre_lib_med - X2rL42_tSNV_nonsense_pre_lib_med

X2rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_missense_pre_lib_med <- unname(X2rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X2rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_syn_pre_lib_med <- unname(X2rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X2rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X2rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X2rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X2rL41rL42a_tSNV_syn_pre_lib_med - X2rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X2rL41_tSNV_syn_rna_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X2rL41_tSNV_syn_rna_pre_med <- unname(X2rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X2rL41_tSNV_syn_rna_post_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X2rL41_tSNV_syn_rna_post_med <- unname(X2rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X2rL42_tSNV_syn_rna_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X2rL42_tSNV_syn_rna_pre_med <- unname(X2rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X2rL42_tSNV_syn_rna_post_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X2rL42_tSNV_syn_rna_post_med <- unname(X2rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X2rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_syn_rna_pre_med <- unname(X2rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X2rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X2rL41rL42a_tSNV_syn_rna_post_med <- unname(X2rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X2rL41_cSNV_syn_pre_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X2rL41_cSNV_syn_post_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X2rL41_cSNV_syn_post_lib_med
# tHDR
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X2rL41_tSNV_syn_pre_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X2rL41_tSNV_syn_post_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X2rL41_tSNV_syn_post_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X2rL41_tSNV_syn_rna_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X2rL41_tSNV_syn_rna_post_med

#rL42
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X2rL42_cSNV_syn_pre_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X2rL42_cSNV_syn_post_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X2rL42_cSNV_syn_post_lib_med
# tHDR
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X2rL42_tSNV_syn_pre_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X2rL42_tSNV_syn_post_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X2rL42_tSNV_syn_post_lib_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X2rL42_tSNV_syn_rna_pre_med
X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X2rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X2rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X2rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X2rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X2rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X2rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X2rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X2rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X2rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X2rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X2rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X2rL41_prog_var_thresh5_df_rL42_int_ord[which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X2rL41_prog_var_thresh5_df_rL42_int_ord
X2rL41_prog_map_thresh5_df_rL42_int_ord = which(X2rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X2rL41_prog_map_thresh5_df_rL42_int_ord_df = X2rL41_prog_var_thresh5_df_rL42_int_ord[X2rL41_prog_map_thresh5_df_rL42_int_ord,]
X2rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X2rL41_prog_map_thresh5_df_rL42_int_ord_df[X2rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X2rL41_prog_map_thresh5_df_rL42_int_ord_df[X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X2rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X2rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X2rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X2rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X2rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X2rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X2rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X2rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X2rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X2rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X2rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41_cSNV_post_pre_by_cadd_cor_s
#X2rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X2rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL42_cSNV_post_pre_by_cadd_cor_s

#X2rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X2rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41_cSNV_post_lib_by_cadd_cor_s
#X2rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X2rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X2rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X2rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41_tSNV_post_pre_by_cadd_cor_s
#X2rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X2rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL42_tSNV_post_pre_by_cadd_cor_s

#X2rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X2rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41_tSNV_post_lib_by_cadd_cor_s
#X2rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X2rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X2rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X2rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X2rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X2rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X2rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X2rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X2rL41_prog_var_all_lib_count
X2rL41_prog_var_all_pre_count
X2rL42_prog_var_all_pre_count
X2rL41_prog_map_thresh5_lib_count
X2rL41_prog_map_thresh5_pre_count
X2rL42_prog_map_thresh5_pre_count
X2rL41_prog_map_thresh5_post_count
X2rL42_prog_map_thresh5_post_count
X2rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X2rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X2rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X2rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X2rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X2rL41_cSNV_post_pre_by_cadd_cor_s
X2rL42_cSNV_post_pre_by_cadd_cor_s
X2rL41_cSNV_post_lib_by_cadd_cor_s
X2rL42_cSNV_post_lib_by_cadd_cor_s
X2rL41_tSNV_post_pre_by_cadd_cor_s
X2rL42_tSNV_post_pre_by_cadd_cor_s
X2rL41_tSNV_post_lib_by_cadd_cor_s
X2rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X2rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X2rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X2rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X2rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X2rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X2rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X2rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X2rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X2rL41_cSNV_syn_to_non_post_pre_spread
X2rL42_cSNV_syn_to_non_post_pre_spread
X2rL41rL42a_cSNV_syn_to_non_post_pre_spread
X2rL41_cSNV_syn_to_non_post_lib_spread
X2rL42_cSNV_syn_to_non_post_lib_spread
X2rL41rL42a_cSNV_syn_to_non_post_lib_spread
X2rL41_tSNV_syn_to_non_post_pre_spread
X2rL42_tSNV_syn_to_non_post_pre_spread
X2rL41rL42a_tSNV_syn_to_non_post_pre_spread
X2rL41_tSNV_syn_to_non_post_lib_spread
X2rL42_tSNV_syn_to_non_post_lib_spread
X2rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X2rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X2rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X2rL41_cSNV_pre_lib_cors = cor(log2(X2rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2rL41_tSNV_pre_lib_cors = cor(log2(X2rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2rL41_cSNV_post_lib_cors = cor(log2(X2rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X2rL41_tSNV_post_lib_cors = cor(log2(X2rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X2rL41_cSNV_post_pre_cors = cor(log2(X2rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2rL41_tSNV_post_pre_cors = cor(log2(X2rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X2rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2rL41_cSNV_rna_lib_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X2rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2rL41_tSNV_rna_lib_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X2rL41_cSNV_rna_pre_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X2rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2rL41_tSNV_rna_pre_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X2rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2rL41rL42_cSNV_pre_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X2rL41rL42_tSNV_pre_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X2rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X2rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X2rL41rL42_cSNV_post_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X2rL41rL42_tSNV_post_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X2rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X2rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X2rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X2rL41rL42_cSNV_rna_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X2rL41rL42_tSNV_rna_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X2rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X2rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X2rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X2rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X2rL41_cors <- c("X2rL41",X2rL41_cSNV_pre_lib_cors,X2rL41_tSNV_pre_lib_cors,X2rL41_cSNV_post_lib_cors,X2rL41_tSNV_post_lib_cors,X2rL41_cSNV_post_pre_cors,X2rL41_tSNV_post_pre_cors,X2rL41_cSNV_rna_lib_cors,X2rL41_tSNV_rna_lib_cors,X2rL41_cSNV_rna_pre_cors,X2rL41_tSNV_rna_pre_cors,X2rL41rL42_cSNV_pre_cors,X2rL41rL42_tSNV_pre_cors,X2rL41rL42_cSNV_pre_lib_ratio_cors,X2rL41rL42_tSNV_pre_lib_ratio_cors,X2rL41rL42_cSNV_post_cors,X2rL41rL42_tSNV_post_cors,X2rL41rL42_cSNV_post_lib_ratio_cors,X2rL41rL42_tSNV_post_lib_ratio_cors,X2rL41rL42_cSNV_post_pre_ratio_cors,X2rL41rL42_tSNV_post_pre_ratio_cors,X2rL41rL42_cSNV_rna_cors,X2rL41rL42_tSNV_rna_cors,X2rL41rL42_tSNV_rna_pre_ratio_cors,X2rL41_cSNV_pre_lib_ratio_cadd_cors,X2rL41_tSNV_pre_lib_ratio_cadd_cors,X2rL41_cSNV_post_lib_ratio_cadd_cors,X2rL41_tSNV_post_lib_ratio_cadd_cors,X2rL41_cSNV_post_pre_ratio_cadd_cors,X2rL41_tSNV_post_pre_ratio_cadd_cors,X2rL41_cSNV_post_pre_ratio_cadd_missense_cors,X2rL41_tSNV_post_pre_ratio_cadd_missense_cors,X2rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X2rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X2rL41_cSNV_post_pre_ratio_grantham_missense_cors,X2rL41_tSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X2rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X2rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X2rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X2rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X2rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X2rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X2rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X2rL42_cSNV_pre_lib_cors = cor(log2(X2rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2rL42_tSNV_pre_lib_cors = cor(log2(X2rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2rL42_cSNV_post_lib_cors = cor(log2(X2rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X2rL42_tSNV_post_lib_cors = cor(log2(X2rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X2rL42_cSNV_post_pre_cors = cor(log2(X2rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X2rL42_tSNV_post_pre_cors = cor(log2(X2rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X2rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X2rL42_cSNV_rna_lib_cors = cor(log2(X2rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X2rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2rL42_tSNV_rna_lib_cors = cor(log2(X2rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X2rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X2rL42_cSNV_rna_pre_cors = cor(log2(X2rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X2rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X2rL42_tSNV_rna_pre_cors = cor(log2(X2rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X2rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X2rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X2rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X2rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X2rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X2rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X2rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X2rL42_cors <- c("X2rL42",X2rL42_cSNV_pre_lib_cors,X2rL42_tSNV_pre_lib_cors,X2rL42_cSNV_post_lib_cors,X2rL42_tSNV_post_lib_cors,X2rL42_cSNV_post_pre_cors,X2rL42_tSNV_post_pre_cors,X2rL42_cSNV_rna_lib_cors,X2rL42_tSNV_rna_lib_cors,X2rL42_cSNV_rna_pre_cors,X2rL42_tSNV_rna_pre_cors,X2rL41rL42_cSNV_pre_cors,X2rL41rL42_tSNV_pre_cors,X2rL41rL42_cSNV_pre_lib_ratio_cors,X2rL41rL42_tSNV_pre_lib_ratio_cors,X2rL41rL42_cSNV_post_cors,X2rL41rL42_tSNV_post_cors,X2rL41rL42_cSNV_post_lib_ratio_cors,X2rL41rL42_tSNV_post_lib_ratio_cors,X2rL41rL42_cSNV_post_pre_ratio_cors,X2rL41rL42_tSNV_post_pre_ratio_cors,X2rL41rL42_cSNV_rna_cors,X2rL41rL42_tSNV_rna_cors,X2rL41rL42_tSNV_rna_pre_ratio_cors,X2rL42_cSNV_pre_lib_ratio_cadd_cors,X2rL42_tSNV_pre_lib_ratio_cadd_cors,X2rL42_cSNV_post_lib_ratio_cadd_cors,X2rL42_tSNV_post_lib_ratio_cadd_cors,X2rL42_cSNV_post_pre_ratio_cadd_cors,X2rL42_tSNV_post_pre_ratio_cadd_cors,X2rL42_cSNV_post_pre_ratio_cadd_missense_cors,X2rL42_tSNV_post_pre_ratio_cadd_missense_cors,X2rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X2rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X2rL42_cSNV_post_pre_ratio_grantham_missense_cors,X2rL42_tSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X2rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X2rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X2rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X2rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X2rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X2rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X2rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X2rL41)
rm(X2rL42)
gc()

X3rL41_file <- paste(experiment_dir_170731,'X3rL41','_annotated.txt',sep='')
X3rL42_file <- paste(experiment_dir_170731,'X3rL42','_annotated.txt',sep='')
X3rL41 <- read.table(X3rL41_file, header=TRUE, sep="\t")
X3rL42 <- read.table(X3rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X3 <- editing_info[which(editing_info$amplicon == 'X3'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X3_HDR_5_SNV = as.character(editing_info_X3$HDR_5_SNV)
X3_HDR_3_SNV = as.character(editing_info_X3$HDR_3_SNV)
#X3_cut_pos = as.character(editing_info_X3$cut_pos)
X3_cut_end = as.character(editing_info_X3$cut_end)
X3_mut_start = as.character(editing_info_X3$mut_start)
X3_mut_end = as.character(editing_info_X3$mut_end)
### Replicate 1
X3rL41_cSNV_all <- which(X3rL41[,'c_hdr_snv']=='True')
X3rL41_cSNV_all_df = X3rL41[X3rL41_cSNV_all,]
X3rL41_prog_var_all <- which(X3rL41[,'all_hdr_variant']=='True' & X3rL41[,'edit_string']!='-WT')
X3rL41_prog_var_all_df = X3rL41[X3rL41_prog_var_all,]
X3rL41_prog_map_all = which(X3rL41_prog_var_all_df[,'pos']!='REF')
X3rL41_prog_map_all_df = X3rL41_prog_var_all_df[X3rL41_prog_map_all,]
X3rL41_prog_map_exon_all = which(X3rL41_prog_map_all_df[,'cDNApos']!='REF' & X3rL41_prog_map_all_df[,'cDNApos']!='NA')
X3rL41_prog_map_exon_all_df = X3rL41_prog_map_all_df[X3rL41_prog_map_exon_all,]
X3rL41_prog_map_CADD = which(X3rL41_prog_map_all_df[,'CADD.phred']!='NA')
X3rL41_prog_map_CADD_df = X3rL41_prog_map_all_df[X3rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X3rL41_prog_var_thresh5 <- which(as.numeric(as.character(X3rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X3rL41_prog_var_thresh5_df = X3rL41_prog_var_all_df[X3rL41_prog_var_thresh5,]
X3rL41_prog_map_thresh5 <- which(as.numeric(as.character(X3rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X3rL41_prog_map_thresh5_df = X3rL41_prog_map_all_df[X3rL41_prog_map_thresh5,]
X3rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X3rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X3rL41_prog_map_exon_thresh5_df = X3rL41_prog_map_exon_all_df[X3rL41_prog_map_exon_thresh5,]
X3rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X3rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X3rL41_prog_map_CADD_thresh5_df = X3rL41_prog_map_CADD_df[X3rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X3rL41_prog_var_all_lib_count = length(X3rL41_prog_var_all_df$lib)
X3rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X3rL41_prog_var_all_min_lib_counts = min(X3rL41_prog_var_all_df$lib)
X3rL41_prog_var_all_min_lib_counts
X3rL41_prog_var_all_max_lib_counts = max(X3rL41_prog_var_all_df$lib)
X3rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X3rL41_prog_map_all_lib_count = length(X3rL41_prog_map_all_df$lib)
X3rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X3rL41_prog_map_all_min_lib_counts = min(X3rL41_prog_map_all_df$lib)
X3rL41_prog_map_all_min_lib_counts
X3rL41_prog_map_all_max_lib_counts = max(X3rL41_prog_map_all_df$lib)
X3rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X3rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X3rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X3rL41_prog_var_all_pre_count = length(X3rL41_prog_var_all_df$pre)
X3rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X3rL41_prog_var_all_min_pre_counts = min(X3rL41_prog_var_all_df$pre)
X3rL41_prog_var_all_min_pre_counts
X3rL41_prog_var_all_max_pre_counts = max(X3rL41_prog_var_all_df$pre)
X3rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X3rL41_prog_map_all_pre_count = length(X3rL41_prog_map_all_df$pre)
X3rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X3rL41_prog_map_all_min_pre_counts = min(X3rL41_prog_map_all_df$pre)
X3rL41_prog_map_all_min_pre_counts
X3rL41_prog_map_all_max_pre_counts = max(X3rL41_prog_map_all_df$pre)
X3rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X3rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X3rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X3rL41_prog_map_all_post_count = length(X3rL41_prog_map_all_df$post)
X3rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X3rL41_prog_map_all_min_post_counts = min(X3rL41_prog_map_all_df$post)
X3rL41_prog_map_all_min_post_counts
X3rL41_prog_map_all_max_post_counts = max(X3rL41_prog_map_all_df$post)
X3rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X3rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X3rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X3rL41_prog_map_all_syn_df <- X3rL41_prog_map_all_df[which(X3rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X3rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X3rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X3rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X3rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X3rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X3rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X3rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X3rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X3rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X3rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X3rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X3rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X3rL41_prog_map_all_min_rna_counts = min(X3rL41_prog_map_exon_all_df$tHDR_rna)
X3rL41_prog_map_all_min_rna_counts
X3rL41_prog_map_all_max_rna_counts = max(X3rL41_prog_map_exon_all_df$tHDR_rna)
X3rL41_prog_map_all_max_rna_counts
X3rL41_prog_map_all_min_rna_pseudo_freq = min(X3rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3rL41_prog_map_all_min_rna_pseudo_freq
X3rL41_prog_map_all_max_rna_pseudo_freq = max(X3rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3rL41_prog_map_all_max_rna_pseudo_freq
X3rL41_prog_map_all_min_rna_pre_ratio = min(X3rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3rL41_prog_map_all_min_rna_pre_ratio
X3rL41_prog_map_all_max_rna_pre_ratio = max(X3rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3rL41_prog_map_all_max_rna_pre_ratio
X3rL41_prog_map_all_min_rna_post_ratio = min(X3rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3rL41_prog_map_all_min_rna_post_ratio
X3rL41_prog_map_all_max_rna_post_ratio = max(X3rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X3rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X3rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X3rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X3rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X3rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X3rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X3rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X3rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X3rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X3rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X3rL41_prog_map_all_df$post_pre_ratio),log2(X3rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X3rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X3rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X3rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X3rL41_cSNV_all_corr_pre_count = length(X3rL41_cSNV_all_df$corr_pre)
X3rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X3rL41_cSNV_all_min_corr_pre_counts = min(X3rL41_cSNV_all_df$corr_pre)
X3rL41_cSNV_all_min_corr_pre_counts
X3rL41_cSNV_all_max_corr_pre_counts = max(X3rL41_cSNV_all_df$corr_pre)
X3rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X3rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X3rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X3rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X3rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X3rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_cSNV_all_corr_post_count = length(X3rL41_cSNV_all_df$corr_post)
X3rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X3rL41_cSNV_all_min_corr_post_counts = min(X3rL41_cSNV_all_df$corr_post)
X3rL41_cSNV_all_min_corr_post_counts
X3rL41_cSNV_all_max_corr_post_counts = max(X3rL41_cSNV_all_df$corr_post)
X3rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X3rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X3rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X3rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X3rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X3rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X3rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X3_p_hdr_snv = paste('p_hdr_',X3_cut_end,'_snv',sep='')
X3rL41_pSNV_all <- which(X3rL41[,X3_p_hdr_snv]=='True')
X3rL41_pSNV_all_df = X3rL41[X3rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_pSNV_all_lib_count = length(X3rL41_pSNV_all_df$lib)
X3rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X3rL41_pSNV_all_min_lib_counts = min(X3rL41_pSNV_all_df$lib)
X3rL41_pSNV_all_min_lib_counts
X3rL41_pSNV_all_max_lib_counts = max(X3rL41_pSNV_all_df$lib)
X3rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X3rL41_pSNV_all_pre_count = length(X3rL41_pSNV_all_df$pre)
X3rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X3rL41_pSNV_all_min_pre_counts = min(X3rL41_pSNV_all_df$pre)
X3rL41_pSNV_all_min_pre_counts
X3rL41_pSNV_all_max_pre_counts = max(X3rL41_pSNV_all_df$pre)
X3rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X3rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X3rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_pSNV_all_post_count = length(X3rL41_pSNV_all_df$post)
X3rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X3rL41_pSNV_all_min_post_counts = min(X3rL41_pSNV_all_df$post)
X3rL41_pSNV_all_min_post_counts
X3rL41_pSNV_all_max_post_counts = max(X3rL41_pSNV_all_df$post)
X3rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X3rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X3rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_prog_map_thresh5_lib_count = length(X3rL41_prog_map_thresh5_df$lib)
X3rL41_prog_map_thresh5_lib_count
X3rL41_prog_map_thresh5_min_lib_counts = min(X3rL41_prog_map_thresh5_df$lib)
X3rL41_prog_map_thresh5_min_lib_counts
X3rL41_prog_map_thresh5_max_lib_counts = max(X3rL41_prog_map_thresh5_df$lib)
X3rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X3rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X3rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_prog_map_thresh5_pre_count = length(X3rL41_prog_map_thresh5_df$pre)
X3rL41_prog_map_thresh5_pre_count
X3rL41_prog_map_thresh5_min_pre_counts = min(X3rL41_prog_map_thresh5_df$pre)
X3rL41_prog_map_thresh5_min_pre_counts
X3rL41_prog_map_thresh5_max_pre_counts = max(X3rL41_prog_map_thresh5_df$pre)
X3rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL41_prog_map_thresh5_post_count = length(X3rL41_prog_map_thresh5_df$post)
X3rL41_prog_map_thresh5_post_count
X3rL41_prog_map_thresh5_min_post_counts = min(X3rL41_prog_map_thresh5_df$post)
X3rL41_prog_map_thresh5_min_post_counts
X3rL41_prog_map_thresh5_max_post_counts = max(X3rL41_prog_map_thresh5_df$post)
X3rL41_prog_map_thresh5_max_post_counts
X3rL41_prog_map_thresh5_corr_post_count = length(X3rL41_cSNV_all_df$corr_post)
X3rL41_prog_map_thresh5_corr_post_count
X3rL41_prog_map_thresh5_min_corr_post_counts = min(X3rL41_cSNV_all_df$corr_post)
X3rL41_prog_map_thresh5_min_corr_post_counts
X3rL41_prog_map_thresh5_max_corr_post_counts = max(X3rL41_cSNV_all_df$corr_post)
X3rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X3rL41_pSNV_thresh5 <- which(X3rL41[,X3_p_hdr_snv]=='True' & as.numeric(as.character(X3rL41[,'pre_freq']))>=0.00001)
X3rL41_pSNV_thresh5_df = X3rL41[X3rL41_pSNV_thresh5,]
X3rL41_pSNV_thresh5_lib_count = length(X3rL41_pSNV_thresh5_df$lib)
X3rL41_pSNV_thresh5_lib_count
X3rL41_pSNV_thresh5_min_lib_counts = min(X3rL41_pSNV_thresh5_df$lib)
X3rL41_pSNV_thresh5_min_lib_counts
X3rL41_pSNV_thresh5_max_lib_counts = max(X3rL41_pSNV_thresh5_df$lib)
X3rL41_pSNV_thresh5_max_lib_counts
X3rL41_pSNV_thresh5_pre_count = length(X3rL41_pSNV_thresh5_df$pre)
X3rL41_pSNV_thresh5_pre_count
X3rL41_pSNV_thresh5_min_pre_counts = min(X3rL41_pSNV_thresh5_df$pre)
X3rL41_pSNV_thresh5_min_pre_counts
X3rL41_pSNV_thresh5_max_pre_counts = max(X3rL41_pSNV_thresh5_df$pre)
X3rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X3rL41_pSNV_thresh5_post_count = length(X3rL41_pSNV_thresh5_df$post)
X3rL41_pSNV_thresh5_post_count
X3rL41_pSNV_thresh5_min_post_counts = min(X3rL41_pSNV_thresh5_df$post)
X3rL41_pSNV_thresh5_min_post_counts
X3rL41_pSNV_thresh5_max_post_counts = max(X3rL41_pSNV_thresh5_df$post)
X3rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X3rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X3rL41_pSNV_thresh5_post_pos

### Replicate 2
X3rL42_cSNV_all <- which(X3rL42[,'c_hdr_snv']=='True')
X3rL42_cSNV_all_df = X3rL42[X3rL42_cSNV_all,]
X3rL42_prog_var_all <- which(X3rL42[,'all_hdr_variant']=='True' & X3rL42[,'edit_string']!='-WT')
X3rL42_prog_var_all_df = X3rL42[X3rL42_prog_var_all,]
X3rL42_prog_map_all = which(X3rL42_prog_var_all_df[,'pos']!='REF')
X3rL42_prog_map_all_df = X3rL42_prog_var_all_df[X3rL42_prog_map_all,]
X3rL42_prog_map_exon_all = which(X3rL42_prog_map_all_df[,'cDNApos']!='REF' & X3rL42_prog_map_all_df[,'cDNApos']!='NA')
X3rL42_prog_map_exon_all_df = X3rL42_prog_map_all_df[X3rL42_prog_map_exon_all,]
X3rL42_prog_map_CADD = which(X3rL42_prog_map_all_df[,'CADD.phred']!='NA')
X3rL42_prog_map_CADD_df = X3rL42_prog_map_all_df[X3rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X3rL42_prog_var_thresh5 <- which(as.numeric(as.character(X3rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X3rL42_prog_var_thresh5_df = X3rL42_prog_var_all_df[X3rL42_prog_var_thresh5,]
X3rL42_prog_map_thresh5 <- which(as.numeric(as.character(X3rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X3rL42_prog_map_thresh5_df = X3rL42_prog_map_all_df[X3rL42_prog_map_thresh5,]
X3rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X3rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X3rL42_prog_map_exon_thresh5_df = X3rL42_prog_map_exon_all_df[X3rL42_prog_map_exon_thresh5,]
X3rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X3rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X3rL42_prog_map_CADD_thresh5_df = X3rL42_prog_map_CADD_df[X3rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X3rL42_prog_var_all_lib_count = length(X3rL42_prog_var_all_df$lib)
X3rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X3rL42_prog_var_all_min_lib_counts = min(X3rL42_prog_var_all_df$lib)
X3rL42_prog_var_all_min_lib_counts
X3rL42_prog_var_all_max_lib_counts = max(X3rL42_prog_var_all_df$lib)
X3rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X3rL42_prog_map_all_lib_count = length(X3rL42_prog_map_all_df$lib)
X3rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X3rL42_prog_map_all_min_lib_counts = min(X3rL42_prog_map_all_df$lib)
X3rL42_prog_map_all_min_lib_counts
X3rL42_prog_map_all_max_lib_counts = max(X3rL42_prog_map_all_df$lib)
X3rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X3rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X3rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X3rL42_prog_var_all_pre_count = length(X3rL42_prog_var_all_df$pre)
X3rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X3rL42_prog_var_all_min_pre_counts = min(X3rL42_prog_var_all_df$pre)
X3rL42_prog_var_all_min_pre_counts
X3rL42_prog_var_all_max_pre_counts = max(X3rL42_prog_var_all_df$pre)
X3rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X3rL42_prog_map_all_pre_count = length(X3rL42_prog_map_all_df$pre)
X3rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X3rL42_prog_map_all_min_pre_counts = min(X3rL42_prog_map_all_df$pre)
X3rL42_prog_map_all_min_pre_counts
X3rL42_prog_map_all_max_pre_counts = max(X3rL42_prog_map_all_df$pre)
X3rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X3rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X3rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X3rL42_prog_map_all_post_count = length(X3rL42_prog_map_all_df$post)
X3rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X3rL42_prog_map_all_min_post_counts = min(X3rL42_prog_map_all_df$post)
X3rL42_prog_map_all_min_post_counts
X3rL42_prog_map_all_max_post_counts = max(X3rL42_prog_map_all_df$post)
X3rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X3rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X3rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X3rL42_prog_map_all_syn_df <- X3rL42_prog_map_all_df[which(X3rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X3rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X3rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X3rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X3rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X3rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X3rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X3rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X3rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X3rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X3rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X3rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X3rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X3rL42_prog_map_all_min_rna_counts = min(X3rL42_prog_map_exon_all_df$tHDR_rna)
X3rL42_prog_map_all_min_rna_counts
X3rL42_prog_map_all_max_rna_counts = max(X3rL42_prog_map_exon_all_df$tHDR_rna)
X3rL42_prog_map_all_max_rna_counts
X3rL42_prog_map_all_min_rna_pseudo_freq = min(X3rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3rL42_prog_map_all_min_rna_pseudo_freq
X3rL42_prog_map_all_max_rna_pseudo_freq = max(X3rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X3rL42_prog_map_all_max_rna_pseudo_freq
X3rL42_prog_map_all_min_rna_pre_ratio = min(X3rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3rL42_prog_map_all_min_rna_pre_ratio
X3rL42_prog_map_all_max_rna_pre_ratio = max(X3rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X3rL42_prog_map_all_max_rna_pre_ratio
X3rL42_prog_map_all_min_rna_post_ratio = min(X3rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3rL42_prog_map_all_min_rna_post_ratio
X3rL42_prog_map_all_max_rna_post_ratio = max(X3rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X3rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X3rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X3rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X3rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X3rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X3rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X3rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X3rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X3rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X3rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X3rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X3rL42_prog_map_all_df$post_pre_ratio),log2(X3rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X3rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X3rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X3rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X3rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X3rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X3rL42_cSNV_all_corr_pre_count = length(X3rL42_cSNV_all_df$corr_pre)
X3rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X3rL42_cSNV_all_min_corr_pre_counts = min(X3rL42_cSNV_all_df$corr_pre)
X3rL42_cSNV_all_min_corr_pre_counts
X3rL42_cSNV_all_max_corr_pre_counts = max(X3rL42_cSNV_all_df$corr_pre)
X3rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X3rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X3rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X3rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X3rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X3rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_cSNV_all_corr_post_count = length(X3rL42_cSNV_all_df$corr_post)
X3rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X3rL42_cSNV_all_min_corr_post_counts = min(X3rL42_cSNV_all_df$corr_post)
X3rL42_cSNV_all_min_corr_post_counts
X3rL42_cSNV_all_max_corr_post_counts = max(X3rL42_cSNV_all_df$corr_post)
X3rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X3rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X3rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X3rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X3rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X3rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X3rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X3_p_hdr_snv = paste('p_hdr_',X3_cut_end,'_snv',sep='')
X3rL42_pSNV_all <- which(X3rL42[,X3_p_hdr_snv]=='True')
X3rL42_pSNV_all_df = X3rL42[X3rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_pSNV_all_lib_count = length(X3rL42_pSNV_all_df$lib)
X3rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X3rL42_pSNV_all_min_lib_counts = min(X3rL42_pSNV_all_df$lib)
X3rL42_pSNV_all_min_lib_counts
X3rL42_pSNV_all_max_lib_counts = max(X3rL42_pSNV_all_df$lib)
X3rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X3rL42_pSNV_all_pre_count = length(X3rL42_pSNV_all_df$pre)
X3rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X3rL42_pSNV_all_min_pre_counts = min(X3rL42_pSNV_all_df$pre)
X3rL42_pSNV_all_min_pre_counts
X3rL42_pSNV_all_max_pre_counts = max(X3rL42_pSNV_all_df$pre)
X3rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X3rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X3rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_pSNV_all_post_count = length(X3rL42_pSNV_all_df$post)
X3rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X3rL42_pSNV_all_min_post_counts = min(X3rL42_pSNV_all_df$post)
X3rL42_pSNV_all_min_post_counts
X3rL42_pSNV_all_max_post_counts = max(X3rL42_pSNV_all_df$post)
X3rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X3rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X3rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_prog_map_thresh5_lib_count = length(X3rL42_prog_map_thresh5_df$lib)
X3rL42_prog_map_thresh5_lib_count
X3rL42_prog_map_thresh5_min_lib_counts = min(X3rL42_prog_map_thresh5_df$lib)
X3rL42_prog_map_thresh5_min_lib_counts
X3rL42_prog_map_thresh5_max_lib_counts = max(X3rL42_prog_map_thresh5_df$lib)
X3rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X3rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X3rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_prog_map_thresh5_pre_count = length(X3rL42_prog_map_thresh5_df$pre)
X3rL42_prog_map_thresh5_pre_count
X3rL42_prog_map_thresh5_min_pre_counts = min(X3rL42_prog_map_thresh5_df$pre)
X3rL42_prog_map_thresh5_min_pre_counts
X3rL42_prog_map_thresh5_max_pre_counts = max(X3rL42_prog_map_thresh5_df$pre)
X3rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2x3 less than SGE region length x 3 due to PAM edits
X3rL42_prog_map_thresh5_post_count = length(X3rL42_prog_map_thresh5_df$post)
X3rL42_prog_map_thresh5_post_count
X3rL42_prog_map_thresh5_min_post_counts = min(X3rL42_prog_map_thresh5_df$post)
X3rL42_prog_map_thresh5_min_post_counts
X3rL42_prog_map_thresh5_max_post_counts = max(X3rL42_prog_map_thresh5_df$post)
X3rL42_prog_map_thresh5_max_post_counts
X3rL42_prog_map_thresh5_corr_post_count = length(X3rL42_prog_map_thresh5_df$corr_post)
X3rL42_prog_map_thresh5_corr_post_count
X3rL42_prog_map_thresh5_min_corr_post_counts = min(X3rL42_prog_map_thresh5_df$corr_post)
X3rL42_prog_map_thresh5_min_corr_post_counts
X3rL42_prog_map_thresh5_max_corr_post_counts = max(X3rL42_prog_map_thresh5_df$corr_post)
X3rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X3rL42_pSNV_thresh5 <- which(X3rL42[,X3_p_hdr_snv]=='True' & as.numeric(as.character(X3rL42[,'pre_freq']))>=0.00001)
X3rL42_pSNV_thresh5_df = X3rL42[X3rL42_pSNV_thresh5,]
X3rL42_pSNV_thresh5_lib_count = length(X3rL42_pSNV_thresh5_df$lib)
X3rL42_pSNV_thresh5_lib_count
X3rL42_pSNV_thresh5_min_lib_counts = min(X3rL42_pSNV_thresh5_df$lib)
X3rL42_pSNV_thresh5_min_lib_counts
X3rL42_pSNV_thresh5_max_lib_counts = max(X3rL42_pSNV_thresh5_df$lib)
X3rL42_pSNV_thresh5_max_lib_counts
X3rL42_pSNV_thresh5_pre_count = length(X3rL42_pSNV_thresh5_df$pre)
X3rL42_pSNV_thresh5_pre_count
X3rL42_pSNV_thresh5_min_pre_counts = min(X3rL42_pSNV_thresh5_df$pre)
X3rL42_pSNV_thresh5_min_pre_counts
X3rL42_pSNV_thresh5_max_pre_counts = max(X3rL42_pSNV_thresh5_df$pre)
X3rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X3rL42_pSNV_thresh5_post_count = length(X3rL42_pSNV_thresh5_df$post)
X3rL42_pSNV_thresh5_post_count
X3rL42_pSNV_thresh5_min_post_counts = min(X3rL42_pSNV_thresh5_df$post)
X3rL42_pSNV_thresh5_min_post_counts
X3rL42_pSNV_thresh5_max_post_counts = max(X3rL42_pSNV_thresh5_df$post)
X3rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X3rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X3rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X3rL41_prog_var_thresh5_df:
X3rL41_prog_var_thresh5_df_rL42_int <- X3rL41_prog_var_thresh5_df[which(X3rL41_prog_var_thresh5_df$variant %in% X3rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X3rL42_prog_var_thresh5_df:
X3rL42_prog_var_thresh5_df_rL41_int <- X3rL42_prog_var_thresh5_df[which(X3rL42_prog_var_thresh5_df$variant %in% X3rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X3rL41_prog_var_thresh5_df_rL42_int_ord <- X3rL41_prog_var_thresh5_df_rL42_int[order(X3rL41_prog_var_thresh5_df_rL42_int$variant),]
X3rL42_prog_var_thresh5_df_rL41_int_ord <- X3rL42_prog_var_thresh5_df_rL41_int[order(X3rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X3rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X3rL41rL42int_prog_var_thresh5_pre_count <- dim(X3rL41_prog_var_thresh5_df_rL42_int)[1] 
X3rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X3rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X3rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X3rL42_prog_var_thresh5_df_rL41_int_ord$lib
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X3rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X3rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X3rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X3rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X3rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X3rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X3rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X3rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X3rL41_cSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X3rL41_cSNV_missense_post_pre_med <- unname(X3rL41_cSNV_missense_post_pre_quarts[3])
X3rL41_cSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X3rL41_cSNV_syn_post_pre_med <- unname(X3rL41_cSNV_syn_post_pre_quarts[3])
X3rL41_cSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X3rL41_cSNV_nonsense_post_pre_med <- unname(X3rL41_cSNV_nonsense_post_pre_quarts[3])
X3rL41_cSNV_syn_to_non_post_pre_spread <- X3rL41_cSNV_syn_post_pre_med - X3rL41_cSNV_nonsense_post_pre_med

X3rL42_cSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X3rL42_cSNV_missense_post_pre_med <- unname(X3rL42_cSNV_missense_post_pre_quarts[3])
X3rL42_cSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X3rL42_cSNV_syn_post_pre_med <- unname(X3rL42_cSNV_syn_post_pre_quarts[3])
X3rL42_cSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X3rL42_cSNV_nonsense_post_pre_med <- unname(X3rL42_cSNV_nonsense_post_pre_quarts[3])
X3rL42_cSNV_syn_to_non_post_pre_spread <- X3rL42_cSNV_syn_post_pre_med - X3rL42_cSNV_nonsense_post_pre_med

X3rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_missense_post_pre_med <- unname(X3rL41rL42a_cSNV_missense_post_pre_quarts[3])
X3rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_syn_post_pre_med <- unname(X3rL41rL42a_cSNV_syn_post_pre_quarts[3])
X3rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X3rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X3rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X3rL41rL42a_cSNV_syn_post_pre_med - X3rL41rL42a_cSNV_nonsense_post_pre_med

X3rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_cSNV_missense_post_pre_med <- unname(X3rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X3rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_cSNV_syn_post_pre_med <- unname(X3rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X3rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X3rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X3rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X3rL41rL42pw_cSNV_syn_post_pre_med - X3rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X3rL41_tSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X3rL41_tSNV_missense_post_pre_med <- unname(X3rL41_tSNV_missense_post_pre_quarts[3])
X3rL41_tSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X3rL41_tSNV_syn_post_pre_med <- unname(X3rL41_tSNV_syn_post_pre_quarts[3])
X3rL41_tSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X3rL41_tSNV_nonsense_post_pre_med <- unname(X3rL41_tSNV_nonsense_post_pre_quarts[3])
X3rL41_tSNV_syn_to_non_post_pre_spread <- X3rL41_tSNV_syn_post_pre_med - X3rL41_tSNV_nonsense_post_pre_med

X3rL42_tSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X3rL42_tSNV_missense_post_pre_med <- unname(X3rL42_tSNV_missense_post_pre_quarts[3])
X3rL42_tSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X3rL42_tSNV_syn_post_pre_med <- unname(X3rL42_tSNV_syn_post_pre_quarts[3])
X3rL42_tSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X3rL42_tSNV_nonsense_post_pre_med <- unname(X3rL42_tSNV_nonsense_post_pre_quarts[3])
X3rL42_tSNV_syn_to_non_post_pre_spread <- X3rL42_tSNV_syn_post_pre_med - X3rL42_tSNV_nonsense_post_pre_med

X3rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_missense_post_pre_med <- unname(X3rL41rL42a_tSNV_missense_post_pre_quarts[3])
X3rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_syn_post_pre_med <- unname(X3rL41rL42a_tSNV_syn_post_pre_quarts[3])
X3rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X3rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X3rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X3rL41rL42a_tSNV_syn_post_pre_med - X3rL41rL42a_tSNV_nonsense_post_pre_med

X3rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_tSNV_missense_post_pre_med <- unname(X3rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X3rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_tSNV_syn_post_pre_med <- unname(X3rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X3rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X3rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X3rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X3rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X3rL41rL42pw_tSNV_syn_post_pre_med - X3rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X3rL41_cSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X3rL41_cSNV_missense_post_lib_med <- unname(X3rL41_cSNV_missense_post_lib_quarts[3])
X3rL41_cSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X3rL41_cSNV_syn_post_lib_med <- unname(X3rL41_cSNV_syn_post_lib_quarts[3])
X3rL41_cSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X3rL41_cSNV_nonsense_post_lib_med <- unname(X3rL41_cSNV_nonsense_post_lib_quarts[3])
X3rL41_cSNV_syn_to_non_post_lib_spread <- X3rL41_cSNV_syn_post_lib_med - X3rL41_cSNV_nonsense_post_lib_med

X3rL42_cSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X3rL42_cSNV_missense_post_lib_med <- unname(X3rL42_cSNV_missense_post_lib_quarts[3])
X3rL42_cSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X3rL42_cSNV_syn_post_lib_med <- unname(X3rL42_cSNV_syn_post_lib_quarts[3])
X3rL42_cSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X3rL42_cSNV_nonsense_post_lib_med <- unname(X3rL42_cSNV_nonsense_post_lib_quarts[3])
X3rL42_cSNV_syn_to_non_post_lib_spread <- X3rL42_cSNV_syn_post_lib_med - X3rL42_cSNV_nonsense_post_lib_med

X3rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_missense_post_lib_med <- unname(X3rL41rL42a_cSNV_missense_post_lib_quarts[3])
X3rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_syn_post_lib_med <- unname(X3rL41rL42a_cSNV_syn_post_lib_quarts[3])
X3rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X3rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X3rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X3rL41rL42a_cSNV_syn_post_lib_med - X3rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X3rL41_tSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X3rL41_tSNV_missense_post_lib_med <- unname(X3rL41_tSNV_missense_post_lib_quarts[3])
X3rL41_tSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X3rL41_tSNV_syn_post_lib_med <- unname(X3rL41_tSNV_syn_post_lib_quarts[3])
X3rL41_tSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X3rL41_tSNV_nonsense_post_lib_med <- unname(X3rL41_tSNV_nonsense_post_lib_quarts[3])
X3rL41_tSNV_syn_to_non_post_lib_spread <- X3rL41_tSNV_syn_post_lib_med - X3rL41_tSNV_nonsense_post_lib_med

X3rL42_tSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X3rL42_tSNV_missense_post_lib_med <- unname(X3rL42_tSNV_missense_post_lib_quarts[3])
X3rL42_tSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X3rL42_tSNV_syn_post_lib_med <- unname(X3rL42_tSNV_syn_post_lib_quarts[3])
X3rL42_tSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X3rL42_tSNV_nonsense_post_lib_med <- unname(X3rL42_tSNV_nonsense_post_lib_quarts[3])
X3rL42_tSNV_syn_to_non_post_lib_spread <- X3rL42_tSNV_syn_post_lib_med - X3rL42_tSNV_nonsense_post_lib_med

X3rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_missense_post_lib_med <- unname(X3rL41rL42a_tSNV_missense_post_lib_quarts[3])
X3rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_syn_post_lib_med <- unname(X3rL41rL42a_tSNV_syn_post_lib_quarts[3])
X3rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X3rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X3rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X3rL41rL42a_tSNV_syn_post_lib_med - X3rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X3rL41_cSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X3rL41_cSNV_missense_pre_lib_med <- unname(X3rL41_cSNV_missense_pre_lib_quarts[3])
X3rL41_cSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X3rL41_cSNV_syn_pre_lib_med <- unname(X3rL41_cSNV_syn_pre_lib_quarts[3])
X3rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X3rL41_cSNV_nonsense_pre_lib_med <- unname(X3rL41_cSNV_nonsense_pre_lib_quarts[3])
X3rL41_cSNV_syn_to_non_pre_lib_spread <- X3rL41_cSNV_syn_pre_lib_med - X3rL41_cSNV_nonsense_pre_lib_med

X3rL42_cSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X3rL42_cSNV_missense_pre_lib_med <- unname(X3rL42_cSNV_missense_pre_lib_quarts[3])
X3rL42_cSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X3rL42_cSNV_syn_pre_lib_med <- unname(X3rL42_cSNV_syn_pre_lib_quarts[3])
X3rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X3rL42_cSNV_nonsense_pre_lib_med <- unname(X3rL42_cSNV_nonsense_pre_lib_quarts[3])
X3rL42_cSNV_syn_to_non_pre_lib_spread <- X3rL42_cSNV_syn_pre_lib_med - X3rL42_cSNV_nonsense_pre_lib_med

X3rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_missense_pre_lib_med <- unname(X3rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X3rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_syn_pre_lib_med <- unname(X3rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X3rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X3rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X3rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X3rL41rL42a_cSNV_syn_pre_lib_med - X3rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X3rL41_tSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X3rL41_tSNV_missense_pre_lib_med <- unname(X3rL41_tSNV_missense_pre_lib_quarts[3])
X3rL41_tSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X3rL41_tSNV_syn_pre_lib_med <- unname(X3rL41_tSNV_syn_pre_lib_quarts[3])
X3rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X3rL41_tSNV_nonsense_pre_lib_med <- unname(X3rL41_tSNV_nonsense_pre_lib_quarts[3])
X3rL41_tSNV_syn_to_non_pre_lib_spread <- X3rL41_tSNV_syn_pre_lib_med - X3rL41_tSNV_nonsense_pre_lib_med

X3rL42_tSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X3rL42_tSNV_missense_pre_lib_med <- unname(X3rL42_tSNV_missense_pre_lib_quarts[3])
X3rL42_tSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X3rL42_tSNV_syn_pre_lib_med <- unname(X3rL42_tSNV_syn_pre_lib_quarts[3])
X3rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X3rL42_tSNV_nonsense_pre_lib_med <- unname(X3rL42_tSNV_nonsense_pre_lib_quarts[3])
X3rL42_tSNV_syn_to_non_pre_lib_spread <- X3rL42_tSNV_syn_pre_lib_med - X3rL42_tSNV_nonsense_pre_lib_med

X3rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_missense_pre_lib_med <- unname(X3rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X3rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_syn_pre_lib_med <- unname(X3rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X3rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X3rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X3rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X3rL41rL42a_tSNV_syn_pre_lib_med - X3rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X3rL41_tSNV_syn_rna_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X3rL41_tSNV_syn_rna_pre_med <- unname(X3rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X3rL41_tSNV_syn_rna_post_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X3rL41_tSNV_syn_rna_post_med <- unname(X3rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X3rL42_tSNV_syn_rna_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X3rL42_tSNV_syn_rna_pre_med <- unname(X3rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X3rL42_tSNV_syn_rna_post_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X3rL42_tSNV_syn_rna_post_med <- unname(X3rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X3rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_syn_rna_pre_med <- unname(X3rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X3rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X3rL41rL42a_tSNV_syn_rna_post_med <- unname(X3rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X3rL41_cSNV_syn_pre_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X3rL41_cSNV_syn_post_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X3rL41_cSNV_syn_post_lib_med
# tHDR
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X3rL41_tSNV_syn_pre_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X3rL41_tSNV_syn_post_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X3rL41_tSNV_syn_post_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X3rL41_tSNV_syn_rna_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X3rL41_tSNV_syn_rna_post_med

#rL42
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X3rL42_cSNV_syn_pre_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X3rL42_cSNV_syn_post_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X3rL42_cSNV_syn_post_lib_med
# tHDR
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X3rL42_tSNV_syn_pre_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X3rL42_tSNV_syn_post_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X3rL42_tSNV_syn_post_lib_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X3rL42_tSNV_syn_rna_pre_med
X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X3rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X3rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X3rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X3rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X3rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X3rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X3rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X3rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X3rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X3rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X3rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X3rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X3rL41_prog_var_thresh5_df_rL42_int_ord[which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X3rL41_prog_var_thresh5_df_rL42_int_ord
X3rL41_prog_map_thresh5_df_rL42_int_ord = which(X3rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X3rL41_prog_map_thresh5_df_rL42_int_ord_df = X3rL41_prog_var_thresh5_df_rL42_int_ord[X3rL41_prog_map_thresh5_df_rL42_int_ord,]
X3rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X3rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X3rL41_prog_map_thresh5_df_rL42_int_ord_df[X3rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X3rL41_prog_map_thresh5_df_rL42_int_ord_df[X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X3rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X3rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X3rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X3rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X3rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X3rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X3rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X3rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X3rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X3rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X3rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X3rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X3rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X3rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X3rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X3rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X3rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X3rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X3rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X3rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X3rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X3rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X3rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41_cSNV_post_pre_by_cadd_cor_s
#X3rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X3rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL42_cSNV_post_pre_by_cadd_cor_s

#X3rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X3rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41_cSNV_post_lib_by_cadd_cor_s
#X3rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X3rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X3rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X3rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41_tSNV_post_pre_by_cadd_cor_s
#X3rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X3rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL42_tSNV_post_pre_by_cadd_cor_s

#X3rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X3rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41_tSNV_post_lib_by_cadd_cor_s
#X3rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X3rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X3rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X3rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X3rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X3rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X3rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X3rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X3rL41_prog_var_all_lib_count
X3rL41_prog_var_all_pre_count
X3rL42_prog_var_all_pre_count
X3rL41_prog_map_thresh5_lib_count
X3rL41_prog_map_thresh5_pre_count
X3rL42_prog_map_thresh5_pre_count
X3rL41_prog_map_thresh5_post_count
X3rL42_prog_map_thresh5_post_count
X3rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X3rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X3rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X3rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X3rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X3rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X3rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X3rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X3rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X3rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X3rL41_cSNV_post_pre_by_cadd_cor_s
X3rL42_cSNV_post_pre_by_cadd_cor_s
X3rL41_cSNV_post_lib_by_cadd_cor_s
X3rL42_cSNV_post_lib_by_cadd_cor_s
X3rL41_tSNV_post_pre_by_cadd_cor_s
X3rL42_tSNV_post_pre_by_cadd_cor_s
X3rL41_tSNV_post_lib_by_cadd_cor_s
X3rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X3rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X3rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X3rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X3rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X3rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X3rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X3rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X3rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X3rL41_cSNV_syn_to_non_post_pre_spread
X3rL42_cSNV_syn_to_non_post_pre_spread
X3rL41rL42a_cSNV_syn_to_non_post_pre_spread
X3rL41_cSNV_syn_to_non_post_lib_spread
X3rL42_cSNV_syn_to_non_post_lib_spread
X3rL41rL42a_cSNV_syn_to_non_post_lib_spread
X3rL41_tSNV_syn_to_non_post_pre_spread
X3rL42_tSNV_syn_to_non_post_pre_spread
X3rL41rL42a_tSNV_syn_to_non_post_pre_spread
X3rL41_tSNV_syn_to_non_post_lib_spread
X3rL42_tSNV_syn_to_non_post_lib_spread
X3rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X3rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X3rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X3rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X3rL41_cSNV_pre_lib_cors = cor(log2(X3rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3rL41_tSNV_pre_lib_cors = cor(log2(X3rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3rL41_cSNV_post_lib_cors = cor(log2(X3rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X3rL41_tSNV_post_lib_cors = cor(log2(X3rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X3rL41_cSNV_post_pre_cors = cor(log2(X3rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3rL41_tSNV_post_pre_cors = cor(log2(X3rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X3rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3rL41_cSNV_rna_lib_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X3rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3rL41_tSNV_rna_lib_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X3rL41_cSNV_rna_pre_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X3rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3rL41_tSNV_rna_pre_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X3rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3rL41rL42_cSNV_pre_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X3rL41rL42_tSNV_pre_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X3rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X3rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X3rL41rL42_cSNV_post_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X3rL41rL42_tSNV_post_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X3rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X3rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X3rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X3rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X3rL41rL42_cSNV_rna_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X3rL41rL42_tSNV_rna_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X3rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X3rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X3rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X3rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X3rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X3rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X3rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X3rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X3rL41_cors <- c("X3rL41",X3rL41_cSNV_pre_lib_cors,X3rL41_tSNV_pre_lib_cors,X3rL41_cSNV_post_lib_cors,X3rL41_tSNV_post_lib_cors,X3rL41_cSNV_post_pre_cors,X3rL41_tSNV_post_pre_cors,X3rL41_cSNV_rna_lib_cors,X3rL41_tSNV_rna_lib_cors,X3rL41_cSNV_rna_pre_cors,X3rL41_tSNV_rna_pre_cors,X3rL41rL42_cSNV_pre_cors,X3rL41rL42_tSNV_pre_cors,X3rL41rL42_cSNV_pre_lib_ratio_cors,X3rL41rL42_tSNV_pre_lib_ratio_cors,X3rL41rL42_cSNV_post_cors,X3rL41rL42_tSNV_post_cors,X3rL41rL42_cSNV_post_lib_ratio_cors,X3rL41rL42_tSNV_post_lib_ratio_cors,X3rL41rL42_cSNV_post_pre_ratio_cors,X3rL41rL42_tSNV_post_pre_ratio_cors,X3rL41rL42_cSNV_rna_cors,X3rL41rL42_tSNV_rna_cors,X3rL41rL42_tSNV_rna_pre_ratio_cors,X3rL41_cSNV_pre_lib_ratio_cadd_cors,X3rL41_tSNV_pre_lib_ratio_cadd_cors,X3rL41_cSNV_post_lib_ratio_cadd_cors,X3rL41_tSNV_post_lib_ratio_cadd_cors,X3rL41_cSNV_post_pre_ratio_cadd_cors,X3rL41_tSNV_post_pre_ratio_cadd_cors,X3rL41_cSNV_post_pre_ratio_cadd_missense_cors,X3rL41_tSNV_post_pre_ratio_cadd_missense_cors,X3rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X3rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X3rL41_cSNV_post_pre_ratio_grantham_missense_cors,X3rL41_tSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X3rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X3rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X3rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X3rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X3rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X3rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X3rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X3rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X3rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X3rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X3rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X3rL42_cSNV_pre_lib_cors = cor(log2(X3rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3rL42_tSNV_pre_lib_cors = cor(log2(X3rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3rL42_cSNV_post_lib_cors = cor(log2(X3rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X3rL42_tSNV_post_lib_cors = cor(log2(X3rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X3rL42_cSNV_post_pre_cors = cor(log2(X3rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X3rL42_tSNV_post_pre_cors = cor(log2(X3rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X3rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X3rL42_cSNV_rna_lib_cors = cor(log2(X3rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X3rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3rL42_tSNV_rna_lib_cors = cor(log2(X3rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X3rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X3rL42_cSNV_rna_pre_cors = cor(log2(X3rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X3rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X3rL42_tSNV_rna_pre_cors = cor(log2(X3rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X3rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X3rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X3rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X3rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X3rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X3rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X3rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X3rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X3rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X3rL42_cors <- c("X3rL42",X3rL42_cSNV_pre_lib_cors,X3rL42_tSNV_pre_lib_cors,X3rL42_cSNV_post_lib_cors,X3rL42_tSNV_post_lib_cors,X3rL42_cSNV_post_pre_cors,X3rL42_tSNV_post_pre_cors,X3rL42_cSNV_rna_lib_cors,X3rL42_tSNV_rna_lib_cors,X3rL42_cSNV_rna_pre_cors,X3rL42_tSNV_rna_pre_cors,X3rL41rL42_cSNV_pre_cors,X3rL41rL42_tSNV_pre_cors,X3rL41rL42_cSNV_pre_lib_ratio_cors,X3rL41rL42_tSNV_pre_lib_ratio_cors,X3rL41rL42_cSNV_post_cors,X3rL41rL42_tSNV_post_cors,X3rL41rL42_cSNV_post_lib_ratio_cors,X3rL41rL42_tSNV_post_lib_ratio_cors,X3rL41rL42_cSNV_post_pre_ratio_cors,X3rL41rL42_tSNV_post_pre_ratio_cors,X3rL41rL42_cSNV_rna_cors,X3rL41rL42_tSNV_rna_cors,X3rL41rL42_tSNV_rna_pre_ratio_cors,X3rL42_cSNV_pre_lib_ratio_cadd_cors,X3rL42_tSNV_pre_lib_ratio_cadd_cors,X3rL42_cSNV_post_lib_ratio_cadd_cors,X3rL42_tSNV_post_lib_ratio_cadd_cors,X3rL42_cSNV_post_pre_ratio_cadd_cors,X3rL42_tSNV_post_pre_ratio_cadd_cors,X3rL42_cSNV_post_pre_ratio_cadd_missense_cors,X3rL42_tSNV_post_pre_ratio_cadd_missense_cors,X3rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X3rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X3rL42_cSNV_post_pre_ratio_grantham_missense_cors,X3rL42_tSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X3rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X3rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X3rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X3rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X3rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X3rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X3rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X3rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X3rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X3rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X3rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X3rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X3rL41)
rm(X3rL42)
gc()

X4rL41_file <- paste(experiment_dir_170731,'X4rL41','_annotated.txt',sep='')
X4rL42_file <- paste(experiment_dir_170731,'X4rL42','_annotated.txt',sep='')
X4rL41 <- read.table(X4rL41_file, header=TRUE, sep="\t")
X4rL42 <- read.table(X4rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X4 <- editing_info[which(editing_info$amplicon == 'X4'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X4_HDR_5_SNV = as.character(editing_info_X4$HDR_5_SNV)
X4_HDR_3_SNV = as.character(editing_info_X4$HDR_3_SNV)
#X4_cut_pos = as.character(editing_info_X4$cut_pos)
X4_cut_end = as.character(editing_info_X4$cut_end)
X4_mut_start = as.character(editing_info_X4$mut_start)
X4_mut_end = as.character(editing_info_X4$mut_end)
### Replicate 1
X4rL41_cSNV_all <- which(X4rL41[,'c_hdr_snv']=='True')
X4rL41_cSNV_all_df = X4rL41[X4rL41_cSNV_all,]
X4rL41_prog_var_all <- which(X4rL41[,'all_hdr_variant']=='True' & X4rL41[,'edit_string']!='-WT')
X4rL41_prog_var_all_df = X4rL41[X4rL41_prog_var_all,]
X4rL41_prog_map_all = which(X4rL41_prog_var_all_df[,'pos']!='REF')
X4rL41_prog_map_all_df = X4rL41_prog_var_all_df[X4rL41_prog_map_all,]
X4rL41_prog_map_exon_all = which(X4rL41_prog_map_all_df[,'cDNApos']!='REF' & X4rL41_prog_map_all_df[,'cDNApos']!='NA')
X4rL41_prog_map_exon_all_df = X4rL41_prog_map_all_df[X4rL41_prog_map_exon_all,]
X4rL41_prog_map_CADD = which(X4rL41_prog_map_all_df[,'CADD.phred']!='NA')
X4rL41_prog_map_CADD_df = X4rL41_prog_map_all_df[X4rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X4rL41_prog_var_thresh5 <- which(as.numeric(as.character(X4rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X4rL41_prog_var_thresh5_df = X4rL41_prog_var_all_df[X4rL41_prog_var_thresh5,]
X4rL41_prog_map_thresh5 <- which(as.numeric(as.character(X4rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X4rL41_prog_map_thresh5_df = X4rL41_prog_map_all_df[X4rL41_prog_map_thresh5,]
X4rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X4rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X4rL41_prog_map_exon_thresh5_df = X4rL41_prog_map_exon_all_df[X4rL41_prog_map_exon_thresh5,]
X4rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X4rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X4rL41_prog_map_CADD_thresh5_df = X4rL41_prog_map_CADD_df[X4rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X4rL41_prog_var_all_lib_count = length(X4rL41_prog_var_all_df$lib)
X4rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X4rL41_prog_var_all_min_lib_counts = min(X4rL41_prog_var_all_df$lib)
X4rL41_prog_var_all_min_lib_counts
X4rL41_prog_var_all_max_lib_counts = max(X4rL41_prog_var_all_df$lib)
X4rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X4rL41_prog_map_all_lib_count = length(X4rL41_prog_map_all_df$lib)
X4rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X4rL41_prog_map_all_min_lib_counts = min(X4rL41_prog_map_all_df$lib)
X4rL41_prog_map_all_min_lib_counts
X4rL41_prog_map_all_max_lib_counts = max(X4rL41_prog_map_all_df$lib)
X4rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X4rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X4rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X4rL41_prog_var_all_pre_count = length(X4rL41_prog_var_all_df$pre)
X4rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X4rL41_prog_var_all_min_pre_counts = min(X4rL41_prog_var_all_df$pre)
X4rL41_prog_var_all_min_pre_counts
X4rL41_prog_var_all_max_pre_counts = max(X4rL41_prog_var_all_df$pre)
X4rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X4rL41_prog_map_all_pre_count = length(X4rL41_prog_map_all_df$pre)
X4rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X4rL41_prog_map_all_min_pre_counts = min(X4rL41_prog_map_all_df$pre)
X4rL41_prog_map_all_min_pre_counts
X4rL41_prog_map_all_max_pre_counts = max(X4rL41_prog_map_all_df$pre)
X4rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X4rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X4rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X4rL41_prog_map_all_post_count = length(X4rL41_prog_map_all_df$post)
X4rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X4rL41_prog_map_all_min_post_counts = min(X4rL41_prog_map_all_df$post)
X4rL41_prog_map_all_min_post_counts
X4rL41_prog_map_all_max_post_counts = max(X4rL41_prog_map_all_df$post)
X4rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X4rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X4rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X4rL41_prog_map_all_syn_df <- X4rL41_prog_map_all_df[which(X4rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X4rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X4rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X4rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X4rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X4rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X4rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X4rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X4rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X4rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X4rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X4rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X4rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X4rL41_prog_map_all_min_rna_counts = min(X4rL41_prog_map_exon_all_df$tHDR_rna)
X4rL41_prog_map_all_min_rna_counts
X4rL41_prog_map_all_max_rna_counts = max(X4rL41_prog_map_exon_all_df$tHDR_rna)
X4rL41_prog_map_all_max_rna_counts
X4rL41_prog_map_all_min_rna_pseudo_freq = min(X4rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4rL41_prog_map_all_min_rna_pseudo_freq
X4rL41_prog_map_all_max_rna_pseudo_freq = max(X4rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4rL41_prog_map_all_max_rna_pseudo_freq
X4rL41_prog_map_all_min_rna_pre_ratio = min(X4rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4rL41_prog_map_all_min_rna_pre_ratio
X4rL41_prog_map_all_max_rna_pre_ratio = max(X4rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4rL41_prog_map_all_max_rna_pre_ratio
X4rL41_prog_map_all_min_rna_post_ratio = min(X4rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4rL41_prog_map_all_min_rna_post_ratio
X4rL41_prog_map_all_max_rna_post_ratio = max(X4rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X4rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X4rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X4rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X4rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X4rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X4rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X4rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X4rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X4rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X4rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X4rL41_prog_map_all_df$post_pre_ratio),log2(X4rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X4rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X4rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X4rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X4rL41_cSNV_all_corr_pre_count = length(X4rL41_cSNV_all_df$corr_pre)
X4rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X4rL41_cSNV_all_min_corr_pre_counts = min(X4rL41_cSNV_all_df$corr_pre)
X4rL41_cSNV_all_min_corr_pre_counts
X4rL41_cSNV_all_max_corr_pre_counts = max(X4rL41_cSNV_all_df$corr_pre)
X4rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X4rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X4rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X4rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X4rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X4rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_cSNV_all_corr_post_count = length(X4rL41_cSNV_all_df$corr_post)
X4rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X4rL41_cSNV_all_min_corr_post_counts = min(X4rL41_cSNV_all_df$corr_post)
X4rL41_cSNV_all_min_corr_post_counts
X4rL41_cSNV_all_max_corr_post_counts = max(X4rL41_cSNV_all_df$corr_post)
X4rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X4rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X4rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X4rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X4rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X4rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X4rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X4_p_hdr_snv = paste('p_hdr_',X4_cut_end,'_snv',sep='')
X4rL41_pSNV_all <- which(X4rL41[,X4_p_hdr_snv]=='True')
X4rL41_pSNV_all_df = X4rL41[X4rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_pSNV_all_lib_count = length(X4rL41_pSNV_all_df$lib)
X4rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X4rL41_pSNV_all_min_lib_counts = min(X4rL41_pSNV_all_df$lib)
X4rL41_pSNV_all_min_lib_counts
X4rL41_pSNV_all_max_lib_counts = max(X4rL41_pSNV_all_df$lib)
X4rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X4rL41_pSNV_all_pre_count = length(X4rL41_pSNV_all_df$pre)
X4rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X4rL41_pSNV_all_min_pre_counts = min(X4rL41_pSNV_all_df$pre)
X4rL41_pSNV_all_min_pre_counts
X4rL41_pSNV_all_max_pre_counts = max(X4rL41_pSNV_all_df$pre)
X4rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X4rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X4rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_pSNV_all_post_count = length(X4rL41_pSNV_all_df$post)
X4rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X4rL41_pSNV_all_min_post_counts = min(X4rL41_pSNV_all_df$post)
X4rL41_pSNV_all_min_post_counts
X4rL41_pSNV_all_max_post_counts = max(X4rL41_pSNV_all_df$post)
X4rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X4rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X4rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_prog_map_thresh5_lib_count = length(X4rL41_prog_map_thresh5_df$lib)
X4rL41_prog_map_thresh5_lib_count
X4rL41_prog_map_thresh5_min_lib_counts = min(X4rL41_prog_map_thresh5_df$lib)
X4rL41_prog_map_thresh5_min_lib_counts
X4rL41_prog_map_thresh5_max_lib_counts = max(X4rL41_prog_map_thresh5_df$lib)
X4rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X4rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X4rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_prog_map_thresh5_pre_count = length(X4rL41_prog_map_thresh5_df$pre)
X4rL41_prog_map_thresh5_pre_count
X4rL41_prog_map_thresh5_min_pre_counts = min(X4rL41_prog_map_thresh5_df$pre)
X4rL41_prog_map_thresh5_min_pre_counts
X4rL41_prog_map_thresh5_max_pre_counts = max(X4rL41_prog_map_thresh5_df$pre)
X4rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL41_prog_map_thresh5_post_count = length(X4rL41_prog_map_thresh5_df$post)
X4rL41_prog_map_thresh5_post_count
X4rL41_prog_map_thresh5_min_post_counts = min(X4rL41_prog_map_thresh5_df$post)
X4rL41_prog_map_thresh5_min_post_counts
X4rL41_prog_map_thresh5_max_post_counts = max(X4rL41_prog_map_thresh5_df$post)
X4rL41_prog_map_thresh5_max_post_counts
X4rL41_prog_map_thresh5_corr_post_count = length(X4rL41_cSNV_all_df$corr_post)
X4rL41_prog_map_thresh5_corr_post_count
X4rL41_prog_map_thresh5_min_corr_post_counts = min(X4rL41_cSNV_all_df$corr_post)
X4rL41_prog_map_thresh5_min_corr_post_counts
X4rL41_prog_map_thresh5_max_corr_post_counts = max(X4rL41_cSNV_all_df$corr_post)
X4rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X4rL41_pSNV_thresh5 <- which(X4rL41[,X4_p_hdr_snv]=='True' & as.numeric(as.character(X4rL41[,'pre_freq']))>=0.00001)
X4rL41_pSNV_thresh5_df = X4rL41[X4rL41_pSNV_thresh5,]
X4rL41_pSNV_thresh5_lib_count = length(X4rL41_pSNV_thresh5_df$lib)
X4rL41_pSNV_thresh5_lib_count
X4rL41_pSNV_thresh5_min_lib_counts = min(X4rL41_pSNV_thresh5_df$lib)
X4rL41_pSNV_thresh5_min_lib_counts
X4rL41_pSNV_thresh5_max_lib_counts = max(X4rL41_pSNV_thresh5_df$lib)
X4rL41_pSNV_thresh5_max_lib_counts
X4rL41_pSNV_thresh5_pre_count = length(X4rL41_pSNV_thresh5_df$pre)
X4rL41_pSNV_thresh5_pre_count
X4rL41_pSNV_thresh5_min_pre_counts = min(X4rL41_pSNV_thresh5_df$pre)
X4rL41_pSNV_thresh5_min_pre_counts
X4rL41_pSNV_thresh5_max_pre_counts = max(X4rL41_pSNV_thresh5_df$pre)
X4rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X4rL41_pSNV_thresh5_post_count = length(X4rL41_pSNV_thresh5_df$post)
X4rL41_pSNV_thresh5_post_count
X4rL41_pSNV_thresh5_min_post_counts = min(X4rL41_pSNV_thresh5_df$post)
X4rL41_pSNV_thresh5_min_post_counts
X4rL41_pSNV_thresh5_max_post_counts = max(X4rL41_pSNV_thresh5_df$post)
X4rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X4rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X4rL41_pSNV_thresh5_post_pos

### Replicate 2
X4rL42_cSNV_all <- which(X4rL42[,'c_hdr_snv']=='True')
X4rL42_cSNV_all_df = X4rL42[X4rL42_cSNV_all,]
X4rL42_prog_var_all <- which(X4rL42[,'all_hdr_variant']=='True' & X4rL42[,'edit_string']!='-WT')
X4rL42_prog_var_all_df = X4rL42[X4rL42_prog_var_all,]
X4rL42_prog_map_all = which(X4rL42_prog_var_all_df[,'pos']!='REF')
X4rL42_prog_map_all_df = X4rL42_prog_var_all_df[X4rL42_prog_map_all,]
X4rL42_prog_map_exon_all = which(X4rL42_prog_map_all_df[,'cDNApos']!='REF' & X4rL42_prog_map_all_df[,'cDNApos']!='NA')
X4rL42_prog_map_exon_all_df = X4rL42_prog_map_all_df[X4rL42_prog_map_exon_all,]
X4rL42_prog_map_CADD = which(X4rL42_prog_map_all_df[,'CADD.phred']!='NA')
X4rL42_prog_map_CADD_df = X4rL42_prog_map_all_df[X4rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X4rL42_prog_var_thresh5 <- which(as.numeric(as.character(X4rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X4rL42_prog_var_thresh5_df = X4rL42_prog_var_all_df[X4rL42_prog_var_thresh5,]
X4rL42_prog_map_thresh5 <- which(as.numeric(as.character(X4rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X4rL42_prog_map_thresh5_df = X4rL42_prog_map_all_df[X4rL42_prog_map_thresh5,]
X4rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X4rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X4rL42_prog_map_exon_thresh5_df = X4rL42_prog_map_exon_all_df[X4rL42_prog_map_exon_thresh5,]
X4rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X4rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X4rL42_prog_map_CADD_thresh5_df = X4rL42_prog_map_CADD_df[X4rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X4rL42_prog_var_all_lib_count = length(X4rL42_prog_var_all_df$lib)
X4rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X4rL42_prog_var_all_min_lib_counts = min(X4rL42_prog_var_all_df$lib)
X4rL42_prog_var_all_min_lib_counts
X4rL42_prog_var_all_max_lib_counts = max(X4rL42_prog_var_all_df$lib)
X4rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X4rL42_prog_map_all_lib_count = length(X4rL42_prog_map_all_df$lib)
X4rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X4rL42_prog_map_all_min_lib_counts = min(X4rL42_prog_map_all_df$lib)
X4rL42_prog_map_all_min_lib_counts
X4rL42_prog_map_all_max_lib_counts = max(X4rL42_prog_map_all_df$lib)
X4rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X4rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X4rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X4rL42_prog_var_all_pre_count = length(X4rL42_prog_var_all_df$pre)
X4rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X4rL42_prog_var_all_min_pre_counts = min(X4rL42_prog_var_all_df$pre)
X4rL42_prog_var_all_min_pre_counts
X4rL42_prog_var_all_max_pre_counts = max(X4rL42_prog_var_all_df$pre)
X4rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X4rL42_prog_map_all_pre_count = length(X4rL42_prog_map_all_df$pre)
X4rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X4rL42_prog_map_all_min_pre_counts = min(X4rL42_prog_map_all_df$pre)
X4rL42_prog_map_all_min_pre_counts
X4rL42_prog_map_all_max_pre_counts = max(X4rL42_prog_map_all_df$pre)
X4rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X4rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X4rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X4rL42_prog_map_all_post_count = length(X4rL42_prog_map_all_df$post)
X4rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X4rL42_prog_map_all_min_post_counts = min(X4rL42_prog_map_all_df$post)
X4rL42_prog_map_all_min_post_counts
X4rL42_prog_map_all_max_post_counts = max(X4rL42_prog_map_all_df$post)
X4rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X4rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X4rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X4rL42_prog_map_all_syn_df <- X4rL42_prog_map_all_df[which(X4rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X4rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X4rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X4rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X4rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X4rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X4rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X4rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X4rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X4rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X4rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X4rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X4rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X4rL42_prog_map_all_min_rna_counts = min(X4rL42_prog_map_exon_all_df$tHDR_rna)
X4rL42_prog_map_all_min_rna_counts
X4rL42_prog_map_all_max_rna_counts = max(X4rL42_prog_map_exon_all_df$tHDR_rna)
X4rL42_prog_map_all_max_rna_counts
X4rL42_prog_map_all_min_rna_pseudo_freq = min(X4rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4rL42_prog_map_all_min_rna_pseudo_freq
X4rL42_prog_map_all_max_rna_pseudo_freq = max(X4rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X4rL42_prog_map_all_max_rna_pseudo_freq
X4rL42_prog_map_all_min_rna_pre_ratio = min(X4rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4rL42_prog_map_all_min_rna_pre_ratio
X4rL42_prog_map_all_max_rna_pre_ratio = max(X4rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X4rL42_prog_map_all_max_rna_pre_ratio
X4rL42_prog_map_all_min_rna_post_ratio = min(X4rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4rL42_prog_map_all_min_rna_post_ratio
X4rL42_prog_map_all_max_rna_post_ratio = max(X4rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X4rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X4rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X4rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X4rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X4rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X4rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X4rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X4rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X4rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X4rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X4rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X4rL42_prog_map_all_df$post_pre_ratio),log2(X4rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X4rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X4rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X4rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X4rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X4rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X4rL42_cSNV_all_corr_pre_count = length(X4rL42_cSNV_all_df$corr_pre)
X4rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X4rL42_cSNV_all_min_corr_pre_counts = min(X4rL42_cSNV_all_df$corr_pre)
X4rL42_cSNV_all_min_corr_pre_counts
X4rL42_cSNV_all_max_corr_pre_counts = max(X4rL42_cSNV_all_df$corr_pre)
X4rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X4rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X4rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X4rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X4rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X4rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_cSNV_all_corr_post_count = length(X4rL42_cSNV_all_df$corr_post)
X4rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X4rL42_cSNV_all_min_corr_post_counts = min(X4rL42_cSNV_all_df$corr_post)
X4rL42_cSNV_all_min_corr_post_counts
X4rL42_cSNV_all_max_corr_post_counts = max(X4rL42_cSNV_all_df$corr_post)
X4rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X4rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X4rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X4rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X4rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X4rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X4rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X4_p_hdr_snv = paste('p_hdr_',X4_cut_end,'_snv',sep='')
X4rL42_pSNV_all <- which(X4rL42[,X4_p_hdr_snv]=='True')
X4rL42_pSNV_all_df = X4rL42[X4rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_pSNV_all_lib_count = length(X4rL42_pSNV_all_df$lib)
X4rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X4rL42_pSNV_all_min_lib_counts = min(X4rL42_pSNV_all_df$lib)
X4rL42_pSNV_all_min_lib_counts
X4rL42_pSNV_all_max_lib_counts = max(X4rL42_pSNV_all_df$lib)
X4rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X4rL42_pSNV_all_pre_count = length(X4rL42_pSNV_all_df$pre)
X4rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X4rL42_pSNV_all_min_pre_counts = min(X4rL42_pSNV_all_df$pre)
X4rL42_pSNV_all_min_pre_counts
X4rL42_pSNV_all_max_pre_counts = max(X4rL42_pSNV_all_df$pre)
X4rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X4rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X4rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_pSNV_all_post_count = length(X4rL42_pSNV_all_df$post)
X4rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X4rL42_pSNV_all_min_post_counts = min(X4rL42_pSNV_all_df$post)
X4rL42_pSNV_all_min_post_counts
X4rL42_pSNV_all_max_post_counts = max(X4rL42_pSNV_all_df$post)
X4rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X4rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X4rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_prog_map_thresh5_lib_count = length(X4rL42_prog_map_thresh5_df$lib)
X4rL42_prog_map_thresh5_lib_count
X4rL42_prog_map_thresh5_min_lib_counts = min(X4rL42_prog_map_thresh5_df$lib)
X4rL42_prog_map_thresh5_min_lib_counts
X4rL42_prog_map_thresh5_max_lib_counts = max(X4rL42_prog_map_thresh5_df$lib)
X4rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X4rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X4rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_prog_map_thresh5_pre_count = length(X4rL42_prog_map_thresh5_df$pre)
X4rL42_prog_map_thresh5_pre_count
X4rL42_prog_map_thresh5_min_pre_counts = min(X4rL42_prog_map_thresh5_df$pre)
X4rL42_prog_map_thresh5_min_pre_counts
X4rL42_prog_map_thresh5_max_pre_counts = max(X4rL42_prog_map_thresh5_df$pre)
X4rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X4 less than SGE region length x 3 due to PAM edits
X4rL42_prog_map_thresh5_post_count = length(X4rL42_prog_map_thresh5_df$post)
X4rL42_prog_map_thresh5_post_count
X4rL42_prog_map_thresh5_min_post_counts = min(X4rL42_prog_map_thresh5_df$post)
X4rL42_prog_map_thresh5_min_post_counts
X4rL42_prog_map_thresh5_max_post_counts = max(X4rL42_prog_map_thresh5_df$post)
X4rL42_prog_map_thresh5_max_post_counts
X4rL42_prog_map_thresh5_corr_post_count = length(X4rL42_prog_map_thresh5_df$corr_post)
X4rL42_prog_map_thresh5_corr_post_count
X4rL42_prog_map_thresh5_min_corr_post_counts = min(X4rL42_prog_map_thresh5_df$corr_post)
X4rL42_prog_map_thresh5_min_corr_post_counts
X4rL42_prog_map_thresh5_max_corr_post_counts = max(X4rL42_prog_map_thresh5_df$corr_post)
X4rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X4rL42_pSNV_thresh5 <- which(X4rL42[,X4_p_hdr_snv]=='True' & as.numeric(as.character(X4rL42[,'pre_freq']))>=0.00001)
X4rL42_pSNV_thresh5_df = X4rL42[X4rL42_pSNV_thresh5,]
X4rL42_pSNV_thresh5_lib_count = length(X4rL42_pSNV_thresh5_df$lib)
X4rL42_pSNV_thresh5_lib_count
X4rL42_pSNV_thresh5_min_lib_counts = min(X4rL42_pSNV_thresh5_df$lib)
X4rL42_pSNV_thresh5_min_lib_counts
X4rL42_pSNV_thresh5_max_lib_counts = max(X4rL42_pSNV_thresh5_df$lib)
X4rL42_pSNV_thresh5_max_lib_counts
X4rL42_pSNV_thresh5_pre_count = length(X4rL42_pSNV_thresh5_df$pre)
X4rL42_pSNV_thresh5_pre_count
X4rL42_pSNV_thresh5_min_pre_counts = min(X4rL42_pSNV_thresh5_df$pre)
X4rL42_pSNV_thresh5_min_pre_counts
X4rL42_pSNV_thresh5_max_pre_counts = max(X4rL42_pSNV_thresh5_df$pre)
X4rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X4rL42_pSNV_thresh5_post_count = length(X4rL42_pSNV_thresh5_df$post)
X4rL42_pSNV_thresh5_post_count
X4rL42_pSNV_thresh5_min_post_counts = min(X4rL42_pSNV_thresh5_df$post)
X4rL42_pSNV_thresh5_min_post_counts
X4rL42_pSNV_thresh5_max_post_counts = max(X4rL42_pSNV_thresh5_df$post)
X4rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X4rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X4rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X4rL41_prog_var_thresh5_df:
X4rL41_prog_var_thresh5_df_rL42_int <- X4rL41_prog_var_thresh5_df[which(X4rL41_prog_var_thresh5_df$variant %in% X4rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X4rL42_prog_var_thresh5_df:
X4rL42_prog_var_thresh5_df_rL41_int <- X4rL42_prog_var_thresh5_df[which(X4rL42_prog_var_thresh5_df$variant %in% X4rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X4rL41_prog_var_thresh5_df_rL42_int_ord <- X4rL41_prog_var_thresh5_df_rL42_int[order(X4rL41_prog_var_thresh5_df_rL42_int$variant),]
X4rL42_prog_var_thresh5_df_rL41_int_ord <- X4rL42_prog_var_thresh5_df_rL41_int[order(X4rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X4rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X4rL41rL42int_prog_var_thresh5_pre_count <- dim(X4rL41_prog_var_thresh5_df_rL42_int)[1] 
X4rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X4rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X4rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X4rL42_prog_var_thresh5_df_rL41_int_ord$lib
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X4rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X4rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X4rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X4rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X4rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X4rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X4rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X4rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X4rL41_cSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X4rL41_cSNV_missense_post_pre_med <- unname(X4rL41_cSNV_missense_post_pre_quarts[3])
X4rL41_cSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X4rL41_cSNV_syn_post_pre_med <- unname(X4rL41_cSNV_syn_post_pre_quarts[3])
X4rL41_cSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X4rL41_cSNV_nonsense_post_pre_med <- unname(X4rL41_cSNV_nonsense_post_pre_quarts[3])
X4rL41_cSNV_syn_to_non_post_pre_spread <- X4rL41_cSNV_syn_post_pre_med - X4rL41_cSNV_nonsense_post_pre_med

X4rL42_cSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X4rL42_cSNV_missense_post_pre_med <- unname(X4rL42_cSNV_missense_post_pre_quarts[3])
X4rL42_cSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X4rL42_cSNV_syn_post_pre_med <- unname(X4rL42_cSNV_syn_post_pre_quarts[3])
X4rL42_cSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X4rL42_cSNV_nonsense_post_pre_med <- unname(X4rL42_cSNV_nonsense_post_pre_quarts[3])
X4rL42_cSNV_syn_to_non_post_pre_spread <- X4rL42_cSNV_syn_post_pre_med - X4rL42_cSNV_nonsense_post_pre_med

X4rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_missense_post_pre_med <- unname(X4rL41rL42a_cSNV_missense_post_pre_quarts[3])
X4rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_syn_post_pre_med <- unname(X4rL41rL42a_cSNV_syn_post_pre_quarts[3])
X4rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X4rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X4rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X4rL41rL42a_cSNV_syn_post_pre_med - X4rL41rL42a_cSNV_nonsense_post_pre_med

X4rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_cSNV_missense_post_pre_med <- unname(X4rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X4rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_cSNV_syn_post_pre_med <- unname(X4rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X4rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X4rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X4rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X4rL41rL42pw_cSNV_syn_post_pre_med - X4rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X4rL41_tSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X4rL41_tSNV_missense_post_pre_med <- unname(X4rL41_tSNV_missense_post_pre_quarts[3])
X4rL41_tSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X4rL41_tSNV_syn_post_pre_med <- unname(X4rL41_tSNV_syn_post_pre_quarts[3])
X4rL41_tSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X4rL41_tSNV_nonsense_post_pre_med <- unname(X4rL41_tSNV_nonsense_post_pre_quarts[3])
X4rL41_tSNV_syn_to_non_post_pre_spread <- X4rL41_tSNV_syn_post_pre_med - X4rL41_tSNV_nonsense_post_pre_med

X4rL42_tSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X4rL42_tSNV_missense_post_pre_med <- unname(X4rL42_tSNV_missense_post_pre_quarts[3])
X4rL42_tSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X4rL42_tSNV_syn_post_pre_med <- unname(X4rL42_tSNV_syn_post_pre_quarts[3])
X4rL42_tSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X4rL42_tSNV_nonsense_post_pre_med <- unname(X4rL42_tSNV_nonsense_post_pre_quarts[3])
X4rL42_tSNV_syn_to_non_post_pre_spread <- X4rL42_tSNV_syn_post_pre_med - X4rL42_tSNV_nonsense_post_pre_med

X4rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_missense_post_pre_med <- unname(X4rL41rL42a_tSNV_missense_post_pre_quarts[3])
X4rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_syn_post_pre_med <- unname(X4rL41rL42a_tSNV_syn_post_pre_quarts[3])
X4rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X4rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X4rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X4rL41rL42a_tSNV_syn_post_pre_med - X4rL41rL42a_tSNV_nonsense_post_pre_med

X4rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_tSNV_missense_post_pre_med <- unname(X4rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X4rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_tSNV_syn_post_pre_med <- unname(X4rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X4rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X4rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X4rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X4rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X4rL41rL42pw_tSNV_syn_post_pre_med - X4rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X4rL41_cSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X4rL41_cSNV_missense_post_lib_med <- unname(X4rL41_cSNV_missense_post_lib_quarts[3])
X4rL41_cSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X4rL41_cSNV_syn_post_lib_med <- unname(X4rL41_cSNV_syn_post_lib_quarts[3])
X4rL41_cSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X4rL41_cSNV_nonsense_post_lib_med <- unname(X4rL41_cSNV_nonsense_post_lib_quarts[3])
X4rL41_cSNV_syn_to_non_post_lib_spread <- X4rL41_cSNV_syn_post_lib_med - X4rL41_cSNV_nonsense_post_lib_med

X4rL42_cSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X4rL42_cSNV_missense_post_lib_med <- unname(X4rL42_cSNV_missense_post_lib_quarts[3])
X4rL42_cSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X4rL42_cSNV_syn_post_lib_med <- unname(X4rL42_cSNV_syn_post_lib_quarts[3])
X4rL42_cSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X4rL42_cSNV_nonsense_post_lib_med <- unname(X4rL42_cSNV_nonsense_post_lib_quarts[3])
X4rL42_cSNV_syn_to_non_post_lib_spread <- X4rL42_cSNV_syn_post_lib_med - X4rL42_cSNV_nonsense_post_lib_med

X4rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_missense_post_lib_med <- unname(X4rL41rL42a_cSNV_missense_post_lib_quarts[3])
X4rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_syn_post_lib_med <- unname(X4rL41rL42a_cSNV_syn_post_lib_quarts[3])
X4rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X4rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X4rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X4rL41rL42a_cSNV_syn_post_lib_med - X4rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X4rL41_tSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X4rL41_tSNV_missense_post_lib_med <- unname(X4rL41_tSNV_missense_post_lib_quarts[3])
X4rL41_tSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X4rL41_tSNV_syn_post_lib_med <- unname(X4rL41_tSNV_syn_post_lib_quarts[3])
X4rL41_tSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X4rL41_tSNV_nonsense_post_lib_med <- unname(X4rL41_tSNV_nonsense_post_lib_quarts[3])
X4rL41_tSNV_syn_to_non_post_lib_spread <- X4rL41_tSNV_syn_post_lib_med - X4rL41_tSNV_nonsense_post_lib_med

X4rL42_tSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X4rL42_tSNV_missense_post_lib_med <- unname(X4rL42_tSNV_missense_post_lib_quarts[3])
X4rL42_tSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X4rL42_tSNV_syn_post_lib_med <- unname(X4rL42_tSNV_syn_post_lib_quarts[3])
X4rL42_tSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X4rL42_tSNV_nonsense_post_lib_med <- unname(X4rL42_tSNV_nonsense_post_lib_quarts[3])
X4rL42_tSNV_syn_to_non_post_lib_spread <- X4rL42_tSNV_syn_post_lib_med - X4rL42_tSNV_nonsense_post_lib_med

X4rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_missense_post_lib_med <- unname(X4rL41rL42a_tSNV_missense_post_lib_quarts[3])
X4rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_syn_post_lib_med <- unname(X4rL41rL42a_tSNV_syn_post_lib_quarts[3])
X4rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X4rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X4rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X4rL41rL42a_tSNV_syn_post_lib_med - X4rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X4rL41_cSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X4rL41_cSNV_missense_pre_lib_med <- unname(X4rL41_cSNV_missense_pre_lib_quarts[3])
X4rL41_cSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X4rL41_cSNV_syn_pre_lib_med <- unname(X4rL41_cSNV_syn_pre_lib_quarts[3])
X4rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X4rL41_cSNV_nonsense_pre_lib_med <- unname(X4rL41_cSNV_nonsense_pre_lib_quarts[3])
X4rL41_cSNV_syn_to_non_pre_lib_spread <- X4rL41_cSNV_syn_pre_lib_med - X4rL41_cSNV_nonsense_pre_lib_med

X4rL42_cSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X4rL42_cSNV_missense_pre_lib_med <- unname(X4rL42_cSNV_missense_pre_lib_quarts[3])
X4rL42_cSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X4rL42_cSNV_syn_pre_lib_med <- unname(X4rL42_cSNV_syn_pre_lib_quarts[3])
X4rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X4rL42_cSNV_nonsense_pre_lib_med <- unname(X4rL42_cSNV_nonsense_pre_lib_quarts[3])
X4rL42_cSNV_syn_to_non_pre_lib_spread <- X4rL42_cSNV_syn_pre_lib_med - X4rL42_cSNV_nonsense_pre_lib_med

X4rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_missense_pre_lib_med <- unname(X4rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X4rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_syn_pre_lib_med <- unname(X4rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X4rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X4rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X4rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X4rL41rL42a_cSNV_syn_pre_lib_med - X4rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X4rL41_tSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X4rL41_tSNV_missense_pre_lib_med <- unname(X4rL41_tSNV_missense_pre_lib_quarts[3])
X4rL41_tSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X4rL41_tSNV_syn_pre_lib_med <- unname(X4rL41_tSNV_syn_pre_lib_quarts[3])
X4rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X4rL41_tSNV_nonsense_pre_lib_med <- unname(X4rL41_tSNV_nonsense_pre_lib_quarts[3])
X4rL41_tSNV_syn_to_non_pre_lib_spread <- X4rL41_tSNV_syn_pre_lib_med - X4rL41_tSNV_nonsense_pre_lib_med

X4rL42_tSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X4rL42_tSNV_missense_pre_lib_med <- unname(X4rL42_tSNV_missense_pre_lib_quarts[3])
X4rL42_tSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X4rL42_tSNV_syn_pre_lib_med <- unname(X4rL42_tSNV_syn_pre_lib_quarts[3])
X4rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X4rL42_tSNV_nonsense_pre_lib_med <- unname(X4rL42_tSNV_nonsense_pre_lib_quarts[3])
X4rL42_tSNV_syn_to_non_pre_lib_spread <- X4rL42_tSNV_syn_pre_lib_med - X4rL42_tSNV_nonsense_pre_lib_med

X4rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_missense_pre_lib_med <- unname(X4rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X4rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_syn_pre_lib_med <- unname(X4rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X4rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X4rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X4rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X4rL41rL42a_tSNV_syn_pre_lib_med - X4rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X4rL41_tSNV_syn_rna_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X4rL41_tSNV_syn_rna_pre_med <- unname(X4rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X4rL41_tSNV_syn_rna_post_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X4rL41_tSNV_syn_rna_post_med <- unname(X4rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X4rL42_tSNV_syn_rna_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X4rL42_tSNV_syn_rna_pre_med <- unname(X4rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X4rL42_tSNV_syn_rna_post_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X4rL42_tSNV_syn_rna_post_med <- unname(X4rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X4rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_syn_rna_pre_med <- unname(X4rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X4rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X4rL41rL42a_tSNV_syn_rna_post_med <- unname(X4rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X4rL41_cSNV_syn_pre_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X4rL41_cSNV_syn_post_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X4rL41_cSNV_syn_post_lib_med
# tHDR
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X4rL41_tSNV_syn_pre_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X4rL41_tSNV_syn_post_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X4rL41_tSNV_syn_post_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X4rL41_tSNV_syn_rna_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X4rL41_tSNV_syn_rna_post_med

#rL42
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X4rL42_cSNV_syn_pre_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X4rL42_cSNV_syn_post_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X4rL42_cSNV_syn_post_lib_med
# tHDR
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X4rL42_tSNV_syn_pre_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X4rL42_tSNV_syn_post_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X4rL42_tSNV_syn_post_lib_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X4rL42_tSNV_syn_rna_pre_med
X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X4rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X4rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X4rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X4rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X4rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X4rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X4rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X4rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X4rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X4rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X4rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X4rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X4rL41_prog_var_thresh5_df_rL42_int_ord[which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X4rL41_prog_var_thresh5_df_rL42_int_ord
X4rL41_prog_map_thresh5_df_rL42_int_ord = which(X4rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X4rL41_prog_map_thresh5_df_rL42_int_ord_df = X4rL41_prog_var_thresh5_df_rL42_int_ord[X4rL41_prog_map_thresh5_df_rL42_int_ord,]
X4rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X4rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X4rL41_prog_map_thresh5_df_rL42_int_ord_df[X4rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X4rL41_prog_map_thresh5_df_rL42_int_ord_df[X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X4rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X4rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X4rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X4rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X4rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X4rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X4rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X4rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X4rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X4rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X4rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X4rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X4rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X4rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X4rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X4rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X4rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X4rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X4rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X4rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X4rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X4rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X4rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41_cSNV_post_pre_by_cadd_cor_s
#X4rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X4rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL42_cSNV_post_pre_by_cadd_cor_s

#X4rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X4rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41_cSNV_post_lib_by_cadd_cor_s
#X4rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X4rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X4rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X4rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41_tSNV_post_pre_by_cadd_cor_s
#X4rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X4rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL42_tSNV_post_pre_by_cadd_cor_s

#X4rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X4rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41_tSNV_post_lib_by_cadd_cor_s
#X4rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X4rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X4rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X4rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X4rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X4rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X4rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X4rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X4rL41_prog_var_all_lib_count
X4rL41_prog_var_all_pre_count
X4rL42_prog_var_all_pre_count
X4rL41_prog_map_thresh5_lib_count
X4rL41_prog_map_thresh5_pre_count
X4rL42_prog_map_thresh5_pre_count
X4rL41_prog_map_thresh5_post_count
X4rL42_prog_map_thresh5_post_count
X4rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X4rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X4rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X4rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X4rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X4rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X4rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X4rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X4rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X4rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X4rL41_cSNV_post_pre_by_cadd_cor_s
X4rL42_cSNV_post_pre_by_cadd_cor_s
X4rL41_cSNV_post_lib_by_cadd_cor_s
X4rL42_cSNV_post_lib_by_cadd_cor_s
X4rL41_tSNV_post_pre_by_cadd_cor_s
X4rL42_tSNV_post_pre_by_cadd_cor_s
X4rL41_tSNV_post_lib_by_cadd_cor_s
X4rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X4rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X4rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X4rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X4rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X4rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X4rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X4rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X4rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X4rL41_cSNV_syn_to_non_post_pre_spread
X4rL42_cSNV_syn_to_non_post_pre_spread
X4rL41rL42a_cSNV_syn_to_non_post_pre_spread
X4rL41_cSNV_syn_to_non_post_lib_spread
X4rL42_cSNV_syn_to_non_post_lib_spread
X4rL41rL42a_cSNV_syn_to_non_post_lib_spread
X4rL41_tSNV_syn_to_non_post_pre_spread
X4rL42_tSNV_syn_to_non_post_pre_spread
X4rL41rL42a_tSNV_syn_to_non_post_pre_spread
X4rL41_tSNV_syn_to_non_post_lib_spread
X4rL42_tSNV_syn_to_non_post_lib_spread
X4rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X4rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X4rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X4rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X4rL41_cSNV_pre_lib_cors = cor(log2(X4rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4rL41_tSNV_pre_lib_cors = cor(log2(X4rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4rL41_cSNV_post_lib_cors = cor(log2(X4rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X4rL41_tSNV_post_lib_cors = cor(log2(X4rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X4rL41_cSNV_post_pre_cors = cor(log2(X4rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4rL41_tSNV_post_pre_cors = cor(log2(X4rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X4rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4rL41_cSNV_rna_lib_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X4rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4rL41_tSNV_rna_lib_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X4rL41_cSNV_rna_pre_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X4rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4rL41_tSNV_rna_pre_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X4rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4rL41rL42_cSNV_pre_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X4rL41rL42_tSNV_pre_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X4rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X4rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X4rL41rL42_cSNV_post_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X4rL41rL42_tSNV_post_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X4rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X4rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X4rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X4rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X4rL41rL42_cSNV_rna_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X4rL41rL42_tSNV_rna_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X4rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X4rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X4rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X4rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X4rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X4rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X4rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X4rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X4rL41_cors <- c("X4rL41",X4rL41_cSNV_pre_lib_cors,X4rL41_tSNV_pre_lib_cors,X4rL41_cSNV_post_lib_cors,X4rL41_tSNV_post_lib_cors,X4rL41_cSNV_post_pre_cors,X4rL41_tSNV_post_pre_cors,X4rL41_cSNV_rna_lib_cors,X4rL41_tSNV_rna_lib_cors,X4rL41_cSNV_rna_pre_cors,X4rL41_tSNV_rna_pre_cors,X4rL41rL42_cSNV_pre_cors,X4rL41rL42_tSNV_pre_cors,X4rL41rL42_cSNV_pre_lib_ratio_cors,X4rL41rL42_tSNV_pre_lib_ratio_cors,X4rL41rL42_cSNV_post_cors,X4rL41rL42_tSNV_post_cors,X4rL41rL42_cSNV_post_lib_ratio_cors,X4rL41rL42_tSNV_post_lib_ratio_cors,X4rL41rL42_cSNV_post_pre_ratio_cors,X4rL41rL42_tSNV_post_pre_ratio_cors,X4rL41rL42_cSNV_rna_cors,X4rL41rL42_tSNV_rna_cors,X4rL41rL42_tSNV_rna_pre_ratio_cors,X4rL41_cSNV_pre_lib_ratio_cadd_cors,X4rL41_tSNV_pre_lib_ratio_cadd_cors,X4rL41_cSNV_post_lib_ratio_cadd_cors,X4rL41_tSNV_post_lib_ratio_cadd_cors,X4rL41_cSNV_post_pre_ratio_cadd_cors,X4rL41_tSNV_post_pre_ratio_cadd_cors,X4rL41_cSNV_post_pre_ratio_cadd_missense_cors,X4rL41_tSNV_post_pre_ratio_cadd_missense_cors,X4rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X4rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X4rL41_cSNV_post_pre_ratio_grantham_missense_cors,X4rL41_tSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X4rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X4rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X4rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X4rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X4rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X4rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X4rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X4rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X4rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X4rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X4rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X4rL42_cSNV_pre_lib_cors = cor(log2(X4rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4rL42_tSNV_pre_lib_cors = cor(log2(X4rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4rL42_cSNV_post_lib_cors = cor(log2(X4rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X4rL42_tSNV_post_lib_cors = cor(log2(X4rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X4rL42_cSNV_post_pre_cors = cor(log2(X4rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X4rL42_tSNV_post_pre_cors = cor(log2(X4rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X4rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X4rL42_cSNV_rna_lib_cors = cor(log2(X4rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X4rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4rL42_tSNV_rna_lib_cors = cor(log2(X4rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X4rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X4rL42_cSNV_rna_pre_cors = cor(log2(X4rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X4rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X4rL42_tSNV_rna_pre_cors = cor(log2(X4rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X4rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X4rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X4rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X4rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X4rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X4rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X4rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X4rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X4rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X4rL42_cors <- c("X4rL42",X4rL42_cSNV_pre_lib_cors,X4rL42_tSNV_pre_lib_cors,X4rL42_cSNV_post_lib_cors,X4rL42_tSNV_post_lib_cors,X4rL42_cSNV_post_pre_cors,X4rL42_tSNV_post_pre_cors,X4rL42_cSNV_rna_lib_cors,X4rL42_tSNV_rna_lib_cors,X4rL42_cSNV_rna_pre_cors,X4rL42_tSNV_rna_pre_cors,X4rL41rL42_cSNV_pre_cors,X4rL41rL42_tSNV_pre_cors,X4rL41rL42_cSNV_pre_lib_ratio_cors,X4rL41rL42_tSNV_pre_lib_ratio_cors,X4rL41rL42_cSNV_post_cors,X4rL41rL42_tSNV_post_cors,X4rL41rL42_cSNV_post_lib_ratio_cors,X4rL41rL42_tSNV_post_lib_ratio_cors,X4rL41rL42_cSNV_post_pre_ratio_cors,X4rL41rL42_tSNV_post_pre_ratio_cors,X4rL41rL42_cSNV_rna_cors,X4rL41rL42_tSNV_rna_cors,X4rL41rL42_tSNV_rna_pre_ratio_cors,X4rL42_cSNV_pre_lib_ratio_cadd_cors,X4rL42_tSNV_pre_lib_ratio_cadd_cors,X4rL42_cSNV_post_lib_ratio_cadd_cors,X4rL42_tSNV_post_lib_ratio_cadd_cors,X4rL42_cSNV_post_pre_ratio_cadd_cors,X4rL42_tSNV_post_pre_ratio_cadd_cors,X4rL42_cSNV_post_pre_ratio_cadd_missense_cors,X4rL42_tSNV_post_pre_ratio_cadd_missense_cors,X4rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X4rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X4rL42_cSNV_post_pre_ratio_grantham_missense_cors,X4rL42_tSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X4rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X4rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X4rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X4rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X4rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X4rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X4rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X4rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X4rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X4rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X4rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X4rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X4rL41)
rm(X4rL42)
gc()
X5rL41_file <- paste(experiment_dir_170731,'X5rL41','_annotated.txt',sep='')
X5rL42_file <- paste(experiment_dir_170731,'X5rL42','_annotated.txt',sep='')
X5rL41 <- read.table(X5rL41_file, header=TRUE, sep="\t")
X5rL42 <- read.table(X5rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X5 <- editing_info[which(editing_info$amplicon == 'X5'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X5_HDR_5_SNV = as.character(editing_info_X5$HDR_5_SNV)
X5_HDR_3_SNV = as.character(editing_info_X5$HDR_3_SNV)
#X5_cut_pos = as.character(editing_info_X5$cut_pos)
X5_cut_end = as.character(editing_info_X5$cut_end)
X5_mut_start = as.character(editing_info_X5$mut_start)
X5_mut_end = as.character(editing_info_X5$mut_end)
### Replicate 1
X5rL41_cSNV_all <- which(X5rL41[,'c_hdr_snv']=='True')
X5rL41_cSNV_all_df = X5rL41[X5rL41_cSNV_all,]
X5rL41_prog_var_all <- which(X5rL41[,'all_hdr_variant']=='True' & X5rL41[,'edit_string']!='-WT')
X5rL41_prog_var_all_df = X5rL41[X5rL41_prog_var_all,]
X5rL41_prog_map_all = which(X5rL41_prog_var_all_df[,'pos']!='REF')
X5rL41_prog_map_all_df = X5rL41_prog_var_all_df[X5rL41_prog_map_all,]
X5rL41_prog_map_exon_all = which(X5rL41_prog_map_all_df[,'cDNApos']!='REF' & X5rL41_prog_map_all_df[,'cDNApos']!='NA')
X5rL41_prog_map_exon_all_df = X5rL41_prog_map_all_df[X5rL41_prog_map_exon_all,]
X5rL41_prog_map_CADD = which(X5rL41_prog_map_all_df[,'CADD.phred']!='NA')
X5rL41_prog_map_CADD_df = X5rL41_prog_map_all_df[X5rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X5rL41_prog_var_thresh5 <- which(as.numeric(as.character(X5rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X5rL41_prog_var_thresh5_df = X5rL41_prog_var_all_df[X5rL41_prog_var_thresh5,]
X5rL41_prog_map_thresh5 <- which(as.numeric(as.character(X5rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X5rL41_prog_map_thresh5_df = X5rL41_prog_map_all_df[X5rL41_prog_map_thresh5,]
X5rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X5rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X5rL41_prog_map_exon_thresh5_df = X5rL41_prog_map_exon_all_df[X5rL41_prog_map_exon_thresh5,]
X5rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X5rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X5rL41_prog_map_CADD_thresh5_df = X5rL41_prog_map_CADD_df[X5rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X5rL41_prog_var_all_lib_count = length(X5rL41_prog_var_all_df$lib)
X5rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X5rL41_prog_var_all_min_lib_counts = min(X5rL41_prog_var_all_df$lib)
X5rL41_prog_var_all_min_lib_counts
X5rL41_prog_var_all_max_lib_counts = max(X5rL41_prog_var_all_df$lib)
X5rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X5rL41_prog_map_all_lib_count = length(X5rL41_prog_map_all_df$lib)
X5rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X5rL41_prog_map_all_min_lib_counts = min(X5rL41_prog_map_all_df$lib)
X5rL41_prog_map_all_min_lib_counts
X5rL41_prog_map_all_max_lib_counts = max(X5rL41_prog_map_all_df$lib)
X5rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X5rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X5rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X5rL41_prog_var_all_pre_count = length(X5rL41_prog_var_all_df$pre)
X5rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X5rL41_prog_var_all_min_pre_counts = min(X5rL41_prog_var_all_df$pre)
X5rL41_prog_var_all_min_pre_counts
X5rL41_prog_var_all_max_pre_counts = max(X5rL41_prog_var_all_df$pre)
X5rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X5rL41_prog_map_all_pre_count = length(X5rL41_prog_map_all_df$pre)
X5rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X5rL41_prog_map_all_min_pre_counts = min(X5rL41_prog_map_all_df$pre)
X5rL41_prog_map_all_min_pre_counts
X5rL41_prog_map_all_max_pre_counts = max(X5rL41_prog_map_all_df$pre)
X5rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X5rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X5rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X5rL41_prog_map_all_post_count = length(X5rL41_prog_map_all_df$post)
X5rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X5rL41_prog_map_all_min_post_counts = min(X5rL41_prog_map_all_df$post)
X5rL41_prog_map_all_min_post_counts
X5rL41_prog_map_all_max_post_counts = max(X5rL41_prog_map_all_df$post)
X5rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X5rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X5rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X5rL41_prog_map_all_syn_df <- X5rL41_prog_map_all_df[which(X5rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X5rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X5rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X5rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X5rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X5rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X5rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X5rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X5rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X5rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X5rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X5rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X5rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X5rL41_prog_map_all_min_rna_counts = min(X5rL41_prog_map_exon_all_df$tHDR_rna)
X5rL41_prog_map_all_min_rna_counts
X5rL41_prog_map_all_max_rna_counts = max(X5rL41_prog_map_exon_all_df$tHDR_rna)
X5rL41_prog_map_all_max_rna_counts
X5rL41_prog_map_all_min_rna_pseudo_freq = min(X5rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5rL41_prog_map_all_min_rna_pseudo_freq
X5rL41_prog_map_all_max_rna_pseudo_freq = max(X5rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5rL41_prog_map_all_max_rna_pseudo_freq
X5rL41_prog_map_all_min_rna_pre_ratio = min(X5rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5rL41_prog_map_all_min_rna_pre_ratio
X5rL41_prog_map_all_max_rna_pre_ratio = max(X5rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5rL41_prog_map_all_max_rna_pre_ratio
X5rL41_prog_map_all_min_rna_post_ratio = min(X5rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5rL41_prog_map_all_min_rna_post_ratio
X5rL41_prog_map_all_max_rna_post_ratio = max(X5rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X5rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X5rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X5rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X5rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X5rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X5rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X5rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X5rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X5rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X5rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X5rL41_prog_map_all_df$post_pre_ratio),log2(X5rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X5rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X5rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X5rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X5rL41_cSNV_all_corr_pre_count = length(X5rL41_cSNV_all_df$corr_pre)
X5rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X5rL41_cSNV_all_min_corr_pre_counts = min(X5rL41_cSNV_all_df$corr_pre)
X5rL41_cSNV_all_min_corr_pre_counts
X5rL41_cSNV_all_max_corr_pre_counts = max(X5rL41_cSNV_all_df$corr_pre)
X5rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X5rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X5rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X5rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X5rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X5rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_cSNV_all_corr_post_count = length(X5rL41_cSNV_all_df$corr_post)
X5rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X5rL41_cSNV_all_min_corr_post_counts = min(X5rL41_cSNV_all_df$corr_post)
X5rL41_cSNV_all_min_corr_post_counts
X5rL41_cSNV_all_max_corr_post_counts = max(X5rL41_cSNV_all_df$corr_post)
X5rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X5rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X5rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X5rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X5rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X5rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X5rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X5_p_hdr_snv = paste('p_hdr_',X5_cut_end,'_snv',sep='')
X5rL41_pSNV_all <- which(X5rL41[,X5_p_hdr_snv]=='True')
X5rL41_pSNV_all_df = X5rL41[X5rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_pSNV_all_lib_count = length(X5rL41_pSNV_all_df$lib)
X5rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X5rL41_pSNV_all_min_lib_counts = min(X5rL41_pSNV_all_df$lib)
X5rL41_pSNV_all_min_lib_counts
X5rL41_pSNV_all_max_lib_counts = max(X5rL41_pSNV_all_df$lib)
X5rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X5rL41_pSNV_all_pre_count = length(X5rL41_pSNV_all_df$pre)
X5rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X5rL41_pSNV_all_min_pre_counts = min(X5rL41_pSNV_all_df$pre)
X5rL41_pSNV_all_min_pre_counts
X5rL41_pSNV_all_max_pre_counts = max(X5rL41_pSNV_all_df$pre)
X5rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X5rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X5rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_pSNV_all_post_count = length(X5rL41_pSNV_all_df$post)
X5rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X5rL41_pSNV_all_min_post_counts = min(X5rL41_pSNV_all_df$post)
X5rL41_pSNV_all_min_post_counts
X5rL41_pSNV_all_max_post_counts = max(X5rL41_pSNV_all_df$post)
X5rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X5rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X5rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_prog_map_thresh5_lib_count = length(X5rL41_prog_map_thresh5_df$lib)
X5rL41_prog_map_thresh5_lib_count
X5rL41_prog_map_thresh5_min_lib_counts = min(X5rL41_prog_map_thresh5_df$lib)
X5rL41_prog_map_thresh5_min_lib_counts
X5rL41_prog_map_thresh5_max_lib_counts = max(X5rL41_prog_map_thresh5_df$lib)
X5rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X5rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X5rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_prog_map_thresh5_pre_count = length(X5rL41_prog_map_thresh5_df$pre)
X5rL41_prog_map_thresh5_pre_count
X5rL41_prog_map_thresh5_min_pre_counts = min(X5rL41_prog_map_thresh5_df$pre)
X5rL41_prog_map_thresh5_min_pre_counts
X5rL41_prog_map_thresh5_max_pre_counts = max(X5rL41_prog_map_thresh5_df$pre)
X5rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL41_prog_map_thresh5_post_count = length(X5rL41_prog_map_thresh5_df$post)
X5rL41_prog_map_thresh5_post_count
X5rL41_prog_map_thresh5_min_post_counts = min(X5rL41_prog_map_thresh5_df$post)
X5rL41_prog_map_thresh5_min_post_counts
X5rL41_prog_map_thresh5_max_post_counts = max(X5rL41_prog_map_thresh5_df$post)
X5rL41_prog_map_thresh5_max_post_counts
X5rL41_prog_map_thresh5_corr_post_count = length(X5rL41_cSNV_all_df$corr_post)
X5rL41_prog_map_thresh5_corr_post_count
X5rL41_prog_map_thresh5_min_corr_post_counts = min(X5rL41_cSNV_all_df$corr_post)
X5rL41_prog_map_thresh5_min_corr_post_counts
X5rL41_prog_map_thresh5_max_corr_post_counts = max(X5rL41_cSNV_all_df$corr_post)
X5rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X5rL41_pSNV_thresh5 <- which(X5rL41[,X5_p_hdr_snv]=='True' & as.numeric(as.character(X5rL41[,'pre_freq']))>=0.00001)
X5rL41_pSNV_thresh5_df = X5rL41[X5rL41_pSNV_thresh5,]
X5rL41_pSNV_thresh5_lib_count = length(X5rL41_pSNV_thresh5_df$lib)
X5rL41_pSNV_thresh5_lib_count
X5rL41_pSNV_thresh5_min_lib_counts = min(X5rL41_pSNV_thresh5_df$lib)
X5rL41_pSNV_thresh5_min_lib_counts
X5rL41_pSNV_thresh5_max_lib_counts = max(X5rL41_pSNV_thresh5_df$lib)
X5rL41_pSNV_thresh5_max_lib_counts
X5rL41_pSNV_thresh5_pre_count = length(X5rL41_pSNV_thresh5_df$pre)
X5rL41_pSNV_thresh5_pre_count
X5rL41_pSNV_thresh5_min_pre_counts = min(X5rL41_pSNV_thresh5_df$pre)
X5rL41_pSNV_thresh5_min_pre_counts
X5rL41_pSNV_thresh5_max_pre_counts = max(X5rL41_pSNV_thresh5_df$pre)
X5rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X5rL41_pSNV_thresh5_post_count = length(X5rL41_pSNV_thresh5_df$post)
X5rL41_pSNV_thresh5_post_count
X5rL41_pSNV_thresh5_min_post_counts = min(X5rL41_pSNV_thresh5_df$post)
X5rL41_pSNV_thresh5_min_post_counts
X5rL41_pSNV_thresh5_max_post_counts = max(X5rL41_pSNV_thresh5_df$post)
X5rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X5rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X5rL41_pSNV_thresh5_post_pos

### Replicate 2
X5rL42_cSNV_all <- which(X5rL42[,'c_hdr_snv']=='True')
X5rL42_cSNV_all_df = X5rL42[X5rL42_cSNV_all,]
X5rL42_prog_var_all <- which(X5rL42[,'all_hdr_variant']=='True' & X5rL42[,'edit_string']!='-WT')
X5rL42_prog_var_all_df = X5rL42[X5rL42_prog_var_all,]
X5rL42_prog_map_all = which(X5rL42_prog_var_all_df[,'pos']!='REF')
X5rL42_prog_map_all_df = X5rL42_prog_var_all_df[X5rL42_prog_map_all,]
X5rL42_prog_map_exon_all = which(X5rL42_prog_map_all_df[,'cDNApos']!='REF' & X5rL42_prog_map_all_df[,'cDNApos']!='NA')
X5rL42_prog_map_exon_all_df = X5rL42_prog_map_all_df[X5rL42_prog_map_exon_all,]
X5rL42_prog_map_CADD = which(X5rL42_prog_map_all_df[,'CADD.phred']!='NA')
X5rL42_prog_map_CADD_df = X5rL42_prog_map_all_df[X5rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X5rL42_prog_var_thresh5 <- which(as.numeric(as.character(X5rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X5rL42_prog_var_thresh5_df = X5rL42_prog_var_all_df[X5rL42_prog_var_thresh5,]
X5rL42_prog_map_thresh5 <- which(as.numeric(as.character(X5rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X5rL42_prog_map_thresh5_df = X5rL42_prog_map_all_df[X5rL42_prog_map_thresh5,]
X5rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X5rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X5rL42_prog_map_exon_thresh5_df = X5rL42_prog_map_exon_all_df[X5rL42_prog_map_exon_thresh5,]
X5rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X5rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X5rL42_prog_map_CADD_thresh5_df = X5rL42_prog_map_CADD_df[X5rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X5rL42_prog_var_all_lib_count = length(X5rL42_prog_var_all_df$lib)
X5rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X5rL42_prog_var_all_min_lib_counts = min(X5rL42_prog_var_all_df$lib)
X5rL42_prog_var_all_min_lib_counts
X5rL42_prog_var_all_max_lib_counts = max(X5rL42_prog_var_all_df$lib)
X5rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X5rL42_prog_map_all_lib_count = length(X5rL42_prog_map_all_df$lib)
X5rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X5rL42_prog_map_all_min_lib_counts = min(X5rL42_prog_map_all_df$lib)
X5rL42_prog_map_all_min_lib_counts
X5rL42_prog_map_all_max_lib_counts = max(X5rL42_prog_map_all_df$lib)
X5rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X5rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X5rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X5rL42_prog_var_all_pre_count = length(X5rL42_prog_var_all_df$pre)
X5rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X5rL42_prog_var_all_min_pre_counts = min(X5rL42_prog_var_all_df$pre)
X5rL42_prog_var_all_min_pre_counts
X5rL42_prog_var_all_max_pre_counts = max(X5rL42_prog_var_all_df$pre)
X5rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X5rL42_prog_map_all_pre_count = length(X5rL42_prog_map_all_df$pre)
X5rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X5rL42_prog_map_all_min_pre_counts = min(X5rL42_prog_map_all_df$pre)
X5rL42_prog_map_all_min_pre_counts
X5rL42_prog_map_all_max_pre_counts = max(X5rL42_prog_map_all_df$pre)
X5rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X5rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X5rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X5rL42_prog_map_all_post_count = length(X5rL42_prog_map_all_df$post)
X5rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X5rL42_prog_map_all_min_post_counts = min(X5rL42_prog_map_all_df$post)
X5rL42_prog_map_all_min_post_counts
X5rL42_prog_map_all_max_post_counts = max(X5rL42_prog_map_all_df$post)
X5rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X5rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X5rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X5rL42_prog_map_all_syn_df <- X5rL42_prog_map_all_df[which(X5rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X5rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X5rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X5rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X5rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X5rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X5rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X5rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X5rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X5rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X5rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X5rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X5rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X5rL42_prog_map_all_min_rna_counts = min(X5rL42_prog_map_exon_all_df$tHDR_rna)
X5rL42_prog_map_all_min_rna_counts
X5rL42_prog_map_all_max_rna_counts = max(X5rL42_prog_map_exon_all_df$tHDR_rna)
X5rL42_prog_map_all_max_rna_counts
X5rL42_prog_map_all_min_rna_pseudo_freq = min(X5rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5rL42_prog_map_all_min_rna_pseudo_freq
X5rL42_prog_map_all_max_rna_pseudo_freq = max(X5rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X5rL42_prog_map_all_max_rna_pseudo_freq
X5rL42_prog_map_all_min_rna_pre_ratio = min(X5rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5rL42_prog_map_all_min_rna_pre_ratio
X5rL42_prog_map_all_max_rna_pre_ratio = max(X5rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X5rL42_prog_map_all_max_rna_pre_ratio
X5rL42_prog_map_all_min_rna_post_ratio = min(X5rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5rL42_prog_map_all_min_rna_post_ratio
X5rL42_prog_map_all_max_rna_post_ratio = max(X5rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X5rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X5rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X5rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X5rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X5rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X5rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X5rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X5rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X5rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X5rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X5rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X5rL42_prog_map_all_df$post_pre_ratio),log2(X5rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X5rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X5rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X5rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X5rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X5rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X5rL42_cSNV_all_corr_pre_count = length(X5rL42_cSNV_all_df$corr_pre)
X5rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X5rL42_cSNV_all_min_corr_pre_counts = min(X5rL42_cSNV_all_df$corr_pre)
X5rL42_cSNV_all_min_corr_pre_counts
X5rL42_cSNV_all_max_corr_pre_counts = max(X5rL42_cSNV_all_df$corr_pre)
X5rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X5rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X5rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X5rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X5rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X5rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_cSNV_all_corr_post_count = length(X5rL42_cSNV_all_df$corr_post)
X5rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X5rL42_cSNV_all_min_corr_post_counts = min(X5rL42_cSNV_all_df$corr_post)
X5rL42_cSNV_all_min_corr_post_counts
X5rL42_cSNV_all_max_corr_post_counts = max(X5rL42_cSNV_all_df$corr_post)
X5rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X5rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X5rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X5rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X5rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X5rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X5rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X5_p_hdr_snv = paste('p_hdr_',X5_cut_end,'_snv',sep='')
X5rL42_pSNV_all <- which(X5rL42[,X5_p_hdr_snv]=='True')
X5rL42_pSNV_all_df = X5rL42[X5rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_pSNV_all_lib_count = length(X5rL42_pSNV_all_df$lib)
X5rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X5rL42_pSNV_all_min_lib_counts = min(X5rL42_pSNV_all_df$lib)
X5rL42_pSNV_all_min_lib_counts
X5rL42_pSNV_all_max_lib_counts = max(X5rL42_pSNV_all_df$lib)
X5rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X5rL42_pSNV_all_pre_count = length(X5rL42_pSNV_all_df$pre)
X5rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X5rL42_pSNV_all_min_pre_counts = min(X5rL42_pSNV_all_df$pre)
X5rL42_pSNV_all_min_pre_counts
X5rL42_pSNV_all_max_pre_counts = max(X5rL42_pSNV_all_df$pre)
X5rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X5rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X5rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_pSNV_all_post_count = length(X5rL42_pSNV_all_df$post)
X5rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X5rL42_pSNV_all_min_post_counts = min(X5rL42_pSNV_all_df$post)
X5rL42_pSNV_all_min_post_counts
X5rL42_pSNV_all_max_post_counts = max(X5rL42_pSNV_all_df$post)
X5rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X5rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X5rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_prog_map_thresh5_lib_count = length(X5rL42_prog_map_thresh5_df$lib)
X5rL42_prog_map_thresh5_lib_count
X5rL42_prog_map_thresh5_min_lib_counts = min(X5rL42_prog_map_thresh5_df$lib)
X5rL42_prog_map_thresh5_min_lib_counts
X5rL42_prog_map_thresh5_max_lib_counts = max(X5rL42_prog_map_thresh5_df$lib)
X5rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X5rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X5rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_prog_map_thresh5_pre_count = length(X5rL42_prog_map_thresh5_df$pre)
X5rL42_prog_map_thresh5_pre_count
X5rL42_prog_map_thresh5_min_pre_counts = min(X5rL42_prog_map_thresh5_df$pre)
X5rL42_prog_map_thresh5_min_pre_counts
X5rL42_prog_map_thresh5_max_pre_counts = max(X5rL42_prog_map_thresh5_df$pre)
X5rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X5 less than SGE region length x 3 due to PAM edits
X5rL42_prog_map_thresh5_post_count = length(X5rL42_prog_map_thresh5_df$post)
X5rL42_prog_map_thresh5_post_count
X5rL42_prog_map_thresh5_min_post_counts = min(X5rL42_prog_map_thresh5_df$post)
X5rL42_prog_map_thresh5_min_post_counts
X5rL42_prog_map_thresh5_max_post_counts = max(X5rL42_prog_map_thresh5_df$post)
X5rL42_prog_map_thresh5_max_post_counts
X5rL42_prog_map_thresh5_corr_post_count = length(X5rL42_prog_map_thresh5_df$corr_post)
X5rL42_prog_map_thresh5_corr_post_count
X5rL42_prog_map_thresh5_min_corr_post_counts = min(X5rL42_prog_map_thresh5_df$corr_post)
X5rL42_prog_map_thresh5_min_corr_post_counts
X5rL42_prog_map_thresh5_max_corr_post_counts = max(X5rL42_prog_map_thresh5_df$corr_post)
X5rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X5rL42_pSNV_thresh5 <- which(X5rL42[,X5_p_hdr_snv]=='True' & as.numeric(as.character(X5rL42[,'pre_freq']))>=0.00001)
X5rL42_pSNV_thresh5_df = X5rL42[X5rL42_pSNV_thresh5,]
X5rL42_pSNV_thresh5_lib_count = length(X5rL42_pSNV_thresh5_df$lib)
X5rL42_pSNV_thresh5_lib_count
X5rL42_pSNV_thresh5_min_lib_counts = min(X5rL42_pSNV_thresh5_df$lib)
X5rL42_pSNV_thresh5_min_lib_counts
X5rL42_pSNV_thresh5_max_lib_counts = max(X5rL42_pSNV_thresh5_df$lib)
X5rL42_pSNV_thresh5_max_lib_counts
X5rL42_pSNV_thresh5_pre_count = length(X5rL42_pSNV_thresh5_df$pre)
X5rL42_pSNV_thresh5_pre_count
X5rL42_pSNV_thresh5_min_pre_counts = min(X5rL42_pSNV_thresh5_df$pre)
X5rL42_pSNV_thresh5_min_pre_counts
X5rL42_pSNV_thresh5_max_pre_counts = max(X5rL42_pSNV_thresh5_df$pre)
X5rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X5rL42_pSNV_thresh5_post_count = length(X5rL42_pSNV_thresh5_df$post)
X5rL42_pSNV_thresh5_post_count
X5rL42_pSNV_thresh5_min_post_counts = min(X5rL42_pSNV_thresh5_df$post)
X5rL42_pSNV_thresh5_min_post_counts
X5rL42_pSNV_thresh5_max_post_counts = max(X5rL42_pSNV_thresh5_df$post)
X5rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X5rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X5rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X5rL41_prog_var_thresh5_df:
X5rL41_prog_var_thresh5_df_rL42_int <- X5rL41_prog_var_thresh5_df[which(X5rL41_prog_var_thresh5_df$variant %in% X5rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X5rL42_prog_var_thresh5_df:
X5rL42_prog_var_thresh5_df_rL41_int <- X5rL42_prog_var_thresh5_df[which(X5rL42_prog_var_thresh5_df$variant %in% X5rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X5rL41_prog_var_thresh5_df_rL42_int_ord <- X5rL41_prog_var_thresh5_df_rL42_int[order(X5rL41_prog_var_thresh5_df_rL42_int$variant),]
X5rL42_prog_var_thresh5_df_rL41_int_ord <- X5rL42_prog_var_thresh5_df_rL41_int[order(X5rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X5rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X5rL41rL42int_prog_var_thresh5_pre_count <- dim(X5rL41_prog_var_thresh5_df_rL42_int)[1] 
X5rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X5rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X5rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X5rL42_prog_var_thresh5_df_rL41_int_ord$lib
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X5rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X5rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X5rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X5rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X5rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X5rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X5rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X5rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X5rL41_cSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X5rL41_cSNV_missense_post_pre_med <- unname(X5rL41_cSNV_missense_post_pre_quarts[3])
X5rL41_cSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X5rL41_cSNV_syn_post_pre_med <- unname(X5rL41_cSNV_syn_post_pre_quarts[3])
X5rL41_cSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X5rL41_cSNV_nonsense_post_pre_med <- unname(X5rL41_cSNV_nonsense_post_pre_quarts[3])
X5rL41_cSNV_syn_to_non_post_pre_spread <- X5rL41_cSNV_syn_post_pre_med - X5rL41_cSNV_nonsense_post_pre_med

X5rL42_cSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X5rL42_cSNV_missense_post_pre_med <- unname(X5rL42_cSNV_missense_post_pre_quarts[3])
X5rL42_cSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X5rL42_cSNV_syn_post_pre_med <- unname(X5rL42_cSNV_syn_post_pre_quarts[3])
X5rL42_cSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X5rL42_cSNV_nonsense_post_pre_med <- unname(X5rL42_cSNV_nonsense_post_pre_quarts[3])
X5rL42_cSNV_syn_to_non_post_pre_spread <- X5rL42_cSNV_syn_post_pre_med - X5rL42_cSNV_nonsense_post_pre_med

X5rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_missense_post_pre_med <- unname(X5rL41rL42a_cSNV_missense_post_pre_quarts[3])
X5rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_syn_post_pre_med <- unname(X5rL41rL42a_cSNV_syn_post_pre_quarts[3])
X5rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X5rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X5rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X5rL41rL42a_cSNV_syn_post_pre_med - X5rL41rL42a_cSNV_nonsense_post_pre_med

X5rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_cSNV_missense_post_pre_med <- unname(X5rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X5rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_cSNV_syn_post_pre_med <- unname(X5rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X5rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X5rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X5rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X5rL41rL42pw_cSNV_syn_post_pre_med - X5rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X5rL41_tSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X5rL41_tSNV_missense_post_pre_med <- unname(X5rL41_tSNV_missense_post_pre_quarts[3])
X5rL41_tSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X5rL41_tSNV_syn_post_pre_med <- unname(X5rL41_tSNV_syn_post_pre_quarts[3])
X5rL41_tSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X5rL41_tSNV_nonsense_post_pre_med <- unname(X5rL41_tSNV_nonsense_post_pre_quarts[3])
X5rL41_tSNV_syn_to_non_post_pre_spread <- X5rL41_tSNV_syn_post_pre_med - X5rL41_tSNV_nonsense_post_pre_med

X5rL42_tSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X5rL42_tSNV_missense_post_pre_med <- unname(X5rL42_tSNV_missense_post_pre_quarts[3])
X5rL42_tSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X5rL42_tSNV_syn_post_pre_med <- unname(X5rL42_tSNV_syn_post_pre_quarts[3])
X5rL42_tSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X5rL42_tSNV_nonsense_post_pre_med <- unname(X5rL42_tSNV_nonsense_post_pre_quarts[3])
X5rL42_tSNV_syn_to_non_post_pre_spread <- X5rL42_tSNV_syn_post_pre_med - X5rL42_tSNV_nonsense_post_pre_med

X5rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_missense_post_pre_med <- unname(X5rL41rL42a_tSNV_missense_post_pre_quarts[3])
X5rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_syn_post_pre_med <- unname(X5rL41rL42a_tSNV_syn_post_pre_quarts[3])
X5rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X5rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X5rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X5rL41rL42a_tSNV_syn_post_pre_med - X5rL41rL42a_tSNV_nonsense_post_pre_med

X5rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_tSNV_missense_post_pre_med <- unname(X5rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X5rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_tSNV_syn_post_pre_med <- unname(X5rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X5rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X5rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X5rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X5rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X5rL41rL42pw_tSNV_syn_post_pre_med - X5rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X5rL41_cSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X5rL41_cSNV_missense_post_lib_med <- unname(X5rL41_cSNV_missense_post_lib_quarts[3])
X5rL41_cSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X5rL41_cSNV_syn_post_lib_med <- unname(X5rL41_cSNV_syn_post_lib_quarts[3])
X5rL41_cSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X5rL41_cSNV_nonsense_post_lib_med <- unname(X5rL41_cSNV_nonsense_post_lib_quarts[3])
X5rL41_cSNV_syn_to_non_post_lib_spread <- X5rL41_cSNV_syn_post_lib_med - X5rL41_cSNV_nonsense_post_lib_med

X5rL42_cSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X5rL42_cSNV_missense_post_lib_med <- unname(X5rL42_cSNV_missense_post_lib_quarts[3])
X5rL42_cSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X5rL42_cSNV_syn_post_lib_med <- unname(X5rL42_cSNV_syn_post_lib_quarts[3])
X5rL42_cSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X5rL42_cSNV_nonsense_post_lib_med <- unname(X5rL42_cSNV_nonsense_post_lib_quarts[3])
X5rL42_cSNV_syn_to_non_post_lib_spread <- X5rL42_cSNV_syn_post_lib_med - X5rL42_cSNV_nonsense_post_lib_med

X5rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_missense_post_lib_med <- unname(X5rL41rL42a_cSNV_missense_post_lib_quarts[3])
X5rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_syn_post_lib_med <- unname(X5rL41rL42a_cSNV_syn_post_lib_quarts[3])
X5rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X5rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X5rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X5rL41rL42a_cSNV_syn_post_lib_med - X5rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X5rL41_tSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X5rL41_tSNV_missense_post_lib_med <- unname(X5rL41_tSNV_missense_post_lib_quarts[3])
X5rL41_tSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X5rL41_tSNV_syn_post_lib_med <- unname(X5rL41_tSNV_syn_post_lib_quarts[3])
X5rL41_tSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X5rL41_tSNV_nonsense_post_lib_med <- unname(X5rL41_tSNV_nonsense_post_lib_quarts[3])
X5rL41_tSNV_syn_to_non_post_lib_spread <- X5rL41_tSNV_syn_post_lib_med - X5rL41_tSNV_nonsense_post_lib_med

X5rL42_tSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X5rL42_tSNV_missense_post_lib_med <- unname(X5rL42_tSNV_missense_post_lib_quarts[3])
X5rL42_tSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X5rL42_tSNV_syn_post_lib_med <- unname(X5rL42_tSNV_syn_post_lib_quarts[3])
X5rL42_tSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X5rL42_tSNV_nonsense_post_lib_med <- unname(X5rL42_tSNV_nonsense_post_lib_quarts[3])
X5rL42_tSNV_syn_to_non_post_lib_spread <- X5rL42_tSNV_syn_post_lib_med - X5rL42_tSNV_nonsense_post_lib_med

X5rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_missense_post_lib_med <- unname(X5rL41rL42a_tSNV_missense_post_lib_quarts[3])
X5rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_syn_post_lib_med <- unname(X5rL41rL42a_tSNV_syn_post_lib_quarts[3])
X5rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X5rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X5rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X5rL41rL42a_tSNV_syn_post_lib_med - X5rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X5rL41_cSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X5rL41_cSNV_missense_pre_lib_med <- unname(X5rL41_cSNV_missense_pre_lib_quarts[3])
X5rL41_cSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X5rL41_cSNV_syn_pre_lib_med <- unname(X5rL41_cSNV_syn_pre_lib_quarts[3])
X5rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X5rL41_cSNV_nonsense_pre_lib_med <- unname(X5rL41_cSNV_nonsense_pre_lib_quarts[3])
X5rL41_cSNV_syn_to_non_pre_lib_spread <- X5rL41_cSNV_syn_pre_lib_med - X5rL41_cSNV_nonsense_pre_lib_med

X5rL42_cSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X5rL42_cSNV_missense_pre_lib_med <- unname(X5rL42_cSNV_missense_pre_lib_quarts[3])
X5rL42_cSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X5rL42_cSNV_syn_pre_lib_med <- unname(X5rL42_cSNV_syn_pre_lib_quarts[3])
X5rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X5rL42_cSNV_nonsense_pre_lib_med <- unname(X5rL42_cSNV_nonsense_pre_lib_quarts[3])
X5rL42_cSNV_syn_to_non_pre_lib_spread <- X5rL42_cSNV_syn_pre_lib_med - X5rL42_cSNV_nonsense_pre_lib_med

X5rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_missense_pre_lib_med <- unname(X5rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X5rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_syn_pre_lib_med <- unname(X5rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X5rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X5rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X5rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X5rL41rL42a_cSNV_syn_pre_lib_med - X5rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X5rL41_tSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X5rL41_tSNV_missense_pre_lib_med <- unname(X5rL41_tSNV_missense_pre_lib_quarts[3])
X5rL41_tSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X5rL41_tSNV_syn_pre_lib_med <- unname(X5rL41_tSNV_syn_pre_lib_quarts[3])
X5rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X5rL41_tSNV_nonsense_pre_lib_med <- unname(X5rL41_tSNV_nonsense_pre_lib_quarts[3])
X5rL41_tSNV_syn_to_non_pre_lib_spread <- X5rL41_tSNV_syn_pre_lib_med - X5rL41_tSNV_nonsense_pre_lib_med

X5rL42_tSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X5rL42_tSNV_missense_pre_lib_med <- unname(X5rL42_tSNV_missense_pre_lib_quarts[3])
X5rL42_tSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X5rL42_tSNV_syn_pre_lib_med <- unname(X5rL42_tSNV_syn_pre_lib_quarts[3])
X5rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X5rL42_tSNV_nonsense_pre_lib_med <- unname(X5rL42_tSNV_nonsense_pre_lib_quarts[3])
X5rL42_tSNV_syn_to_non_pre_lib_spread <- X5rL42_tSNV_syn_pre_lib_med - X5rL42_tSNV_nonsense_pre_lib_med

X5rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_missense_pre_lib_med <- unname(X5rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X5rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_syn_pre_lib_med <- unname(X5rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X5rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X5rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X5rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X5rL41rL42a_tSNV_syn_pre_lib_med - X5rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X5rL41_tSNV_syn_rna_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X5rL41_tSNV_syn_rna_pre_med <- unname(X5rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X5rL41_tSNV_syn_rna_post_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X5rL41_tSNV_syn_rna_post_med <- unname(X5rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X5rL42_tSNV_syn_rna_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X5rL42_tSNV_syn_rna_pre_med <- unname(X5rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X5rL42_tSNV_syn_rna_post_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X5rL42_tSNV_syn_rna_post_med <- unname(X5rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X5rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_syn_rna_pre_med <- unname(X5rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X5rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X5rL41rL42a_tSNV_syn_rna_post_med <- unname(X5rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X5rL41_cSNV_syn_pre_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X5rL41_cSNV_syn_post_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X5rL41_cSNV_syn_post_lib_med
# tHDR
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X5rL41_tSNV_syn_pre_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X5rL41_tSNV_syn_post_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X5rL41_tSNV_syn_post_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X5rL41_tSNV_syn_rna_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X5rL41_tSNV_syn_rna_post_med

#rL42
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X5rL42_cSNV_syn_pre_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X5rL42_cSNV_syn_post_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X5rL42_cSNV_syn_post_lib_med
# tHDR
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X5rL42_tSNV_syn_pre_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X5rL42_tSNV_syn_post_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X5rL42_tSNV_syn_post_lib_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X5rL42_tSNV_syn_rna_pre_med
X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X5rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X5rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X5rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X5rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X5rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X5rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X5rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X5rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X5rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X5rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X5rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X5rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X5rL41_prog_var_thresh5_df_rL42_int_ord[which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X5rL41_prog_var_thresh5_df_rL42_int_ord
X5rL41_prog_map_thresh5_df_rL42_int_ord = which(X5rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X5rL41_prog_map_thresh5_df_rL42_int_ord_df = X5rL41_prog_var_thresh5_df_rL42_int_ord[X5rL41_prog_map_thresh5_df_rL42_int_ord,]
X5rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X5rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X5rL41_prog_map_thresh5_df_rL42_int_ord_df[X5rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X5rL41_prog_map_thresh5_df_rL42_int_ord_df[X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X5rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X5rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X5rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X5rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X5rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X5rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X5rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X5rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X5rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X5rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X5rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X5rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X5rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X5rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X5rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X5rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X5rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X5rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X5rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X5rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X5rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X5rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X5rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41_cSNV_post_pre_by_cadd_cor_s
#X5rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X5rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL42_cSNV_post_pre_by_cadd_cor_s

#X5rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X5rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41_cSNV_post_lib_by_cadd_cor_s
#X5rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X5rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X5rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X5rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41_tSNV_post_pre_by_cadd_cor_s
#X5rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X5rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL42_tSNV_post_pre_by_cadd_cor_s

#X5rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X5rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41_tSNV_post_lib_by_cadd_cor_s
#X5rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X5rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X5rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X5rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X5rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X5rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X5rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X5rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X5rL41_prog_var_all_lib_count
X5rL41_prog_var_all_pre_count
X5rL42_prog_var_all_pre_count
X5rL41_prog_map_thresh5_lib_count
X5rL41_prog_map_thresh5_pre_count
X5rL42_prog_map_thresh5_pre_count
X5rL41_prog_map_thresh5_post_count
X5rL42_prog_map_thresh5_post_count
X5rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X5rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X5rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X5rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X5rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X5rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X5rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X5rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X5rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X5rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X5rL41_cSNV_post_pre_by_cadd_cor_s
X5rL42_cSNV_post_pre_by_cadd_cor_s
X5rL41_cSNV_post_lib_by_cadd_cor_s
X5rL42_cSNV_post_lib_by_cadd_cor_s
X5rL41_tSNV_post_pre_by_cadd_cor_s
X5rL42_tSNV_post_pre_by_cadd_cor_s
X5rL41_tSNV_post_lib_by_cadd_cor_s
X5rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X5rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X5rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X5rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X5rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X5rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X5rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X5rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X5rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X5rL41_cSNV_syn_to_non_post_pre_spread
X5rL42_cSNV_syn_to_non_post_pre_spread
X5rL41rL42a_cSNV_syn_to_non_post_pre_spread
X5rL41_cSNV_syn_to_non_post_lib_spread
X5rL42_cSNV_syn_to_non_post_lib_spread
X5rL41rL42a_cSNV_syn_to_non_post_lib_spread
X5rL41_tSNV_syn_to_non_post_pre_spread
X5rL42_tSNV_syn_to_non_post_pre_spread
X5rL41rL42a_tSNV_syn_to_non_post_pre_spread
X5rL41_tSNV_syn_to_non_post_lib_spread
X5rL42_tSNV_syn_to_non_post_lib_spread
X5rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X5rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X5rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X5rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X5rL41_cSNV_pre_lib_cors = cor(log2(X5rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5rL41_tSNV_pre_lib_cors = cor(log2(X5rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5rL41_cSNV_post_lib_cors = cor(log2(X5rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X5rL41_tSNV_post_lib_cors = cor(log2(X5rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X5rL41_cSNV_post_pre_cors = cor(log2(X5rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5rL41_tSNV_post_pre_cors = cor(log2(X5rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X5rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5rL41_cSNV_rna_lib_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X5rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5rL41_tSNV_rna_lib_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X5rL41_cSNV_rna_pre_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X5rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5rL41_tSNV_rna_pre_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X5rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5rL41rL42_cSNV_pre_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X5rL41rL42_tSNV_pre_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X5rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X5rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X5rL41rL42_cSNV_post_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X5rL41rL42_tSNV_post_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X5rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X5rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X5rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X5rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X5rL41rL42_cSNV_rna_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X5rL41rL42_tSNV_rna_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X5rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X5rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X5rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X5rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X5rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X5rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X5rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X5rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X5rL41_cors <- c("X5rL41",X5rL41_cSNV_pre_lib_cors,X5rL41_tSNV_pre_lib_cors,X5rL41_cSNV_post_lib_cors,X5rL41_tSNV_post_lib_cors,X5rL41_cSNV_post_pre_cors,X5rL41_tSNV_post_pre_cors,X5rL41_cSNV_rna_lib_cors,X5rL41_tSNV_rna_lib_cors,X5rL41_cSNV_rna_pre_cors,X5rL41_tSNV_rna_pre_cors,X5rL41rL42_cSNV_pre_cors,X5rL41rL42_tSNV_pre_cors,X5rL41rL42_cSNV_pre_lib_ratio_cors,X5rL41rL42_tSNV_pre_lib_ratio_cors,X5rL41rL42_cSNV_post_cors,X5rL41rL42_tSNV_post_cors,X5rL41rL42_cSNV_post_lib_ratio_cors,X5rL41rL42_tSNV_post_lib_ratio_cors,X5rL41rL42_cSNV_post_pre_ratio_cors,X5rL41rL42_tSNV_post_pre_ratio_cors,X5rL41rL42_cSNV_rna_cors,X5rL41rL42_tSNV_rna_cors,X5rL41rL42_tSNV_rna_pre_ratio_cors,X5rL41_cSNV_pre_lib_ratio_cadd_cors,X5rL41_tSNV_pre_lib_ratio_cadd_cors,X5rL41_cSNV_post_lib_ratio_cadd_cors,X5rL41_tSNV_post_lib_ratio_cadd_cors,X5rL41_cSNV_post_pre_ratio_cadd_cors,X5rL41_tSNV_post_pre_ratio_cadd_cors,X5rL41_cSNV_post_pre_ratio_cadd_missense_cors,X5rL41_tSNV_post_pre_ratio_cadd_missense_cors,X5rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X5rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X5rL41_cSNV_post_pre_ratio_grantham_missense_cors,X5rL41_tSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X5rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X5rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X5rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X5rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X5rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X5rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X5rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X5rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X5rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X5rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X5rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X5rL42_cSNV_pre_lib_cors = cor(log2(X5rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5rL42_tSNV_pre_lib_cors = cor(log2(X5rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5rL42_cSNV_post_lib_cors = cor(log2(X5rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X5rL42_tSNV_post_lib_cors = cor(log2(X5rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X5rL42_cSNV_post_pre_cors = cor(log2(X5rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X5rL42_tSNV_post_pre_cors = cor(log2(X5rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X5rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X5rL42_cSNV_rna_lib_cors = cor(log2(X5rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X5rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5rL42_tSNV_rna_lib_cors = cor(log2(X5rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X5rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X5rL42_cSNV_rna_pre_cors = cor(log2(X5rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X5rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X5rL42_tSNV_rna_pre_cors = cor(log2(X5rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X5rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X5rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X5rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X5rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X5rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X5rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X5rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X5rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X5rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X5rL42_cors <- c("X5rL42",X5rL42_cSNV_pre_lib_cors,X5rL42_tSNV_pre_lib_cors,X5rL42_cSNV_post_lib_cors,X5rL42_tSNV_post_lib_cors,X5rL42_cSNV_post_pre_cors,X5rL42_tSNV_post_pre_cors,X5rL42_cSNV_rna_lib_cors,X5rL42_tSNV_rna_lib_cors,X5rL42_cSNV_rna_pre_cors,X5rL42_tSNV_rna_pre_cors,X5rL41rL42_cSNV_pre_cors,X5rL41rL42_tSNV_pre_cors,X5rL41rL42_cSNV_pre_lib_ratio_cors,X5rL41rL42_tSNV_pre_lib_ratio_cors,X5rL41rL42_cSNV_post_cors,X5rL41rL42_tSNV_post_cors,X5rL41rL42_cSNV_post_lib_ratio_cors,X5rL41rL42_tSNV_post_lib_ratio_cors,X5rL41rL42_cSNV_post_pre_ratio_cors,X5rL41rL42_tSNV_post_pre_ratio_cors,X5rL41rL42_cSNV_rna_cors,X5rL41rL42_tSNV_rna_cors,X5rL41rL42_tSNV_rna_pre_ratio_cors,X5rL42_cSNV_pre_lib_ratio_cadd_cors,X5rL42_tSNV_pre_lib_ratio_cadd_cors,X5rL42_cSNV_post_lib_ratio_cadd_cors,X5rL42_tSNV_post_lib_ratio_cadd_cors,X5rL42_cSNV_post_pre_ratio_cadd_cors,X5rL42_tSNV_post_pre_ratio_cadd_cors,X5rL42_cSNV_post_pre_ratio_cadd_missense_cors,X5rL42_tSNV_post_pre_ratio_cadd_missense_cors,X5rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X5rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X5rL42_cSNV_post_pre_ratio_grantham_missense_cors,X5rL42_tSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X5rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X5rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X5rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X5rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X5rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X5rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X5rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X5rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X5rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X5rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X5rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X5rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X5rL41)
rm(X5rL42)
gc()
X15rL41_file <- paste(experiment_dir_170731,'X15rL41','_annotated.txt',sep='')
X15rL42_file <- paste(experiment_dir_170731,'X15rL42','_annotated.txt',sep='')
X15rL41 <- read.table(X15rL41_file, header=TRUE, sep="\t")
X15rL42 <- read.table(X15rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X15 <- editing_info[which(editing_info$amplicon == 'X15'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X15_HDR_5_SNV = as.character(editing_info_X15$HDR_5_SNV)
X15_HDR_3_SNV = as.character(editing_info_X15$HDR_3_SNV)
#X15_cut_pos = as.character(editing_info_X15$cut_pos)
X15_cut_end = as.character(editing_info_X15$cut_end)
X15_mut_start = as.character(editing_info_X15$mut_start)
X15_mut_end = as.character(editing_info_X15$mut_end)
### Replicate 1
X15rL41_cSNV_all <- which(X15rL41[,'c_hdr_snv']=='True')
X15rL41_cSNV_all_df = X15rL41[X15rL41_cSNV_all,]
X15rL41_prog_var_all <- which(X15rL41[,'all_hdr_variant']=='True' & X15rL41[,'edit_string']!='-WT')
X15rL41_prog_var_all_df = X15rL41[X15rL41_prog_var_all,]
X15rL41_prog_map_all = which(X15rL41_prog_var_all_df[,'pos']!='REF')
X15rL41_prog_map_all_df = X15rL41_prog_var_all_df[X15rL41_prog_map_all,]
X15rL41_prog_map_exon_all = which(X15rL41_prog_map_all_df[,'cDNApos']!='REF' & X15rL41_prog_map_all_df[,'cDNApos']!='NA')
X15rL41_prog_map_exon_all_df = X15rL41_prog_map_all_df[X15rL41_prog_map_exon_all,]
X15rL41_prog_map_CADD = which(X15rL41_prog_map_all_df[,'CADD.phred']!='NA')
X15rL41_prog_map_CADD_df = X15rL41_prog_map_all_df[X15rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X15rL41_prog_var_thresh5 <- which(as.numeric(as.character(X15rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X15rL41_prog_var_thresh5_df = X15rL41_prog_var_all_df[X15rL41_prog_var_thresh5,]
X15rL41_prog_map_thresh5 <- which(as.numeric(as.character(X15rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X15rL41_prog_map_thresh5_df = X15rL41_prog_map_all_df[X15rL41_prog_map_thresh5,]
X15rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X15rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X15rL41_prog_map_exon_thresh5_df = X15rL41_prog_map_exon_all_df[X15rL41_prog_map_exon_thresh5,]
X15rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X15rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X15rL41_prog_map_CADD_thresh5_df = X15rL41_prog_map_CADD_df[X15rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X15rL41_prog_var_all_lib_count = length(X15rL41_prog_var_all_df$lib)
X15rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X15rL41_prog_var_all_min_lib_counts = min(X15rL41_prog_var_all_df$lib)
X15rL41_prog_var_all_min_lib_counts
X15rL41_prog_var_all_max_lib_counts = max(X15rL41_prog_var_all_df$lib)
X15rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X15rL41_prog_map_all_lib_count = length(X15rL41_prog_map_all_df$lib)
X15rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X15rL41_prog_map_all_min_lib_counts = min(X15rL41_prog_map_all_df$lib)
X15rL41_prog_map_all_min_lib_counts
X15rL41_prog_map_all_max_lib_counts = max(X15rL41_prog_map_all_df$lib)
X15rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X15rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X15rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X15rL41_prog_var_all_pre_count = length(X15rL41_prog_var_all_df$pre)
X15rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X15rL41_prog_var_all_min_pre_counts = min(X15rL41_prog_var_all_df$pre)
X15rL41_prog_var_all_min_pre_counts
X15rL41_prog_var_all_max_pre_counts = max(X15rL41_prog_var_all_df$pre)
X15rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X15rL41_prog_map_all_pre_count = length(X15rL41_prog_map_all_df$pre)
X15rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X15rL41_prog_map_all_min_pre_counts = min(X15rL41_prog_map_all_df$pre)
X15rL41_prog_map_all_min_pre_counts
X15rL41_prog_map_all_max_pre_counts = max(X15rL41_prog_map_all_df$pre)
X15rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X15rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X15rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X15rL41_prog_map_all_post_count = length(X15rL41_prog_map_all_df$post)
X15rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X15rL41_prog_map_all_min_post_counts = min(X15rL41_prog_map_all_df$post)
X15rL41_prog_map_all_min_post_counts
X15rL41_prog_map_all_max_post_counts = max(X15rL41_prog_map_all_df$post)
X15rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X15rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X15rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X15rL41_prog_map_all_syn_df <- X15rL41_prog_map_all_df[which(X15rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X15rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X15rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X15rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X15rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X15rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X15rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X15rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X15rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X15rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X15rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X15rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X15rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X15rL41_prog_map_all_min_rna_counts = min(X15rL41_prog_map_exon_all_df$tHDR_rna)
X15rL41_prog_map_all_min_rna_counts
X15rL41_prog_map_all_max_rna_counts = max(X15rL41_prog_map_exon_all_df$tHDR_rna)
X15rL41_prog_map_all_max_rna_counts
X15rL41_prog_map_all_min_rna_pseudo_freq = min(X15rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15rL41_prog_map_all_min_rna_pseudo_freq
X15rL41_prog_map_all_max_rna_pseudo_freq = max(X15rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15rL41_prog_map_all_max_rna_pseudo_freq
X15rL41_prog_map_all_min_rna_pre_ratio = min(X15rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15rL41_prog_map_all_min_rna_pre_ratio
X15rL41_prog_map_all_max_rna_pre_ratio = max(X15rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15rL41_prog_map_all_max_rna_pre_ratio
X15rL41_prog_map_all_min_rna_post_ratio = min(X15rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15rL41_prog_map_all_min_rna_post_ratio
X15rL41_prog_map_all_max_rna_post_ratio = max(X15rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X15rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X15rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X15rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X15rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X15rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X15rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X15rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X15rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X15rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X15rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X15rL41_prog_map_all_df$post_pre_ratio),log2(X15rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X15rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X15rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X15rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X15rL41_cSNV_all_corr_pre_count = length(X15rL41_cSNV_all_df$corr_pre)
X15rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X15rL41_cSNV_all_min_corr_pre_counts = min(X15rL41_cSNV_all_df$corr_pre)
X15rL41_cSNV_all_min_corr_pre_counts
X15rL41_cSNV_all_max_corr_pre_counts = max(X15rL41_cSNV_all_df$corr_pre)
X15rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X15rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X15rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X15rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X15rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X15rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_cSNV_all_corr_post_count = length(X15rL41_cSNV_all_df$corr_post)
X15rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X15rL41_cSNV_all_min_corr_post_counts = min(X15rL41_cSNV_all_df$corr_post)
X15rL41_cSNV_all_min_corr_post_counts
X15rL41_cSNV_all_max_corr_post_counts = max(X15rL41_cSNV_all_df$corr_post)
X15rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X15rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X15rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X15rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X15rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X15rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X15rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X15_p_hdr_snv = paste('p_hdr_',X15_cut_end,'_snv',sep='')
X15rL41_pSNV_all <- which(X15rL41[,X15_p_hdr_snv]=='True')
X15rL41_pSNV_all_df = X15rL41[X15rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_pSNV_all_lib_count = length(X15rL41_pSNV_all_df$lib)
X15rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X15rL41_pSNV_all_min_lib_counts = min(X15rL41_pSNV_all_df$lib)
X15rL41_pSNV_all_min_lib_counts
X15rL41_pSNV_all_max_lib_counts = max(X15rL41_pSNV_all_df$lib)
X15rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X15rL41_pSNV_all_pre_count = length(X15rL41_pSNV_all_df$pre)
X15rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X15rL41_pSNV_all_min_pre_counts = min(X15rL41_pSNV_all_df$pre)
X15rL41_pSNV_all_min_pre_counts
X15rL41_pSNV_all_max_pre_counts = max(X15rL41_pSNV_all_df$pre)
X15rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X15rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X15rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_pSNV_all_post_count = length(X15rL41_pSNV_all_df$post)
X15rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X15rL41_pSNV_all_min_post_counts = min(X15rL41_pSNV_all_df$post)
X15rL41_pSNV_all_min_post_counts
X15rL41_pSNV_all_max_post_counts = max(X15rL41_pSNV_all_df$post)
X15rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X15rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X15rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_prog_map_thresh5_lib_count = length(X15rL41_prog_map_thresh5_df$lib)
X15rL41_prog_map_thresh5_lib_count
X15rL41_prog_map_thresh5_min_lib_counts = min(X15rL41_prog_map_thresh5_df$lib)
X15rL41_prog_map_thresh5_min_lib_counts
X15rL41_prog_map_thresh5_max_lib_counts = max(X15rL41_prog_map_thresh5_df$lib)
X15rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X15rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X15rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_prog_map_thresh5_pre_count = length(X15rL41_prog_map_thresh5_df$pre)
X15rL41_prog_map_thresh5_pre_count
X15rL41_prog_map_thresh5_min_pre_counts = min(X15rL41_prog_map_thresh5_df$pre)
X15rL41_prog_map_thresh5_min_pre_counts
X15rL41_prog_map_thresh5_max_pre_counts = max(X15rL41_prog_map_thresh5_df$pre)
X15rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL41_prog_map_thresh5_post_count = length(X15rL41_prog_map_thresh5_df$post)
X15rL41_prog_map_thresh5_post_count
X15rL41_prog_map_thresh5_min_post_counts = min(X15rL41_prog_map_thresh5_df$post)
X15rL41_prog_map_thresh5_min_post_counts
X15rL41_prog_map_thresh5_max_post_counts = max(X15rL41_prog_map_thresh5_df$post)
X15rL41_prog_map_thresh5_max_post_counts
X15rL41_prog_map_thresh5_corr_post_count = length(X15rL41_cSNV_all_df$corr_post)
X15rL41_prog_map_thresh5_corr_post_count
X15rL41_prog_map_thresh5_min_corr_post_counts = min(X15rL41_cSNV_all_df$corr_post)
X15rL41_prog_map_thresh5_min_corr_post_counts
X15rL41_prog_map_thresh5_max_corr_post_counts = max(X15rL41_cSNV_all_df$corr_post)
X15rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X15rL41_pSNV_thresh5 <- which(X15rL41[,X15_p_hdr_snv]=='True' & as.numeric(as.character(X15rL41[,'pre_freq']))>=0.00001)
X15rL41_pSNV_thresh5_df = X15rL41[X15rL41_pSNV_thresh5,]
X15rL41_pSNV_thresh5_lib_count = length(X15rL41_pSNV_thresh5_df$lib)
X15rL41_pSNV_thresh5_lib_count
X15rL41_pSNV_thresh5_min_lib_counts = min(X15rL41_pSNV_thresh5_df$lib)
X15rL41_pSNV_thresh5_min_lib_counts
X15rL41_pSNV_thresh5_max_lib_counts = max(X15rL41_pSNV_thresh5_df$lib)
X15rL41_pSNV_thresh5_max_lib_counts
X15rL41_pSNV_thresh5_pre_count = length(X15rL41_pSNV_thresh5_df$pre)
X15rL41_pSNV_thresh5_pre_count
X15rL41_pSNV_thresh5_min_pre_counts = min(X15rL41_pSNV_thresh5_df$pre)
X15rL41_pSNV_thresh5_min_pre_counts
X15rL41_pSNV_thresh5_max_pre_counts = max(X15rL41_pSNV_thresh5_df$pre)
X15rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X15rL41_pSNV_thresh5_post_count = length(X15rL41_pSNV_thresh5_df$post)
X15rL41_pSNV_thresh5_post_count
X15rL41_pSNV_thresh5_min_post_counts = min(X15rL41_pSNV_thresh5_df$post)
X15rL41_pSNV_thresh5_min_post_counts
X15rL41_pSNV_thresh5_max_post_counts = max(X15rL41_pSNV_thresh5_df$post)
X15rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X15rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X15rL41_pSNV_thresh5_post_pos

### Replicate 2
X15rL42_cSNV_all <- which(X15rL42[,'c_hdr_snv']=='True')
X15rL42_cSNV_all_df = X15rL42[X15rL42_cSNV_all,]
X15rL42_prog_var_all <- which(X15rL42[,'all_hdr_variant']=='True' & X15rL42[,'edit_string']!='-WT')
X15rL42_prog_var_all_df = X15rL42[X15rL42_prog_var_all,]
X15rL42_prog_map_all = which(X15rL42_prog_var_all_df[,'pos']!='REF')
X15rL42_prog_map_all_df = X15rL42_prog_var_all_df[X15rL42_prog_map_all,]
X15rL42_prog_map_exon_all = which(X15rL42_prog_map_all_df[,'cDNApos']!='REF' & X15rL42_prog_map_all_df[,'cDNApos']!='NA')
X15rL42_prog_map_exon_all_df = X15rL42_prog_map_all_df[X15rL42_prog_map_exon_all,]
X15rL42_prog_map_CADD = which(X15rL42_prog_map_all_df[,'CADD.phred']!='NA')
X15rL42_prog_map_CADD_df = X15rL42_prog_map_all_df[X15rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X15rL42_prog_var_thresh5 <- which(as.numeric(as.character(X15rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X15rL42_prog_var_thresh5_df = X15rL42_prog_var_all_df[X15rL42_prog_var_thresh5,]
X15rL42_prog_map_thresh5 <- which(as.numeric(as.character(X15rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X15rL42_prog_map_thresh5_df = X15rL42_prog_map_all_df[X15rL42_prog_map_thresh5,]
X15rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X15rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X15rL42_prog_map_exon_thresh5_df = X15rL42_prog_map_exon_all_df[X15rL42_prog_map_exon_thresh5,]
X15rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X15rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X15rL42_prog_map_CADD_thresh5_df = X15rL42_prog_map_CADD_df[X15rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X15rL42_prog_var_all_lib_count = length(X15rL42_prog_var_all_df$lib)
X15rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X15rL42_prog_var_all_min_lib_counts = min(X15rL42_prog_var_all_df$lib)
X15rL42_prog_var_all_min_lib_counts
X15rL42_prog_var_all_max_lib_counts = max(X15rL42_prog_var_all_df$lib)
X15rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X15rL42_prog_map_all_lib_count = length(X15rL42_prog_map_all_df$lib)
X15rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X15rL42_prog_map_all_min_lib_counts = min(X15rL42_prog_map_all_df$lib)
X15rL42_prog_map_all_min_lib_counts
X15rL42_prog_map_all_max_lib_counts = max(X15rL42_prog_map_all_df$lib)
X15rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X15rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X15rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X15rL42_prog_var_all_pre_count = length(X15rL42_prog_var_all_df$pre)
X15rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X15rL42_prog_var_all_min_pre_counts = min(X15rL42_prog_var_all_df$pre)
X15rL42_prog_var_all_min_pre_counts
X15rL42_prog_var_all_max_pre_counts = max(X15rL42_prog_var_all_df$pre)
X15rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X15rL42_prog_map_all_pre_count = length(X15rL42_prog_map_all_df$pre)
X15rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X15rL42_prog_map_all_min_pre_counts = min(X15rL42_prog_map_all_df$pre)
X15rL42_prog_map_all_min_pre_counts
X15rL42_prog_map_all_max_pre_counts = max(X15rL42_prog_map_all_df$pre)
X15rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X15rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X15rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X15rL42_prog_map_all_post_count = length(X15rL42_prog_map_all_df$post)
X15rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X15rL42_prog_map_all_min_post_counts = min(X15rL42_prog_map_all_df$post)
X15rL42_prog_map_all_min_post_counts
X15rL42_prog_map_all_max_post_counts = max(X15rL42_prog_map_all_df$post)
X15rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X15rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X15rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X15rL42_prog_map_all_syn_df <- X15rL42_prog_map_all_df[which(X15rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X15rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X15rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X15rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X15rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X15rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X15rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X15rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X15rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X15rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X15rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X15rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X15rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X15rL42_prog_map_all_min_rna_counts = min(X15rL42_prog_map_exon_all_df$tHDR_rna)
X15rL42_prog_map_all_min_rna_counts
X15rL42_prog_map_all_max_rna_counts = max(X15rL42_prog_map_exon_all_df$tHDR_rna)
X15rL42_prog_map_all_max_rna_counts
X15rL42_prog_map_all_min_rna_pseudo_freq = min(X15rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15rL42_prog_map_all_min_rna_pseudo_freq
X15rL42_prog_map_all_max_rna_pseudo_freq = max(X15rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X15rL42_prog_map_all_max_rna_pseudo_freq
X15rL42_prog_map_all_min_rna_pre_ratio = min(X15rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15rL42_prog_map_all_min_rna_pre_ratio
X15rL42_prog_map_all_max_rna_pre_ratio = max(X15rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X15rL42_prog_map_all_max_rna_pre_ratio
X15rL42_prog_map_all_min_rna_post_ratio = min(X15rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15rL42_prog_map_all_min_rna_post_ratio
X15rL42_prog_map_all_max_rna_post_ratio = max(X15rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X15rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X15rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X15rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X15rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X15rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X15rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X15rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X15rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X15rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X15rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X15rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X15rL42_prog_map_all_df$post_pre_ratio),log2(X15rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X15rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X15rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X15rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X15rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X15rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X15rL42_cSNV_all_corr_pre_count = length(X15rL42_cSNV_all_df$corr_pre)
X15rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X15rL42_cSNV_all_min_corr_pre_counts = min(X15rL42_cSNV_all_df$corr_pre)
X15rL42_cSNV_all_min_corr_pre_counts
X15rL42_cSNV_all_max_corr_pre_counts = max(X15rL42_cSNV_all_df$corr_pre)
X15rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X15rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X15rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X15rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X15rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X15rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_cSNV_all_corr_post_count = length(X15rL42_cSNV_all_df$corr_post)
X15rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X15rL42_cSNV_all_min_corr_post_counts = min(X15rL42_cSNV_all_df$corr_post)
X15rL42_cSNV_all_min_corr_post_counts
X15rL42_cSNV_all_max_corr_post_counts = max(X15rL42_cSNV_all_df$corr_post)
X15rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X15rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X15rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X15rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X15rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X15rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X15rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X15_p_hdr_snv = paste('p_hdr_',X15_cut_end,'_snv',sep='')
X15rL42_pSNV_all <- which(X15rL42[,X15_p_hdr_snv]=='True')
X15rL42_pSNV_all_df = X15rL42[X15rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_pSNV_all_lib_count = length(X15rL42_pSNV_all_df$lib)
X15rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X15rL42_pSNV_all_min_lib_counts = min(X15rL42_pSNV_all_df$lib)
X15rL42_pSNV_all_min_lib_counts
X15rL42_pSNV_all_max_lib_counts = max(X15rL42_pSNV_all_df$lib)
X15rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X15rL42_pSNV_all_pre_count = length(X15rL42_pSNV_all_df$pre)
X15rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X15rL42_pSNV_all_min_pre_counts = min(X15rL42_pSNV_all_df$pre)
X15rL42_pSNV_all_min_pre_counts
X15rL42_pSNV_all_max_pre_counts = max(X15rL42_pSNV_all_df$pre)
X15rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X15rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X15rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_pSNV_all_post_count = length(X15rL42_pSNV_all_df$post)
X15rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X15rL42_pSNV_all_min_post_counts = min(X15rL42_pSNV_all_df$post)
X15rL42_pSNV_all_min_post_counts
X15rL42_pSNV_all_max_post_counts = max(X15rL42_pSNV_all_df$post)
X15rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X15rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X15rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_prog_map_thresh5_lib_count = length(X15rL42_prog_map_thresh5_df$lib)
X15rL42_prog_map_thresh5_lib_count
X15rL42_prog_map_thresh5_min_lib_counts = min(X15rL42_prog_map_thresh5_df$lib)
X15rL42_prog_map_thresh5_min_lib_counts
X15rL42_prog_map_thresh5_max_lib_counts = max(X15rL42_prog_map_thresh5_df$lib)
X15rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X15rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X15rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_prog_map_thresh5_pre_count = length(X15rL42_prog_map_thresh5_df$pre)
X15rL42_prog_map_thresh5_pre_count
X15rL42_prog_map_thresh5_min_pre_counts = min(X15rL42_prog_map_thresh5_df$pre)
X15rL42_prog_map_thresh5_min_pre_counts
X15rL42_prog_map_thresh5_max_pre_counts = max(X15rL42_prog_map_thresh5_df$pre)
X15rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X15 less than SGE region length x 3 due to PAM edits
X15rL42_prog_map_thresh5_post_count = length(X15rL42_prog_map_thresh5_df$post)
X15rL42_prog_map_thresh5_post_count
X15rL42_prog_map_thresh5_min_post_counts = min(X15rL42_prog_map_thresh5_df$post)
X15rL42_prog_map_thresh5_min_post_counts
X15rL42_prog_map_thresh5_max_post_counts = max(X15rL42_prog_map_thresh5_df$post)
X15rL42_prog_map_thresh5_max_post_counts
X15rL42_prog_map_thresh5_corr_post_count = length(X15rL42_prog_map_thresh5_df$corr_post)
X15rL42_prog_map_thresh5_corr_post_count
X15rL42_prog_map_thresh5_min_corr_post_counts = min(X15rL42_prog_map_thresh5_df$corr_post)
X15rL42_prog_map_thresh5_min_corr_post_counts
X15rL42_prog_map_thresh5_max_corr_post_counts = max(X15rL42_prog_map_thresh5_df$corr_post)
X15rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X15rL42_pSNV_thresh5 <- which(X15rL42[,X15_p_hdr_snv]=='True' & as.numeric(as.character(X15rL42[,'pre_freq']))>=0.00001)
X15rL42_pSNV_thresh5_df = X15rL42[X15rL42_pSNV_thresh5,]
X15rL42_pSNV_thresh5_lib_count = length(X15rL42_pSNV_thresh5_df$lib)
X15rL42_pSNV_thresh5_lib_count
X15rL42_pSNV_thresh5_min_lib_counts = min(X15rL42_pSNV_thresh5_df$lib)
X15rL42_pSNV_thresh5_min_lib_counts
X15rL42_pSNV_thresh5_max_lib_counts = max(X15rL42_pSNV_thresh5_df$lib)
X15rL42_pSNV_thresh5_max_lib_counts
X15rL42_pSNV_thresh5_pre_count = length(X15rL42_pSNV_thresh5_df$pre)
X15rL42_pSNV_thresh5_pre_count
X15rL42_pSNV_thresh5_min_pre_counts = min(X15rL42_pSNV_thresh5_df$pre)
X15rL42_pSNV_thresh5_min_pre_counts
X15rL42_pSNV_thresh5_max_pre_counts = max(X15rL42_pSNV_thresh5_df$pre)
X15rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X15rL42_pSNV_thresh5_post_count = length(X15rL42_pSNV_thresh5_df$post)
X15rL42_pSNV_thresh5_post_count
X15rL42_pSNV_thresh5_min_post_counts = min(X15rL42_pSNV_thresh5_df$post)
X15rL42_pSNV_thresh5_min_post_counts
X15rL42_pSNV_thresh5_max_post_counts = max(X15rL42_pSNV_thresh5_df$post)
X15rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X15rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X15rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X15rL41_prog_var_thresh5_df:
X15rL41_prog_var_thresh5_df_rL42_int <- X15rL41_prog_var_thresh5_df[which(X15rL41_prog_var_thresh5_df$variant %in% X15rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X15rL42_prog_var_thresh5_df:
X15rL42_prog_var_thresh5_df_rL41_int <- X15rL42_prog_var_thresh5_df[which(X15rL42_prog_var_thresh5_df$variant %in% X15rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X15rL41_prog_var_thresh5_df_rL42_int_ord <- X15rL41_prog_var_thresh5_df_rL42_int[order(X15rL41_prog_var_thresh5_df_rL42_int$variant),]
X15rL42_prog_var_thresh5_df_rL41_int_ord <- X15rL42_prog_var_thresh5_df_rL41_int[order(X15rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X15rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X15rL41rL42int_prog_var_thresh5_pre_count <- dim(X15rL41_prog_var_thresh5_df_rL42_int)[1] 
X15rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X15rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X15rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X15rL42_prog_var_thresh5_df_rL41_int_ord$lib
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X15rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X15rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X15rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X15rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X15rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X15rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X15rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X15rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X15rL41_cSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X15rL41_cSNV_missense_post_pre_med <- unname(X15rL41_cSNV_missense_post_pre_quarts[3])
X15rL41_cSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X15rL41_cSNV_syn_post_pre_med <- unname(X15rL41_cSNV_syn_post_pre_quarts[3])
X15rL41_cSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X15rL41_cSNV_nonsense_post_pre_med <- unname(X15rL41_cSNV_nonsense_post_pre_quarts[3])
X15rL41_cSNV_syn_to_non_post_pre_spread <- X15rL41_cSNV_syn_post_pre_med - X15rL41_cSNV_nonsense_post_pre_med

X15rL42_cSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X15rL42_cSNV_missense_post_pre_med <- unname(X15rL42_cSNV_missense_post_pre_quarts[3])
X15rL42_cSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X15rL42_cSNV_syn_post_pre_med <- unname(X15rL42_cSNV_syn_post_pre_quarts[3])
X15rL42_cSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X15rL42_cSNV_nonsense_post_pre_med <- unname(X15rL42_cSNV_nonsense_post_pre_quarts[3])
X15rL42_cSNV_syn_to_non_post_pre_spread <- X15rL42_cSNV_syn_post_pre_med - X15rL42_cSNV_nonsense_post_pre_med

X15rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_missense_post_pre_med <- unname(X15rL41rL42a_cSNV_missense_post_pre_quarts[3])
X15rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_syn_post_pre_med <- unname(X15rL41rL42a_cSNV_syn_post_pre_quarts[3])
X15rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X15rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X15rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X15rL41rL42a_cSNV_syn_post_pre_med - X15rL41rL42a_cSNV_nonsense_post_pre_med

X15rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_cSNV_missense_post_pre_med <- unname(X15rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X15rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_cSNV_syn_post_pre_med <- unname(X15rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X15rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X15rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X15rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X15rL41rL42pw_cSNV_syn_post_pre_med - X15rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X15rL41_tSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X15rL41_tSNV_missense_post_pre_med <- unname(X15rL41_tSNV_missense_post_pre_quarts[3])
X15rL41_tSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X15rL41_tSNV_syn_post_pre_med <- unname(X15rL41_tSNV_syn_post_pre_quarts[3])
X15rL41_tSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X15rL41_tSNV_nonsense_post_pre_med <- unname(X15rL41_tSNV_nonsense_post_pre_quarts[3])
X15rL41_tSNV_syn_to_non_post_pre_spread <- X15rL41_tSNV_syn_post_pre_med - X15rL41_tSNV_nonsense_post_pre_med

X15rL42_tSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X15rL42_tSNV_missense_post_pre_med <- unname(X15rL42_tSNV_missense_post_pre_quarts[3])
X15rL42_tSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X15rL42_tSNV_syn_post_pre_med <- unname(X15rL42_tSNV_syn_post_pre_quarts[3])
X15rL42_tSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X15rL42_tSNV_nonsense_post_pre_med <- unname(X15rL42_tSNV_nonsense_post_pre_quarts[3])
X15rL42_tSNV_syn_to_non_post_pre_spread <- X15rL42_tSNV_syn_post_pre_med - X15rL42_tSNV_nonsense_post_pre_med

X15rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_missense_post_pre_med <- unname(X15rL41rL42a_tSNV_missense_post_pre_quarts[3])
X15rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_syn_post_pre_med <- unname(X15rL41rL42a_tSNV_syn_post_pre_quarts[3])
X15rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X15rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X15rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X15rL41rL42a_tSNV_syn_post_pre_med - X15rL41rL42a_tSNV_nonsense_post_pre_med

X15rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_tSNV_missense_post_pre_med <- unname(X15rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X15rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_tSNV_syn_post_pre_med <- unname(X15rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X15rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X15rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X15rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X15rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X15rL41rL42pw_tSNV_syn_post_pre_med - X15rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X15rL41_cSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X15rL41_cSNV_missense_post_lib_med <- unname(X15rL41_cSNV_missense_post_lib_quarts[3])
X15rL41_cSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X15rL41_cSNV_syn_post_lib_med <- unname(X15rL41_cSNV_syn_post_lib_quarts[3])
X15rL41_cSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X15rL41_cSNV_nonsense_post_lib_med <- unname(X15rL41_cSNV_nonsense_post_lib_quarts[3])
X15rL41_cSNV_syn_to_non_post_lib_spread <- X15rL41_cSNV_syn_post_lib_med - X15rL41_cSNV_nonsense_post_lib_med

X15rL42_cSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X15rL42_cSNV_missense_post_lib_med <- unname(X15rL42_cSNV_missense_post_lib_quarts[3])
X15rL42_cSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X15rL42_cSNV_syn_post_lib_med <- unname(X15rL42_cSNV_syn_post_lib_quarts[3])
X15rL42_cSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X15rL42_cSNV_nonsense_post_lib_med <- unname(X15rL42_cSNV_nonsense_post_lib_quarts[3])
X15rL42_cSNV_syn_to_non_post_lib_spread <- X15rL42_cSNV_syn_post_lib_med - X15rL42_cSNV_nonsense_post_lib_med

X15rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_missense_post_lib_med <- unname(X15rL41rL42a_cSNV_missense_post_lib_quarts[3])
X15rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_syn_post_lib_med <- unname(X15rL41rL42a_cSNV_syn_post_lib_quarts[3])
X15rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X15rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X15rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X15rL41rL42a_cSNV_syn_post_lib_med - X15rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X15rL41_tSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X15rL41_tSNV_missense_post_lib_med <- unname(X15rL41_tSNV_missense_post_lib_quarts[3])
X15rL41_tSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X15rL41_tSNV_syn_post_lib_med <- unname(X15rL41_tSNV_syn_post_lib_quarts[3])
X15rL41_tSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X15rL41_tSNV_nonsense_post_lib_med <- unname(X15rL41_tSNV_nonsense_post_lib_quarts[3])
X15rL41_tSNV_syn_to_non_post_lib_spread <- X15rL41_tSNV_syn_post_lib_med - X15rL41_tSNV_nonsense_post_lib_med

X15rL42_tSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X15rL42_tSNV_missense_post_lib_med <- unname(X15rL42_tSNV_missense_post_lib_quarts[3])
X15rL42_tSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X15rL42_tSNV_syn_post_lib_med <- unname(X15rL42_tSNV_syn_post_lib_quarts[3])
X15rL42_tSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X15rL42_tSNV_nonsense_post_lib_med <- unname(X15rL42_tSNV_nonsense_post_lib_quarts[3])
X15rL42_tSNV_syn_to_non_post_lib_spread <- X15rL42_tSNV_syn_post_lib_med - X15rL42_tSNV_nonsense_post_lib_med

X15rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_missense_post_lib_med <- unname(X15rL41rL42a_tSNV_missense_post_lib_quarts[3])
X15rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_syn_post_lib_med <- unname(X15rL41rL42a_tSNV_syn_post_lib_quarts[3])
X15rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X15rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X15rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X15rL41rL42a_tSNV_syn_post_lib_med - X15rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X15rL41_cSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X15rL41_cSNV_missense_pre_lib_med <- unname(X15rL41_cSNV_missense_pre_lib_quarts[3])
X15rL41_cSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X15rL41_cSNV_syn_pre_lib_med <- unname(X15rL41_cSNV_syn_pre_lib_quarts[3])
X15rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X15rL41_cSNV_nonsense_pre_lib_med <- unname(X15rL41_cSNV_nonsense_pre_lib_quarts[3])
X15rL41_cSNV_syn_to_non_pre_lib_spread <- X15rL41_cSNV_syn_pre_lib_med - X15rL41_cSNV_nonsense_pre_lib_med

X15rL42_cSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X15rL42_cSNV_missense_pre_lib_med <- unname(X15rL42_cSNV_missense_pre_lib_quarts[3])
X15rL42_cSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X15rL42_cSNV_syn_pre_lib_med <- unname(X15rL42_cSNV_syn_pre_lib_quarts[3])
X15rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X15rL42_cSNV_nonsense_pre_lib_med <- unname(X15rL42_cSNV_nonsense_pre_lib_quarts[3])
X15rL42_cSNV_syn_to_non_pre_lib_spread <- X15rL42_cSNV_syn_pre_lib_med - X15rL42_cSNV_nonsense_pre_lib_med

X15rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_missense_pre_lib_med <- unname(X15rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X15rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_syn_pre_lib_med <- unname(X15rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X15rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X15rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X15rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X15rL41rL42a_cSNV_syn_pre_lib_med - X15rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X15rL41_tSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X15rL41_tSNV_missense_pre_lib_med <- unname(X15rL41_tSNV_missense_pre_lib_quarts[3])
X15rL41_tSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X15rL41_tSNV_syn_pre_lib_med <- unname(X15rL41_tSNV_syn_pre_lib_quarts[3])
X15rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X15rL41_tSNV_nonsense_pre_lib_med <- unname(X15rL41_tSNV_nonsense_pre_lib_quarts[3])
X15rL41_tSNV_syn_to_non_pre_lib_spread <- X15rL41_tSNV_syn_pre_lib_med - X15rL41_tSNV_nonsense_pre_lib_med

X15rL42_tSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X15rL42_tSNV_missense_pre_lib_med <- unname(X15rL42_tSNV_missense_pre_lib_quarts[3])
X15rL42_tSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X15rL42_tSNV_syn_pre_lib_med <- unname(X15rL42_tSNV_syn_pre_lib_quarts[3])
X15rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X15rL42_tSNV_nonsense_pre_lib_med <- unname(X15rL42_tSNV_nonsense_pre_lib_quarts[3])
X15rL42_tSNV_syn_to_non_pre_lib_spread <- X15rL42_tSNV_syn_pre_lib_med - X15rL42_tSNV_nonsense_pre_lib_med

X15rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_missense_pre_lib_med <- unname(X15rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X15rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_syn_pre_lib_med <- unname(X15rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X15rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X15rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X15rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X15rL41rL42a_tSNV_syn_pre_lib_med - X15rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X15rL41_tSNV_syn_rna_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X15rL41_tSNV_syn_rna_pre_med <- unname(X15rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X15rL41_tSNV_syn_rna_post_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X15rL41_tSNV_syn_rna_post_med <- unname(X15rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X15rL42_tSNV_syn_rna_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X15rL42_tSNV_syn_rna_pre_med <- unname(X15rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X15rL42_tSNV_syn_rna_post_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X15rL42_tSNV_syn_rna_post_med <- unname(X15rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X15rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_syn_rna_pre_med <- unname(X15rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X15rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X15rL41rL42a_tSNV_syn_rna_post_med <- unname(X15rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X15rL41_cSNV_syn_pre_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X15rL41_cSNV_syn_post_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X15rL41_cSNV_syn_post_lib_med
# tHDR
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X15rL41_tSNV_syn_pre_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X15rL41_tSNV_syn_post_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X15rL41_tSNV_syn_post_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X15rL41_tSNV_syn_rna_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X15rL41_tSNV_syn_rna_post_med

#rL42
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X15rL42_cSNV_syn_pre_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X15rL42_cSNV_syn_post_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X15rL42_cSNV_syn_post_lib_med
# tHDR
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X15rL42_tSNV_syn_pre_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X15rL42_tSNV_syn_post_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X15rL42_tSNV_syn_post_lib_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X15rL42_tSNV_syn_rna_pre_med
X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X15rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X15rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X15rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X15rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X15rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X15rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X15rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X15rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X15rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X15rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X15rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X15rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X15rL41_prog_var_thresh5_df_rL42_int_ord[which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X15rL41_prog_var_thresh5_df_rL42_int_ord
X15rL41_prog_map_thresh5_df_rL42_int_ord = which(X15rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X15rL41_prog_map_thresh5_df_rL42_int_ord_df = X15rL41_prog_var_thresh5_df_rL42_int_ord[X15rL41_prog_map_thresh5_df_rL42_int_ord,]
X15rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X15rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X15rL41_prog_map_thresh5_df_rL42_int_ord_df[X15rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X15rL41_prog_map_thresh5_df_rL42_int_ord_df[X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X15rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X15rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X15rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X15rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X15rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X15rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X15rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X15rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X15rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X15rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X15rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X15rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X15rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X15rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X15rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X15rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X15rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X15rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X15rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X15rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X15rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X15rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X15rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41_cSNV_post_pre_by_cadd_cor_s
#X15rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X15rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL42_cSNV_post_pre_by_cadd_cor_s

#X15rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X15rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41_cSNV_post_lib_by_cadd_cor_s
#X15rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X15rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X15rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X15rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41_tSNV_post_pre_by_cadd_cor_s
#X15rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X15rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL42_tSNV_post_pre_by_cadd_cor_s

#X15rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X15rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41_tSNV_post_lib_by_cadd_cor_s
#X15rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X15rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X15rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X15rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X15rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X15rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X15rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X15rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X15rL41_prog_var_all_lib_count
X15rL41_prog_var_all_pre_count
X15rL42_prog_var_all_pre_count
X15rL41_prog_map_thresh5_lib_count
X15rL41_prog_map_thresh5_pre_count
X15rL42_prog_map_thresh5_pre_count
X15rL41_prog_map_thresh5_post_count
X15rL42_prog_map_thresh5_post_count
X15rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X15rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X15rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X15rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X15rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X15rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X15rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X15rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X15rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X15rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X15rL41_cSNV_post_pre_by_cadd_cor_s
X15rL42_cSNV_post_pre_by_cadd_cor_s
X15rL41_cSNV_post_lib_by_cadd_cor_s
X15rL42_cSNV_post_lib_by_cadd_cor_s
X15rL41_tSNV_post_pre_by_cadd_cor_s
X15rL42_tSNV_post_pre_by_cadd_cor_s
X15rL41_tSNV_post_lib_by_cadd_cor_s
X15rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X15rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X15rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X15rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X15rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X15rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X15rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X15rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X15rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X15rL41_cSNV_syn_to_non_post_pre_spread
X15rL42_cSNV_syn_to_non_post_pre_spread
X15rL41rL42a_cSNV_syn_to_non_post_pre_spread
X15rL41_cSNV_syn_to_non_post_lib_spread
X15rL42_cSNV_syn_to_non_post_lib_spread
X15rL41rL42a_cSNV_syn_to_non_post_lib_spread
X15rL41_tSNV_syn_to_non_post_pre_spread
X15rL42_tSNV_syn_to_non_post_pre_spread
X15rL41rL42a_tSNV_syn_to_non_post_pre_spread
X15rL41_tSNV_syn_to_non_post_lib_spread
X15rL42_tSNV_syn_to_non_post_lib_spread
X15rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X15rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X15rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X15rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X15rL41_cSNV_pre_lib_cors = cor(log2(X15rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15rL41_tSNV_pre_lib_cors = cor(log2(X15rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15rL41_cSNV_post_lib_cors = cor(log2(X15rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X15rL41_tSNV_post_lib_cors = cor(log2(X15rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X15rL41_cSNV_post_pre_cors = cor(log2(X15rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15rL41_tSNV_post_pre_cors = cor(log2(X15rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X15rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15rL41_cSNV_rna_lib_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X15rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15rL41_tSNV_rna_lib_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X15rL41_cSNV_rna_pre_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X15rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15rL41_tSNV_rna_pre_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X15rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15rL41rL42_cSNV_pre_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X15rL41rL42_tSNV_pre_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X15rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X15rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X15rL41rL42_cSNV_post_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X15rL41rL42_tSNV_post_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X15rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X15rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X15rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X15rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X15rL41rL42_cSNV_rna_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X15rL41rL42_tSNV_rna_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X15rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X15rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X15rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X15rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X15rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X15rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X15rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X15rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X15rL41_cors <- c("X15rL41",X15rL41_cSNV_pre_lib_cors,X15rL41_tSNV_pre_lib_cors,X15rL41_cSNV_post_lib_cors,X15rL41_tSNV_post_lib_cors,X15rL41_cSNV_post_pre_cors,X15rL41_tSNV_post_pre_cors,X15rL41_cSNV_rna_lib_cors,X15rL41_tSNV_rna_lib_cors,X15rL41_cSNV_rna_pre_cors,X15rL41_tSNV_rna_pre_cors,X15rL41rL42_cSNV_pre_cors,X15rL41rL42_tSNV_pre_cors,X15rL41rL42_cSNV_pre_lib_ratio_cors,X15rL41rL42_tSNV_pre_lib_ratio_cors,X15rL41rL42_cSNV_post_cors,X15rL41rL42_tSNV_post_cors,X15rL41rL42_cSNV_post_lib_ratio_cors,X15rL41rL42_tSNV_post_lib_ratio_cors,X15rL41rL42_cSNV_post_pre_ratio_cors,X15rL41rL42_tSNV_post_pre_ratio_cors,X15rL41rL42_cSNV_rna_cors,X15rL41rL42_tSNV_rna_cors,X15rL41rL42_tSNV_rna_pre_ratio_cors,X15rL41_cSNV_pre_lib_ratio_cadd_cors,X15rL41_tSNV_pre_lib_ratio_cadd_cors,X15rL41_cSNV_post_lib_ratio_cadd_cors,X15rL41_tSNV_post_lib_ratio_cadd_cors,X15rL41_cSNV_post_pre_ratio_cadd_cors,X15rL41_tSNV_post_pre_ratio_cadd_cors,X15rL41_cSNV_post_pre_ratio_cadd_missense_cors,X15rL41_tSNV_post_pre_ratio_cadd_missense_cors,X15rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X15rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X15rL41_cSNV_post_pre_ratio_grantham_missense_cors,X15rL41_tSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X15rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X15rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X15rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X15rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X15rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X15rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X15rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X15rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X15rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X15rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X15rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X15rL42_cSNV_pre_lib_cors = cor(log2(X15rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15rL42_tSNV_pre_lib_cors = cor(log2(X15rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15rL42_cSNV_post_lib_cors = cor(log2(X15rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X15rL42_tSNV_post_lib_cors = cor(log2(X15rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X15rL42_cSNV_post_pre_cors = cor(log2(X15rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X15rL42_tSNV_post_pre_cors = cor(log2(X15rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X15rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X15rL42_cSNV_rna_lib_cors = cor(log2(X15rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X15rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15rL42_tSNV_rna_lib_cors = cor(log2(X15rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X15rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X15rL42_cSNV_rna_pre_cors = cor(log2(X15rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X15rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X15rL42_tSNV_rna_pre_cors = cor(log2(X15rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X15rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X15rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X15rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X15rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X15rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X15rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X15rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X15rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X15rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X15rL42_cors <- c("X15rL42",X15rL42_cSNV_pre_lib_cors,X15rL42_tSNV_pre_lib_cors,X15rL42_cSNV_post_lib_cors,X15rL42_tSNV_post_lib_cors,X15rL42_cSNV_post_pre_cors,X15rL42_tSNV_post_pre_cors,X15rL42_cSNV_rna_lib_cors,X15rL42_tSNV_rna_lib_cors,X15rL42_cSNV_rna_pre_cors,X15rL42_tSNV_rna_pre_cors,X15rL41rL42_cSNV_pre_cors,X15rL41rL42_tSNV_pre_cors,X15rL41rL42_cSNV_pre_lib_ratio_cors,X15rL41rL42_tSNV_pre_lib_ratio_cors,X15rL41rL42_cSNV_post_cors,X15rL41rL42_tSNV_post_cors,X15rL41rL42_cSNV_post_lib_ratio_cors,X15rL41rL42_tSNV_post_lib_ratio_cors,X15rL41rL42_cSNV_post_pre_ratio_cors,X15rL41rL42_tSNV_post_pre_ratio_cors,X15rL41rL42_cSNV_rna_cors,X15rL41rL42_tSNV_rna_cors,X15rL41rL42_tSNV_rna_pre_ratio_cors,X15rL42_cSNV_pre_lib_ratio_cadd_cors,X15rL42_tSNV_pre_lib_ratio_cadd_cors,X15rL42_cSNV_post_lib_ratio_cadd_cors,X15rL42_tSNV_post_lib_ratio_cadd_cors,X15rL42_cSNV_post_pre_ratio_cadd_cors,X15rL42_tSNV_post_pre_ratio_cadd_cors,X15rL42_cSNV_post_pre_ratio_cadd_missense_cors,X15rL42_tSNV_post_pre_ratio_cadd_missense_cors,X15rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X15rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X15rL42_cSNV_post_pre_ratio_grantham_missense_cors,X15rL42_tSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X15rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X15rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X15rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X15rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X15rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X15rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X15rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X15rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X15rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X15rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X15rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X15rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X15rL41)
rm(X15rL42)
gc()
X16rL41_file <- paste(experiment_dir_170731,'X16rL41','_annotated.txt',sep='')
X16rL42_file <- paste(experiment_dir_170731,'X16rL42','_annotated.txt',sep='')
X16rL41 <- read.table(X16rL41_file, header=TRUE, sep="\t")
X16rL42 <- read.table(X16rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X16 <- editing_info[which(editing_info$amplicon == 'X16'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X16_HDR_5_SNV = as.character(editing_info_X16$HDR_5_SNV)
X16_HDR_3_SNV = as.character(editing_info_X16$HDR_3_SNV)
#X16_cut_pos = as.character(editing_info_X16$cut_pos)
X16_cut_end = as.character(editing_info_X16$cut_end)
X16_mut_start = as.character(editing_info_X16$mut_start)
X16_mut_end = as.character(editing_info_X16$mut_end)
### Replicate 1
X16rL41_cSNV_all <- which(X16rL41[,'c_hdr_snv']=='True')
X16rL41_cSNV_all_df = X16rL41[X16rL41_cSNV_all,]
X16rL41_prog_var_all <- which(X16rL41[,'all_hdr_variant']=='True' & X16rL41[,'edit_string']!='-WT')
X16rL41_prog_var_all_df = X16rL41[X16rL41_prog_var_all,]
X16rL41_prog_map_all = which(X16rL41_prog_var_all_df[,'pos']!='REF')
X16rL41_prog_map_all_df = X16rL41_prog_var_all_df[X16rL41_prog_map_all,]
X16rL41_prog_map_exon_all = which(X16rL41_prog_map_all_df[,'cDNApos']!='REF' & X16rL41_prog_map_all_df[,'cDNApos']!='NA')
X16rL41_prog_map_exon_all_df = X16rL41_prog_map_all_df[X16rL41_prog_map_exon_all,]
X16rL41_prog_map_CADD = which(X16rL41_prog_map_all_df[,'CADD.phred']!='NA')
X16rL41_prog_map_CADD_df = X16rL41_prog_map_all_df[X16rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X16rL41_prog_var_thresh5 <- which(as.numeric(as.character(X16rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X16rL41_prog_var_thresh5_df = X16rL41_prog_var_all_df[X16rL41_prog_var_thresh5,]
X16rL41_prog_map_thresh5 <- which(as.numeric(as.character(X16rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X16rL41_prog_map_thresh5_df = X16rL41_prog_map_all_df[X16rL41_prog_map_thresh5,]
X16rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X16rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X16rL41_prog_map_exon_thresh5_df = X16rL41_prog_map_exon_all_df[X16rL41_prog_map_exon_thresh5,]
X16rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X16rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X16rL41_prog_map_CADD_thresh5_df = X16rL41_prog_map_CADD_df[X16rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X16rL41_prog_var_all_lib_count = length(X16rL41_prog_var_all_df$lib)
X16rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X16rL41_prog_var_all_min_lib_counts = min(X16rL41_prog_var_all_df$lib)
X16rL41_prog_var_all_min_lib_counts
X16rL41_prog_var_all_max_lib_counts = max(X16rL41_prog_var_all_df$lib)
X16rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X16rL41_prog_map_all_lib_count = length(X16rL41_prog_map_all_df$lib)
X16rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X16rL41_prog_map_all_min_lib_counts = min(X16rL41_prog_map_all_df$lib)
X16rL41_prog_map_all_min_lib_counts
X16rL41_prog_map_all_max_lib_counts = max(X16rL41_prog_map_all_df$lib)
X16rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X16rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X16rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X16rL41_prog_var_all_pre_count = length(X16rL41_prog_var_all_df$pre)
X16rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X16rL41_prog_var_all_min_pre_counts = min(X16rL41_prog_var_all_df$pre)
X16rL41_prog_var_all_min_pre_counts
X16rL41_prog_var_all_max_pre_counts = max(X16rL41_prog_var_all_df$pre)
X16rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X16rL41_prog_map_all_pre_count = length(X16rL41_prog_map_all_df$pre)
X16rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X16rL41_prog_map_all_min_pre_counts = min(X16rL41_prog_map_all_df$pre)
X16rL41_prog_map_all_min_pre_counts
X16rL41_prog_map_all_max_pre_counts = max(X16rL41_prog_map_all_df$pre)
X16rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X16rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X16rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X16rL41_prog_map_all_post_count = length(X16rL41_prog_map_all_df$post)
X16rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X16rL41_prog_map_all_min_post_counts = min(X16rL41_prog_map_all_df$post)
X16rL41_prog_map_all_min_post_counts
X16rL41_prog_map_all_max_post_counts = max(X16rL41_prog_map_all_df$post)
X16rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X16rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X16rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X16rL41_prog_map_all_syn_df <- X16rL41_prog_map_all_df[which(X16rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X16rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X16rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X16rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X16rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X16rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X16rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X16rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X16rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X16rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X16rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X16rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X16rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X16rL41_prog_map_all_min_rna_counts = min(X16rL41_prog_map_exon_all_df$tHDR_rna)
X16rL41_prog_map_all_min_rna_counts
X16rL41_prog_map_all_max_rna_counts = max(X16rL41_prog_map_exon_all_df$tHDR_rna)
X16rL41_prog_map_all_max_rna_counts
X16rL41_prog_map_all_min_rna_pseudo_freq = min(X16rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16rL41_prog_map_all_min_rna_pseudo_freq
X16rL41_prog_map_all_max_rna_pseudo_freq = max(X16rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16rL41_prog_map_all_max_rna_pseudo_freq
X16rL41_prog_map_all_min_rna_pre_ratio = min(X16rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16rL41_prog_map_all_min_rna_pre_ratio
X16rL41_prog_map_all_max_rna_pre_ratio = max(X16rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16rL41_prog_map_all_max_rna_pre_ratio
X16rL41_prog_map_all_min_rna_post_ratio = min(X16rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16rL41_prog_map_all_min_rna_post_ratio
X16rL41_prog_map_all_max_rna_post_ratio = max(X16rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X16rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X16rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X16rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X16rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X16rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X16rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X16rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X16rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X16rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X16rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X16rL41_prog_map_all_df$post_pre_ratio),log2(X16rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X16rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X16rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X16rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X16rL41_cSNV_all_corr_pre_count = length(X16rL41_cSNV_all_df$corr_pre)
X16rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X16rL41_cSNV_all_min_corr_pre_counts = min(X16rL41_cSNV_all_df$corr_pre)
X16rL41_cSNV_all_min_corr_pre_counts
X16rL41_cSNV_all_max_corr_pre_counts = max(X16rL41_cSNV_all_df$corr_pre)
X16rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X16rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X16rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X16rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X16rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X16rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_cSNV_all_corr_post_count = length(X16rL41_cSNV_all_df$corr_post)
X16rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X16rL41_cSNV_all_min_corr_post_counts = min(X16rL41_cSNV_all_df$corr_post)
X16rL41_cSNV_all_min_corr_post_counts
X16rL41_cSNV_all_max_corr_post_counts = max(X16rL41_cSNV_all_df$corr_post)
X16rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X16rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X16rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X16rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X16rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X16rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X16rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X16_p_hdr_snv = paste('p_hdr_',X16_cut_end,'_snv',sep='')
X16rL41_pSNV_all <- which(X16rL41[,X16_p_hdr_snv]=='True')
X16rL41_pSNV_all_df = X16rL41[X16rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_pSNV_all_lib_count = length(X16rL41_pSNV_all_df$lib)
X16rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X16rL41_pSNV_all_min_lib_counts = min(X16rL41_pSNV_all_df$lib)
X16rL41_pSNV_all_min_lib_counts
X16rL41_pSNV_all_max_lib_counts = max(X16rL41_pSNV_all_df$lib)
X16rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X16rL41_pSNV_all_pre_count = length(X16rL41_pSNV_all_df$pre)
X16rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X16rL41_pSNV_all_min_pre_counts = min(X16rL41_pSNV_all_df$pre)
X16rL41_pSNV_all_min_pre_counts
X16rL41_pSNV_all_max_pre_counts = max(X16rL41_pSNV_all_df$pre)
X16rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X16rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X16rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_pSNV_all_post_count = length(X16rL41_pSNV_all_df$post)
X16rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X16rL41_pSNV_all_min_post_counts = min(X16rL41_pSNV_all_df$post)
X16rL41_pSNV_all_min_post_counts
X16rL41_pSNV_all_max_post_counts = max(X16rL41_pSNV_all_df$post)
X16rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X16rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X16rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_prog_map_thresh5_lib_count = length(X16rL41_prog_map_thresh5_df$lib)
X16rL41_prog_map_thresh5_lib_count
X16rL41_prog_map_thresh5_min_lib_counts = min(X16rL41_prog_map_thresh5_df$lib)
X16rL41_prog_map_thresh5_min_lib_counts
X16rL41_prog_map_thresh5_max_lib_counts = max(X16rL41_prog_map_thresh5_df$lib)
X16rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X16rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X16rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_prog_map_thresh5_pre_count = length(X16rL41_prog_map_thresh5_df$pre)
X16rL41_prog_map_thresh5_pre_count
X16rL41_prog_map_thresh5_min_pre_counts = min(X16rL41_prog_map_thresh5_df$pre)
X16rL41_prog_map_thresh5_min_pre_counts
X16rL41_prog_map_thresh5_max_pre_counts = max(X16rL41_prog_map_thresh5_df$pre)
X16rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL41_prog_map_thresh5_post_count = length(X16rL41_prog_map_thresh5_df$post)
X16rL41_prog_map_thresh5_post_count
X16rL41_prog_map_thresh5_min_post_counts = min(X16rL41_prog_map_thresh5_df$post)
X16rL41_prog_map_thresh5_min_post_counts
X16rL41_prog_map_thresh5_max_post_counts = max(X16rL41_prog_map_thresh5_df$post)
X16rL41_prog_map_thresh5_max_post_counts
X16rL41_prog_map_thresh5_corr_post_count = length(X16rL41_cSNV_all_df$corr_post)
X16rL41_prog_map_thresh5_corr_post_count
X16rL41_prog_map_thresh5_min_corr_post_counts = min(X16rL41_cSNV_all_df$corr_post)
X16rL41_prog_map_thresh5_min_corr_post_counts
X16rL41_prog_map_thresh5_max_corr_post_counts = max(X16rL41_cSNV_all_df$corr_post)
X16rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X16rL41_pSNV_thresh5 <- which(X16rL41[,X16_p_hdr_snv]=='True' & as.numeric(as.character(X16rL41[,'pre_freq']))>=0.00001)
X16rL41_pSNV_thresh5_df = X16rL41[X16rL41_pSNV_thresh5,]
X16rL41_pSNV_thresh5_lib_count = length(X16rL41_pSNV_thresh5_df$lib)
X16rL41_pSNV_thresh5_lib_count
X16rL41_pSNV_thresh5_min_lib_counts = min(X16rL41_pSNV_thresh5_df$lib)
X16rL41_pSNV_thresh5_min_lib_counts
X16rL41_pSNV_thresh5_max_lib_counts = max(X16rL41_pSNV_thresh5_df$lib)
X16rL41_pSNV_thresh5_max_lib_counts
X16rL41_pSNV_thresh5_pre_count = length(X16rL41_pSNV_thresh5_df$pre)
X16rL41_pSNV_thresh5_pre_count
X16rL41_pSNV_thresh5_min_pre_counts = min(X16rL41_pSNV_thresh5_df$pre)
X16rL41_pSNV_thresh5_min_pre_counts
X16rL41_pSNV_thresh5_max_pre_counts = max(X16rL41_pSNV_thresh5_df$pre)
X16rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X16rL41_pSNV_thresh5_post_count = length(X16rL41_pSNV_thresh5_df$post)
X16rL41_pSNV_thresh5_post_count
X16rL41_pSNV_thresh5_min_post_counts = min(X16rL41_pSNV_thresh5_df$post)
X16rL41_pSNV_thresh5_min_post_counts
X16rL41_pSNV_thresh5_max_post_counts = max(X16rL41_pSNV_thresh5_df$post)
X16rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X16rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X16rL41_pSNV_thresh5_post_pos

### Replicate 2
X16rL42_cSNV_all <- which(X16rL42[,'c_hdr_snv']=='True')
X16rL42_cSNV_all_df = X16rL42[X16rL42_cSNV_all,]
X16rL42_prog_var_all <- which(X16rL42[,'all_hdr_variant']=='True' & X16rL42[,'edit_string']!='-WT')
X16rL42_prog_var_all_df = X16rL42[X16rL42_prog_var_all,]
X16rL42_prog_map_all = which(X16rL42_prog_var_all_df[,'pos']!='REF')
X16rL42_prog_map_all_df = X16rL42_prog_var_all_df[X16rL42_prog_map_all,]
X16rL42_prog_map_exon_all = which(X16rL42_prog_map_all_df[,'cDNApos']!='REF' & X16rL42_prog_map_all_df[,'cDNApos']!='NA')
X16rL42_prog_map_exon_all_df = X16rL42_prog_map_all_df[X16rL42_prog_map_exon_all,]
X16rL42_prog_map_CADD = which(X16rL42_prog_map_all_df[,'CADD.phred']!='NA')
X16rL42_prog_map_CADD_df = X16rL42_prog_map_all_df[X16rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X16rL42_prog_var_thresh5 <- which(as.numeric(as.character(X16rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X16rL42_prog_var_thresh5_df = X16rL42_prog_var_all_df[X16rL42_prog_var_thresh5,]
X16rL42_prog_map_thresh5 <- which(as.numeric(as.character(X16rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X16rL42_prog_map_thresh5_df = X16rL42_prog_map_all_df[X16rL42_prog_map_thresh5,]
X16rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X16rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X16rL42_prog_map_exon_thresh5_df = X16rL42_prog_map_exon_all_df[X16rL42_prog_map_exon_thresh5,]
X16rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X16rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X16rL42_prog_map_CADD_thresh5_df = X16rL42_prog_map_CADD_df[X16rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X16rL42_prog_var_all_lib_count = length(X16rL42_prog_var_all_df$lib)
X16rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X16rL42_prog_var_all_min_lib_counts = min(X16rL42_prog_var_all_df$lib)
X16rL42_prog_var_all_min_lib_counts
X16rL42_prog_var_all_max_lib_counts = max(X16rL42_prog_var_all_df$lib)
X16rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X16rL42_prog_map_all_lib_count = length(X16rL42_prog_map_all_df$lib)
X16rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X16rL42_prog_map_all_min_lib_counts = min(X16rL42_prog_map_all_df$lib)
X16rL42_prog_map_all_min_lib_counts
X16rL42_prog_map_all_max_lib_counts = max(X16rL42_prog_map_all_df$lib)
X16rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X16rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X16rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X16rL42_prog_var_all_pre_count = length(X16rL42_prog_var_all_df$pre)
X16rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X16rL42_prog_var_all_min_pre_counts = min(X16rL42_prog_var_all_df$pre)
X16rL42_prog_var_all_min_pre_counts
X16rL42_prog_var_all_max_pre_counts = max(X16rL42_prog_var_all_df$pre)
X16rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X16rL42_prog_map_all_pre_count = length(X16rL42_prog_map_all_df$pre)
X16rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X16rL42_prog_map_all_min_pre_counts = min(X16rL42_prog_map_all_df$pre)
X16rL42_prog_map_all_min_pre_counts
X16rL42_prog_map_all_max_pre_counts = max(X16rL42_prog_map_all_df$pre)
X16rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X16rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X16rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X16rL42_prog_map_all_post_count = length(X16rL42_prog_map_all_df$post)
X16rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X16rL42_prog_map_all_min_post_counts = min(X16rL42_prog_map_all_df$post)
X16rL42_prog_map_all_min_post_counts
X16rL42_prog_map_all_max_post_counts = max(X16rL42_prog_map_all_df$post)
X16rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X16rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X16rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X16rL42_prog_map_all_syn_df <- X16rL42_prog_map_all_df[which(X16rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X16rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X16rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X16rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X16rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X16rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X16rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X16rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X16rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X16rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X16rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X16rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X16rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X16rL42_prog_map_all_min_rna_counts = min(X16rL42_prog_map_exon_all_df$tHDR_rna)
X16rL42_prog_map_all_min_rna_counts
X16rL42_prog_map_all_max_rna_counts = max(X16rL42_prog_map_exon_all_df$tHDR_rna)
X16rL42_prog_map_all_max_rna_counts
X16rL42_prog_map_all_min_rna_pseudo_freq = min(X16rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16rL42_prog_map_all_min_rna_pseudo_freq
X16rL42_prog_map_all_max_rna_pseudo_freq = max(X16rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X16rL42_prog_map_all_max_rna_pseudo_freq
X16rL42_prog_map_all_min_rna_pre_ratio = min(X16rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16rL42_prog_map_all_min_rna_pre_ratio
X16rL42_prog_map_all_max_rna_pre_ratio = max(X16rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X16rL42_prog_map_all_max_rna_pre_ratio
X16rL42_prog_map_all_min_rna_post_ratio = min(X16rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16rL42_prog_map_all_min_rna_post_ratio
X16rL42_prog_map_all_max_rna_post_ratio = max(X16rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X16rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X16rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X16rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X16rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X16rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X16rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X16rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X16rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X16rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X16rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X16rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X16rL42_prog_map_all_df$post_pre_ratio),log2(X16rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X16rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X16rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X16rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X16rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X16rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X16rL42_cSNV_all_corr_pre_count = length(X16rL42_cSNV_all_df$corr_pre)
X16rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X16rL42_cSNV_all_min_corr_pre_counts = min(X16rL42_cSNV_all_df$corr_pre)
X16rL42_cSNV_all_min_corr_pre_counts
X16rL42_cSNV_all_max_corr_pre_counts = max(X16rL42_cSNV_all_df$corr_pre)
X16rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X16rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X16rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X16rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X16rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X16rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_cSNV_all_corr_post_count = length(X16rL42_cSNV_all_df$corr_post)
X16rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X16rL42_cSNV_all_min_corr_post_counts = min(X16rL42_cSNV_all_df$corr_post)
X16rL42_cSNV_all_min_corr_post_counts
X16rL42_cSNV_all_max_corr_post_counts = max(X16rL42_cSNV_all_df$corr_post)
X16rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X16rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X16rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X16rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X16rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X16rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X16rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X16_p_hdr_snv = paste('p_hdr_',X16_cut_end,'_snv',sep='')
X16rL42_pSNV_all <- which(X16rL42[,X16_p_hdr_snv]=='True')
X16rL42_pSNV_all_df = X16rL42[X16rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_pSNV_all_lib_count = length(X16rL42_pSNV_all_df$lib)
X16rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X16rL42_pSNV_all_min_lib_counts = min(X16rL42_pSNV_all_df$lib)
X16rL42_pSNV_all_min_lib_counts
X16rL42_pSNV_all_max_lib_counts = max(X16rL42_pSNV_all_df$lib)
X16rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X16rL42_pSNV_all_pre_count = length(X16rL42_pSNV_all_df$pre)
X16rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X16rL42_pSNV_all_min_pre_counts = min(X16rL42_pSNV_all_df$pre)
X16rL42_pSNV_all_min_pre_counts
X16rL42_pSNV_all_max_pre_counts = max(X16rL42_pSNV_all_df$pre)
X16rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X16rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X16rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_pSNV_all_post_count = length(X16rL42_pSNV_all_df$post)
X16rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X16rL42_pSNV_all_min_post_counts = min(X16rL42_pSNV_all_df$post)
X16rL42_pSNV_all_min_post_counts
X16rL42_pSNV_all_max_post_counts = max(X16rL42_pSNV_all_df$post)
X16rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X16rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X16rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_prog_map_thresh5_lib_count = length(X16rL42_prog_map_thresh5_df$lib)
X16rL42_prog_map_thresh5_lib_count
X16rL42_prog_map_thresh5_min_lib_counts = min(X16rL42_prog_map_thresh5_df$lib)
X16rL42_prog_map_thresh5_min_lib_counts
X16rL42_prog_map_thresh5_max_lib_counts = max(X16rL42_prog_map_thresh5_df$lib)
X16rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X16rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X16rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_prog_map_thresh5_pre_count = length(X16rL42_prog_map_thresh5_df$pre)
X16rL42_prog_map_thresh5_pre_count
X16rL42_prog_map_thresh5_min_pre_counts = min(X16rL42_prog_map_thresh5_df$pre)
X16rL42_prog_map_thresh5_min_pre_counts
X16rL42_prog_map_thresh5_max_pre_counts = max(X16rL42_prog_map_thresh5_df$pre)
X16rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X16 less than SGE region length x 3 due to PAM edits
X16rL42_prog_map_thresh5_post_count = length(X16rL42_prog_map_thresh5_df$post)
X16rL42_prog_map_thresh5_post_count
X16rL42_prog_map_thresh5_min_post_counts = min(X16rL42_prog_map_thresh5_df$post)
X16rL42_prog_map_thresh5_min_post_counts
X16rL42_prog_map_thresh5_max_post_counts = max(X16rL42_prog_map_thresh5_df$post)
X16rL42_prog_map_thresh5_max_post_counts
X16rL42_prog_map_thresh5_corr_post_count = length(X16rL42_prog_map_thresh5_df$corr_post)
X16rL42_prog_map_thresh5_corr_post_count
X16rL42_prog_map_thresh5_min_corr_post_counts = min(X16rL42_prog_map_thresh5_df$corr_post)
X16rL42_prog_map_thresh5_min_corr_post_counts
X16rL42_prog_map_thresh5_max_corr_post_counts = max(X16rL42_prog_map_thresh5_df$corr_post)
X16rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X16rL42_pSNV_thresh5 <- which(X16rL42[,X16_p_hdr_snv]=='True' & as.numeric(as.character(X16rL42[,'pre_freq']))>=0.00001)
X16rL42_pSNV_thresh5_df = X16rL42[X16rL42_pSNV_thresh5,]
X16rL42_pSNV_thresh5_lib_count = length(X16rL42_pSNV_thresh5_df$lib)
X16rL42_pSNV_thresh5_lib_count
X16rL42_pSNV_thresh5_min_lib_counts = min(X16rL42_pSNV_thresh5_df$lib)
X16rL42_pSNV_thresh5_min_lib_counts
X16rL42_pSNV_thresh5_max_lib_counts = max(X16rL42_pSNV_thresh5_df$lib)
X16rL42_pSNV_thresh5_max_lib_counts
X16rL42_pSNV_thresh5_pre_count = length(X16rL42_pSNV_thresh5_df$pre)
X16rL42_pSNV_thresh5_pre_count
X16rL42_pSNV_thresh5_min_pre_counts = min(X16rL42_pSNV_thresh5_df$pre)
X16rL42_pSNV_thresh5_min_pre_counts
X16rL42_pSNV_thresh5_max_pre_counts = max(X16rL42_pSNV_thresh5_df$pre)
X16rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X16rL42_pSNV_thresh5_post_count = length(X16rL42_pSNV_thresh5_df$post)
X16rL42_pSNV_thresh5_post_count
X16rL42_pSNV_thresh5_min_post_counts = min(X16rL42_pSNV_thresh5_df$post)
X16rL42_pSNV_thresh5_min_post_counts
X16rL42_pSNV_thresh5_max_post_counts = max(X16rL42_pSNV_thresh5_df$post)
X16rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X16rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X16rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X16rL41_prog_var_thresh5_df:
X16rL41_prog_var_thresh5_df_rL42_int <- X16rL41_prog_var_thresh5_df[which(X16rL41_prog_var_thresh5_df$variant %in% X16rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X16rL42_prog_var_thresh5_df:
X16rL42_prog_var_thresh5_df_rL41_int <- X16rL42_prog_var_thresh5_df[which(X16rL42_prog_var_thresh5_df$variant %in% X16rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X16rL41_prog_var_thresh5_df_rL42_int_ord <- X16rL41_prog_var_thresh5_df_rL42_int[order(X16rL41_prog_var_thresh5_df_rL42_int$variant),]
X16rL42_prog_var_thresh5_df_rL41_int_ord <- X16rL42_prog_var_thresh5_df_rL41_int[order(X16rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X16rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X16rL41rL42int_prog_var_thresh5_pre_count <- dim(X16rL41_prog_var_thresh5_df_rL42_int)[1] 
X16rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X16rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X16rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X16rL42_prog_var_thresh5_df_rL41_int_ord$lib
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X16rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X16rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X16rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X16rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X16rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X16rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X16rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X16rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X16rL41_cSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X16rL41_cSNV_missense_post_pre_med <- unname(X16rL41_cSNV_missense_post_pre_quarts[3])
X16rL41_cSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X16rL41_cSNV_syn_post_pre_med <- unname(X16rL41_cSNV_syn_post_pre_quarts[3])
X16rL41_cSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X16rL41_cSNV_nonsense_post_pre_med <- unname(X16rL41_cSNV_nonsense_post_pre_quarts[3])
X16rL41_cSNV_syn_to_non_post_pre_spread <- X16rL41_cSNV_syn_post_pre_med - X16rL41_cSNV_nonsense_post_pre_med

X16rL42_cSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X16rL42_cSNV_missense_post_pre_med <- unname(X16rL42_cSNV_missense_post_pre_quarts[3])
X16rL42_cSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X16rL42_cSNV_syn_post_pre_med <- unname(X16rL42_cSNV_syn_post_pre_quarts[3])
X16rL42_cSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X16rL42_cSNV_nonsense_post_pre_med <- unname(X16rL42_cSNV_nonsense_post_pre_quarts[3])
X16rL42_cSNV_syn_to_non_post_pre_spread <- X16rL42_cSNV_syn_post_pre_med - X16rL42_cSNV_nonsense_post_pre_med

X16rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_missense_post_pre_med <- unname(X16rL41rL42a_cSNV_missense_post_pre_quarts[3])
X16rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_syn_post_pre_med <- unname(X16rL41rL42a_cSNV_syn_post_pre_quarts[3])
X16rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X16rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X16rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X16rL41rL42a_cSNV_syn_post_pre_med - X16rL41rL42a_cSNV_nonsense_post_pre_med

X16rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_cSNV_missense_post_pre_med <- unname(X16rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X16rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_cSNV_syn_post_pre_med <- unname(X16rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X16rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X16rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X16rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X16rL41rL42pw_cSNV_syn_post_pre_med - X16rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X16rL41_tSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X16rL41_tSNV_missense_post_pre_med <- unname(X16rL41_tSNV_missense_post_pre_quarts[3])
X16rL41_tSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X16rL41_tSNV_syn_post_pre_med <- unname(X16rL41_tSNV_syn_post_pre_quarts[3])
X16rL41_tSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X16rL41_tSNV_nonsense_post_pre_med <- unname(X16rL41_tSNV_nonsense_post_pre_quarts[3])
X16rL41_tSNV_syn_to_non_post_pre_spread <- X16rL41_tSNV_syn_post_pre_med - X16rL41_tSNV_nonsense_post_pre_med

X16rL42_tSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X16rL42_tSNV_missense_post_pre_med <- unname(X16rL42_tSNV_missense_post_pre_quarts[3])
X16rL42_tSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X16rL42_tSNV_syn_post_pre_med <- unname(X16rL42_tSNV_syn_post_pre_quarts[3])
X16rL42_tSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X16rL42_tSNV_nonsense_post_pre_med <- unname(X16rL42_tSNV_nonsense_post_pre_quarts[3])
X16rL42_tSNV_syn_to_non_post_pre_spread <- X16rL42_tSNV_syn_post_pre_med - X16rL42_tSNV_nonsense_post_pre_med

X16rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_missense_post_pre_med <- unname(X16rL41rL42a_tSNV_missense_post_pre_quarts[3])
X16rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_syn_post_pre_med <- unname(X16rL41rL42a_tSNV_syn_post_pre_quarts[3])
X16rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X16rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X16rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X16rL41rL42a_tSNV_syn_post_pre_med - X16rL41rL42a_tSNV_nonsense_post_pre_med

X16rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_tSNV_missense_post_pre_med <- unname(X16rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X16rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_tSNV_syn_post_pre_med <- unname(X16rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X16rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X16rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X16rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X16rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X16rL41rL42pw_tSNV_syn_post_pre_med - X16rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X16rL41_cSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X16rL41_cSNV_missense_post_lib_med <- unname(X16rL41_cSNV_missense_post_lib_quarts[3])
X16rL41_cSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X16rL41_cSNV_syn_post_lib_med <- unname(X16rL41_cSNV_syn_post_lib_quarts[3])
X16rL41_cSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X16rL41_cSNV_nonsense_post_lib_med <- unname(X16rL41_cSNV_nonsense_post_lib_quarts[3])
X16rL41_cSNV_syn_to_non_post_lib_spread <- X16rL41_cSNV_syn_post_lib_med - X16rL41_cSNV_nonsense_post_lib_med

X16rL42_cSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X16rL42_cSNV_missense_post_lib_med <- unname(X16rL42_cSNV_missense_post_lib_quarts[3])
X16rL42_cSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X16rL42_cSNV_syn_post_lib_med <- unname(X16rL42_cSNV_syn_post_lib_quarts[3])
X16rL42_cSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X16rL42_cSNV_nonsense_post_lib_med <- unname(X16rL42_cSNV_nonsense_post_lib_quarts[3])
X16rL42_cSNV_syn_to_non_post_lib_spread <- X16rL42_cSNV_syn_post_lib_med - X16rL42_cSNV_nonsense_post_lib_med

X16rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_missense_post_lib_med <- unname(X16rL41rL42a_cSNV_missense_post_lib_quarts[3])
X16rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_syn_post_lib_med <- unname(X16rL41rL42a_cSNV_syn_post_lib_quarts[3])
X16rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X16rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X16rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X16rL41rL42a_cSNV_syn_post_lib_med - X16rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X16rL41_tSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X16rL41_tSNV_missense_post_lib_med <- unname(X16rL41_tSNV_missense_post_lib_quarts[3])
X16rL41_tSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X16rL41_tSNV_syn_post_lib_med <- unname(X16rL41_tSNV_syn_post_lib_quarts[3])
X16rL41_tSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X16rL41_tSNV_nonsense_post_lib_med <- unname(X16rL41_tSNV_nonsense_post_lib_quarts[3])
X16rL41_tSNV_syn_to_non_post_lib_spread <- X16rL41_tSNV_syn_post_lib_med - X16rL41_tSNV_nonsense_post_lib_med

X16rL42_tSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X16rL42_tSNV_missense_post_lib_med <- unname(X16rL42_tSNV_missense_post_lib_quarts[3])
X16rL42_tSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X16rL42_tSNV_syn_post_lib_med <- unname(X16rL42_tSNV_syn_post_lib_quarts[3])
X16rL42_tSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X16rL42_tSNV_nonsense_post_lib_med <- unname(X16rL42_tSNV_nonsense_post_lib_quarts[3])
X16rL42_tSNV_syn_to_non_post_lib_spread <- X16rL42_tSNV_syn_post_lib_med - X16rL42_tSNV_nonsense_post_lib_med

X16rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_missense_post_lib_med <- unname(X16rL41rL42a_tSNV_missense_post_lib_quarts[3])
X16rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_syn_post_lib_med <- unname(X16rL41rL42a_tSNV_syn_post_lib_quarts[3])
X16rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X16rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X16rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X16rL41rL42a_tSNV_syn_post_lib_med - X16rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X16rL41_cSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X16rL41_cSNV_missense_pre_lib_med <- unname(X16rL41_cSNV_missense_pre_lib_quarts[3])
X16rL41_cSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X16rL41_cSNV_syn_pre_lib_med <- unname(X16rL41_cSNV_syn_pre_lib_quarts[3])
X16rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X16rL41_cSNV_nonsense_pre_lib_med <- unname(X16rL41_cSNV_nonsense_pre_lib_quarts[3])
X16rL41_cSNV_syn_to_non_pre_lib_spread <- X16rL41_cSNV_syn_pre_lib_med - X16rL41_cSNV_nonsense_pre_lib_med

X16rL42_cSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X16rL42_cSNV_missense_pre_lib_med <- unname(X16rL42_cSNV_missense_pre_lib_quarts[3])
X16rL42_cSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X16rL42_cSNV_syn_pre_lib_med <- unname(X16rL42_cSNV_syn_pre_lib_quarts[3])
X16rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X16rL42_cSNV_nonsense_pre_lib_med <- unname(X16rL42_cSNV_nonsense_pre_lib_quarts[3])
X16rL42_cSNV_syn_to_non_pre_lib_spread <- X16rL42_cSNV_syn_pre_lib_med - X16rL42_cSNV_nonsense_pre_lib_med

X16rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_missense_pre_lib_med <- unname(X16rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X16rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_syn_pre_lib_med <- unname(X16rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X16rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X16rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X16rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X16rL41rL42a_cSNV_syn_pre_lib_med - X16rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X16rL41_tSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X16rL41_tSNV_missense_pre_lib_med <- unname(X16rL41_tSNV_missense_pre_lib_quarts[3])
X16rL41_tSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X16rL41_tSNV_syn_pre_lib_med <- unname(X16rL41_tSNV_syn_pre_lib_quarts[3])
X16rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X16rL41_tSNV_nonsense_pre_lib_med <- unname(X16rL41_tSNV_nonsense_pre_lib_quarts[3])
X16rL41_tSNV_syn_to_non_pre_lib_spread <- X16rL41_tSNV_syn_pre_lib_med - X16rL41_tSNV_nonsense_pre_lib_med

X16rL42_tSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X16rL42_tSNV_missense_pre_lib_med <- unname(X16rL42_tSNV_missense_pre_lib_quarts[3])
X16rL42_tSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X16rL42_tSNV_syn_pre_lib_med <- unname(X16rL42_tSNV_syn_pre_lib_quarts[3])
X16rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X16rL42_tSNV_nonsense_pre_lib_med <- unname(X16rL42_tSNV_nonsense_pre_lib_quarts[3])
X16rL42_tSNV_syn_to_non_pre_lib_spread <- X16rL42_tSNV_syn_pre_lib_med - X16rL42_tSNV_nonsense_pre_lib_med

X16rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_missense_pre_lib_med <- unname(X16rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X16rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_syn_pre_lib_med <- unname(X16rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X16rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X16rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X16rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X16rL41rL42a_tSNV_syn_pre_lib_med - X16rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X16rL41_tSNV_syn_rna_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X16rL41_tSNV_syn_rna_pre_med <- unname(X16rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X16rL41_tSNV_syn_rna_post_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X16rL41_tSNV_syn_rna_post_med <- unname(X16rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X16rL42_tSNV_syn_rna_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X16rL42_tSNV_syn_rna_pre_med <- unname(X16rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X16rL42_tSNV_syn_rna_post_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X16rL42_tSNV_syn_rna_post_med <- unname(X16rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X16rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_syn_rna_pre_med <- unname(X16rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X16rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X16rL41rL42a_tSNV_syn_rna_post_med <- unname(X16rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X16rL41_cSNV_syn_pre_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X16rL41_cSNV_syn_post_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X16rL41_cSNV_syn_post_lib_med
# tHDR
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X16rL41_tSNV_syn_pre_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X16rL41_tSNV_syn_post_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X16rL41_tSNV_syn_post_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X16rL41_tSNV_syn_rna_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X16rL41_tSNV_syn_rna_post_med

#rL42
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X16rL42_cSNV_syn_pre_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X16rL42_cSNV_syn_post_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X16rL42_cSNV_syn_post_lib_med
# tHDR
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X16rL42_tSNV_syn_pre_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X16rL42_tSNV_syn_post_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X16rL42_tSNV_syn_post_lib_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X16rL42_tSNV_syn_rna_pre_med
X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X16rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X16rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X16rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X16rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X16rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X16rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X16rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X16rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X16rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X16rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X16rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X16rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X16rL41_prog_var_thresh5_df_rL42_int_ord[which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X16rL41_prog_var_thresh5_df_rL42_int_ord
X16rL41_prog_map_thresh5_df_rL42_int_ord = which(X16rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X16rL41_prog_map_thresh5_df_rL42_int_ord_df = X16rL41_prog_var_thresh5_df_rL42_int_ord[X16rL41_prog_map_thresh5_df_rL42_int_ord,]
X16rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X16rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X16rL41_prog_map_thresh5_df_rL42_int_ord_df[X16rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X16rL41_prog_map_thresh5_df_rL42_int_ord_df[X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X16rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X16rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X16rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X16rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X16rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X16rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X16rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X16rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X16rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X16rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X16rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X16rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X16rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X16rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X16rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X16rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X16rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X16rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X16rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X16rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X16rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X16rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X16rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41_cSNV_post_pre_by_cadd_cor_s
#X16rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X16rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL42_cSNV_post_pre_by_cadd_cor_s

#X16rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X16rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41_cSNV_post_lib_by_cadd_cor_s
#X16rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X16rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X16rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X16rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41_tSNV_post_pre_by_cadd_cor_s
#X16rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X16rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL42_tSNV_post_pre_by_cadd_cor_s

#X16rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X16rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41_tSNV_post_lib_by_cadd_cor_s
#X16rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X16rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X16rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X16rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X16rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X16rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X16rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X16rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X16rL41_prog_var_all_lib_count
X16rL41_prog_var_all_pre_count
X16rL42_prog_var_all_pre_count
X16rL41_prog_map_thresh5_lib_count
X16rL41_prog_map_thresh5_pre_count
X16rL42_prog_map_thresh5_pre_count
X16rL41_prog_map_thresh5_post_count
X16rL42_prog_map_thresh5_post_count
X16rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X16rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X16rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X16rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X16rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X16rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X16rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X16rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X16rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X16rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X16rL41_cSNV_post_pre_by_cadd_cor_s
X16rL42_cSNV_post_pre_by_cadd_cor_s
X16rL41_cSNV_post_lib_by_cadd_cor_s
X16rL42_cSNV_post_lib_by_cadd_cor_s
X16rL41_tSNV_post_pre_by_cadd_cor_s
X16rL42_tSNV_post_pre_by_cadd_cor_s
X16rL41_tSNV_post_lib_by_cadd_cor_s
X16rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X16rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X16rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X16rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X16rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X16rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X16rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X16rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X16rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X16rL41_cSNV_syn_to_non_post_pre_spread
X16rL42_cSNV_syn_to_non_post_pre_spread
X16rL41rL42a_cSNV_syn_to_non_post_pre_spread
X16rL41_cSNV_syn_to_non_post_lib_spread
X16rL42_cSNV_syn_to_non_post_lib_spread
X16rL41rL42a_cSNV_syn_to_non_post_lib_spread
X16rL41_tSNV_syn_to_non_post_pre_spread
X16rL42_tSNV_syn_to_non_post_pre_spread
X16rL41rL42a_tSNV_syn_to_non_post_pre_spread
X16rL41_tSNV_syn_to_non_post_lib_spread
X16rL42_tSNV_syn_to_non_post_lib_spread
X16rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X16rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X16rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X16rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X16rL41_cSNV_pre_lib_cors = cor(log2(X16rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16rL41_tSNV_pre_lib_cors = cor(log2(X16rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16rL41_cSNV_post_lib_cors = cor(log2(X16rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X16rL41_tSNV_post_lib_cors = cor(log2(X16rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X16rL41_cSNV_post_pre_cors = cor(log2(X16rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16rL41_tSNV_post_pre_cors = cor(log2(X16rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X16rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16rL41_cSNV_rna_lib_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X16rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16rL41_tSNV_rna_lib_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X16rL41_cSNV_rna_pre_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X16rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16rL41_tSNV_rna_pre_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X16rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16rL41rL42_cSNV_pre_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X16rL41rL42_tSNV_pre_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X16rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X16rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X16rL41rL42_cSNV_post_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X16rL41rL42_tSNV_post_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X16rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X16rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X16rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X16rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X16rL41rL42_cSNV_rna_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X16rL41rL42_tSNV_rna_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X16rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X16rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X16rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X16rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X16rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X16rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X16rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X16rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X16rL41_cors <- c("X16rL41",X16rL41_cSNV_pre_lib_cors,X16rL41_tSNV_pre_lib_cors,X16rL41_cSNV_post_lib_cors,X16rL41_tSNV_post_lib_cors,X16rL41_cSNV_post_pre_cors,X16rL41_tSNV_post_pre_cors,X16rL41_cSNV_rna_lib_cors,X16rL41_tSNV_rna_lib_cors,X16rL41_cSNV_rna_pre_cors,X16rL41_tSNV_rna_pre_cors,X16rL41rL42_cSNV_pre_cors,X16rL41rL42_tSNV_pre_cors,X16rL41rL42_cSNV_pre_lib_ratio_cors,X16rL41rL42_tSNV_pre_lib_ratio_cors,X16rL41rL42_cSNV_post_cors,X16rL41rL42_tSNV_post_cors,X16rL41rL42_cSNV_post_lib_ratio_cors,X16rL41rL42_tSNV_post_lib_ratio_cors,X16rL41rL42_cSNV_post_pre_ratio_cors,X16rL41rL42_tSNV_post_pre_ratio_cors,X16rL41rL42_cSNV_rna_cors,X16rL41rL42_tSNV_rna_cors,X16rL41rL42_tSNV_rna_pre_ratio_cors,X16rL41_cSNV_pre_lib_ratio_cadd_cors,X16rL41_tSNV_pre_lib_ratio_cadd_cors,X16rL41_cSNV_post_lib_ratio_cadd_cors,X16rL41_tSNV_post_lib_ratio_cadd_cors,X16rL41_cSNV_post_pre_ratio_cadd_cors,X16rL41_tSNV_post_pre_ratio_cadd_cors,X16rL41_cSNV_post_pre_ratio_cadd_missense_cors,X16rL41_tSNV_post_pre_ratio_cadd_missense_cors,X16rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X16rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X16rL41_cSNV_post_pre_ratio_grantham_missense_cors,X16rL41_tSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X16rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X16rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X16rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X16rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X16rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X16rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X16rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X16rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X16rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X16rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X16rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X16rL42_cSNV_pre_lib_cors = cor(log2(X16rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16rL42_tSNV_pre_lib_cors = cor(log2(X16rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16rL42_cSNV_post_lib_cors = cor(log2(X16rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X16rL42_tSNV_post_lib_cors = cor(log2(X16rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X16rL42_cSNV_post_pre_cors = cor(log2(X16rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X16rL42_tSNV_post_pre_cors = cor(log2(X16rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X16rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X16rL42_cSNV_rna_lib_cors = cor(log2(X16rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X16rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16rL42_tSNV_rna_lib_cors = cor(log2(X16rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X16rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X16rL42_cSNV_rna_pre_cors = cor(log2(X16rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X16rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X16rL42_tSNV_rna_pre_cors = cor(log2(X16rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X16rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X16rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X16rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X16rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X16rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X16rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X16rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X16rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X16rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X16rL42_cors <- c("X16rL42",X16rL42_cSNV_pre_lib_cors,X16rL42_tSNV_pre_lib_cors,X16rL42_cSNV_post_lib_cors,X16rL42_tSNV_post_lib_cors,X16rL42_cSNV_post_pre_cors,X16rL42_tSNV_post_pre_cors,X16rL42_cSNV_rna_lib_cors,X16rL42_tSNV_rna_lib_cors,X16rL42_cSNV_rna_pre_cors,X16rL42_tSNV_rna_pre_cors,X16rL41rL42_cSNV_pre_cors,X16rL41rL42_tSNV_pre_cors,X16rL41rL42_cSNV_pre_lib_ratio_cors,X16rL41rL42_tSNV_pre_lib_ratio_cors,X16rL41rL42_cSNV_post_cors,X16rL41rL42_tSNV_post_cors,X16rL41rL42_cSNV_post_lib_ratio_cors,X16rL41rL42_tSNV_post_lib_ratio_cors,X16rL41rL42_cSNV_post_pre_ratio_cors,X16rL41rL42_tSNV_post_pre_ratio_cors,X16rL41rL42_cSNV_rna_cors,X16rL41rL42_tSNV_rna_cors,X16rL41rL42_tSNV_rna_pre_ratio_cors,X16rL42_cSNV_pre_lib_ratio_cadd_cors,X16rL42_tSNV_pre_lib_ratio_cadd_cors,X16rL42_cSNV_post_lib_ratio_cadd_cors,X16rL42_tSNV_post_lib_ratio_cadd_cors,X16rL42_cSNV_post_pre_ratio_cadd_cors,X16rL42_tSNV_post_pre_ratio_cadd_cors,X16rL42_cSNV_post_pre_ratio_cadd_missense_cors,X16rL42_tSNV_post_pre_ratio_cadd_missense_cors,X16rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X16rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X16rL42_cSNV_post_pre_ratio_grantham_missense_cors,X16rL42_tSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X16rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X16rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X16rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X16rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X16rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X16rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X16rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X16rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X16rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X16rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X16rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X16rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X16rL41)
rm(X16rL42)
gc()
X17rL41_file <- paste(experiment_dir_170731,'X17rL41','_annotated.txt',sep='')
X17rL42_file <- paste(experiment_dir_170731,'X17rL42','_annotated.txt',sep='')
X17rL41 <- read.table(X17rL41_file, header=TRUE, sep="\t")
X17rL42 <- read.table(X17rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X17 <- editing_info[which(editing_info$amplicon == 'X17'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X17_HDR_5_SNV = as.character(editing_info_X17$HDR_5_SNV)
X17_HDR_3_SNV = as.character(editing_info_X17$HDR_3_SNV)
#X17_cut_pos = as.character(editing_info_X17$cut_pos)
X17_cut_end = as.character(editing_info_X17$cut_end)
X17_mut_start = as.character(editing_info_X17$mut_start)
X17_mut_end = as.character(editing_info_X17$mut_end)
### Replicate 1
X17rL41_cSNV_all <- which(X17rL41[,'c_hdr_snv']=='True')
X17rL41_cSNV_all_df = X17rL41[X17rL41_cSNV_all,]
X17rL41_prog_var_all <- which(X17rL41[,'all_hdr_variant']=='True' & X17rL41[,'edit_string']!='-WT')
X17rL41_prog_var_all_df = X17rL41[X17rL41_prog_var_all,]
X17rL41_prog_map_all = which(X17rL41_prog_var_all_df[,'pos']!='REF')
X17rL41_prog_map_all_df = X17rL41_prog_var_all_df[X17rL41_prog_map_all,]
X17rL41_prog_map_exon_all = which(X17rL41_prog_map_all_df[,'cDNApos']!='REF' & X17rL41_prog_map_all_df[,'cDNApos']!='NA')
X17rL41_prog_map_exon_all_df = X17rL41_prog_map_all_df[X17rL41_prog_map_exon_all,]
X17rL41_prog_map_CADD = which(X17rL41_prog_map_all_df[,'CADD.phred']!='NA')
X17rL41_prog_map_CADD_df = X17rL41_prog_map_all_df[X17rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X17rL41_prog_var_thresh5 <- which(as.numeric(as.character(X17rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X17rL41_prog_var_thresh5_df = X17rL41_prog_var_all_df[X17rL41_prog_var_thresh5,]
X17rL41_prog_map_thresh5 <- which(as.numeric(as.character(X17rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X17rL41_prog_map_thresh5_df = X17rL41_prog_map_all_df[X17rL41_prog_map_thresh5,]
X17rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X17rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X17rL41_prog_map_exon_thresh5_df = X17rL41_prog_map_exon_all_df[X17rL41_prog_map_exon_thresh5,]
X17rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X17rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X17rL41_prog_map_CADD_thresh5_df = X17rL41_prog_map_CADD_df[X17rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X17rL41_prog_var_all_lib_count = length(X17rL41_prog_var_all_df$lib)
X17rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X17rL41_prog_var_all_min_lib_counts = min(X17rL41_prog_var_all_df$lib)
X17rL41_prog_var_all_min_lib_counts
X17rL41_prog_var_all_max_lib_counts = max(X17rL41_prog_var_all_df$lib)
X17rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X17rL41_prog_map_all_lib_count = length(X17rL41_prog_map_all_df$lib)
X17rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X17rL41_prog_map_all_min_lib_counts = min(X17rL41_prog_map_all_df$lib)
X17rL41_prog_map_all_min_lib_counts
X17rL41_prog_map_all_max_lib_counts = max(X17rL41_prog_map_all_df$lib)
X17rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X17rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X17rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X17rL41_prog_var_all_pre_count = length(X17rL41_prog_var_all_df$pre)
X17rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X17rL41_prog_var_all_min_pre_counts = min(X17rL41_prog_var_all_df$pre)
X17rL41_prog_var_all_min_pre_counts
X17rL41_prog_var_all_max_pre_counts = max(X17rL41_prog_var_all_df$pre)
X17rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X17rL41_prog_map_all_pre_count = length(X17rL41_prog_map_all_df$pre)
X17rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X17rL41_prog_map_all_min_pre_counts = min(X17rL41_prog_map_all_df$pre)
X17rL41_prog_map_all_min_pre_counts
X17rL41_prog_map_all_max_pre_counts = max(X17rL41_prog_map_all_df$pre)
X17rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X17rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X17rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X17rL41_prog_map_all_post_count = length(X17rL41_prog_map_all_df$post)
X17rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X17rL41_prog_map_all_min_post_counts = min(X17rL41_prog_map_all_df$post)
X17rL41_prog_map_all_min_post_counts
X17rL41_prog_map_all_max_post_counts = max(X17rL41_prog_map_all_df$post)
X17rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X17rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X17rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X17rL41_prog_map_all_syn_df <- X17rL41_prog_map_all_df[which(X17rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X17rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X17rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X17rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X17rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X17rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X17rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X17rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X17rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X17rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X17rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X17rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X17rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X17rL41_prog_map_all_min_rna_counts = min(X17rL41_prog_map_exon_all_df$tHDR_rna)
X17rL41_prog_map_all_min_rna_counts
X17rL41_prog_map_all_max_rna_counts = max(X17rL41_prog_map_exon_all_df$tHDR_rna)
X17rL41_prog_map_all_max_rna_counts
X17rL41_prog_map_all_min_rna_pseudo_freq = min(X17rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17rL41_prog_map_all_min_rna_pseudo_freq
X17rL41_prog_map_all_max_rna_pseudo_freq = max(X17rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17rL41_prog_map_all_max_rna_pseudo_freq
X17rL41_prog_map_all_min_rna_pre_ratio = min(X17rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17rL41_prog_map_all_min_rna_pre_ratio
X17rL41_prog_map_all_max_rna_pre_ratio = max(X17rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17rL41_prog_map_all_max_rna_pre_ratio
X17rL41_prog_map_all_min_rna_post_ratio = min(X17rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17rL41_prog_map_all_min_rna_post_ratio
X17rL41_prog_map_all_max_rna_post_ratio = max(X17rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X17rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X17rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X17rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X17rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X17rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X17rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X17rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X17rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X17rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X17rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X17rL41_prog_map_all_df$post_pre_ratio),log2(X17rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X17rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X17rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X17rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X17rL41_cSNV_all_corr_pre_count = length(X17rL41_cSNV_all_df$corr_pre)
X17rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X17rL41_cSNV_all_min_corr_pre_counts = min(X17rL41_cSNV_all_df$corr_pre)
X17rL41_cSNV_all_min_corr_pre_counts
X17rL41_cSNV_all_max_corr_pre_counts = max(X17rL41_cSNV_all_df$corr_pre)
X17rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X17rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X17rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X17rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X17rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X17rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_cSNV_all_corr_post_count = length(X17rL41_cSNV_all_df$corr_post)
X17rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X17rL41_cSNV_all_min_corr_post_counts = min(X17rL41_cSNV_all_df$corr_post)
X17rL41_cSNV_all_min_corr_post_counts
X17rL41_cSNV_all_max_corr_post_counts = max(X17rL41_cSNV_all_df$corr_post)
X17rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X17rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X17rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X17rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X17rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X17rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X17rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X17_p_hdr_snv = paste('p_hdr_',X17_cut_end,'_snv',sep='')
X17rL41_pSNV_all <- which(X17rL41[,X17_p_hdr_snv]=='True')
X17rL41_pSNV_all_df = X17rL41[X17rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_pSNV_all_lib_count = length(X17rL41_pSNV_all_df$lib)
X17rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X17rL41_pSNV_all_min_lib_counts = min(X17rL41_pSNV_all_df$lib)
X17rL41_pSNV_all_min_lib_counts
X17rL41_pSNV_all_max_lib_counts = max(X17rL41_pSNV_all_df$lib)
X17rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X17rL41_pSNV_all_pre_count = length(X17rL41_pSNV_all_df$pre)
X17rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X17rL41_pSNV_all_min_pre_counts = min(X17rL41_pSNV_all_df$pre)
X17rL41_pSNV_all_min_pre_counts
X17rL41_pSNV_all_max_pre_counts = max(X17rL41_pSNV_all_df$pre)
X17rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X17rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X17rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_pSNV_all_post_count = length(X17rL41_pSNV_all_df$post)
X17rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X17rL41_pSNV_all_min_post_counts = min(X17rL41_pSNV_all_df$post)
X17rL41_pSNV_all_min_post_counts
X17rL41_pSNV_all_max_post_counts = max(X17rL41_pSNV_all_df$post)
X17rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X17rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X17rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_prog_map_thresh5_lib_count = length(X17rL41_prog_map_thresh5_df$lib)
X17rL41_prog_map_thresh5_lib_count
X17rL41_prog_map_thresh5_min_lib_counts = min(X17rL41_prog_map_thresh5_df$lib)
X17rL41_prog_map_thresh5_min_lib_counts
X17rL41_prog_map_thresh5_max_lib_counts = max(X17rL41_prog_map_thresh5_df$lib)
X17rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X17rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X17rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_prog_map_thresh5_pre_count = length(X17rL41_prog_map_thresh5_df$pre)
X17rL41_prog_map_thresh5_pre_count
X17rL41_prog_map_thresh5_min_pre_counts = min(X17rL41_prog_map_thresh5_df$pre)
X17rL41_prog_map_thresh5_min_pre_counts
X17rL41_prog_map_thresh5_max_pre_counts = max(X17rL41_prog_map_thresh5_df$pre)
X17rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL41_prog_map_thresh5_post_count = length(X17rL41_prog_map_thresh5_df$post)
X17rL41_prog_map_thresh5_post_count
X17rL41_prog_map_thresh5_min_post_counts = min(X17rL41_prog_map_thresh5_df$post)
X17rL41_prog_map_thresh5_min_post_counts
X17rL41_prog_map_thresh5_max_post_counts = max(X17rL41_prog_map_thresh5_df$post)
X17rL41_prog_map_thresh5_max_post_counts
X17rL41_prog_map_thresh5_corr_post_count = length(X17rL41_cSNV_all_df$corr_post)
X17rL41_prog_map_thresh5_corr_post_count
X17rL41_prog_map_thresh5_min_corr_post_counts = min(X17rL41_cSNV_all_df$corr_post)
X17rL41_prog_map_thresh5_min_corr_post_counts
X17rL41_prog_map_thresh5_max_corr_post_counts = max(X17rL41_cSNV_all_df$corr_post)
X17rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X17rL41_pSNV_thresh5 <- which(X17rL41[,X17_p_hdr_snv]=='True' & as.numeric(as.character(X17rL41[,'pre_freq']))>=0.00001)
X17rL41_pSNV_thresh5_df = X17rL41[X17rL41_pSNV_thresh5,]
X17rL41_pSNV_thresh5_lib_count = length(X17rL41_pSNV_thresh5_df$lib)
X17rL41_pSNV_thresh5_lib_count
X17rL41_pSNV_thresh5_min_lib_counts = min(X17rL41_pSNV_thresh5_df$lib)
X17rL41_pSNV_thresh5_min_lib_counts
X17rL41_pSNV_thresh5_max_lib_counts = max(X17rL41_pSNV_thresh5_df$lib)
X17rL41_pSNV_thresh5_max_lib_counts
X17rL41_pSNV_thresh5_pre_count = length(X17rL41_pSNV_thresh5_df$pre)
X17rL41_pSNV_thresh5_pre_count
X17rL41_pSNV_thresh5_min_pre_counts = min(X17rL41_pSNV_thresh5_df$pre)
X17rL41_pSNV_thresh5_min_pre_counts
X17rL41_pSNV_thresh5_max_pre_counts = max(X17rL41_pSNV_thresh5_df$pre)
X17rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X17rL41_pSNV_thresh5_post_count = length(X17rL41_pSNV_thresh5_df$post)
X17rL41_pSNV_thresh5_post_count
X17rL41_pSNV_thresh5_min_post_counts = min(X17rL41_pSNV_thresh5_df$post)
X17rL41_pSNV_thresh5_min_post_counts
X17rL41_pSNV_thresh5_max_post_counts = max(X17rL41_pSNV_thresh5_df$post)
X17rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X17rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X17rL41_pSNV_thresh5_post_pos

### Replicate 2
X17rL42_cSNV_all <- which(X17rL42[,'c_hdr_snv']=='True')
X17rL42_cSNV_all_df = X17rL42[X17rL42_cSNV_all,]
X17rL42_prog_var_all <- which(X17rL42[,'all_hdr_variant']=='True' & X17rL42[,'edit_string']!='-WT')
X17rL42_prog_var_all_df = X17rL42[X17rL42_prog_var_all,]
X17rL42_prog_map_all = which(X17rL42_prog_var_all_df[,'pos']!='REF')
X17rL42_prog_map_all_df = X17rL42_prog_var_all_df[X17rL42_prog_map_all,]
X17rL42_prog_map_exon_all = which(X17rL42_prog_map_all_df[,'cDNApos']!='REF' & X17rL42_prog_map_all_df[,'cDNApos']!='NA')
X17rL42_prog_map_exon_all_df = X17rL42_prog_map_all_df[X17rL42_prog_map_exon_all,]
X17rL42_prog_map_CADD = which(X17rL42_prog_map_all_df[,'CADD.phred']!='NA')
X17rL42_prog_map_CADD_df = X17rL42_prog_map_all_df[X17rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X17rL42_prog_var_thresh5 <- which(as.numeric(as.character(X17rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X17rL42_prog_var_thresh5_df = X17rL42_prog_var_all_df[X17rL42_prog_var_thresh5,]
X17rL42_prog_map_thresh5 <- which(as.numeric(as.character(X17rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X17rL42_prog_map_thresh5_df = X17rL42_prog_map_all_df[X17rL42_prog_map_thresh5,]
X17rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X17rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X17rL42_prog_map_exon_thresh5_df = X17rL42_prog_map_exon_all_df[X17rL42_prog_map_exon_thresh5,]
X17rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X17rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X17rL42_prog_map_CADD_thresh5_df = X17rL42_prog_map_CADD_df[X17rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X17rL42_prog_var_all_lib_count = length(X17rL42_prog_var_all_df$lib)
X17rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X17rL42_prog_var_all_min_lib_counts = min(X17rL42_prog_var_all_df$lib)
X17rL42_prog_var_all_min_lib_counts
X17rL42_prog_var_all_max_lib_counts = max(X17rL42_prog_var_all_df$lib)
X17rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X17rL42_prog_map_all_lib_count = length(X17rL42_prog_map_all_df$lib)
X17rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X17rL42_prog_map_all_min_lib_counts = min(X17rL42_prog_map_all_df$lib)
X17rL42_prog_map_all_min_lib_counts
X17rL42_prog_map_all_max_lib_counts = max(X17rL42_prog_map_all_df$lib)
X17rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X17rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X17rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X17rL42_prog_var_all_pre_count = length(X17rL42_prog_var_all_df$pre)
X17rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X17rL42_prog_var_all_min_pre_counts = min(X17rL42_prog_var_all_df$pre)
X17rL42_prog_var_all_min_pre_counts
X17rL42_prog_var_all_max_pre_counts = max(X17rL42_prog_var_all_df$pre)
X17rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X17rL42_prog_map_all_pre_count = length(X17rL42_prog_map_all_df$pre)
X17rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X17rL42_prog_map_all_min_pre_counts = min(X17rL42_prog_map_all_df$pre)
X17rL42_prog_map_all_min_pre_counts
X17rL42_prog_map_all_max_pre_counts = max(X17rL42_prog_map_all_df$pre)
X17rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X17rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X17rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X17rL42_prog_map_all_post_count = length(X17rL42_prog_map_all_df$post)
X17rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X17rL42_prog_map_all_min_post_counts = min(X17rL42_prog_map_all_df$post)
X17rL42_prog_map_all_min_post_counts
X17rL42_prog_map_all_max_post_counts = max(X17rL42_prog_map_all_df$post)
X17rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X17rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X17rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X17rL42_prog_map_all_syn_df <- X17rL42_prog_map_all_df[which(X17rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X17rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X17rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X17rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X17rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X17rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X17rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X17rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X17rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X17rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X17rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X17rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X17rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X17rL42_prog_map_all_min_rna_counts = min(X17rL42_prog_map_exon_all_df$tHDR_rna)
X17rL42_prog_map_all_min_rna_counts
X17rL42_prog_map_all_max_rna_counts = max(X17rL42_prog_map_exon_all_df$tHDR_rna)
X17rL42_prog_map_all_max_rna_counts
X17rL42_prog_map_all_min_rna_pseudo_freq = min(X17rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17rL42_prog_map_all_min_rna_pseudo_freq
X17rL42_prog_map_all_max_rna_pseudo_freq = max(X17rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X17rL42_prog_map_all_max_rna_pseudo_freq
X17rL42_prog_map_all_min_rna_pre_ratio = min(X17rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17rL42_prog_map_all_min_rna_pre_ratio
X17rL42_prog_map_all_max_rna_pre_ratio = max(X17rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X17rL42_prog_map_all_max_rna_pre_ratio
X17rL42_prog_map_all_min_rna_post_ratio = min(X17rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17rL42_prog_map_all_min_rna_post_ratio
X17rL42_prog_map_all_max_rna_post_ratio = max(X17rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X17rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X17rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X17rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X17rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X17rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X17rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X17rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X17rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X17rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X17rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X17rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X17rL42_prog_map_all_df$post_pre_ratio),log2(X17rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X17rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X17rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X17rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X17rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X17rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X17rL42_cSNV_all_corr_pre_count = length(X17rL42_cSNV_all_df$corr_pre)
X17rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X17rL42_cSNV_all_min_corr_pre_counts = min(X17rL42_cSNV_all_df$corr_pre)
X17rL42_cSNV_all_min_corr_pre_counts
X17rL42_cSNV_all_max_corr_pre_counts = max(X17rL42_cSNV_all_df$corr_pre)
X17rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X17rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X17rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X17rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X17rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X17rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_cSNV_all_corr_post_count = length(X17rL42_cSNV_all_df$corr_post)
X17rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X17rL42_cSNV_all_min_corr_post_counts = min(X17rL42_cSNV_all_df$corr_post)
X17rL42_cSNV_all_min_corr_post_counts
X17rL42_cSNV_all_max_corr_post_counts = max(X17rL42_cSNV_all_df$corr_post)
X17rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X17rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X17rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X17rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X17rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X17rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X17rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X17_p_hdr_snv = paste('p_hdr_',X17_cut_end,'_snv',sep='')
X17rL42_pSNV_all <- which(X17rL42[,X17_p_hdr_snv]=='True')
X17rL42_pSNV_all_df = X17rL42[X17rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_pSNV_all_lib_count = length(X17rL42_pSNV_all_df$lib)
X17rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X17rL42_pSNV_all_min_lib_counts = min(X17rL42_pSNV_all_df$lib)
X17rL42_pSNV_all_min_lib_counts
X17rL42_pSNV_all_max_lib_counts = max(X17rL42_pSNV_all_df$lib)
X17rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X17rL42_pSNV_all_pre_count = length(X17rL42_pSNV_all_df$pre)
X17rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X17rL42_pSNV_all_min_pre_counts = min(X17rL42_pSNV_all_df$pre)
X17rL42_pSNV_all_min_pre_counts
X17rL42_pSNV_all_max_pre_counts = max(X17rL42_pSNV_all_df$pre)
X17rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X17rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X17rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_pSNV_all_post_count = length(X17rL42_pSNV_all_df$post)
X17rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X17rL42_pSNV_all_min_post_counts = min(X17rL42_pSNV_all_df$post)
X17rL42_pSNV_all_min_post_counts
X17rL42_pSNV_all_max_post_counts = max(X17rL42_pSNV_all_df$post)
X17rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X17rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X17rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_prog_map_thresh5_lib_count = length(X17rL42_prog_map_thresh5_df$lib)
X17rL42_prog_map_thresh5_lib_count
X17rL42_prog_map_thresh5_min_lib_counts = min(X17rL42_prog_map_thresh5_df$lib)
X17rL42_prog_map_thresh5_min_lib_counts
X17rL42_prog_map_thresh5_max_lib_counts = max(X17rL42_prog_map_thresh5_df$lib)
X17rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X17rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X17rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_prog_map_thresh5_pre_count = length(X17rL42_prog_map_thresh5_df$pre)
X17rL42_prog_map_thresh5_pre_count
X17rL42_prog_map_thresh5_min_pre_counts = min(X17rL42_prog_map_thresh5_df$pre)
X17rL42_prog_map_thresh5_min_pre_counts
X17rL42_prog_map_thresh5_max_pre_counts = max(X17rL42_prog_map_thresh5_df$pre)
X17rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X17 less than SGE region length x 3 due to PAM edits
X17rL42_prog_map_thresh5_post_count = length(X17rL42_prog_map_thresh5_df$post)
X17rL42_prog_map_thresh5_post_count
X17rL42_prog_map_thresh5_min_post_counts = min(X17rL42_prog_map_thresh5_df$post)
X17rL42_prog_map_thresh5_min_post_counts
X17rL42_prog_map_thresh5_max_post_counts = max(X17rL42_prog_map_thresh5_df$post)
X17rL42_prog_map_thresh5_max_post_counts
X17rL42_prog_map_thresh5_corr_post_count = length(X17rL42_prog_map_thresh5_df$corr_post)
X17rL42_prog_map_thresh5_corr_post_count
X17rL42_prog_map_thresh5_min_corr_post_counts = min(X17rL42_prog_map_thresh5_df$corr_post)
X17rL42_prog_map_thresh5_min_corr_post_counts
X17rL42_prog_map_thresh5_max_corr_post_counts = max(X17rL42_prog_map_thresh5_df$corr_post)
X17rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X17rL42_pSNV_thresh5 <- which(X17rL42[,X17_p_hdr_snv]=='True' & as.numeric(as.character(X17rL42[,'pre_freq']))>=0.00001)
X17rL42_pSNV_thresh5_df = X17rL42[X17rL42_pSNV_thresh5,]
X17rL42_pSNV_thresh5_lib_count = length(X17rL42_pSNV_thresh5_df$lib)
X17rL42_pSNV_thresh5_lib_count
X17rL42_pSNV_thresh5_min_lib_counts = min(X17rL42_pSNV_thresh5_df$lib)
X17rL42_pSNV_thresh5_min_lib_counts
X17rL42_pSNV_thresh5_max_lib_counts = max(X17rL42_pSNV_thresh5_df$lib)
X17rL42_pSNV_thresh5_max_lib_counts
X17rL42_pSNV_thresh5_pre_count = length(X17rL42_pSNV_thresh5_df$pre)
X17rL42_pSNV_thresh5_pre_count
X17rL42_pSNV_thresh5_min_pre_counts = min(X17rL42_pSNV_thresh5_df$pre)
X17rL42_pSNV_thresh5_min_pre_counts
X17rL42_pSNV_thresh5_max_pre_counts = max(X17rL42_pSNV_thresh5_df$pre)
X17rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X17rL42_pSNV_thresh5_post_count = length(X17rL42_pSNV_thresh5_df$post)
X17rL42_pSNV_thresh5_post_count
X17rL42_pSNV_thresh5_min_post_counts = min(X17rL42_pSNV_thresh5_df$post)
X17rL42_pSNV_thresh5_min_post_counts
X17rL42_pSNV_thresh5_max_post_counts = max(X17rL42_pSNV_thresh5_df$post)
X17rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X17rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X17rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X17rL41_prog_var_thresh5_df:
X17rL41_prog_var_thresh5_df_rL42_int <- X17rL41_prog_var_thresh5_df[which(X17rL41_prog_var_thresh5_df$variant %in% X17rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X17rL42_prog_var_thresh5_df:
X17rL42_prog_var_thresh5_df_rL41_int <- X17rL42_prog_var_thresh5_df[which(X17rL42_prog_var_thresh5_df$variant %in% X17rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X17rL41_prog_var_thresh5_df_rL42_int_ord <- X17rL41_prog_var_thresh5_df_rL42_int[order(X17rL41_prog_var_thresh5_df_rL42_int$variant),]
X17rL42_prog_var_thresh5_df_rL41_int_ord <- X17rL42_prog_var_thresh5_df_rL41_int[order(X17rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X17rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X17rL41rL42int_prog_var_thresh5_pre_count <- dim(X17rL41_prog_var_thresh5_df_rL42_int)[1] 
X17rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X17rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X17rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X17rL42_prog_var_thresh5_df_rL41_int_ord$lib
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X17rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X17rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X17rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X17rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X17rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X17rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X17rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X17rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X17rL41_cSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X17rL41_cSNV_missense_post_pre_med <- unname(X17rL41_cSNV_missense_post_pre_quarts[3])
X17rL41_cSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X17rL41_cSNV_syn_post_pre_med <- unname(X17rL41_cSNV_syn_post_pre_quarts[3])
X17rL41_cSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X17rL41_cSNV_nonsense_post_pre_med <- unname(X17rL41_cSNV_nonsense_post_pre_quarts[3])
X17rL41_cSNV_syn_to_non_post_pre_spread <- X17rL41_cSNV_syn_post_pre_med - X17rL41_cSNV_nonsense_post_pre_med

X17rL42_cSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X17rL42_cSNV_missense_post_pre_med <- unname(X17rL42_cSNV_missense_post_pre_quarts[3])
X17rL42_cSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X17rL42_cSNV_syn_post_pre_med <- unname(X17rL42_cSNV_syn_post_pre_quarts[3])
X17rL42_cSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X17rL42_cSNV_nonsense_post_pre_med <- unname(X17rL42_cSNV_nonsense_post_pre_quarts[3])
X17rL42_cSNV_syn_to_non_post_pre_spread <- X17rL42_cSNV_syn_post_pre_med - X17rL42_cSNV_nonsense_post_pre_med

X17rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_missense_post_pre_med <- unname(X17rL41rL42a_cSNV_missense_post_pre_quarts[3])
X17rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_syn_post_pre_med <- unname(X17rL41rL42a_cSNV_syn_post_pre_quarts[3])
X17rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X17rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X17rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X17rL41rL42a_cSNV_syn_post_pre_med - X17rL41rL42a_cSNV_nonsense_post_pre_med

X17rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_cSNV_missense_post_pre_med <- unname(X17rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X17rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_cSNV_syn_post_pre_med <- unname(X17rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X17rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X17rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X17rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X17rL41rL42pw_cSNV_syn_post_pre_med - X17rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X17rL41_tSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X17rL41_tSNV_missense_post_pre_med <- unname(X17rL41_tSNV_missense_post_pre_quarts[3])
X17rL41_tSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X17rL41_tSNV_syn_post_pre_med <- unname(X17rL41_tSNV_syn_post_pre_quarts[3])
X17rL41_tSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X17rL41_tSNV_nonsense_post_pre_med <- unname(X17rL41_tSNV_nonsense_post_pre_quarts[3])
X17rL41_tSNV_syn_to_non_post_pre_spread <- X17rL41_tSNV_syn_post_pre_med - X17rL41_tSNV_nonsense_post_pre_med

X17rL42_tSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X17rL42_tSNV_missense_post_pre_med <- unname(X17rL42_tSNV_missense_post_pre_quarts[3])
X17rL42_tSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X17rL42_tSNV_syn_post_pre_med <- unname(X17rL42_tSNV_syn_post_pre_quarts[3])
X17rL42_tSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X17rL42_tSNV_nonsense_post_pre_med <- unname(X17rL42_tSNV_nonsense_post_pre_quarts[3])
X17rL42_tSNV_syn_to_non_post_pre_spread <- X17rL42_tSNV_syn_post_pre_med - X17rL42_tSNV_nonsense_post_pre_med

X17rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_missense_post_pre_med <- unname(X17rL41rL42a_tSNV_missense_post_pre_quarts[3])
X17rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_syn_post_pre_med <- unname(X17rL41rL42a_tSNV_syn_post_pre_quarts[3])
X17rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X17rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X17rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X17rL41rL42a_tSNV_syn_post_pre_med - X17rL41rL42a_tSNV_nonsense_post_pre_med

X17rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_tSNV_missense_post_pre_med <- unname(X17rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X17rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_tSNV_syn_post_pre_med <- unname(X17rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X17rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X17rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X17rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X17rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X17rL41rL42pw_tSNV_syn_post_pre_med - X17rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X17rL41_cSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X17rL41_cSNV_missense_post_lib_med <- unname(X17rL41_cSNV_missense_post_lib_quarts[3])
X17rL41_cSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X17rL41_cSNV_syn_post_lib_med <- unname(X17rL41_cSNV_syn_post_lib_quarts[3])
X17rL41_cSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X17rL41_cSNV_nonsense_post_lib_med <- unname(X17rL41_cSNV_nonsense_post_lib_quarts[3])
X17rL41_cSNV_syn_to_non_post_lib_spread <- X17rL41_cSNV_syn_post_lib_med - X17rL41_cSNV_nonsense_post_lib_med

X17rL42_cSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X17rL42_cSNV_missense_post_lib_med <- unname(X17rL42_cSNV_missense_post_lib_quarts[3])
X17rL42_cSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X17rL42_cSNV_syn_post_lib_med <- unname(X17rL42_cSNV_syn_post_lib_quarts[3])
X17rL42_cSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X17rL42_cSNV_nonsense_post_lib_med <- unname(X17rL42_cSNV_nonsense_post_lib_quarts[3])
X17rL42_cSNV_syn_to_non_post_lib_spread <- X17rL42_cSNV_syn_post_lib_med - X17rL42_cSNV_nonsense_post_lib_med

X17rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_missense_post_lib_med <- unname(X17rL41rL42a_cSNV_missense_post_lib_quarts[3])
X17rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_syn_post_lib_med <- unname(X17rL41rL42a_cSNV_syn_post_lib_quarts[3])
X17rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X17rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X17rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X17rL41rL42a_cSNV_syn_post_lib_med - X17rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X17rL41_tSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X17rL41_tSNV_missense_post_lib_med <- unname(X17rL41_tSNV_missense_post_lib_quarts[3])
X17rL41_tSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X17rL41_tSNV_syn_post_lib_med <- unname(X17rL41_tSNV_syn_post_lib_quarts[3])
X17rL41_tSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X17rL41_tSNV_nonsense_post_lib_med <- unname(X17rL41_tSNV_nonsense_post_lib_quarts[3])
X17rL41_tSNV_syn_to_non_post_lib_spread <- X17rL41_tSNV_syn_post_lib_med - X17rL41_tSNV_nonsense_post_lib_med

X17rL42_tSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X17rL42_tSNV_missense_post_lib_med <- unname(X17rL42_tSNV_missense_post_lib_quarts[3])
X17rL42_tSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X17rL42_tSNV_syn_post_lib_med <- unname(X17rL42_tSNV_syn_post_lib_quarts[3])
X17rL42_tSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X17rL42_tSNV_nonsense_post_lib_med <- unname(X17rL42_tSNV_nonsense_post_lib_quarts[3])
X17rL42_tSNV_syn_to_non_post_lib_spread <- X17rL42_tSNV_syn_post_lib_med - X17rL42_tSNV_nonsense_post_lib_med

X17rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_missense_post_lib_med <- unname(X17rL41rL42a_tSNV_missense_post_lib_quarts[3])
X17rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_syn_post_lib_med <- unname(X17rL41rL42a_tSNV_syn_post_lib_quarts[3])
X17rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X17rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X17rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X17rL41rL42a_tSNV_syn_post_lib_med - X17rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X17rL41_cSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X17rL41_cSNV_missense_pre_lib_med <- unname(X17rL41_cSNV_missense_pre_lib_quarts[3])
X17rL41_cSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X17rL41_cSNV_syn_pre_lib_med <- unname(X17rL41_cSNV_syn_pre_lib_quarts[3])
X17rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X17rL41_cSNV_nonsense_pre_lib_med <- unname(X17rL41_cSNV_nonsense_pre_lib_quarts[3])
X17rL41_cSNV_syn_to_non_pre_lib_spread <- X17rL41_cSNV_syn_pre_lib_med - X17rL41_cSNV_nonsense_pre_lib_med

X17rL42_cSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X17rL42_cSNV_missense_pre_lib_med <- unname(X17rL42_cSNV_missense_pre_lib_quarts[3])
X17rL42_cSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X17rL42_cSNV_syn_pre_lib_med <- unname(X17rL42_cSNV_syn_pre_lib_quarts[3])
X17rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X17rL42_cSNV_nonsense_pre_lib_med <- unname(X17rL42_cSNV_nonsense_pre_lib_quarts[3])
X17rL42_cSNV_syn_to_non_pre_lib_spread <- X17rL42_cSNV_syn_pre_lib_med - X17rL42_cSNV_nonsense_pre_lib_med

X17rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_missense_pre_lib_med <- unname(X17rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X17rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_syn_pre_lib_med <- unname(X17rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X17rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X17rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X17rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X17rL41rL42a_cSNV_syn_pre_lib_med - X17rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X17rL41_tSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X17rL41_tSNV_missense_pre_lib_med <- unname(X17rL41_tSNV_missense_pre_lib_quarts[3])
X17rL41_tSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X17rL41_tSNV_syn_pre_lib_med <- unname(X17rL41_tSNV_syn_pre_lib_quarts[3])
X17rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X17rL41_tSNV_nonsense_pre_lib_med <- unname(X17rL41_tSNV_nonsense_pre_lib_quarts[3])
X17rL41_tSNV_syn_to_non_pre_lib_spread <- X17rL41_tSNV_syn_pre_lib_med - X17rL41_tSNV_nonsense_pre_lib_med

X17rL42_tSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X17rL42_tSNV_missense_pre_lib_med <- unname(X17rL42_tSNV_missense_pre_lib_quarts[3])
X17rL42_tSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X17rL42_tSNV_syn_pre_lib_med <- unname(X17rL42_tSNV_syn_pre_lib_quarts[3])
X17rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X17rL42_tSNV_nonsense_pre_lib_med <- unname(X17rL42_tSNV_nonsense_pre_lib_quarts[3])
X17rL42_tSNV_syn_to_non_pre_lib_spread <- X17rL42_tSNV_syn_pre_lib_med - X17rL42_tSNV_nonsense_pre_lib_med

X17rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_missense_pre_lib_med <- unname(X17rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X17rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_syn_pre_lib_med <- unname(X17rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X17rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X17rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X17rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X17rL41rL42a_tSNV_syn_pre_lib_med - X17rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X17rL41_tSNV_syn_rna_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X17rL41_tSNV_syn_rna_pre_med <- unname(X17rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X17rL41_tSNV_syn_rna_post_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X17rL41_tSNV_syn_rna_post_med <- unname(X17rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X17rL42_tSNV_syn_rna_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X17rL42_tSNV_syn_rna_pre_med <- unname(X17rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X17rL42_tSNV_syn_rna_post_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X17rL42_tSNV_syn_rna_post_med <- unname(X17rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X17rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_syn_rna_pre_med <- unname(X17rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X17rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X17rL41rL42a_tSNV_syn_rna_post_med <- unname(X17rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X17rL41_cSNV_syn_pre_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X17rL41_cSNV_syn_post_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X17rL41_cSNV_syn_post_lib_med
# tHDR
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X17rL41_tSNV_syn_pre_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X17rL41_tSNV_syn_post_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X17rL41_tSNV_syn_post_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X17rL41_tSNV_syn_rna_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X17rL41_tSNV_syn_rna_post_med

#rL42
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X17rL42_cSNV_syn_pre_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X17rL42_cSNV_syn_post_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X17rL42_cSNV_syn_post_lib_med
# tHDR
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X17rL42_tSNV_syn_pre_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X17rL42_tSNV_syn_post_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X17rL42_tSNV_syn_post_lib_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X17rL42_tSNV_syn_rna_pre_med
X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X17rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X17rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X17rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X17rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X17rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X17rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X17rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X17rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X17rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X17rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X17rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X17rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X17rL41_prog_var_thresh5_df_rL42_int_ord[which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X17rL41_prog_var_thresh5_df_rL42_int_ord
X17rL41_prog_map_thresh5_df_rL42_int_ord = which(X17rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X17rL41_prog_map_thresh5_df_rL42_int_ord_df = X17rL41_prog_var_thresh5_df_rL42_int_ord[X17rL41_prog_map_thresh5_df_rL42_int_ord,]
X17rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X17rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X17rL41_prog_map_thresh5_df_rL42_int_ord_df[X17rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X17rL41_prog_map_thresh5_df_rL42_int_ord_df[X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X17rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X17rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X17rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X17rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X17rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X17rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X17rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X17rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X17rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X17rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X17rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X17rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X17rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X17rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X17rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X17rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X17rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X17rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X17rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X17rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X17rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X17rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X17rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41_cSNV_post_pre_by_cadd_cor_s
#X17rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X17rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL42_cSNV_post_pre_by_cadd_cor_s

#X17rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X17rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41_cSNV_post_lib_by_cadd_cor_s
#X17rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X17rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X17rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X17rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41_tSNV_post_pre_by_cadd_cor_s
#X17rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X17rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL42_tSNV_post_pre_by_cadd_cor_s

#X17rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X17rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41_tSNV_post_lib_by_cadd_cor_s
#X17rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X17rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X17rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X17rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X17rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X17rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X17rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X17rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X17rL41_prog_var_all_lib_count
X17rL41_prog_var_all_pre_count
X17rL42_prog_var_all_pre_count
X17rL41_prog_map_thresh5_lib_count
X17rL41_prog_map_thresh5_pre_count
X17rL42_prog_map_thresh5_pre_count
X17rL41_prog_map_thresh5_post_count
X17rL42_prog_map_thresh5_post_count
X17rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X17rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X17rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X17rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X17rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X17rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X17rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X17rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X17rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X17rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X17rL41_cSNV_post_pre_by_cadd_cor_s
X17rL42_cSNV_post_pre_by_cadd_cor_s
X17rL41_cSNV_post_lib_by_cadd_cor_s
X17rL42_cSNV_post_lib_by_cadd_cor_s
X17rL41_tSNV_post_pre_by_cadd_cor_s
X17rL42_tSNV_post_pre_by_cadd_cor_s
X17rL41_tSNV_post_lib_by_cadd_cor_s
X17rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X17rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X17rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X17rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X17rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X17rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X17rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X17rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X17rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X17rL41_cSNV_syn_to_non_post_pre_spread
X17rL42_cSNV_syn_to_non_post_pre_spread
X17rL41rL42a_cSNV_syn_to_non_post_pre_spread
X17rL41_cSNV_syn_to_non_post_lib_spread
X17rL42_cSNV_syn_to_non_post_lib_spread
X17rL41rL42a_cSNV_syn_to_non_post_lib_spread
X17rL41_tSNV_syn_to_non_post_pre_spread
X17rL42_tSNV_syn_to_non_post_pre_spread
X17rL41rL42a_tSNV_syn_to_non_post_pre_spread
X17rL41_tSNV_syn_to_non_post_lib_spread
X17rL42_tSNV_syn_to_non_post_lib_spread
X17rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X17rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X17rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X17rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X17rL41_cSNV_pre_lib_cors = cor(log2(X17rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17rL41_tSNV_pre_lib_cors = cor(log2(X17rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17rL41_cSNV_post_lib_cors = cor(log2(X17rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X17rL41_tSNV_post_lib_cors = cor(log2(X17rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X17rL41_cSNV_post_pre_cors = cor(log2(X17rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17rL41_tSNV_post_pre_cors = cor(log2(X17rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X17rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17rL41_cSNV_rna_lib_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X17rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17rL41_tSNV_rna_lib_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X17rL41_cSNV_rna_pre_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X17rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17rL41_tSNV_rna_pre_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X17rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17rL41rL42_cSNV_pre_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X17rL41rL42_tSNV_pre_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X17rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X17rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X17rL41rL42_cSNV_post_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X17rL41rL42_tSNV_post_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X17rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X17rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X17rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X17rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X17rL41rL42_cSNV_rna_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X17rL41rL42_tSNV_rna_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X17rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X17rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X17rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X17rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X17rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X17rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X17rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X17rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X17rL41_cors <- c("X17rL41",X17rL41_cSNV_pre_lib_cors,X17rL41_tSNV_pre_lib_cors,X17rL41_cSNV_post_lib_cors,X17rL41_tSNV_post_lib_cors,X17rL41_cSNV_post_pre_cors,X17rL41_tSNV_post_pre_cors,X17rL41_cSNV_rna_lib_cors,X17rL41_tSNV_rna_lib_cors,X17rL41_cSNV_rna_pre_cors,X17rL41_tSNV_rna_pre_cors,X17rL41rL42_cSNV_pre_cors,X17rL41rL42_tSNV_pre_cors,X17rL41rL42_cSNV_pre_lib_ratio_cors,X17rL41rL42_tSNV_pre_lib_ratio_cors,X17rL41rL42_cSNV_post_cors,X17rL41rL42_tSNV_post_cors,X17rL41rL42_cSNV_post_lib_ratio_cors,X17rL41rL42_tSNV_post_lib_ratio_cors,X17rL41rL42_cSNV_post_pre_ratio_cors,X17rL41rL42_tSNV_post_pre_ratio_cors,X17rL41rL42_cSNV_rna_cors,X17rL41rL42_tSNV_rna_cors,X17rL41rL42_tSNV_rna_pre_ratio_cors,X17rL41_cSNV_pre_lib_ratio_cadd_cors,X17rL41_tSNV_pre_lib_ratio_cadd_cors,X17rL41_cSNV_post_lib_ratio_cadd_cors,X17rL41_tSNV_post_lib_ratio_cadd_cors,X17rL41_cSNV_post_pre_ratio_cadd_cors,X17rL41_tSNV_post_pre_ratio_cadd_cors,X17rL41_cSNV_post_pre_ratio_cadd_missense_cors,X17rL41_tSNV_post_pre_ratio_cadd_missense_cors,X17rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X17rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X17rL41_cSNV_post_pre_ratio_grantham_missense_cors,X17rL41_tSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X17rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X17rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X17rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X17rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X17rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X17rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X17rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X17rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X17rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X17rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X17rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X17rL42_cSNV_pre_lib_cors = cor(log2(X17rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17rL42_tSNV_pre_lib_cors = cor(log2(X17rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17rL42_cSNV_post_lib_cors = cor(log2(X17rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X17rL42_tSNV_post_lib_cors = cor(log2(X17rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X17rL42_cSNV_post_pre_cors = cor(log2(X17rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X17rL42_tSNV_post_pre_cors = cor(log2(X17rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X17rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X17rL42_cSNV_rna_lib_cors = cor(log2(X17rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X17rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17rL42_tSNV_rna_lib_cors = cor(log2(X17rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X17rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X17rL42_cSNV_rna_pre_cors = cor(log2(X17rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X17rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X17rL42_tSNV_rna_pre_cors = cor(log2(X17rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X17rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X17rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X17rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X17rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X17rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X17rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X17rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X17rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X17rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X17rL42_cors <- c("X17rL42",X17rL42_cSNV_pre_lib_cors,X17rL42_tSNV_pre_lib_cors,X17rL42_cSNV_post_lib_cors,X17rL42_tSNV_post_lib_cors,X17rL42_cSNV_post_pre_cors,X17rL42_tSNV_post_pre_cors,X17rL42_cSNV_rna_lib_cors,X17rL42_tSNV_rna_lib_cors,X17rL42_cSNV_rna_pre_cors,X17rL42_tSNV_rna_pre_cors,X17rL41rL42_cSNV_pre_cors,X17rL41rL42_tSNV_pre_cors,X17rL41rL42_cSNV_pre_lib_ratio_cors,X17rL41rL42_tSNV_pre_lib_ratio_cors,X17rL41rL42_cSNV_post_cors,X17rL41rL42_tSNV_post_cors,X17rL41rL42_cSNV_post_lib_ratio_cors,X17rL41rL42_tSNV_post_lib_ratio_cors,X17rL41rL42_cSNV_post_pre_ratio_cors,X17rL41rL42_tSNV_post_pre_ratio_cors,X17rL41rL42_cSNV_rna_cors,X17rL41rL42_tSNV_rna_cors,X17rL41rL42_tSNV_rna_pre_ratio_cors,X17rL42_cSNV_pre_lib_ratio_cadd_cors,X17rL42_tSNV_pre_lib_ratio_cadd_cors,X17rL42_cSNV_post_lib_ratio_cadd_cors,X17rL42_tSNV_post_lib_ratio_cadd_cors,X17rL42_cSNV_post_pre_ratio_cadd_cors,X17rL42_tSNV_post_pre_ratio_cadd_cors,X17rL42_cSNV_post_pre_ratio_cadd_missense_cors,X17rL42_tSNV_post_pre_ratio_cadd_missense_cors,X17rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X17rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X17rL42_cSNV_post_pre_ratio_grantham_missense_cors,X17rL42_tSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X17rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X17rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X17rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X17rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X17rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X17rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X17rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X17rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X17rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X17rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X17rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X17rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X17rL41)
rm(X17rL42)
gc()
X18rL41_file <- paste(experiment_dir_170731,'X18rL41','_annotated.txt',sep='')
X18rL42_file <- paste(experiment_dir_170731,'X18rL42','_annotated.txt',sep='')
X18rL41 <- read.table(X18rL41_file, header=TRUE, sep="\t")
X18rL42 <- read.table(X18rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X18 <- editing_info[which(editing_info$amplicon == 'X18'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X18_HDR_5_SNV = as.character(editing_info_X18$HDR_5_SNV)
X18_HDR_3_SNV = as.character(editing_info_X18$HDR_3_SNV)
#X18_cut_pos = as.character(editing_info_X18$cut_pos)
X18_cut_end = as.character(editing_info_X18$cut_end)
X18_mut_start = as.character(editing_info_X18$mut_start)
X18_mut_end = as.character(editing_info_X18$mut_end)
### Replicate 1
X18rL41_cSNV_all <- which(X18rL41[,'c_hdr_snv']=='True')
X18rL41_cSNV_all_df = X18rL41[X18rL41_cSNV_all,]
X18rL41_prog_var_all <- which(X18rL41[,'all_hdr_variant']=='True' & X18rL41[,'edit_string']!='-WT')
X18rL41_prog_var_all_df = X18rL41[X18rL41_prog_var_all,]
X18rL41_prog_map_all = which(X18rL41_prog_var_all_df[,'pos']!='REF')
X18rL41_prog_map_all_df = X18rL41_prog_var_all_df[X18rL41_prog_map_all,]
X18rL41_prog_map_exon_all = which(X18rL41_prog_map_all_df[,'cDNApos']!='REF' & X18rL41_prog_map_all_df[,'cDNApos']!='NA')
X18rL41_prog_map_exon_all_df = X18rL41_prog_map_all_df[X18rL41_prog_map_exon_all,]
X18rL41_prog_map_CADD = which(X18rL41_prog_map_all_df[,'CADD.phred']!='NA')
X18rL41_prog_map_CADD_df = X18rL41_prog_map_all_df[X18rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X18rL41_prog_var_thresh5 <- which(as.numeric(as.character(X18rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X18rL41_prog_var_thresh5_df = X18rL41_prog_var_all_df[X18rL41_prog_var_thresh5,]
X18rL41_prog_map_thresh5 <- which(as.numeric(as.character(X18rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X18rL41_prog_map_thresh5_df = X18rL41_prog_map_all_df[X18rL41_prog_map_thresh5,]
X18rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X18rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X18rL41_prog_map_exon_thresh5_df = X18rL41_prog_map_exon_all_df[X18rL41_prog_map_exon_thresh5,]
X18rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X18rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X18rL41_prog_map_CADD_thresh5_df = X18rL41_prog_map_CADD_df[X18rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X18rL41_prog_var_all_lib_count = length(X18rL41_prog_var_all_df$lib)
X18rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X18rL41_prog_var_all_min_lib_counts = min(X18rL41_prog_var_all_df$lib)
X18rL41_prog_var_all_min_lib_counts
X18rL41_prog_var_all_max_lib_counts = max(X18rL41_prog_var_all_df$lib)
X18rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X18rL41_prog_map_all_lib_count = length(X18rL41_prog_map_all_df$lib)
X18rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X18rL41_prog_map_all_min_lib_counts = min(X18rL41_prog_map_all_df$lib)
X18rL41_prog_map_all_min_lib_counts
X18rL41_prog_map_all_max_lib_counts = max(X18rL41_prog_map_all_df$lib)
X18rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X18rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X18rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X18rL41_prog_var_all_pre_count = length(X18rL41_prog_var_all_df$pre)
X18rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X18rL41_prog_var_all_min_pre_counts = min(X18rL41_prog_var_all_df$pre)
X18rL41_prog_var_all_min_pre_counts
X18rL41_prog_var_all_max_pre_counts = max(X18rL41_prog_var_all_df$pre)
X18rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X18rL41_prog_map_all_pre_count = length(X18rL41_prog_map_all_df$pre)
X18rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X18rL41_prog_map_all_min_pre_counts = min(X18rL41_prog_map_all_df$pre)
X18rL41_prog_map_all_min_pre_counts
X18rL41_prog_map_all_max_pre_counts = max(X18rL41_prog_map_all_df$pre)
X18rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X18rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X18rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X18rL41_prog_map_all_post_count = length(X18rL41_prog_map_all_df$post)
X18rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X18rL41_prog_map_all_min_post_counts = min(X18rL41_prog_map_all_df$post)
X18rL41_prog_map_all_min_post_counts
X18rL41_prog_map_all_max_post_counts = max(X18rL41_prog_map_all_df$post)
X18rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X18rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X18rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X18rL41_prog_map_all_syn_df <- X18rL41_prog_map_all_df[which(X18rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X18rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X18rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X18rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X18rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X18rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X18rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X18rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X18rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X18rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X18rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X18rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X18rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X18rL41_prog_map_all_min_rna_counts = min(X18rL41_prog_map_exon_all_df$tHDR_rna)
X18rL41_prog_map_all_min_rna_counts
X18rL41_prog_map_all_max_rna_counts = max(X18rL41_prog_map_exon_all_df$tHDR_rna)
X18rL41_prog_map_all_max_rna_counts
X18rL41_prog_map_all_min_rna_pseudo_freq = min(X18rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18rL41_prog_map_all_min_rna_pseudo_freq
X18rL41_prog_map_all_max_rna_pseudo_freq = max(X18rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18rL41_prog_map_all_max_rna_pseudo_freq
X18rL41_prog_map_all_min_rna_pre_ratio = min(X18rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18rL41_prog_map_all_min_rna_pre_ratio
X18rL41_prog_map_all_max_rna_pre_ratio = max(X18rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18rL41_prog_map_all_max_rna_pre_ratio
X18rL41_prog_map_all_min_rna_post_ratio = min(X18rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18rL41_prog_map_all_min_rna_post_ratio
X18rL41_prog_map_all_max_rna_post_ratio = max(X18rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X18rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X18rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X18rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X18rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X18rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X18rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X18rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X18rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X18rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X18rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X18rL41_prog_map_all_df$post_pre_ratio),log2(X18rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X18rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X18rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X18rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X18rL41_cSNV_all_corr_pre_count = length(X18rL41_cSNV_all_df$corr_pre)
X18rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X18rL41_cSNV_all_min_corr_pre_counts = min(X18rL41_cSNV_all_df$corr_pre)
X18rL41_cSNV_all_min_corr_pre_counts
X18rL41_cSNV_all_max_corr_pre_counts = max(X18rL41_cSNV_all_df$corr_pre)
X18rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X18rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X18rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X18rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X18rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X18rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_cSNV_all_corr_post_count = length(X18rL41_cSNV_all_df$corr_post)
X18rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X18rL41_cSNV_all_min_corr_post_counts = min(X18rL41_cSNV_all_df$corr_post)
X18rL41_cSNV_all_min_corr_post_counts
X18rL41_cSNV_all_max_corr_post_counts = max(X18rL41_cSNV_all_df$corr_post)
X18rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X18rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X18rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X18rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X18rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X18rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X18rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X18_p_hdr_snv = paste('p_hdr_',X18_cut_end,'_snv',sep='')
X18rL41_pSNV_all <- which(X18rL41[,X18_p_hdr_snv]=='True')
X18rL41_pSNV_all_df = X18rL41[X18rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_pSNV_all_lib_count = length(X18rL41_pSNV_all_df$lib)
X18rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X18rL41_pSNV_all_min_lib_counts = min(X18rL41_pSNV_all_df$lib)
X18rL41_pSNV_all_min_lib_counts
X18rL41_pSNV_all_max_lib_counts = max(X18rL41_pSNV_all_df$lib)
X18rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X18rL41_pSNV_all_pre_count = length(X18rL41_pSNV_all_df$pre)
X18rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X18rL41_pSNV_all_min_pre_counts = min(X18rL41_pSNV_all_df$pre)
X18rL41_pSNV_all_min_pre_counts
X18rL41_pSNV_all_max_pre_counts = max(X18rL41_pSNV_all_df$pre)
X18rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X18rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X18rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_pSNV_all_post_count = length(X18rL41_pSNV_all_df$post)
X18rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X18rL41_pSNV_all_min_post_counts = min(X18rL41_pSNV_all_df$post)
X18rL41_pSNV_all_min_post_counts
X18rL41_pSNV_all_max_post_counts = max(X18rL41_pSNV_all_df$post)
X18rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X18rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X18rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_prog_map_thresh5_lib_count = length(X18rL41_prog_map_thresh5_df$lib)
X18rL41_prog_map_thresh5_lib_count
X18rL41_prog_map_thresh5_min_lib_counts = min(X18rL41_prog_map_thresh5_df$lib)
X18rL41_prog_map_thresh5_min_lib_counts
X18rL41_prog_map_thresh5_max_lib_counts = max(X18rL41_prog_map_thresh5_df$lib)
X18rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X18rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X18rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_prog_map_thresh5_pre_count = length(X18rL41_prog_map_thresh5_df$pre)
X18rL41_prog_map_thresh5_pre_count
X18rL41_prog_map_thresh5_min_pre_counts = min(X18rL41_prog_map_thresh5_df$pre)
X18rL41_prog_map_thresh5_min_pre_counts
X18rL41_prog_map_thresh5_max_pre_counts = max(X18rL41_prog_map_thresh5_df$pre)
X18rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL41_prog_map_thresh5_post_count = length(X18rL41_prog_map_thresh5_df$post)
X18rL41_prog_map_thresh5_post_count
X18rL41_prog_map_thresh5_min_post_counts = min(X18rL41_prog_map_thresh5_df$post)
X18rL41_prog_map_thresh5_min_post_counts
X18rL41_prog_map_thresh5_max_post_counts = max(X18rL41_prog_map_thresh5_df$post)
X18rL41_prog_map_thresh5_max_post_counts
X18rL41_prog_map_thresh5_corr_post_count = length(X18rL41_cSNV_all_df$corr_post)
X18rL41_prog_map_thresh5_corr_post_count
X18rL41_prog_map_thresh5_min_corr_post_counts = min(X18rL41_cSNV_all_df$corr_post)
X18rL41_prog_map_thresh5_min_corr_post_counts
X18rL41_prog_map_thresh5_max_corr_post_counts = max(X18rL41_cSNV_all_df$corr_post)
X18rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X18rL41_pSNV_thresh5 <- which(X18rL41[,X18_p_hdr_snv]=='True' & as.numeric(as.character(X18rL41[,'pre_freq']))>=0.00001)
X18rL41_pSNV_thresh5_df = X18rL41[X18rL41_pSNV_thresh5,]
X18rL41_pSNV_thresh5_lib_count = length(X18rL41_pSNV_thresh5_df$lib)
X18rL41_pSNV_thresh5_lib_count
X18rL41_pSNV_thresh5_min_lib_counts = min(X18rL41_pSNV_thresh5_df$lib)
X18rL41_pSNV_thresh5_min_lib_counts
X18rL41_pSNV_thresh5_max_lib_counts = max(X18rL41_pSNV_thresh5_df$lib)
X18rL41_pSNV_thresh5_max_lib_counts
X18rL41_pSNV_thresh5_pre_count = length(X18rL41_pSNV_thresh5_df$pre)
X18rL41_pSNV_thresh5_pre_count
X18rL41_pSNV_thresh5_min_pre_counts = min(X18rL41_pSNV_thresh5_df$pre)
X18rL41_pSNV_thresh5_min_pre_counts
X18rL41_pSNV_thresh5_max_pre_counts = max(X18rL41_pSNV_thresh5_df$pre)
X18rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X18rL41_pSNV_thresh5_post_count = length(X18rL41_pSNV_thresh5_df$post)
X18rL41_pSNV_thresh5_post_count
X18rL41_pSNV_thresh5_min_post_counts = min(X18rL41_pSNV_thresh5_df$post)
X18rL41_pSNV_thresh5_min_post_counts
X18rL41_pSNV_thresh5_max_post_counts = max(X18rL41_pSNV_thresh5_df$post)
X18rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X18rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X18rL41_pSNV_thresh5_post_pos

### Replicate 2
X18rL42_cSNV_all <- which(X18rL42[,'c_hdr_snv']=='True')
X18rL42_cSNV_all_df = X18rL42[X18rL42_cSNV_all,]
X18rL42_prog_var_all <- which(X18rL42[,'all_hdr_variant']=='True' & X18rL42[,'edit_string']!='-WT')
X18rL42_prog_var_all_df = X18rL42[X18rL42_prog_var_all,]
X18rL42_prog_map_all = which(X18rL42_prog_var_all_df[,'pos']!='REF')
X18rL42_prog_map_all_df = X18rL42_prog_var_all_df[X18rL42_prog_map_all,]
X18rL42_prog_map_exon_all = which(X18rL42_prog_map_all_df[,'cDNApos']!='REF' & X18rL42_prog_map_all_df[,'cDNApos']!='NA')
X18rL42_prog_map_exon_all_df = X18rL42_prog_map_all_df[X18rL42_prog_map_exon_all,]
X18rL42_prog_map_CADD = which(X18rL42_prog_map_all_df[,'CADD.phred']!='NA')
X18rL42_prog_map_CADD_df = X18rL42_prog_map_all_df[X18rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X18rL42_prog_var_thresh5 <- which(as.numeric(as.character(X18rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X18rL42_prog_var_thresh5_df = X18rL42_prog_var_all_df[X18rL42_prog_var_thresh5,]
X18rL42_prog_map_thresh5 <- which(as.numeric(as.character(X18rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X18rL42_prog_map_thresh5_df = X18rL42_prog_map_all_df[X18rL42_prog_map_thresh5,]
X18rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X18rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X18rL42_prog_map_exon_thresh5_df = X18rL42_prog_map_exon_all_df[X18rL42_prog_map_exon_thresh5,]
X18rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X18rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X18rL42_prog_map_CADD_thresh5_df = X18rL42_prog_map_CADD_df[X18rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X18rL42_prog_var_all_lib_count = length(X18rL42_prog_var_all_df$lib)
X18rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X18rL42_prog_var_all_min_lib_counts = min(X18rL42_prog_var_all_df$lib)
X18rL42_prog_var_all_min_lib_counts
X18rL42_prog_var_all_max_lib_counts = max(X18rL42_prog_var_all_df$lib)
X18rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X18rL42_prog_map_all_lib_count = length(X18rL42_prog_map_all_df$lib)
X18rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X18rL42_prog_map_all_min_lib_counts = min(X18rL42_prog_map_all_df$lib)
X18rL42_prog_map_all_min_lib_counts
X18rL42_prog_map_all_max_lib_counts = max(X18rL42_prog_map_all_df$lib)
X18rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X18rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X18rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X18rL42_prog_var_all_pre_count = length(X18rL42_prog_var_all_df$pre)
X18rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X18rL42_prog_var_all_min_pre_counts = min(X18rL42_prog_var_all_df$pre)
X18rL42_prog_var_all_min_pre_counts
X18rL42_prog_var_all_max_pre_counts = max(X18rL42_prog_var_all_df$pre)
X18rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X18rL42_prog_map_all_pre_count = length(X18rL42_prog_map_all_df$pre)
X18rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X18rL42_prog_map_all_min_pre_counts = min(X18rL42_prog_map_all_df$pre)
X18rL42_prog_map_all_min_pre_counts
X18rL42_prog_map_all_max_pre_counts = max(X18rL42_prog_map_all_df$pre)
X18rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X18rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X18rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X18rL42_prog_map_all_post_count = length(X18rL42_prog_map_all_df$post)
X18rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X18rL42_prog_map_all_min_post_counts = min(X18rL42_prog_map_all_df$post)
X18rL42_prog_map_all_min_post_counts
X18rL42_prog_map_all_max_post_counts = max(X18rL42_prog_map_all_df$post)
X18rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X18rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X18rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X18rL42_prog_map_all_syn_df <- X18rL42_prog_map_all_df[which(X18rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X18rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X18rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X18rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X18rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X18rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X18rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X18rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X18rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X18rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X18rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X18rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X18rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X18rL42_prog_map_all_min_rna_counts = min(X18rL42_prog_map_exon_all_df$tHDR_rna)
X18rL42_prog_map_all_min_rna_counts
X18rL42_prog_map_all_max_rna_counts = max(X18rL42_prog_map_exon_all_df$tHDR_rna)
X18rL42_prog_map_all_max_rna_counts
X18rL42_prog_map_all_min_rna_pseudo_freq = min(X18rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18rL42_prog_map_all_min_rna_pseudo_freq
X18rL42_prog_map_all_max_rna_pseudo_freq = max(X18rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X18rL42_prog_map_all_max_rna_pseudo_freq
X18rL42_prog_map_all_min_rna_pre_ratio = min(X18rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18rL42_prog_map_all_min_rna_pre_ratio
X18rL42_prog_map_all_max_rna_pre_ratio = max(X18rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X18rL42_prog_map_all_max_rna_pre_ratio
X18rL42_prog_map_all_min_rna_post_ratio = min(X18rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18rL42_prog_map_all_min_rna_post_ratio
X18rL42_prog_map_all_max_rna_post_ratio = max(X18rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X18rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X18rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X18rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X18rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X18rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X18rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X18rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X18rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X18rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X18rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X18rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X18rL42_prog_map_all_df$post_pre_ratio),log2(X18rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X18rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X18rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X18rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X18rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X18rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X18rL42_cSNV_all_corr_pre_count = length(X18rL42_cSNV_all_df$corr_pre)
X18rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X18rL42_cSNV_all_min_corr_pre_counts = min(X18rL42_cSNV_all_df$corr_pre)
X18rL42_cSNV_all_min_corr_pre_counts
X18rL42_cSNV_all_max_corr_pre_counts = max(X18rL42_cSNV_all_df$corr_pre)
X18rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X18rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X18rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X18rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X18rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X18rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_cSNV_all_corr_post_count = length(X18rL42_cSNV_all_df$corr_post)
X18rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X18rL42_cSNV_all_min_corr_post_counts = min(X18rL42_cSNV_all_df$corr_post)
X18rL42_cSNV_all_min_corr_post_counts
X18rL42_cSNV_all_max_corr_post_counts = max(X18rL42_cSNV_all_df$corr_post)
X18rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X18rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X18rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X18rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X18rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X18rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X18rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X18_p_hdr_snv = paste('p_hdr_',X18_cut_end,'_snv',sep='')
X18rL42_pSNV_all <- which(X18rL42[,X18_p_hdr_snv]=='True')
X18rL42_pSNV_all_df = X18rL42[X18rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_pSNV_all_lib_count = length(X18rL42_pSNV_all_df$lib)
X18rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X18rL42_pSNV_all_min_lib_counts = min(X18rL42_pSNV_all_df$lib)
X18rL42_pSNV_all_min_lib_counts
X18rL42_pSNV_all_max_lib_counts = max(X18rL42_pSNV_all_df$lib)
X18rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X18rL42_pSNV_all_pre_count = length(X18rL42_pSNV_all_df$pre)
X18rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X18rL42_pSNV_all_min_pre_counts = min(X18rL42_pSNV_all_df$pre)
X18rL42_pSNV_all_min_pre_counts
X18rL42_pSNV_all_max_pre_counts = max(X18rL42_pSNV_all_df$pre)
X18rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X18rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X18rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_pSNV_all_post_count = length(X18rL42_pSNV_all_df$post)
X18rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X18rL42_pSNV_all_min_post_counts = min(X18rL42_pSNV_all_df$post)
X18rL42_pSNV_all_min_post_counts
X18rL42_pSNV_all_max_post_counts = max(X18rL42_pSNV_all_df$post)
X18rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X18rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X18rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_prog_map_thresh5_lib_count = length(X18rL42_prog_map_thresh5_df$lib)
X18rL42_prog_map_thresh5_lib_count
X18rL42_prog_map_thresh5_min_lib_counts = min(X18rL42_prog_map_thresh5_df$lib)
X18rL42_prog_map_thresh5_min_lib_counts
X18rL42_prog_map_thresh5_max_lib_counts = max(X18rL42_prog_map_thresh5_df$lib)
X18rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X18rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X18rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_prog_map_thresh5_pre_count = length(X18rL42_prog_map_thresh5_df$pre)
X18rL42_prog_map_thresh5_pre_count
X18rL42_prog_map_thresh5_min_pre_counts = min(X18rL42_prog_map_thresh5_df$pre)
X18rL42_prog_map_thresh5_min_pre_counts
X18rL42_prog_map_thresh5_max_pre_counts = max(X18rL42_prog_map_thresh5_df$pre)
X18rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X18 less than SGE region length x 3 due to PAM edits
X18rL42_prog_map_thresh5_post_count = length(X18rL42_prog_map_thresh5_df$post)
X18rL42_prog_map_thresh5_post_count
X18rL42_prog_map_thresh5_min_post_counts = min(X18rL42_prog_map_thresh5_df$post)
X18rL42_prog_map_thresh5_min_post_counts
X18rL42_prog_map_thresh5_max_post_counts = max(X18rL42_prog_map_thresh5_df$post)
X18rL42_prog_map_thresh5_max_post_counts
X18rL42_prog_map_thresh5_corr_post_count = length(X18rL42_prog_map_thresh5_df$corr_post)
X18rL42_prog_map_thresh5_corr_post_count
X18rL42_prog_map_thresh5_min_corr_post_counts = min(X18rL42_prog_map_thresh5_df$corr_post)
X18rL42_prog_map_thresh5_min_corr_post_counts
X18rL42_prog_map_thresh5_max_corr_post_counts = max(X18rL42_prog_map_thresh5_df$corr_post)
X18rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X18rL42_pSNV_thresh5 <- which(X18rL42[,X18_p_hdr_snv]=='True' & as.numeric(as.character(X18rL42[,'pre_freq']))>=0.00001)
X18rL42_pSNV_thresh5_df = X18rL42[X18rL42_pSNV_thresh5,]
X18rL42_pSNV_thresh5_lib_count = length(X18rL42_pSNV_thresh5_df$lib)
X18rL42_pSNV_thresh5_lib_count
X18rL42_pSNV_thresh5_min_lib_counts = min(X18rL42_pSNV_thresh5_df$lib)
X18rL42_pSNV_thresh5_min_lib_counts
X18rL42_pSNV_thresh5_max_lib_counts = max(X18rL42_pSNV_thresh5_df$lib)
X18rL42_pSNV_thresh5_max_lib_counts
X18rL42_pSNV_thresh5_pre_count = length(X18rL42_pSNV_thresh5_df$pre)
X18rL42_pSNV_thresh5_pre_count
X18rL42_pSNV_thresh5_min_pre_counts = min(X18rL42_pSNV_thresh5_df$pre)
X18rL42_pSNV_thresh5_min_pre_counts
X18rL42_pSNV_thresh5_max_pre_counts = max(X18rL42_pSNV_thresh5_df$pre)
X18rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X18rL42_pSNV_thresh5_post_count = length(X18rL42_pSNV_thresh5_df$post)
X18rL42_pSNV_thresh5_post_count
X18rL42_pSNV_thresh5_min_post_counts = min(X18rL42_pSNV_thresh5_df$post)
X18rL42_pSNV_thresh5_min_post_counts
X18rL42_pSNV_thresh5_max_post_counts = max(X18rL42_pSNV_thresh5_df$post)
X18rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X18rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X18rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X18rL41_prog_var_thresh5_df:
X18rL41_prog_var_thresh5_df_rL42_int <- X18rL41_prog_var_thresh5_df[which(X18rL41_prog_var_thresh5_df$variant %in% X18rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X18rL42_prog_var_thresh5_df:
X18rL42_prog_var_thresh5_df_rL41_int <- X18rL42_prog_var_thresh5_df[which(X18rL42_prog_var_thresh5_df$variant %in% X18rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X18rL41_prog_var_thresh5_df_rL42_int_ord <- X18rL41_prog_var_thresh5_df_rL42_int[order(X18rL41_prog_var_thresh5_df_rL42_int$variant),]
X18rL42_prog_var_thresh5_df_rL41_int_ord <- X18rL42_prog_var_thresh5_df_rL41_int[order(X18rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X18rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X18rL41rL42int_prog_var_thresh5_pre_count <- dim(X18rL41_prog_var_thresh5_df_rL42_int)[1] 
X18rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X18rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X18rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X18rL42_prog_var_thresh5_df_rL41_int_ord$lib
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X18rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X18rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X18rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X18rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X18rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X18rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X18rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X18rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X18rL41_cSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X18rL41_cSNV_missense_post_pre_med <- unname(X18rL41_cSNV_missense_post_pre_quarts[3])
X18rL41_cSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X18rL41_cSNV_syn_post_pre_med <- unname(X18rL41_cSNV_syn_post_pre_quarts[3])
X18rL41_cSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X18rL41_cSNV_nonsense_post_pre_med <- unname(X18rL41_cSNV_nonsense_post_pre_quarts[3])
X18rL41_cSNV_syn_to_non_post_pre_spread <- X18rL41_cSNV_syn_post_pre_med - X18rL41_cSNV_nonsense_post_pre_med

X18rL42_cSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X18rL42_cSNV_missense_post_pre_med <- unname(X18rL42_cSNV_missense_post_pre_quarts[3])
X18rL42_cSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X18rL42_cSNV_syn_post_pre_med <- unname(X18rL42_cSNV_syn_post_pre_quarts[3])
X18rL42_cSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X18rL42_cSNV_nonsense_post_pre_med <- unname(X18rL42_cSNV_nonsense_post_pre_quarts[3])
X18rL42_cSNV_syn_to_non_post_pre_spread <- X18rL42_cSNV_syn_post_pre_med - X18rL42_cSNV_nonsense_post_pre_med

X18rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_missense_post_pre_med <- unname(X18rL41rL42a_cSNV_missense_post_pre_quarts[3])
X18rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_syn_post_pre_med <- unname(X18rL41rL42a_cSNV_syn_post_pre_quarts[3])
X18rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X18rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X18rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X18rL41rL42a_cSNV_syn_post_pre_med - X18rL41rL42a_cSNV_nonsense_post_pre_med

X18rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_cSNV_missense_post_pre_med <- unname(X18rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X18rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_cSNV_syn_post_pre_med <- unname(X18rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X18rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X18rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X18rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X18rL41rL42pw_cSNV_syn_post_pre_med - X18rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X18rL41_tSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X18rL41_tSNV_missense_post_pre_med <- unname(X18rL41_tSNV_missense_post_pre_quarts[3])
X18rL41_tSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X18rL41_tSNV_syn_post_pre_med <- unname(X18rL41_tSNV_syn_post_pre_quarts[3])
X18rL41_tSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X18rL41_tSNV_nonsense_post_pre_med <- unname(X18rL41_tSNV_nonsense_post_pre_quarts[3])
X18rL41_tSNV_syn_to_non_post_pre_spread <- X18rL41_tSNV_syn_post_pre_med - X18rL41_tSNV_nonsense_post_pre_med

X18rL42_tSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X18rL42_tSNV_missense_post_pre_med <- unname(X18rL42_tSNV_missense_post_pre_quarts[3])
X18rL42_tSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X18rL42_tSNV_syn_post_pre_med <- unname(X18rL42_tSNV_syn_post_pre_quarts[3])
X18rL42_tSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X18rL42_tSNV_nonsense_post_pre_med <- unname(X18rL42_tSNV_nonsense_post_pre_quarts[3])
X18rL42_tSNV_syn_to_non_post_pre_spread <- X18rL42_tSNV_syn_post_pre_med - X18rL42_tSNV_nonsense_post_pre_med

X18rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_missense_post_pre_med <- unname(X18rL41rL42a_tSNV_missense_post_pre_quarts[3])
X18rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_syn_post_pre_med <- unname(X18rL41rL42a_tSNV_syn_post_pre_quarts[3])
X18rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X18rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X18rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X18rL41rL42a_tSNV_syn_post_pre_med - X18rL41rL42a_tSNV_nonsense_post_pre_med

X18rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_tSNV_missense_post_pre_med <- unname(X18rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X18rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_tSNV_syn_post_pre_med <- unname(X18rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X18rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X18rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X18rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X18rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X18rL41rL42pw_tSNV_syn_post_pre_med - X18rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X18rL41_cSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X18rL41_cSNV_missense_post_lib_med <- unname(X18rL41_cSNV_missense_post_lib_quarts[3])
X18rL41_cSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X18rL41_cSNV_syn_post_lib_med <- unname(X18rL41_cSNV_syn_post_lib_quarts[3])
X18rL41_cSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X18rL41_cSNV_nonsense_post_lib_med <- unname(X18rL41_cSNV_nonsense_post_lib_quarts[3])
X18rL41_cSNV_syn_to_non_post_lib_spread <- X18rL41_cSNV_syn_post_lib_med - X18rL41_cSNV_nonsense_post_lib_med

X18rL42_cSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X18rL42_cSNV_missense_post_lib_med <- unname(X18rL42_cSNV_missense_post_lib_quarts[3])
X18rL42_cSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X18rL42_cSNV_syn_post_lib_med <- unname(X18rL42_cSNV_syn_post_lib_quarts[3])
X18rL42_cSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X18rL42_cSNV_nonsense_post_lib_med <- unname(X18rL42_cSNV_nonsense_post_lib_quarts[3])
X18rL42_cSNV_syn_to_non_post_lib_spread <- X18rL42_cSNV_syn_post_lib_med - X18rL42_cSNV_nonsense_post_lib_med

X18rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_missense_post_lib_med <- unname(X18rL41rL42a_cSNV_missense_post_lib_quarts[3])
X18rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_syn_post_lib_med <- unname(X18rL41rL42a_cSNV_syn_post_lib_quarts[3])
X18rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X18rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X18rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X18rL41rL42a_cSNV_syn_post_lib_med - X18rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X18rL41_tSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X18rL41_tSNV_missense_post_lib_med <- unname(X18rL41_tSNV_missense_post_lib_quarts[3])
X18rL41_tSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X18rL41_tSNV_syn_post_lib_med <- unname(X18rL41_tSNV_syn_post_lib_quarts[3])
X18rL41_tSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X18rL41_tSNV_nonsense_post_lib_med <- unname(X18rL41_tSNV_nonsense_post_lib_quarts[3])
X18rL41_tSNV_syn_to_non_post_lib_spread <- X18rL41_tSNV_syn_post_lib_med - X18rL41_tSNV_nonsense_post_lib_med

X18rL42_tSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X18rL42_tSNV_missense_post_lib_med <- unname(X18rL42_tSNV_missense_post_lib_quarts[3])
X18rL42_tSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X18rL42_tSNV_syn_post_lib_med <- unname(X18rL42_tSNV_syn_post_lib_quarts[3])
X18rL42_tSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X18rL42_tSNV_nonsense_post_lib_med <- unname(X18rL42_tSNV_nonsense_post_lib_quarts[3])
X18rL42_tSNV_syn_to_non_post_lib_spread <- X18rL42_tSNV_syn_post_lib_med - X18rL42_tSNV_nonsense_post_lib_med

X18rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_missense_post_lib_med <- unname(X18rL41rL42a_tSNV_missense_post_lib_quarts[3])
X18rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_syn_post_lib_med <- unname(X18rL41rL42a_tSNV_syn_post_lib_quarts[3])
X18rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X18rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X18rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X18rL41rL42a_tSNV_syn_post_lib_med - X18rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X18rL41_cSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X18rL41_cSNV_missense_pre_lib_med <- unname(X18rL41_cSNV_missense_pre_lib_quarts[3])
X18rL41_cSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X18rL41_cSNV_syn_pre_lib_med <- unname(X18rL41_cSNV_syn_pre_lib_quarts[3])
X18rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X18rL41_cSNV_nonsense_pre_lib_med <- unname(X18rL41_cSNV_nonsense_pre_lib_quarts[3])
X18rL41_cSNV_syn_to_non_pre_lib_spread <- X18rL41_cSNV_syn_pre_lib_med - X18rL41_cSNV_nonsense_pre_lib_med

X18rL42_cSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X18rL42_cSNV_missense_pre_lib_med <- unname(X18rL42_cSNV_missense_pre_lib_quarts[3])
X18rL42_cSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X18rL42_cSNV_syn_pre_lib_med <- unname(X18rL42_cSNV_syn_pre_lib_quarts[3])
X18rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X18rL42_cSNV_nonsense_pre_lib_med <- unname(X18rL42_cSNV_nonsense_pre_lib_quarts[3])
X18rL42_cSNV_syn_to_non_pre_lib_spread <- X18rL42_cSNV_syn_pre_lib_med - X18rL42_cSNV_nonsense_pre_lib_med

X18rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_missense_pre_lib_med <- unname(X18rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X18rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_syn_pre_lib_med <- unname(X18rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X18rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X18rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X18rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X18rL41rL42a_cSNV_syn_pre_lib_med - X18rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X18rL41_tSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X18rL41_tSNV_missense_pre_lib_med <- unname(X18rL41_tSNV_missense_pre_lib_quarts[3])
X18rL41_tSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X18rL41_tSNV_syn_pre_lib_med <- unname(X18rL41_tSNV_syn_pre_lib_quarts[3])
X18rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X18rL41_tSNV_nonsense_pre_lib_med <- unname(X18rL41_tSNV_nonsense_pre_lib_quarts[3])
X18rL41_tSNV_syn_to_non_pre_lib_spread <- X18rL41_tSNV_syn_pre_lib_med - X18rL41_tSNV_nonsense_pre_lib_med

X18rL42_tSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X18rL42_tSNV_missense_pre_lib_med <- unname(X18rL42_tSNV_missense_pre_lib_quarts[3])
X18rL42_tSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X18rL42_tSNV_syn_pre_lib_med <- unname(X18rL42_tSNV_syn_pre_lib_quarts[3])
X18rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X18rL42_tSNV_nonsense_pre_lib_med <- unname(X18rL42_tSNV_nonsense_pre_lib_quarts[3])
X18rL42_tSNV_syn_to_non_pre_lib_spread <- X18rL42_tSNV_syn_pre_lib_med - X18rL42_tSNV_nonsense_pre_lib_med

X18rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_missense_pre_lib_med <- unname(X18rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X18rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_syn_pre_lib_med <- unname(X18rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X18rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X18rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X18rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X18rL41rL42a_tSNV_syn_pre_lib_med - X18rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X18rL41_tSNV_syn_rna_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X18rL41_tSNV_syn_rna_pre_med <- unname(X18rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X18rL41_tSNV_syn_rna_post_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X18rL41_tSNV_syn_rna_post_med <- unname(X18rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X18rL42_tSNV_syn_rna_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X18rL42_tSNV_syn_rna_pre_med <- unname(X18rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X18rL42_tSNV_syn_rna_post_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X18rL42_tSNV_syn_rna_post_med <- unname(X18rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X18rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_syn_rna_pre_med <- unname(X18rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X18rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X18rL41rL42a_tSNV_syn_rna_post_med <- unname(X18rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X18rL41_cSNV_syn_pre_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X18rL41_cSNV_syn_post_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X18rL41_cSNV_syn_post_lib_med
# tHDR
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X18rL41_tSNV_syn_pre_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X18rL41_tSNV_syn_post_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X18rL41_tSNV_syn_post_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X18rL41_tSNV_syn_rna_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X18rL41_tSNV_syn_rna_post_med

#rL42
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X18rL42_cSNV_syn_pre_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X18rL42_cSNV_syn_post_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X18rL42_cSNV_syn_post_lib_med
# tHDR
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X18rL42_tSNV_syn_pre_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X18rL42_tSNV_syn_post_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X18rL42_tSNV_syn_post_lib_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X18rL42_tSNV_syn_rna_pre_med
X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X18rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X18rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X18rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X18rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X18rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X18rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X18rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X18rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X18rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X18rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X18rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X18rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X18rL41_prog_var_thresh5_df_rL42_int_ord[which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X18rL41_prog_var_thresh5_df_rL42_int_ord
X18rL41_prog_map_thresh5_df_rL42_int_ord = which(X18rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X18rL41_prog_map_thresh5_df_rL42_int_ord_df = X18rL41_prog_var_thresh5_df_rL42_int_ord[X18rL41_prog_map_thresh5_df_rL42_int_ord,]
X18rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X18rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X18rL41_prog_map_thresh5_df_rL42_int_ord_df[X18rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X18rL41_prog_map_thresh5_df_rL42_int_ord_df[X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X18rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X18rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X18rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X18rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X18rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X18rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X18rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X18rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X18rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X18rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X18rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X18rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X18rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X18rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X18rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X18rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X18rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X18rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X18rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X18rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X18rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X18rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X18rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41_cSNV_post_pre_by_cadd_cor_s
#X18rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X18rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL42_cSNV_post_pre_by_cadd_cor_s

#X18rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X18rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41_cSNV_post_lib_by_cadd_cor_s
#X18rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X18rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X18rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X18rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41_tSNV_post_pre_by_cadd_cor_s
#X18rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X18rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL42_tSNV_post_pre_by_cadd_cor_s

#X18rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X18rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41_tSNV_post_lib_by_cadd_cor_s
#X18rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X18rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X18rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X18rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X18rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X18rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X18rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X18rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X18rL41_prog_var_all_lib_count
X18rL41_prog_var_all_pre_count
X18rL42_prog_var_all_pre_count
X18rL41_prog_map_thresh5_lib_count
X18rL41_prog_map_thresh5_pre_count
X18rL42_prog_map_thresh5_pre_count
X18rL41_prog_map_thresh5_post_count
X18rL42_prog_map_thresh5_post_count
X18rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X18rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X18rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X18rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X18rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X18rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X18rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X18rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X18rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X18rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X18rL41_cSNV_post_pre_by_cadd_cor_s
X18rL42_cSNV_post_pre_by_cadd_cor_s
X18rL41_cSNV_post_lib_by_cadd_cor_s
X18rL42_cSNV_post_lib_by_cadd_cor_s
X18rL41_tSNV_post_pre_by_cadd_cor_s
X18rL42_tSNV_post_pre_by_cadd_cor_s
X18rL41_tSNV_post_lib_by_cadd_cor_s
X18rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X18rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X18rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X18rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X18rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X18rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X18rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X18rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X18rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X18rL41_cSNV_syn_to_non_post_pre_spread
X18rL42_cSNV_syn_to_non_post_pre_spread
X18rL41rL42a_cSNV_syn_to_non_post_pre_spread
X18rL41_cSNV_syn_to_non_post_lib_spread
X18rL42_cSNV_syn_to_non_post_lib_spread
X18rL41rL42a_cSNV_syn_to_non_post_lib_spread
X18rL41_tSNV_syn_to_non_post_pre_spread
X18rL42_tSNV_syn_to_non_post_pre_spread
X18rL41rL42a_tSNV_syn_to_non_post_pre_spread
X18rL41_tSNV_syn_to_non_post_lib_spread
X18rL42_tSNV_syn_to_non_post_lib_spread
X18rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X18rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X18rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X18rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X18rL41_cSNV_pre_lib_cors = cor(log2(X18rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18rL41_tSNV_pre_lib_cors = cor(log2(X18rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18rL41_cSNV_post_lib_cors = cor(log2(X18rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X18rL41_tSNV_post_lib_cors = cor(log2(X18rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X18rL41_cSNV_post_pre_cors = cor(log2(X18rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18rL41_tSNV_post_pre_cors = cor(log2(X18rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X18rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18rL41_cSNV_rna_lib_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X18rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18rL41_tSNV_rna_lib_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X18rL41_cSNV_rna_pre_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X18rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18rL41_tSNV_rna_pre_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X18rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18rL41rL42_cSNV_pre_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X18rL41rL42_tSNV_pre_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X18rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X18rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X18rL41rL42_cSNV_post_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X18rL41rL42_tSNV_post_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X18rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X18rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X18rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X18rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X18rL41rL42_cSNV_rna_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X18rL41rL42_tSNV_rna_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X18rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X18rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X18rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X18rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X18rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X18rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X18rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X18rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X18rL41_cors <- c("X18rL41",X18rL41_cSNV_pre_lib_cors,X18rL41_tSNV_pre_lib_cors,X18rL41_cSNV_post_lib_cors,X18rL41_tSNV_post_lib_cors,X18rL41_cSNV_post_pre_cors,X18rL41_tSNV_post_pre_cors,X18rL41_cSNV_rna_lib_cors,X18rL41_tSNV_rna_lib_cors,X18rL41_cSNV_rna_pre_cors,X18rL41_tSNV_rna_pre_cors,X18rL41rL42_cSNV_pre_cors,X18rL41rL42_tSNV_pre_cors,X18rL41rL42_cSNV_pre_lib_ratio_cors,X18rL41rL42_tSNV_pre_lib_ratio_cors,X18rL41rL42_cSNV_post_cors,X18rL41rL42_tSNV_post_cors,X18rL41rL42_cSNV_post_lib_ratio_cors,X18rL41rL42_tSNV_post_lib_ratio_cors,X18rL41rL42_cSNV_post_pre_ratio_cors,X18rL41rL42_tSNV_post_pre_ratio_cors,X18rL41rL42_cSNV_rna_cors,X18rL41rL42_tSNV_rna_cors,X18rL41rL42_tSNV_rna_pre_ratio_cors,X18rL41_cSNV_pre_lib_ratio_cadd_cors,X18rL41_tSNV_pre_lib_ratio_cadd_cors,X18rL41_cSNV_post_lib_ratio_cadd_cors,X18rL41_tSNV_post_lib_ratio_cadd_cors,X18rL41_cSNV_post_pre_ratio_cadd_cors,X18rL41_tSNV_post_pre_ratio_cadd_cors,X18rL41_cSNV_post_pre_ratio_cadd_missense_cors,X18rL41_tSNV_post_pre_ratio_cadd_missense_cors,X18rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X18rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X18rL41_cSNV_post_pre_ratio_grantham_missense_cors,X18rL41_tSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X18rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X18rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X18rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X18rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X18rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X18rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X18rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X18rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X18rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X18rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X18rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X18rL42_cSNV_pre_lib_cors = cor(log2(X18rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18rL42_tSNV_pre_lib_cors = cor(log2(X18rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18rL42_cSNV_post_lib_cors = cor(log2(X18rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X18rL42_tSNV_post_lib_cors = cor(log2(X18rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X18rL42_cSNV_post_pre_cors = cor(log2(X18rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X18rL42_tSNV_post_pre_cors = cor(log2(X18rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X18rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X18rL42_cSNV_rna_lib_cors = cor(log2(X18rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X18rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18rL42_tSNV_rna_lib_cors = cor(log2(X18rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X18rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X18rL42_cSNV_rna_pre_cors = cor(log2(X18rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X18rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X18rL42_tSNV_rna_pre_cors = cor(log2(X18rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X18rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X18rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X18rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X18rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X18rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X18rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X18rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X18rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X18rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X18rL42_cors <- c("X18rL42",X18rL42_cSNV_pre_lib_cors,X18rL42_tSNV_pre_lib_cors,X18rL42_cSNV_post_lib_cors,X18rL42_tSNV_post_lib_cors,X18rL42_cSNV_post_pre_cors,X18rL42_tSNV_post_pre_cors,X18rL42_cSNV_rna_lib_cors,X18rL42_tSNV_rna_lib_cors,X18rL42_cSNV_rna_pre_cors,X18rL42_tSNV_rna_pre_cors,X18rL41rL42_cSNV_pre_cors,X18rL41rL42_tSNV_pre_cors,X18rL41rL42_cSNV_pre_lib_ratio_cors,X18rL41rL42_tSNV_pre_lib_ratio_cors,X18rL41rL42_cSNV_post_cors,X18rL41rL42_tSNV_post_cors,X18rL41rL42_cSNV_post_lib_ratio_cors,X18rL41rL42_tSNV_post_lib_ratio_cors,X18rL41rL42_cSNV_post_pre_ratio_cors,X18rL41rL42_tSNV_post_pre_ratio_cors,X18rL41rL42_cSNV_rna_cors,X18rL41rL42_tSNV_rna_cors,X18rL41rL42_tSNV_rna_pre_ratio_cors,X18rL42_cSNV_pre_lib_ratio_cadd_cors,X18rL42_tSNV_pre_lib_ratio_cadd_cors,X18rL42_cSNV_post_lib_ratio_cadd_cors,X18rL42_tSNV_post_lib_ratio_cadd_cors,X18rL42_cSNV_post_pre_ratio_cadd_cors,X18rL42_tSNV_post_pre_ratio_cadd_cors,X18rL42_cSNV_post_pre_ratio_cadd_missense_cors,X18rL42_tSNV_post_pre_ratio_cadd_missense_cors,X18rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X18rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X18rL42_cSNV_post_pre_ratio_grantham_missense_cors,X18rL42_tSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X18rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X18rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X18rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X18rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X18rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X18rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X18rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X18rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X18rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X18rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X18rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X18rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X18rL41)
rm(X18rL42)
gc()
X19rL41_file <- paste(experiment_dir_170731,'X19rL41','_annotated.txt',sep='')
X19rL42_file <- paste(experiment_dir_170731,'X19rL42','_annotated.txt',sep='')
X19rL41 <- read.table(X19rL41_file, header=TRUE, sep="\t")
X19rL42 <- read.table(X19rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X19 <- editing_info[which(editing_info$amplicon == 'X19'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X19_HDR_5_SNV = as.character(editing_info_X19$HDR_5_SNV)
X19_HDR_3_SNV = as.character(editing_info_X19$HDR_3_SNV)
#X19_cut_pos = as.character(editing_info_X19$cut_pos)
X19_cut_end = as.character(editing_info_X19$cut_end)
X19_mut_start = as.character(editing_info_X19$mut_start)
X19_mut_end = as.character(editing_info_X19$mut_end)
### Replicate 1
X19rL41_cSNV_all <- which(X19rL41[,'c_hdr_snv']=='True')
X19rL41_cSNV_all_df = X19rL41[X19rL41_cSNV_all,]
X19rL41_prog_var_all <- which(X19rL41[,'all_hdr_variant']=='True' & X19rL41[,'edit_string']!='-WT')
X19rL41_prog_var_all_df = X19rL41[X19rL41_prog_var_all,]
X19rL41_prog_map_all = which(X19rL41_prog_var_all_df[,'pos']!='REF')
X19rL41_prog_map_all_df = X19rL41_prog_var_all_df[X19rL41_prog_map_all,]
X19rL41_prog_map_exon_all = which(X19rL41_prog_map_all_df[,'cDNApos']!='REF' & X19rL41_prog_map_all_df[,'cDNApos']!='NA')
X19rL41_prog_map_exon_all_df = X19rL41_prog_map_all_df[X19rL41_prog_map_exon_all,]
X19rL41_prog_map_CADD = which(X19rL41_prog_map_all_df[,'CADD.phred']!='NA')
X19rL41_prog_map_CADD_df = X19rL41_prog_map_all_df[X19rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X19rL41_prog_var_thresh5 <- which(as.numeric(as.character(X19rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X19rL41_prog_var_thresh5_df = X19rL41_prog_var_all_df[X19rL41_prog_var_thresh5,]
X19rL41_prog_map_thresh5 <- which(as.numeric(as.character(X19rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X19rL41_prog_map_thresh5_df = X19rL41_prog_map_all_df[X19rL41_prog_map_thresh5,]
X19rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X19rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X19rL41_prog_map_exon_thresh5_df = X19rL41_prog_map_exon_all_df[X19rL41_prog_map_exon_thresh5,]
X19rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X19rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X19rL41_prog_map_CADD_thresh5_df = X19rL41_prog_map_CADD_df[X19rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X19rL41_prog_var_all_lib_count = length(X19rL41_prog_var_all_df$lib)
X19rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X19rL41_prog_var_all_min_lib_counts = min(X19rL41_prog_var_all_df$lib)
X19rL41_prog_var_all_min_lib_counts
X19rL41_prog_var_all_max_lib_counts = max(X19rL41_prog_var_all_df$lib)
X19rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X19rL41_prog_map_all_lib_count = length(X19rL41_prog_map_all_df$lib)
X19rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X19rL41_prog_map_all_min_lib_counts = min(X19rL41_prog_map_all_df$lib)
X19rL41_prog_map_all_min_lib_counts
X19rL41_prog_map_all_max_lib_counts = max(X19rL41_prog_map_all_df$lib)
X19rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X19rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X19rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X19rL41_prog_var_all_pre_count = length(X19rL41_prog_var_all_df$pre)
X19rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X19rL41_prog_var_all_min_pre_counts = min(X19rL41_prog_var_all_df$pre)
X19rL41_prog_var_all_min_pre_counts
X19rL41_prog_var_all_max_pre_counts = max(X19rL41_prog_var_all_df$pre)
X19rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X19rL41_prog_map_all_pre_count = length(X19rL41_prog_map_all_df$pre)
X19rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X19rL41_prog_map_all_min_pre_counts = min(X19rL41_prog_map_all_df$pre)
X19rL41_prog_map_all_min_pre_counts
X19rL41_prog_map_all_max_pre_counts = max(X19rL41_prog_map_all_df$pre)
X19rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X19rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X19rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X19rL41_prog_map_all_post_count = length(X19rL41_prog_map_all_df$post)
X19rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X19rL41_prog_map_all_min_post_counts = min(X19rL41_prog_map_all_df$post)
X19rL41_prog_map_all_min_post_counts
X19rL41_prog_map_all_max_post_counts = max(X19rL41_prog_map_all_df$post)
X19rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X19rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X19rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X19rL41_prog_map_all_syn_df <- X19rL41_prog_map_all_df[which(X19rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X19rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X19rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X19rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X19rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X19rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X19rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X19rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X19rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X19rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X19rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X19rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X19rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X19rL41_prog_map_all_min_rna_counts = min(X19rL41_prog_map_exon_all_df$tHDR_rna)
X19rL41_prog_map_all_min_rna_counts
X19rL41_prog_map_all_max_rna_counts = max(X19rL41_prog_map_exon_all_df$tHDR_rna)
X19rL41_prog_map_all_max_rna_counts
X19rL41_prog_map_all_min_rna_pseudo_freq = min(X19rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19rL41_prog_map_all_min_rna_pseudo_freq
X19rL41_prog_map_all_max_rna_pseudo_freq = max(X19rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19rL41_prog_map_all_max_rna_pseudo_freq
X19rL41_prog_map_all_min_rna_pre_ratio = min(X19rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19rL41_prog_map_all_min_rna_pre_ratio
X19rL41_prog_map_all_max_rna_pre_ratio = max(X19rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19rL41_prog_map_all_max_rna_pre_ratio
X19rL41_prog_map_all_min_rna_post_ratio = min(X19rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19rL41_prog_map_all_min_rna_post_ratio
X19rL41_prog_map_all_max_rna_post_ratio = max(X19rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X19rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X19rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X19rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X19rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X19rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X19rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X19rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X19rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X19rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X19rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X19rL41_prog_map_all_df$post_pre_ratio),log2(X19rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X19rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X19rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X19rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X19rL41_cSNV_all_corr_pre_count = length(X19rL41_cSNV_all_df$corr_pre)
X19rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X19rL41_cSNV_all_min_corr_pre_counts = min(X19rL41_cSNV_all_df$corr_pre)
X19rL41_cSNV_all_min_corr_pre_counts
X19rL41_cSNV_all_max_corr_pre_counts = max(X19rL41_cSNV_all_df$corr_pre)
X19rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X19rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X19rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X19rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X19rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X19rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_cSNV_all_corr_post_count = length(X19rL41_cSNV_all_df$corr_post)
X19rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X19rL41_cSNV_all_min_corr_post_counts = min(X19rL41_cSNV_all_df$corr_post)
X19rL41_cSNV_all_min_corr_post_counts
X19rL41_cSNV_all_max_corr_post_counts = max(X19rL41_cSNV_all_df$corr_post)
X19rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X19rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X19rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X19rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X19rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X19rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X19rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X19_p_hdr_snv = paste('p_hdr_',X19_cut_end,'_snv',sep='')
X19rL41_pSNV_all <- which(X19rL41[,X19_p_hdr_snv]=='True')
X19rL41_pSNV_all_df = X19rL41[X19rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_pSNV_all_lib_count = length(X19rL41_pSNV_all_df$lib)
X19rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X19rL41_pSNV_all_min_lib_counts = min(X19rL41_pSNV_all_df$lib)
X19rL41_pSNV_all_min_lib_counts
X19rL41_pSNV_all_max_lib_counts = max(X19rL41_pSNV_all_df$lib)
X19rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X19rL41_pSNV_all_pre_count = length(X19rL41_pSNV_all_df$pre)
X19rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X19rL41_pSNV_all_min_pre_counts = min(X19rL41_pSNV_all_df$pre)
X19rL41_pSNV_all_min_pre_counts
X19rL41_pSNV_all_max_pre_counts = max(X19rL41_pSNV_all_df$pre)
X19rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X19rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X19rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_pSNV_all_post_count = length(X19rL41_pSNV_all_df$post)
X19rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X19rL41_pSNV_all_min_post_counts = min(X19rL41_pSNV_all_df$post)
X19rL41_pSNV_all_min_post_counts
X19rL41_pSNV_all_max_post_counts = max(X19rL41_pSNV_all_df$post)
X19rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X19rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X19rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_prog_map_thresh5_lib_count = length(X19rL41_prog_map_thresh5_df$lib)
X19rL41_prog_map_thresh5_lib_count
X19rL41_prog_map_thresh5_min_lib_counts = min(X19rL41_prog_map_thresh5_df$lib)
X19rL41_prog_map_thresh5_min_lib_counts
X19rL41_prog_map_thresh5_max_lib_counts = max(X19rL41_prog_map_thresh5_df$lib)
X19rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X19rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X19rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_prog_map_thresh5_pre_count = length(X19rL41_prog_map_thresh5_df$pre)
X19rL41_prog_map_thresh5_pre_count
X19rL41_prog_map_thresh5_min_pre_counts = min(X19rL41_prog_map_thresh5_df$pre)
X19rL41_prog_map_thresh5_min_pre_counts
X19rL41_prog_map_thresh5_max_pre_counts = max(X19rL41_prog_map_thresh5_df$pre)
X19rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL41_prog_map_thresh5_post_count = length(X19rL41_prog_map_thresh5_df$post)
X19rL41_prog_map_thresh5_post_count
X19rL41_prog_map_thresh5_min_post_counts = min(X19rL41_prog_map_thresh5_df$post)
X19rL41_prog_map_thresh5_min_post_counts
X19rL41_prog_map_thresh5_max_post_counts = max(X19rL41_prog_map_thresh5_df$post)
X19rL41_prog_map_thresh5_max_post_counts
X19rL41_prog_map_thresh5_corr_post_count = length(X19rL41_cSNV_all_df$corr_post)
X19rL41_prog_map_thresh5_corr_post_count
X19rL41_prog_map_thresh5_min_corr_post_counts = min(X19rL41_cSNV_all_df$corr_post)
X19rL41_prog_map_thresh5_min_corr_post_counts
X19rL41_prog_map_thresh5_max_corr_post_counts = max(X19rL41_cSNV_all_df$corr_post)
X19rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X19rL41_pSNV_thresh5 <- which(X19rL41[,X19_p_hdr_snv]=='True' & as.numeric(as.character(X19rL41[,'pre_freq']))>=0.00001)
X19rL41_pSNV_thresh5_df = X19rL41[X19rL41_pSNV_thresh5,]
X19rL41_pSNV_thresh5_lib_count = length(X19rL41_pSNV_thresh5_df$lib)
X19rL41_pSNV_thresh5_lib_count
X19rL41_pSNV_thresh5_min_lib_counts = min(X19rL41_pSNV_thresh5_df$lib)
X19rL41_pSNV_thresh5_min_lib_counts
X19rL41_pSNV_thresh5_max_lib_counts = max(X19rL41_pSNV_thresh5_df$lib)
X19rL41_pSNV_thresh5_max_lib_counts
X19rL41_pSNV_thresh5_pre_count = length(X19rL41_pSNV_thresh5_df$pre)
X19rL41_pSNV_thresh5_pre_count
X19rL41_pSNV_thresh5_min_pre_counts = min(X19rL41_pSNV_thresh5_df$pre)
X19rL41_pSNV_thresh5_min_pre_counts
X19rL41_pSNV_thresh5_max_pre_counts = max(X19rL41_pSNV_thresh5_df$pre)
X19rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X19rL41_pSNV_thresh5_post_count = length(X19rL41_pSNV_thresh5_df$post)
X19rL41_pSNV_thresh5_post_count
X19rL41_pSNV_thresh5_min_post_counts = min(X19rL41_pSNV_thresh5_df$post)
X19rL41_pSNV_thresh5_min_post_counts
X19rL41_pSNV_thresh5_max_post_counts = max(X19rL41_pSNV_thresh5_df$post)
X19rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X19rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X19rL41_pSNV_thresh5_post_pos

### Replicate 2
X19rL42_cSNV_all <- which(X19rL42[,'c_hdr_snv']=='True')
X19rL42_cSNV_all_df = X19rL42[X19rL42_cSNV_all,]
X19rL42_prog_var_all <- which(X19rL42[,'all_hdr_variant']=='True' & X19rL42[,'edit_string']!='-WT')
X19rL42_prog_var_all_df = X19rL42[X19rL42_prog_var_all,]
X19rL42_prog_map_all = which(X19rL42_prog_var_all_df[,'pos']!='REF')
X19rL42_prog_map_all_df = X19rL42_prog_var_all_df[X19rL42_prog_map_all,]
X19rL42_prog_map_exon_all = which(X19rL42_prog_map_all_df[,'cDNApos']!='REF' & X19rL42_prog_map_all_df[,'cDNApos']!='NA')
X19rL42_prog_map_exon_all_df = X19rL42_prog_map_all_df[X19rL42_prog_map_exon_all,]
X19rL42_prog_map_CADD = which(X19rL42_prog_map_all_df[,'CADD.phred']!='NA')
X19rL42_prog_map_CADD_df = X19rL42_prog_map_all_df[X19rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X19rL42_prog_var_thresh5 <- which(as.numeric(as.character(X19rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X19rL42_prog_var_thresh5_df = X19rL42_prog_var_all_df[X19rL42_prog_var_thresh5,]
X19rL42_prog_map_thresh5 <- which(as.numeric(as.character(X19rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X19rL42_prog_map_thresh5_df = X19rL42_prog_map_all_df[X19rL42_prog_map_thresh5,]
X19rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X19rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X19rL42_prog_map_exon_thresh5_df = X19rL42_prog_map_exon_all_df[X19rL42_prog_map_exon_thresh5,]
X19rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X19rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X19rL42_prog_map_CADD_thresh5_df = X19rL42_prog_map_CADD_df[X19rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X19rL42_prog_var_all_lib_count = length(X19rL42_prog_var_all_df$lib)
X19rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X19rL42_prog_var_all_min_lib_counts = min(X19rL42_prog_var_all_df$lib)
X19rL42_prog_var_all_min_lib_counts
X19rL42_prog_var_all_max_lib_counts = max(X19rL42_prog_var_all_df$lib)
X19rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X19rL42_prog_map_all_lib_count = length(X19rL42_prog_map_all_df$lib)
X19rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X19rL42_prog_map_all_min_lib_counts = min(X19rL42_prog_map_all_df$lib)
X19rL42_prog_map_all_min_lib_counts
X19rL42_prog_map_all_max_lib_counts = max(X19rL42_prog_map_all_df$lib)
X19rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X19rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X19rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X19rL42_prog_var_all_pre_count = length(X19rL42_prog_var_all_df$pre)
X19rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X19rL42_prog_var_all_min_pre_counts = min(X19rL42_prog_var_all_df$pre)
X19rL42_prog_var_all_min_pre_counts
X19rL42_prog_var_all_max_pre_counts = max(X19rL42_prog_var_all_df$pre)
X19rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X19rL42_prog_map_all_pre_count = length(X19rL42_prog_map_all_df$pre)
X19rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X19rL42_prog_map_all_min_pre_counts = min(X19rL42_prog_map_all_df$pre)
X19rL42_prog_map_all_min_pre_counts
X19rL42_prog_map_all_max_pre_counts = max(X19rL42_prog_map_all_df$pre)
X19rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X19rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X19rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X19rL42_prog_map_all_post_count = length(X19rL42_prog_map_all_df$post)
X19rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X19rL42_prog_map_all_min_post_counts = min(X19rL42_prog_map_all_df$post)
X19rL42_prog_map_all_min_post_counts
X19rL42_prog_map_all_max_post_counts = max(X19rL42_prog_map_all_df$post)
X19rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X19rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X19rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X19rL42_prog_map_all_syn_df <- X19rL42_prog_map_all_df[which(X19rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X19rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X19rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X19rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X19rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X19rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X19rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X19rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X19rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X19rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X19rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X19rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X19rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X19rL42_prog_map_all_min_rna_counts = min(X19rL42_prog_map_exon_all_df$tHDR_rna)
X19rL42_prog_map_all_min_rna_counts
X19rL42_prog_map_all_max_rna_counts = max(X19rL42_prog_map_exon_all_df$tHDR_rna)
X19rL42_prog_map_all_max_rna_counts
X19rL42_prog_map_all_min_rna_pseudo_freq = min(X19rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19rL42_prog_map_all_min_rna_pseudo_freq
X19rL42_prog_map_all_max_rna_pseudo_freq = max(X19rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X19rL42_prog_map_all_max_rna_pseudo_freq
X19rL42_prog_map_all_min_rna_pre_ratio = min(X19rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19rL42_prog_map_all_min_rna_pre_ratio
X19rL42_prog_map_all_max_rna_pre_ratio = max(X19rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X19rL42_prog_map_all_max_rna_pre_ratio
X19rL42_prog_map_all_min_rna_post_ratio = min(X19rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19rL42_prog_map_all_min_rna_post_ratio
X19rL42_prog_map_all_max_rna_post_ratio = max(X19rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X19rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X19rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X19rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X19rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X19rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X19rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X19rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X19rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X19rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X19rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X19rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X19rL42_prog_map_all_df$post_pre_ratio),log2(X19rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X19rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X19rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X19rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X19rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X19rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X19rL42_cSNV_all_corr_pre_count = length(X19rL42_cSNV_all_df$corr_pre)
X19rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X19rL42_cSNV_all_min_corr_pre_counts = min(X19rL42_cSNV_all_df$corr_pre)
X19rL42_cSNV_all_min_corr_pre_counts
X19rL42_cSNV_all_max_corr_pre_counts = max(X19rL42_cSNV_all_df$corr_pre)
X19rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X19rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X19rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X19rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X19rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X19rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_cSNV_all_corr_post_count = length(X19rL42_cSNV_all_df$corr_post)
X19rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X19rL42_cSNV_all_min_corr_post_counts = min(X19rL42_cSNV_all_df$corr_post)
X19rL42_cSNV_all_min_corr_post_counts
X19rL42_cSNV_all_max_corr_post_counts = max(X19rL42_cSNV_all_df$corr_post)
X19rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X19rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X19rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X19rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X19rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X19rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X19rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X19_p_hdr_snv = paste('p_hdr_',X19_cut_end,'_snv',sep='')
X19rL42_pSNV_all <- which(X19rL42[,X19_p_hdr_snv]=='True')
X19rL42_pSNV_all_df = X19rL42[X19rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_pSNV_all_lib_count = length(X19rL42_pSNV_all_df$lib)
X19rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X19rL42_pSNV_all_min_lib_counts = min(X19rL42_pSNV_all_df$lib)
X19rL42_pSNV_all_min_lib_counts
X19rL42_pSNV_all_max_lib_counts = max(X19rL42_pSNV_all_df$lib)
X19rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X19rL42_pSNV_all_pre_count = length(X19rL42_pSNV_all_df$pre)
X19rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X19rL42_pSNV_all_min_pre_counts = min(X19rL42_pSNV_all_df$pre)
X19rL42_pSNV_all_min_pre_counts
X19rL42_pSNV_all_max_pre_counts = max(X19rL42_pSNV_all_df$pre)
X19rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X19rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X19rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_pSNV_all_post_count = length(X19rL42_pSNV_all_df$post)
X19rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X19rL42_pSNV_all_min_post_counts = min(X19rL42_pSNV_all_df$post)
X19rL42_pSNV_all_min_post_counts
X19rL42_pSNV_all_max_post_counts = max(X19rL42_pSNV_all_df$post)
X19rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X19rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X19rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_prog_map_thresh5_lib_count = length(X19rL42_prog_map_thresh5_df$lib)
X19rL42_prog_map_thresh5_lib_count
X19rL42_prog_map_thresh5_min_lib_counts = min(X19rL42_prog_map_thresh5_df$lib)
X19rL42_prog_map_thresh5_min_lib_counts
X19rL42_prog_map_thresh5_max_lib_counts = max(X19rL42_prog_map_thresh5_df$lib)
X19rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X19rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X19rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_prog_map_thresh5_pre_count = length(X19rL42_prog_map_thresh5_df$pre)
X19rL42_prog_map_thresh5_pre_count
X19rL42_prog_map_thresh5_min_pre_counts = min(X19rL42_prog_map_thresh5_df$pre)
X19rL42_prog_map_thresh5_min_pre_counts
X19rL42_prog_map_thresh5_max_pre_counts = max(X19rL42_prog_map_thresh5_df$pre)
X19rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X19 less than SGE region length x 3 due to PAM edits
X19rL42_prog_map_thresh5_post_count = length(X19rL42_prog_map_thresh5_df$post)
X19rL42_prog_map_thresh5_post_count
X19rL42_prog_map_thresh5_min_post_counts = min(X19rL42_prog_map_thresh5_df$post)
X19rL42_prog_map_thresh5_min_post_counts
X19rL42_prog_map_thresh5_max_post_counts = max(X19rL42_prog_map_thresh5_df$post)
X19rL42_prog_map_thresh5_max_post_counts
X19rL42_prog_map_thresh5_corr_post_count = length(X19rL42_prog_map_thresh5_df$corr_post)
X19rL42_prog_map_thresh5_corr_post_count
X19rL42_prog_map_thresh5_min_corr_post_counts = min(X19rL42_prog_map_thresh5_df$corr_post)
X19rL42_prog_map_thresh5_min_corr_post_counts
X19rL42_prog_map_thresh5_max_corr_post_counts = max(X19rL42_prog_map_thresh5_df$corr_post)
X19rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X19rL42_pSNV_thresh5 <- which(X19rL42[,X19_p_hdr_snv]=='True' & as.numeric(as.character(X19rL42[,'pre_freq']))>=0.00001)
X19rL42_pSNV_thresh5_df = X19rL42[X19rL42_pSNV_thresh5,]
X19rL42_pSNV_thresh5_lib_count = length(X19rL42_pSNV_thresh5_df$lib)
X19rL42_pSNV_thresh5_lib_count
X19rL42_pSNV_thresh5_min_lib_counts = min(X19rL42_pSNV_thresh5_df$lib)
X19rL42_pSNV_thresh5_min_lib_counts
X19rL42_pSNV_thresh5_max_lib_counts = max(X19rL42_pSNV_thresh5_df$lib)
X19rL42_pSNV_thresh5_max_lib_counts
X19rL42_pSNV_thresh5_pre_count = length(X19rL42_pSNV_thresh5_df$pre)
X19rL42_pSNV_thresh5_pre_count
X19rL42_pSNV_thresh5_min_pre_counts = min(X19rL42_pSNV_thresh5_df$pre)
X19rL42_pSNV_thresh5_min_pre_counts
X19rL42_pSNV_thresh5_max_pre_counts = max(X19rL42_pSNV_thresh5_df$pre)
X19rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X19rL42_pSNV_thresh5_post_count = length(X19rL42_pSNV_thresh5_df$post)
X19rL42_pSNV_thresh5_post_count
X19rL42_pSNV_thresh5_min_post_counts = min(X19rL42_pSNV_thresh5_df$post)
X19rL42_pSNV_thresh5_min_post_counts
X19rL42_pSNV_thresh5_max_post_counts = max(X19rL42_pSNV_thresh5_df$post)
X19rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X19rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X19rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X19rL41_prog_var_thresh5_df:
X19rL41_prog_var_thresh5_df_rL42_int <- X19rL41_prog_var_thresh5_df[which(X19rL41_prog_var_thresh5_df$variant %in% X19rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X19rL42_prog_var_thresh5_df:
X19rL42_prog_var_thresh5_df_rL41_int <- X19rL42_prog_var_thresh5_df[which(X19rL42_prog_var_thresh5_df$variant %in% X19rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X19rL41_prog_var_thresh5_df_rL42_int_ord <- X19rL41_prog_var_thresh5_df_rL42_int[order(X19rL41_prog_var_thresh5_df_rL42_int$variant),]
X19rL42_prog_var_thresh5_df_rL41_int_ord <- X19rL42_prog_var_thresh5_df_rL41_int[order(X19rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X19rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X19rL41rL42int_prog_var_thresh5_pre_count <- dim(X19rL41_prog_var_thresh5_df_rL42_int)[1] 
X19rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X19rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X19rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X19rL42_prog_var_thresh5_df_rL41_int_ord$lib
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X19rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X19rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X19rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X19rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X19rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X19rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X19rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X19rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X19rL41_cSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X19rL41_cSNV_missense_post_pre_med <- unname(X19rL41_cSNV_missense_post_pre_quarts[3])
X19rL41_cSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X19rL41_cSNV_syn_post_pre_med <- unname(X19rL41_cSNV_syn_post_pre_quarts[3])
X19rL41_cSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X19rL41_cSNV_nonsense_post_pre_med <- unname(X19rL41_cSNV_nonsense_post_pre_quarts[3])
X19rL41_cSNV_syn_to_non_post_pre_spread <- X19rL41_cSNV_syn_post_pre_med - X19rL41_cSNV_nonsense_post_pre_med

X19rL42_cSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X19rL42_cSNV_missense_post_pre_med <- unname(X19rL42_cSNV_missense_post_pre_quarts[3])
X19rL42_cSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X19rL42_cSNV_syn_post_pre_med <- unname(X19rL42_cSNV_syn_post_pre_quarts[3])
X19rL42_cSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X19rL42_cSNV_nonsense_post_pre_med <- unname(X19rL42_cSNV_nonsense_post_pre_quarts[3])
X19rL42_cSNV_syn_to_non_post_pre_spread <- X19rL42_cSNV_syn_post_pre_med - X19rL42_cSNV_nonsense_post_pre_med

X19rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_missense_post_pre_med <- unname(X19rL41rL42a_cSNV_missense_post_pre_quarts[3])
X19rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_syn_post_pre_med <- unname(X19rL41rL42a_cSNV_syn_post_pre_quarts[3])
X19rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X19rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X19rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X19rL41rL42a_cSNV_syn_post_pre_med - X19rL41rL42a_cSNV_nonsense_post_pre_med

X19rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_cSNV_missense_post_pre_med <- unname(X19rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X19rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_cSNV_syn_post_pre_med <- unname(X19rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X19rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X19rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X19rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X19rL41rL42pw_cSNV_syn_post_pre_med - X19rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X19rL41_tSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X19rL41_tSNV_missense_post_pre_med <- unname(X19rL41_tSNV_missense_post_pre_quarts[3])
X19rL41_tSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X19rL41_tSNV_syn_post_pre_med <- unname(X19rL41_tSNV_syn_post_pre_quarts[3])
X19rL41_tSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X19rL41_tSNV_nonsense_post_pre_med <- unname(X19rL41_tSNV_nonsense_post_pre_quarts[3])
X19rL41_tSNV_syn_to_non_post_pre_spread <- X19rL41_tSNV_syn_post_pre_med - X19rL41_tSNV_nonsense_post_pre_med

X19rL42_tSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X19rL42_tSNV_missense_post_pre_med <- unname(X19rL42_tSNV_missense_post_pre_quarts[3])
X19rL42_tSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X19rL42_tSNV_syn_post_pre_med <- unname(X19rL42_tSNV_syn_post_pre_quarts[3])
X19rL42_tSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X19rL42_tSNV_nonsense_post_pre_med <- unname(X19rL42_tSNV_nonsense_post_pre_quarts[3])
X19rL42_tSNV_syn_to_non_post_pre_spread <- X19rL42_tSNV_syn_post_pre_med - X19rL42_tSNV_nonsense_post_pre_med

X19rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_missense_post_pre_med <- unname(X19rL41rL42a_tSNV_missense_post_pre_quarts[3])
X19rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_syn_post_pre_med <- unname(X19rL41rL42a_tSNV_syn_post_pre_quarts[3])
X19rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X19rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X19rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X19rL41rL42a_tSNV_syn_post_pre_med - X19rL41rL42a_tSNV_nonsense_post_pre_med

X19rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_tSNV_missense_post_pre_med <- unname(X19rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X19rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_tSNV_syn_post_pre_med <- unname(X19rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X19rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X19rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X19rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X19rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X19rL41rL42pw_tSNV_syn_post_pre_med - X19rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X19rL41_cSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X19rL41_cSNV_missense_post_lib_med <- unname(X19rL41_cSNV_missense_post_lib_quarts[3])
X19rL41_cSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X19rL41_cSNV_syn_post_lib_med <- unname(X19rL41_cSNV_syn_post_lib_quarts[3])
X19rL41_cSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X19rL41_cSNV_nonsense_post_lib_med <- unname(X19rL41_cSNV_nonsense_post_lib_quarts[3])
X19rL41_cSNV_syn_to_non_post_lib_spread <- X19rL41_cSNV_syn_post_lib_med - X19rL41_cSNV_nonsense_post_lib_med

X19rL42_cSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X19rL42_cSNV_missense_post_lib_med <- unname(X19rL42_cSNV_missense_post_lib_quarts[3])
X19rL42_cSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X19rL42_cSNV_syn_post_lib_med <- unname(X19rL42_cSNV_syn_post_lib_quarts[3])
X19rL42_cSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X19rL42_cSNV_nonsense_post_lib_med <- unname(X19rL42_cSNV_nonsense_post_lib_quarts[3])
X19rL42_cSNV_syn_to_non_post_lib_spread <- X19rL42_cSNV_syn_post_lib_med - X19rL42_cSNV_nonsense_post_lib_med

X19rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_missense_post_lib_med <- unname(X19rL41rL42a_cSNV_missense_post_lib_quarts[3])
X19rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_syn_post_lib_med <- unname(X19rL41rL42a_cSNV_syn_post_lib_quarts[3])
X19rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X19rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X19rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X19rL41rL42a_cSNV_syn_post_lib_med - X19rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X19rL41_tSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X19rL41_tSNV_missense_post_lib_med <- unname(X19rL41_tSNV_missense_post_lib_quarts[3])
X19rL41_tSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X19rL41_tSNV_syn_post_lib_med <- unname(X19rL41_tSNV_syn_post_lib_quarts[3])
X19rL41_tSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X19rL41_tSNV_nonsense_post_lib_med <- unname(X19rL41_tSNV_nonsense_post_lib_quarts[3])
X19rL41_tSNV_syn_to_non_post_lib_spread <- X19rL41_tSNV_syn_post_lib_med - X19rL41_tSNV_nonsense_post_lib_med

X19rL42_tSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X19rL42_tSNV_missense_post_lib_med <- unname(X19rL42_tSNV_missense_post_lib_quarts[3])
X19rL42_tSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X19rL42_tSNV_syn_post_lib_med <- unname(X19rL42_tSNV_syn_post_lib_quarts[3])
X19rL42_tSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X19rL42_tSNV_nonsense_post_lib_med <- unname(X19rL42_tSNV_nonsense_post_lib_quarts[3])
X19rL42_tSNV_syn_to_non_post_lib_spread <- X19rL42_tSNV_syn_post_lib_med - X19rL42_tSNV_nonsense_post_lib_med

X19rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_missense_post_lib_med <- unname(X19rL41rL42a_tSNV_missense_post_lib_quarts[3])
X19rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_syn_post_lib_med <- unname(X19rL41rL42a_tSNV_syn_post_lib_quarts[3])
X19rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X19rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X19rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X19rL41rL42a_tSNV_syn_post_lib_med - X19rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X19rL41_cSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X19rL41_cSNV_missense_pre_lib_med <- unname(X19rL41_cSNV_missense_pre_lib_quarts[3])
X19rL41_cSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X19rL41_cSNV_syn_pre_lib_med <- unname(X19rL41_cSNV_syn_pre_lib_quarts[3])
X19rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X19rL41_cSNV_nonsense_pre_lib_med <- unname(X19rL41_cSNV_nonsense_pre_lib_quarts[3])
X19rL41_cSNV_syn_to_non_pre_lib_spread <- X19rL41_cSNV_syn_pre_lib_med - X19rL41_cSNV_nonsense_pre_lib_med

X19rL42_cSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X19rL42_cSNV_missense_pre_lib_med <- unname(X19rL42_cSNV_missense_pre_lib_quarts[3])
X19rL42_cSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X19rL42_cSNV_syn_pre_lib_med <- unname(X19rL42_cSNV_syn_pre_lib_quarts[3])
X19rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X19rL42_cSNV_nonsense_pre_lib_med <- unname(X19rL42_cSNV_nonsense_pre_lib_quarts[3])
X19rL42_cSNV_syn_to_non_pre_lib_spread <- X19rL42_cSNV_syn_pre_lib_med - X19rL42_cSNV_nonsense_pre_lib_med

X19rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_missense_pre_lib_med <- unname(X19rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X19rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_syn_pre_lib_med <- unname(X19rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X19rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X19rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X19rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X19rL41rL42a_cSNV_syn_pre_lib_med - X19rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X19rL41_tSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X19rL41_tSNV_missense_pre_lib_med <- unname(X19rL41_tSNV_missense_pre_lib_quarts[3])
X19rL41_tSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X19rL41_tSNV_syn_pre_lib_med <- unname(X19rL41_tSNV_syn_pre_lib_quarts[3])
X19rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X19rL41_tSNV_nonsense_pre_lib_med <- unname(X19rL41_tSNV_nonsense_pre_lib_quarts[3])
X19rL41_tSNV_syn_to_non_pre_lib_spread <- X19rL41_tSNV_syn_pre_lib_med - X19rL41_tSNV_nonsense_pre_lib_med

X19rL42_tSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X19rL42_tSNV_missense_pre_lib_med <- unname(X19rL42_tSNV_missense_pre_lib_quarts[3])
X19rL42_tSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X19rL42_tSNV_syn_pre_lib_med <- unname(X19rL42_tSNV_syn_pre_lib_quarts[3])
X19rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X19rL42_tSNV_nonsense_pre_lib_med <- unname(X19rL42_tSNV_nonsense_pre_lib_quarts[3])
X19rL42_tSNV_syn_to_non_pre_lib_spread <- X19rL42_tSNV_syn_pre_lib_med - X19rL42_tSNV_nonsense_pre_lib_med

X19rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_missense_pre_lib_med <- unname(X19rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X19rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_syn_pre_lib_med <- unname(X19rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X19rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X19rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X19rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X19rL41rL42a_tSNV_syn_pre_lib_med - X19rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X19rL41_tSNV_syn_rna_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X19rL41_tSNV_syn_rna_pre_med <- unname(X19rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X19rL41_tSNV_syn_rna_post_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X19rL41_tSNV_syn_rna_post_med <- unname(X19rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X19rL42_tSNV_syn_rna_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X19rL42_tSNV_syn_rna_pre_med <- unname(X19rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X19rL42_tSNV_syn_rna_post_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X19rL42_tSNV_syn_rna_post_med <- unname(X19rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X19rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_syn_rna_pre_med <- unname(X19rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X19rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X19rL41rL42a_tSNV_syn_rna_post_med <- unname(X19rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X19rL41_cSNV_syn_pre_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X19rL41_cSNV_syn_post_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X19rL41_cSNV_syn_post_lib_med
# tHDR
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X19rL41_tSNV_syn_pre_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X19rL41_tSNV_syn_post_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X19rL41_tSNV_syn_post_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X19rL41_tSNV_syn_rna_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X19rL41_tSNV_syn_rna_post_med

#rL42
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X19rL42_cSNV_syn_pre_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X19rL42_cSNV_syn_post_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X19rL42_cSNV_syn_post_lib_med
# tHDR
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X19rL42_tSNV_syn_pre_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X19rL42_tSNV_syn_post_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X19rL42_tSNV_syn_post_lib_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X19rL42_tSNV_syn_rna_pre_med
X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X19rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X19rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X19rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X19rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X19rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X19rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X19rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X19rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X19rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X19rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X19rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X19rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X19rL41_prog_var_thresh5_df_rL42_int_ord[which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X19rL41_prog_var_thresh5_df_rL42_int_ord
X19rL41_prog_map_thresh5_df_rL42_int_ord = which(X19rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X19rL41_prog_map_thresh5_df_rL42_int_ord_df = X19rL41_prog_var_thresh5_df_rL42_int_ord[X19rL41_prog_map_thresh5_df_rL42_int_ord,]
X19rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X19rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X19rL41_prog_map_thresh5_df_rL42_int_ord_df[X19rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X19rL41_prog_map_thresh5_df_rL42_int_ord_df[X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X19rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X19rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X19rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X19rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X19rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X19rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X19rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X19rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X19rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X19rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X19rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X19rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X19rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X19rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X19rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X19rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X19rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X19rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X19rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X19rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X19rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X19rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X19rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41_cSNV_post_pre_by_cadd_cor_s
#X19rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X19rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL42_cSNV_post_pre_by_cadd_cor_s

#X19rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X19rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41_cSNV_post_lib_by_cadd_cor_s
#X19rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X19rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X19rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X19rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41_tSNV_post_pre_by_cadd_cor_s
#X19rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X19rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL42_tSNV_post_pre_by_cadd_cor_s

#X19rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X19rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41_tSNV_post_lib_by_cadd_cor_s
#X19rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X19rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X19rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X19rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X19rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X19rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X19rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X19rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X19rL41_prog_var_all_lib_count
X19rL41_prog_var_all_pre_count
X19rL42_prog_var_all_pre_count
X19rL41_prog_map_thresh5_lib_count
X19rL41_prog_map_thresh5_pre_count
X19rL42_prog_map_thresh5_pre_count
X19rL41_prog_map_thresh5_post_count
X19rL42_prog_map_thresh5_post_count
X19rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X19rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X19rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X19rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X19rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X19rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X19rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X19rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X19rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X19rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X19rL41_cSNV_post_pre_by_cadd_cor_s
X19rL42_cSNV_post_pre_by_cadd_cor_s
X19rL41_cSNV_post_lib_by_cadd_cor_s
X19rL42_cSNV_post_lib_by_cadd_cor_s
X19rL41_tSNV_post_pre_by_cadd_cor_s
X19rL42_tSNV_post_pre_by_cadd_cor_s
X19rL41_tSNV_post_lib_by_cadd_cor_s
X19rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X19rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X19rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X19rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X19rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X19rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X19rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X19rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X19rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X19rL41_cSNV_syn_to_non_post_pre_spread
X19rL42_cSNV_syn_to_non_post_pre_spread
X19rL41rL42a_cSNV_syn_to_non_post_pre_spread
X19rL41_cSNV_syn_to_non_post_lib_spread
X19rL42_cSNV_syn_to_non_post_lib_spread
X19rL41rL42a_cSNV_syn_to_non_post_lib_spread
X19rL41_tSNV_syn_to_non_post_pre_spread
X19rL42_tSNV_syn_to_non_post_pre_spread
X19rL41rL42a_tSNV_syn_to_non_post_pre_spread
X19rL41_tSNV_syn_to_non_post_lib_spread
X19rL42_tSNV_syn_to_non_post_lib_spread
X19rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X19rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X19rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X19rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X19rL41_cSNV_pre_lib_cors = cor(log2(X19rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19rL41_tSNV_pre_lib_cors = cor(log2(X19rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19rL41_cSNV_post_lib_cors = cor(log2(X19rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X19rL41_tSNV_post_lib_cors = cor(log2(X19rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X19rL41_cSNV_post_pre_cors = cor(log2(X19rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19rL41_tSNV_post_pre_cors = cor(log2(X19rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X19rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19rL41_cSNV_rna_lib_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X19rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19rL41_tSNV_rna_lib_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X19rL41_cSNV_rna_pre_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X19rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19rL41_tSNV_rna_pre_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X19rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19rL41rL42_cSNV_pre_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X19rL41rL42_tSNV_pre_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X19rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X19rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X19rL41rL42_cSNV_post_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X19rL41rL42_tSNV_post_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X19rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X19rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X19rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X19rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X19rL41rL42_cSNV_rna_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X19rL41rL42_tSNV_rna_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X19rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X19rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X19rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X19rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X19rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X19rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X19rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X19rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X19rL41_cors <- c("X19rL41",X19rL41_cSNV_pre_lib_cors,X19rL41_tSNV_pre_lib_cors,X19rL41_cSNV_post_lib_cors,X19rL41_tSNV_post_lib_cors,X19rL41_cSNV_post_pre_cors,X19rL41_tSNV_post_pre_cors,X19rL41_cSNV_rna_lib_cors,X19rL41_tSNV_rna_lib_cors,X19rL41_cSNV_rna_pre_cors,X19rL41_tSNV_rna_pre_cors,X19rL41rL42_cSNV_pre_cors,X19rL41rL42_tSNV_pre_cors,X19rL41rL42_cSNV_pre_lib_ratio_cors,X19rL41rL42_tSNV_pre_lib_ratio_cors,X19rL41rL42_cSNV_post_cors,X19rL41rL42_tSNV_post_cors,X19rL41rL42_cSNV_post_lib_ratio_cors,X19rL41rL42_tSNV_post_lib_ratio_cors,X19rL41rL42_cSNV_post_pre_ratio_cors,X19rL41rL42_tSNV_post_pre_ratio_cors,X19rL41rL42_cSNV_rna_cors,X19rL41rL42_tSNV_rna_cors,X19rL41rL42_tSNV_rna_pre_ratio_cors,X19rL41_cSNV_pre_lib_ratio_cadd_cors,X19rL41_tSNV_pre_lib_ratio_cadd_cors,X19rL41_cSNV_post_lib_ratio_cadd_cors,X19rL41_tSNV_post_lib_ratio_cadd_cors,X19rL41_cSNV_post_pre_ratio_cadd_cors,X19rL41_tSNV_post_pre_ratio_cadd_cors,X19rL41_cSNV_post_pre_ratio_cadd_missense_cors,X19rL41_tSNV_post_pre_ratio_cadd_missense_cors,X19rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X19rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X19rL41_cSNV_post_pre_ratio_grantham_missense_cors,X19rL41_tSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X19rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X19rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X19rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X19rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X19rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X19rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X19rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X19rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X19rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X19rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X19rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X19rL42_cSNV_pre_lib_cors = cor(log2(X19rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19rL42_tSNV_pre_lib_cors = cor(log2(X19rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19rL42_cSNV_post_lib_cors = cor(log2(X19rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X19rL42_tSNV_post_lib_cors = cor(log2(X19rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X19rL42_cSNV_post_pre_cors = cor(log2(X19rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X19rL42_tSNV_post_pre_cors = cor(log2(X19rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X19rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X19rL42_cSNV_rna_lib_cors = cor(log2(X19rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X19rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19rL42_tSNV_rna_lib_cors = cor(log2(X19rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X19rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X19rL42_cSNV_rna_pre_cors = cor(log2(X19rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X19rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X19rL42_tSNV_rna_pre_cors = cor(log2(X19rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X19rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X19rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X19rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X19rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X19rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X19rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X19rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X19rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X19rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X19rL42_cors <- c("X19rL42",X19rL42_cSNV_pre_lib_cors,X19rL42_tSNV_pre_lib_cors,X19rL42_cSNV_post_lib_cors,X19rL42_tSNV_post_lib_cors,X19rL42_cSNV_post_pre_cors,X19rL42_tSNV_post_pre_cors,X19rL42_cSNV_rna_lib_cors,X19rL42_tSNV_rna_lib_cors,X19rL42_cSNV_rna_pre_cors,X19rL42_tSNV_rna_pre_cors,X19rL41rL42_cSNV_pre_cors,X19rL41rL42_tSNV_pre_cors,X19rL41rL42_cSNV_pre_lib_ratio_cors,X19rL41rL42_tSNV_pre_lib_ratio_cors,X19rL41rL42_cSNV_post_cors,X19rL41rL42_tSNV_post_cors,X19rL41rL42_cSNV_post_lib_ratio_cors,X19rL41rL42_tSNV_post_lib_ratio_cors,X19rL41rL42_cSNV_post_pre_ratio_cors,X19rL41rL42_tSNV_post_pre_ratio_cors,X19rL41rL42_cSNV_rna_cors,X19rL41rL42_tSNV_rna_cors,X19rL41rL42_tSNV_rna_pre_ratio_cors,X19rL42_cSNV_pre_lib_ratio_cadd_cors,X19rL42_tSNV_pre_lib_ratio_cadd_cors,X19rL42_cSNV_post_lib_ratio_cadd_cors,X19rL42_tSNV_post_lib_ratio_cadd_cors,X19rL42_cSNV_post_pre_ratio_cadd_cors,X19rL42_tSNV_post_pre_ratio_cadd_cors,X19rL42_cSNV_post_pre_ratio_cadd_missense_cors,X19rL42_tSNV_post_pre_ratio_cadd_missense_cors,X19rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X19rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X19rL42_cSNV_post_pre_ratio_grantham_missense_cors,X19rL42_tSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X19rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X19rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X19rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X19rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X19rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X19rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X19rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X19rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X19rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X19rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X19rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X19rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X19rL41)
rm(X19rL42)
gc()

#subbed in cleaner 3rd replicate for below QC first replicate here!!
X20rL41_file <- paste(experiment_dir_170731,'X20rL43','_annotated.txt',sep='')
X20rL42_file <- paste(experiment_dir_170731,'X20rL42','_annotated.txt',sep='')
X20rL41 <- read.table(X20rL41_file, header=TRUE, sep="\t")
X20rL42 <- read.table(X20rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X20 <- editing_info[which(editing_info$amplicon == 'X20'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X20_HDR_5_SNV = as.character(editing_info_X20$HDR_5_SNV)
X20_HDR_3_SNV = as.character(editing_info_X20$HDR_3_SNV)
#X20_cut_pos = as.character(editing_info_X20$cut_pos)
X20_cut_end = as.character(editing_info_X20$cut_end)
X20_mut_start = as.character(editing_info_X20$mut_start)
X20_mut_end = as.character(editing_info_X20$mut_end)
### Replicate 1
X20rL41_cSNV_all <- which(X20rL41[,'c_hdr_snv']=='True')
X20rL41_cSNV_all_df = X20rL41[X20rL41_cSNV_all,]
X20rL41_prog_var_all <- which(X20rL41[,'all_hdr_variant']=='True' & X20rL41[,'edit_string']!='-WT')
X20rL41_prog_var_all_df = X20rL41[X20rL41_prog_var_all,]
X20rL41_prog_map_all = which(X20rL41_prog_var_all_df[,'pos']!='REF')
X20rL41_prog_map_all_df = X20rL41_prog_var_all_df[X20rL41_prog_map_all,]
X20rL41_prog_map_exon_all = which(X20rL41_prog_map_all_df[,'cDNApos']!='REF' & X20rL41_prog_map_all_df[,'cDNApos']!='NA')
X20rL41_prog_map_exon_all_df = X20rL41_prog_map_all_df[X20rL41_prog_map_exon_all,]
X20rL41_prog_map_CADD = which(X20rL41_prog_map_all_df[,'CADD.phred']!='NA')
X20rL41_prog_map_CADD_df = X20rL41_prog_map_all_df[X20rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X20rL41_prog_var_thresh5 <- which(as.numeric(as.character(X20rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X20rL41_prog_var_thresh5_df = X20rL41_prog_var_all_df[X20rL41_prog_var_thresh5,]
X20rL41_prog_map_thresh5 <- which(as.numeric(as.character(X20rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X20rL41_prog_map_thresh5_df = X20rL41_prog_map_all_df[X20rL41_prog_map_thresh5,]
X20rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X20rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X20rL41_prog_map_exon_thresh5_df = X20rL41_prog_map_exon_all_df[X20rL41_prog_map_exon_thresh5,]
X20rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X20rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X20rL41_prog_map_CADD_thresh5_df = X20rL41_prog_map_CADD_df[X20rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X20rL41_prog_var_all_lib_count = length(X20rL41_prog_var_all_df$lib)
X20rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X20rL41_prog_var_all_min_lib_counts = min(X20rL41_prog_var_all_df$lib)
X20rL41_prog_var_all_min_lib_counts
X20rL41_prog_var_all_max_lib_counts = max(X20rL41_prog_var_all_df$lib)
X20rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X20rL41_prog_map_all_lib_count = length(X20rL41_prog_map_all_df$lib)
X20rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X20rL41_prog_map_all_min_lib_counts = min(X20rL41_prog_map_all_df$lib)
X20rL41_prog_map_all_min_lib_counts
X20rL41_prog_map_all_max_lib_counts = max(X20rL41_prog_map_all_df$lib)
X20rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X20rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X20rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X20rL41_prog_var_all_pre_count = length(X20rL41_prog_var_all_df$pre)
X20rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X20rL41_prog_var_all_min_pre_counts = min(X20rL41_prog_var_all_df$pre)
X20rL41_prog_var_all_min_pre_counts
X20rL41_prog_var_all_max_pre_counts = max(X20rL41_prog_var_all_df$pre)
X20rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X20rL41_prog_map_all_pre_count = length(X20rL41_prog_map_all_df$pre)
X20rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X20rL41_prog_map_all_min_pre_counts = min(X20rL41_prog_map_all_df$pre)
X20rL41_prog_map_all_min_pre_counts
X20rL41_prog_map_all_max_pre_counts = max(X20rL41_prog_map_all_df$pre)
X20rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X20rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X20rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X20rL41_prog_map_all_post_count = length(X20rL41_prog_map_all_df$post)
X20rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X20rL41_prog_map_all_min_post_counts = min(X20rL41_prog_map_all_df$post)
X20rL41_prog_map_all_min_post_counts
X20rL41_prog_map_all_max_post_counts = max(X20rL41_prog_map_all_df$post)
X20rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X20rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X20rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X20rL41_prog_map_all_syn_df <- X20rL41_prog_map_all_df[which(X20rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X20rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X20rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X20rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X20rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X20rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X20rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X20rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X20rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X20rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X20rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X20rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X20rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X20rL41_prog_map_all_min_rna_counts = min(X20rL41_prog_map_exon_all_df$tHDR_rna)
X20rL41_prog_map_all_min_rna_counts
X20rL41_prog_map_all_max_rna_counts = max(X20rL41_prog_map_exon_all_df$tHDR_rna)
X20rL41_prog_map_all_max_rna_counts
X20rL41_prog_map_all_min_rna_pseudo_freq = min(X20rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20rL41_prog_map_all_min_rna_pseudo_freq
X20rL41_prog_map_all_max_rna_pseudo_freq = max(X20rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20rL41_prog_map_all_max_rna_pseudo_freq
X20rL41_prog_map_all_min_rna_pre_ratio = min(X20rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20rL41_prog_map_all_min_rna_pre_ratio
X20rL41_prog_map_all_max_rna_pre_ratio = max(X20rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20rL41_prog_map_all_max_rna_pre_ratio
X20rL41_prog_map_all_min_rna_post_ratio = min(X20rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20rL41_prog_map_all_min_rna_post_ratio
X20rL41_prog_map_all_max_rna_post_ratio = max(X20rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X20rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X20rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X20rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X20rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X20rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X20rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X20rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X20rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X20rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X20rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X20rL41_prog_map_all_df$post_pre_ratio),log2(X20rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X20rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X20rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X20rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X20rL41_cSNV_all_corr_pre_count = length(X20rL41_cSNV_all_df$corr_pre)
X20rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X20rL41_cSNV_all_min_corr_pre_counts = min(X20rL41_cSNV_all_df$corr_pre)
X20rL41_cSNV_all_min_corr_pre_counts
X20rL41_cSNV_all_max_corr_pre_counts = max(X20rL41_cSNV_all_df$corr_pre)
X20rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X20rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X20rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X20rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X20rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X20rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_cSNV_all_corr_post_count = length(X20rL41_cSNV_all_df$corr_post)
X20rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X20rL41_cSNV_all_min_corr_post_counts = min(X20rL41_cSNV_all_df$corr_post)
X20rL41_cSNV_all_min_corr_post_counts
X20rL41_cSNV_all_max_corr_post_counts = max(X20rL41_cSNV_all_df$corr_post)
X20rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X20rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X20rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X20rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X20rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X20rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X20rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X20_p_hdr_snv = paste('p_hdr_',X20_cut_end,'_snv',sep='')
X20rL41_pSNV_all <- which(X20rL41[,X20_p_hdr_snv]=='True')
X20rL41_pSNV_all_df = X20rL41[X20rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_pSNV_all_lib_count = length(X20rL41_pSNV_all_df$lib)
X20rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X20rL41_pSNV_all_min_lib_counts = min(X20rL41_pSNV_all_df$lib)
X20rL41_pSNV_all_min_lib_counts
X20rL41_pSNV_all_max_lib_counts = max(X20rL41_pSNV_all_df$lib)
X20rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X20rL41_pSNV_all_pre_count = length(X20rL41_pSNV_all_df$pre)
X20rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X20rL41_pSNV_all_min_pre_counts = min(X20rL41_pSNV_all_df$pre)
X20rL41_pSNV_all_min_pre_counts
X20rL41_pSNV_all_max_pre_counts = max(X20rL41_pSNV_all_df$pre)
X20rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X20rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X20rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_pSNV_all_post_count = length(X20rL41_pSNV_all_df$post)
X20rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X20rL41_pSNV_all_min_post_counts = min(X20rL41_pSNV_all_df$post)
X20rL41_pSNV_all_min_post_counts
X20rL41_pSNV_all_max_post_counts = max(X20rL41_pSNV_all_df$post)
X20rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X20rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X20rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_prog_map_thresh5_lib_count = length(X20rL41_prog_map_thresh5_df$lib)
X20rL41_prog_map_thresh5_lib_count
X20rL41_prog_map_thresh5_min_lib_counts = min(X20rL41_prog_map_thresh5_df$lib)
X20rL41_prog_map_thresh5_min_lib_counts
X20rL41_prog_map_thresh5_max_lib_counts = max(X20rL41_prog_map_thresh5_df$lib)
X20rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X20rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X20rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_prog_map_thresh5_pre_count = length(X20rL41_prog_map_thresh5_df$pre)
X20rL41_prog_map_thresh5_pre_count
X20rL41_prog_map_thresh5_min_pre_counts = min(X20rL41_prog_map_thresh5_df$pre)
X20rL41_prog_map_thresh5_min_pre_counts
X20rL41_prog_map_thresh5_max_pre_counts = max(X20rL41_prog_map_thresh5_df$pre)
X20rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL41_prog_map_thresh5_post_count = length(X20rL41_prog_map_thresh5_df$post)
X20rL41_prog_map_thresh5_post_count
X20rL41_prog_map_thresh5_min_post_counts = min(X20rL41_prog_map_thresh5_df$post)
X20rL41_prog_map_thresh5_min_post_counts
X20rL41_prog_map_thresh5_max_post_counts = max(X20rL41_prog_map_thresh5_df$post)
X20rL41_prog_map_thresh5_max_post_counts
X20rL41_prog_map_thresh5_corr_post_count = length(X20rL41_cSNV_all_df$corr_post)
X20rL41_prog_map_thresh5_corr_post_count
X20rL41_prog_map_thresh5_min_corr_post_counts = min(X20rL41_cSNV_all_df$corr_post)
X20rL41_prog_map_thresh5_min_corr_post_counts
X20rL41_prog_map_thresh5_max_corr_post_counts = max(X20rL41_cSNV_all_df$corr_post)
X20rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X20rL41_pSNV_thresh5 <- which(X20rL41[,X20_p_hdr_snv]=='True' & as.numeric(as.character(X20rL41[,'pre_freq']))>=0.00001)
X20rL41_pSNV_thresh5_df = X20rL41[X20rL41_pSNV_thresh5,]
X20rL41_pSNV_thresh5_lib_count = length(X20rL41_pSNV_thresh5_df$lib)
X20rL41_pSNV_thresh5_lib_count
X20rL41_pSNV_thresh5_min_lib_counts = min(X20rL41_pSNV_thresh5_df$lib)
X20rL41_pSNV_thresh5_min_lib_counts
X20rL41_pSNV_thresh5_max_lib_counts = max(X20rL41_pSNV_thresh5_df$lib)
X20rL41_pSNV_thresh5_max_lib_counts
X20rL41_pSNV_thresh5_pre_count = length(X20rL41_pSNV_thresh5_df$pre)
X20rL41_pSNV_thresh5_pre_count
X20rL41_pSNV_thresh5_min_pre_counts = min(X20rL41_pSNV_thresh5_df$pre)
X20rL41_pSNV_thresh5_min_pre_counts
X20rL41_pSNV_thresh5_max_pre_counts = max(X20rL41_pSNV_thresh5_df$pre)
X20rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X20rL41_pSNV_thresh5_post_count = length(X20rL41_pSNV_thresh5_df$post)
X20rL41_pSNV_thresh5_post_count
X20rL41_pSNV_thresh5_min_post_counts = min(X20rL41_pSNV_thresh5_df$post)
X20rL41_pSNV_thresh5_min_post_counts
X20rL41_pSNV_thresh5_max_post_counts = max(X20rL41_pSNV_thresh5_df$post)
X20rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X20rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X20rL41_pSNV_thresh5_post_pos

### Replicate 2
X20rL42_cSNV_all <- which(X20rL42[,'c_hdr_snv']=='True')
X20rL42_cSNV_all_df = X20rL42[X20rL42_cSNV_all,]
X20rL42_prog_var_all <- which(X20rL42[,'all_hdr_variant']=='True' & X20rL42[,'edit_string']!='-WT')
X20rL42_prog_var_all_df = X20rL42[X20rL42_prog_var_all,]
X20rL42_prog_map_all = which(X20rL42_prog_var_all_df[,'pos']!='REF')
X20rL42_prog_map_all_df = X20rL42_prog_var_all_df[X20rL42_prog_map_all,]
X20rL42_prog_map_exon_all = which(X20rL42_prog_map_all_df[,'cDNApos']!='REF' & X20rL42_prog_map_all_df[,'cDNApos']!='NA')
X20rL42_prog_map_exon_all_df = X20rL42_prog_map_all_df[X20rL42_prog_map_exon_all,]
X20rL42_prog_map_CADD = which(X20rL42_prog_map_all_df[,'CADD.phred']!='NA')
X20rL42_prog_map_CADD_df = X20rL42_prog_map_all_df[X20rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X20rL42_prog_var_thresh5 <- which(as.numeric(as.character(X20rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X20rL42_prog_var_thresh5_df = X20rL42_prog_var_all_df[X20rL42_prog_var_thresh5,]
X20rL42_prog_map_thresh5 <- which(as.numeric(as.character(X20rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X20rL42_prog_map_thresh5_df = X20rL42_prog_map_all_df[X20rL42_prog_map_thresh5,]
X20rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X20rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X20rL42_prog_map_exon_thresh5_df = X20rL42_prog_map_exon_all_df[X20rL42_prog_map_exon_thresh5,]
X20rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X20rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X20rL42_prog_map_CADD_thresh5_df = X20rL42_prog_map_CADD_df[X20rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X20rL42_prog_var_all_lib_count = length(X20rL42_prog_var_all_df$lib)
X20rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X20rL42_prog_var_all_min_lib_counts = min(X20rL42_prog_var_all_df$lib)
X20rL42_prog_var_all_min_lib_counts
X20rL42_prog_var_all_max_lib_counts = max(X20rL42_prog_var_all_df$lib)
X20rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X20rL42_prog_map_all_lib_count = length(X20rL42_prog_map_all_df$lib)
X20rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X20rL42_prog_map_all_min_lib_counts = min(X20rL42_prog_map_all_df$lib)
X20rL42_prog_map_all_min_lib_counts
X20rL42_prog_map_all_max_lib_counts = max(X20rL42_prog_map_all_df$lib)
X20rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X20rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X20rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X20rL42_prog_var_all_pre_count = length(X20rL42_prog_var_all_df$pre)
X20rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X20rL42_prog_var_all_min_pre_counts = min(X20rL42_prog_var_all_df$pre)
X20rL42_prog_var_all_min_pre_counts
X20rL42_prog_var_all_max_pre_counts = max(X20rL42_prog_var_all_df$pre)
X20rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X20rL42_prog_map_all_pre_count = length(X20rL42_prog_map_all_df$pre)
X20rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X20rL42_prog_map_all_min_pre_counts = min(X20rL42_prog_map_all_df$pre)
X20rL42_prog_map_all_min_pre_counts
X20rL42_prog_map_all_max_pre_counts = max(X20rL42_prog_map_all_df$pre)
X20rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X20rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X20rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X20rL42_prog_map_all_post_count = length(X20rL42_prog_map_all_df$post)
X20rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X20rL42_prog_map_all_min_post_counts = min(X20rL42_prog_map_all_df$post)
X20rL42_prog_map_all_min_post_counts
X20rL42_prog_map_all_max_post_counts = max(X20rL42_prog_map_all_df$post)
X20rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X20rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X20rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X20rL42_prog_map_all_syn_df <- X20rL42_prog_map_all_df[which(X20rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X20rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X20rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X20rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X20rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X20rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X20rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X20rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X20rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X20rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X20rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X20rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X20rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X20rL42_prog_map_all_min_rna_counts = min(X20rL42_prog_map_exon_all_df$tHDR_rna)
X20rL42_prog_map_all_min_rna_counts
X20rL42_prog_map_all_max_rna_counts = max(X20rL42_prog_map_exon_all_df$tHDR_rna)
X20rL42_prog_map_all_max_rna_counts
X20rL42_prog_map_all_min_rna_pseudo_freq = min(X20rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20rL42_prog_map_all_min_rna_pseudo_freq
X20rL42_prog_map_all_max_rna_pseudo_freq = max(X20rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X20rL42_prog_map_all_max_rna_pseudo_freq
X20rL42_prog_map_all_min_rna_pre_ratio = min(X20rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20rL42_prog_map_all_min_rna_pre_ratio
X20rL42_prog_map_all_max_rna_pre_ratio = max(X20rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X20rL42_prog_map_all_max_rna_pre_ratio
X20rL42_prog_map_all_min_rna_post_ratio = min(X20rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20rL42_prog_map_all_min_rna_post_ratio
X20rL42_prog_map_all_max_rna_post_ratio = max(X20rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X20rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X20rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X20rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X20rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X20rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X20rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X20rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X20rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X20rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X20rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X20rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X20rL42_prog_map_all_df$post_pre_ratio),log2(X20rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X20rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X20rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X20rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X20rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X20rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X20rL42_cSNV_all_corr_pre_count = length(X20rL42_cSNV_all_df$corr_pre)
X20rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X20rL42_cSNV_all_min_corr_pre_counts = min(X20rL42_cSNV_all_df$corr_pre)
X20rL42_cSNV_all_min_corr_pre_counts
X20rL42_cSNV_all_max_corr_pre_counts = max(X20rL42_cSNV_all_df$corr_pre)
X20rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X20rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X20rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X20rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X20rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X20rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_cSNV_all_corr_post_count = length(X20rL42_cSNV_all_df$corr_post)
X20rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X20rL42_cSNV_all_min_corr_post_counts = min(X20rL42_cSNV_all_df$corr_post)
X20rL42_cSNV_all_min_corr_post_counts
X20rL42_cSNV_all_max_corr_post_counts = max(X20rL42_cSNV_all_df$corr_post)
X20rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X20rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X20rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X20rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X20rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X20rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X20rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X20_p_hdr_snv = paste('p_hdr_',X20_cut_end,'_snv',sep='')
X20rL42_pSNV_all <- which(X20rL42[,X20_p_hdr_snv]=='True')
X20rL42_pSNV_all_df = X20rL42[X20rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_pSNV_all_lib_count = length(X20rL42_pSNV_all_df$lib)
X20rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X20rL42_pSNV_all_min_lib_counts = min(X20rL42_pSNV_all_df$lib)
X20rL42_pSNV_all_min_lib_counts
X20rL42_pSNV_all_max_lib_counts = max(X20rL42_pSNV_all_df$lib)
X20rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X20rL42_pSNV_all_pre_count = length(X20rL42_pSNV_all_df$pre)
X20rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X20rL42_pSNV_all_min_pre_counts = min(X20rL42_pSNV_all_df$pre)
X20rL42_pSNV_all_min_pre_counts
X20rL42_pSNV_all_max_pre_counts = max(X20rL42_pSNV_all_df$pre)
X20rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X20rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X20rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_pSNV_all_post_count = length(X20rL42_pSNV_all_df$post)
X20rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X20rL42_pSNV_all_min_post_counts = min(X20rL42_pSNV_all_df$post)
X20rL42_pSNV_all_min_post_counts
X20rL42_pSNV_all_max_post_counts = max(X20rL42_pSNV_all_df$post)
X20rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X20rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X20rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_prog_map_thresh5_lib_count = length(X20rL42_prog_map_thresh5_df$lib)
X20rL42_prog_map_thresh5_lib_count
X20rL42_prog_map_thresh5_min_lib_counts = min(X20rL42_prog_map_thresh5_df$lib)
X20rL42_prog_map_thresh5_min_lib_counts
X20rL42_prog_map_thresh5_max_lib_counts = max(X20rL42_prog_map_thresh5_df$lib)
X20rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X20rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X20rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_prog_map_thresh5_pre_count = length(X20rL42_prog_map_thresh5_df$pre)
X20rL42_prog_map_thresh5_pre_count
X20rL42_prog_map_thresh5_min_pre_counts = min(X20rL42_prog_map_thresh5_df$pre)
X20rL42_prog_map_thresh5_min_pre_counts
X20rL42_prog_map_thresh5_max_pre_counts = max(X20rL42_prog_map_thresh5_df$pre)
X20rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X20 less than SGE region length x 3 due to PAM edits
X20rL42_prog_map_thresh5_post_count = length(X20rL42_prog_map_thresh5_df$post)
X20rL42_prog_map_thresh5_post_count
X20rL42_prog_map_thresh5_min_post_counts = min(X20rL42_prog_map_thresh5_df$post)
X20rL42_prog_map_thresh5_min_post_counts
X20rL42_prog_map_thresh5_max_post_counts = max(X20rL42_prog_map_thresh5_df$post)
X20rL42_prog_map_thresh5_max_post_counts
X20rL42_prog_map_thresh5_corr_post_count = length(X20rL42_prog_map_thresh5_df$corr_post)
X20rL42_prog_map_thresh5_corr_post_count
X20rL42_prog_map_thresh5_min_corr_post_counts = min(X20rL42_prog_map_thresh5_df$corr_post)
X20rL42_prog_map_thresh5_min_corr_post_counts
X20rL42_prog_map_thresh5_max_corr_post_counts = max(X20rL42_prog_map_thresh5_df$corr_post)
X20rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X20rL42_pSNV_thresh5 <- which(X20rL42[,X20_p_hdr_snv]=='True' & as.numeric(as.character(X20rL42[,'pre_freq']))>=0.00001)
X20rL42_pSNV_thresh5_df = X20rL42[X20rL42_pSNV_thresh5,]
X20rL42_pSNV_thresh5_lib_count = length(X20rL42_pSNV_thresh5_df$lib)
X20rL42_pSNV_thresh5_lib_count
X20rL42_pSNV_thresh5_min_lib_counts = min(X20rL42_pSNV_thresh5_df$lib)
X20rL42_pSNV_thresh5_min_lib_counts
X20rL42_pSNV_thresh5_max_lib_counts = max(X20rL42_pSNV_thresh5_df$lib)
X20rL42_pSNV_thresh5_max_lib_counts
X20rL42_pSNV_thresh5_pre_count = length(X20rL42_pSNV_thresh5_df$pre)
X20rL42_pSNV_thresh5_pre_count
X20rL42_pSNV_thresh5_min_pre_counts = min(X20rL42_pSNV_thresh5_df$pre)
X20rL42_pSNV_thresh5_min_pre_counts
X20rL42_pSNV_thresh5_max_pre_counts = max(X20rL42_pSNV_thresh5_df$pre)
X20rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X20rL42_pSNV_thresh5_post_count = length(X20rL42_pSNV_thresh5_df$post)
X20rL42_pSNV_thresh5_post_count
X20rL42_pSNV_thresh5_min_post_counts = min(X20rL42_pSNV_thresh5_df$post)
X20rL42_pSNV_thresh5_min_post_counts
X20rL42_pSNV_thresh5_max_post_counts = max(X20rL42_pSNV_thresh5_df$post)
X20rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X20rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X20rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X20rL41_prog_var_thresh5_df:
X20rL41_prog_var_thresh5_df_rL42_int <- X20rL41_prog_var_thresh5_df[which(X20rL41_prog_var_thresh5_df$variant %in% X20rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X20rL42_prog_var_thresh5_df:
X20rL42_prog_var_thresh5_df_rL41_int <- X20rL42_prog_var_thresh5_df[which(X20rL42_prog_var_thresh5_df$variant %in% X20rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X20rL41_prog_var_thresh5_df_rL42_int_ord <- X20rL41_prog_var_thresh5_df_rL42_int[order(X20rL41_prog_var_thresh5_df_rL42_int$variant),]
X20rL42_prog_var_thresh5_df_rL41_int_ord <- X20rL42_prog_var_thresh5_df_rL41_int[order(X20rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X20rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X20rL41rL42int_prog_var_thresh5_pre_count <- dim(X20rL41_prog_var_thresh5_df_rL42_int)[1] 
X20rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X20rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X20rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X20rL42_prog_var_thresh5_df_rL41_int_ord$lib
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X20rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X20rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X20rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X20rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X20rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X20rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X20rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X20rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X20rL41_cSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X20rL41_cSNV_missense_post_pre_med <- unname(X20rL41_cSNV_missense_post_pre_quarts[3])
X20rL41_cSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X20rL41_cSNV_syn_post_pre_med <- unname(X20rL41_cSNV_syn_post_pre_quarts[3])
X20rL41_cSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X20rL41_cSNV_nonsense_post_pre_med <- unname(X20rL41_cSNV_nonsense_post_pre_quarts[3])
X20rL41_cSNV_syn_to_non_post_pre_spread <- X20rL41_cSNV_syn_post_pre_med - X20rL41_cSNV_nonsense_post_pre_med

X20rL42_cSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X20rL42_cSNV_missense_post_pre_med <- unname(X20rL42_cSNV_missense_post_pre_quarts[3])
X20rL42_cSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X20rL42_cSNV_syn_post_pre_med <- unname(X20rL42_cSNV_syn_post_pre_quarts[3])
X20rL42_cSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X20rL42_cSNV_nonsense_post_pre_med <- unname(X20rL42_cSNV_nonsense_post_pre_quarts[3])
X20rL42_cSNV_syn_to_non_post_pre_spread <- X20rL42_cSNV_syn_post_pre_med - X20rL42_cSNV_nonsense_post_pre_med

X20rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_missense_post_pre_med <- unname(X20rL41rL42a_cSNV_missense_post_pre_quarts[3])
X20rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_syn_post_pre_med <- unname(X20rL41rL42a_cSNV_syn_post_pre_quarts[3])
X20rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X20rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X20rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X20rL41rL42a_cSNV_syn_post_pre_med - X20rL41rL42a_cSNV_nonsense_post_pre_med

X20rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_cSNV_missense_post_pre_med <- unname(X20rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X20rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_cSNV_syn_post_pre_med <- unname(X20rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X20rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X20rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X20rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X20rL41rL42pw_cSNV_syn_post_pre_med - X20rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X20rL41_tSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X20rL41_tSNV_missense_post_pre_med <- unname(X20rL41_tSNV_missense_post_pre_quarts[3])
X20rL41_tSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X20rL41_tSNV_syn_post_pre_med <- unname(X20rL41_tSNV_syn_post_pre_quarts[3])
X20rL41_tSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X20rL41_tSNV_nonsense_post_pre_med <- unname(X20rL41_tSNV_nonsense_post_pre_quarts[3])
X20rL41_tSNV_syn_to_non_post_pre_spread <- X20rL41_tSNV_syn_post_pre_med - X20rL41_tSNV_nonsense_post_pre_med

X20rL42_tSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X20rL42_tSNV_missense_post_pre_med <- unname(X20rL42_tSNV_missense_post_pre_quarts[3])
X20rL42_tSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X20rL42_tSNV_syn_post_pre_med <- unname(X20rL42_tSNV_syn_post_pre_quarts[3])
X20rL42_tSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X20rL42_tSNV_nonsense_post_pre_med <- unname(X20rL42_tSNV_nonsense_post_pre_quarts[3])
X20rL42_tSNV_syn_to_non_post_pre_spread <- X20rL42_tSNV_syn_post_pre_med - X20rL42_tSNV_nonsense_post_pre_med

X20rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_missense_post_pre_med <- unname(X20rL41rL42a_tSNV_missense_post_pre_quarts[3])
X20rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_syn_post_pre_med <- unname(X20rL41rL42a_tSNV_syn_post_pre_quarts[3])
X20rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X20rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X20rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X20rL41rL42a_tSNV_syn_post_pre_med - X20rL41rL42a_tSNV_nonsense_post_pre_med

X20rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_tSNV_missense_post_pre_med <- unname(X20rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X20rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_tSNV_syn_post_pre_med <- unname(X20rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X20rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X20rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X20rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X20rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X20rL41rL42pw_tSNV_syn_post_pre_med - X20rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X20rL41_cSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X20rL41_cSNV_missense_post_lib_med <- unname(X20rL41_cSNV_missense_post_lib_quarts[3])
X20rL41_cSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X20rL41_cSNV_syn_post_lib_med <- unname(X20rL41_cSNV_syn_post_lib_quarts[3])
X20rL41_cSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X20rL41_cSNV_nonsense_post_lib_med <- unname(X20rL41_cSNV_nonsense_post_lib_quarts[3])
X20rL41_cSNV_syn_to_non_post_lib_spread <- X20rL41_cSNV_syn_post_lib_med - X20rL41_cSNV_nonsense_post_lib_med

X20rL42_cSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X20rL42_cSNV_missense_post_lib_med <- unname(X20rL42_cSNV_missense_post_lib_quarts[3])
X20rL42_cSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X20rL42_cSNV_syn_post_lib_med <- unname(X20rL42_cSNV_syn_post_lib_quarts[3])
X20rL42_cSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X20rL42_cSNV_nonsense_post_lib_med <- unname(X20rL42_cSNV_nonsense_post_lib_quarts[3])
X20rL42_cSNV_syn_to_non_post_lib_spread <- X20rL42_cSNV_syn_post_lib_med - X20rL42_cSNV_nonsense_post_lib_med

X20rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_missense_post_lib_med <- unname(X20rL41rL42a_cSNV_missense_post_lib_quarts[3])
X20rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_syn_post_lib_med <- unname(X20rL41rL42a_cSNV_syn_post_lib_quarts[3])
X20rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X20rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X20rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X20rL41rL42a_cSNV_syn_post_lib_med - X20rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X20rL41_tSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X20rL41_tSNV_missense_post_lib_med <- unname(X20rL41_tSNV_missense_post_lib_quarts[3])
X20rL41_tSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X20rL41_tSNV_syn_post_lib_med <- unname(X20rL41_tSNV_syn_post_lib_quarts[3])
X20rL41_tSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X20rL41_tSNV_nonsense_post_lib_med <- unname(X20rL41_tSNV_nonsense_post_lib_quarts[3])
X20rL41_tSNV_syn_to_non_post_lib_spread <- X20rL41_tSNV_syn_post_lib_med - X20rL41_tSNV_nonsense_post_lib_med

X20rL42_tSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X20rL42_tSNV_missense_post_lib_med <- unname(X20rL42_tSNV_missense_post_lib_quarts[3])
X20rL42_tSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X20rL42_tSNV_syn_post_lib_med <- unname(X20rL42_tSNV_syn_post_lib_quarts[3])
X20rL42_tSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X20rL42_tSNV_nonsense_post_lib_med <- unname(X20rL42_tSNV_nonsense_post_lib_quarts[3])
X20rL42_tSNV_syn_to_non_post_lib_spread <- X20rL42_tSNV_syn_post_lib_med - X20rL42_tSNV_nonsense_post_lib_med

X20rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_missense_post_lib_med <- unname(X20rL41rL42a_tSNV_missense_post_lib_quarts[3])
X20rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_syn_post_lib_med <- unname(X20rL41rL42a_tSNV_syn_post_lib_quarts[3])
X20rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X20rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X20rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X20rL41rL42a_tSNV_syn_post_lib_med - X20rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X20rL41_cSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X20rL41_cSNV_missense_pre_lib_med <- unname(X20rL41_cSNV_missense_pre_lib_quarts[3])
X20rL41_cSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X20rL41_cSNV_syn_pre_lib_med <- unname(X20rL41_cSNV_syn_pre_lib_quarts[3])
X20rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X20rL41_cSNV_nonsense_pre_lib_med <- unname(X20rL41_cSNV_nonsense_pre_lib_quarts[3])
X20rL41_cSNV_syn_to_non_pre_lib_spread <- X20rL41_cSNV_syn_pre_lib_med - X20rL41_cSNV_nonsense_pre_lib_med

X20rL42_cSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X20rL42_cSNV_missense_pre_lib_med <- unname(X20rL42_cSNV_missense_pre_lib_quarts[3])
X20rL42_cSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X20rL42_cSNV_syn_pre_lib_med <- unname(X20rL42_cSNV_syn_pre_lib_quarts[3])
X20rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X20rL42_cSNV_nonsense_pre_lib_med <- unname(X20rL42_cSNV_nonsense_pre_lib_quarts[3])
X20rL42_cSNV_syn_to_non_pre_lib_spread <- X20rL42_cSNV_syn_pre_lib_med - X20rL42_cSNV_nonsense_pre_lib_med

X20rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_missense_pre_lib_med <- unname(X20rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X20rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_syn_pre_lib_med <- unname(X20rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X20rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X20rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X20rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X20rL41rL42a_cSNV_syn_pre_lib_med - X20rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X20rL41_tSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X20rL41_tSNV_missense_pre_lib_med <- unname(X20rL41_tSNV_missense_pre_lib_quarts[3])
X20rL41_tSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X20rL41_tSNV_syn_pre_lib_med <- unname(X20rL41_tSNV_syn_pre_lib_quarts[3])
X20rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X20rL41_tSNV_nonsense_pre_lib_med <- unname(X20rL41_tSNV_nonsense_pre_lib_quarts[3])
X20rL41_tSNV_syn_to_non_pre_lib_spread <- X20rL41_tSNV_syn_pre_lib_med - X20rL41_tSNV_nonsense_pre_lib_med

X20rL42_tSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X20rL42_tSNV_missense_pre_lib_med <- unname(X20rL42_tSNV_missense_pre_lib_quarts[3])
X20rL42_tSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X20rL42_tSNV_syn_pre_lib_med <- unname(X20rL42_tSNV_syn_pre_lib_quarts[3])
X20rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X20rL42_tSNV_nonsense_pre_lib_med <- unname(X20rL42_tSNV_nonsense_pre_lib_quarts[3])
X20rL42_tSNV_syn_to_non_pre_lib_spread <- X20rL42_tSNV_syn_pre_lib_med - X20rL42_tSNV_nonsense_pre_lib_med

X20rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_missense_pre_lib_med <- unname(X20rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X20rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_syn_pre_lib_med <- unname(X20rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X20rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X20rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X20rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X20rL41rL42a_tSNV_syn_pre_lib_med - X20rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X20rL41_tSNV_syn_rna_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X20rL41_tSNV_syn_rna_pre_med <- unname(X20rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X20rL41_tSNV_syn_rna_post_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X20rL41_tSNV_syn_rna_post_med <- unname(X20rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X20rL42_tSNV_syn_rna_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X20rL42_tSNV_syn_rna_pre_med <- unname(X20rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X20rL42_tSNV_syn_rna_post_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X20rL42_tSNV_syn_rna_post_med <- unname(X20rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X20rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_syn_rna_pre_med <- unname(X20rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X20rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X20rL41rL42a_tSNV_syn_rna_post_med <- unname(X20rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X20rL41_cSNV_syn_pre_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X20rL41_cSNV_syn_post_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X20rL41_cSNV_syn_post_lib_med
# tHDR
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X20rL41_tSNV_syn_pre_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X20rL41_tSNV_syn_post_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X20rL41_tSNV_syn_post_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X20rL41_tSNV_syn_rna_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X20rL41_tSNV_syn_rna_post_med

#rL42
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X20rL42_cSNV_syn_pre_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X20rL42_cSNV_syn_post_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X20rL42_cSNV_syn_post_lib_med
# tHDR
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X20rL42_tSNV_syn_pre_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X20rL42_tSNV_syn_post_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X20rL42_tSNV_syn_post_lib_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X20rL42_tSNV_syn_rna_pre_med
X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X20rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X20rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X20rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X20rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X20rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X20rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X20rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X20rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X20rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X20rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X20rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X20rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X20rL41_prog_var_thresh5_df_rL42_int_ord[which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X20rL41_prog_var_thresh5_df_rL42_int_ord
X20rL41_prog_map_thresh5_df_rL42_int_ord = which(X20rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X20rL41_prog_map_thresh5_df_rL42_int_ord_df = X20rL41_prog_var_thresh5_df_rL42_int_ord[X20rL41_prog_map_thresh5_df_rL42_int_ord,]
X20rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X20rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X20rL41_prog_map_thresh5_df_rL42_int_ord_df[X20rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X20rL41_prog_map_thresh5_df_rL42_int_ord_df[X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X20rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X20rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X20rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X20rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X20rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X20rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X20rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X20rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X20rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X20rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X20rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X20rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X20rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X20rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X20rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X20rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X20rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X20rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X20rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X20rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X20rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X20rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X20rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41_cSNV_post_pre_by_cadd_cor_s
#X20rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X20rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL42_cSNV_post_pre_by_cadd_cor_s

#X20rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X20rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41_cSNV_post_lib_by_cadd_cor_s
#X20rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X20rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X20rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X20rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41_tSNV_post_pre_by_cadd_cor_s
#X20rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X20rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL42_tSNV_post_pre_by_cadd_cor_s

#X20rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X20rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41_tSNV_post_lib_by_cadd_cor_s
#X20rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X20rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X20rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X20rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X20rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X20rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X20rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X20rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X20rL41_prog_var_all_lib_count
X20rL41_prog_var_all_pre_count
X20rL42_prog_var_all_pre_count
X20rL41_prog_map_thresh5_lib_count
X20rL41_prog_map_thresh5_pre_count
X20rL42_prog_map_thresh5_pre_count
X20rL41_prog_map_thresh5_post_count
X20rL42_prog_map_thresh5_post_count
X20rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X20rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X20rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X20rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X20rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X20rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X20rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X20rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X20rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X20rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X20rL41_cSNV_post_pre_by_cadd_cor_s
X20rL42_cSNV_post_pre_by_cadd_cor_s
X20rL41_cSNV_post_lib_by_cadd_cor_s
X20rL42_cSNV_post_lib_by_cadd_cor_s
X20rL41_tSNV_post_pre_by_cadd_cor_s
X20rL42_tSNV_post_pre_by_cadd_cor_s
X20rL41_tSNV_post_lib_by_cadd_cor_s
X20rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X20rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X20rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X20rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X20rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X20rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X20rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X20rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X20rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X20rL41_cSNV_syn_to_non_post_pre_spread
X20rL42_cSNV_syn_to_non_post_pre_spread
X20rL41rL42a_cSNV_syn_to_non_post_pre_spread
X20rL41_cSNV_syn_to_non_post_lib_spread
X20rL42_cSNV_syn_to_non_post_lib_spread
X20rL41rL42a_cSNV_syn_to_non_post_lib_spread
X20rL41_tSNV_syn_to_non_post_pre_spread
X20rL42_tSNV_syn_to_non_post_pre_spread
X20rL41rL42a_tSNV_syn_to_non_post_pre_spread
X20rL41_tSNV_syn_to_non_post_lib_spread
X20rL42_tSNV_syn_to_non_post_lib_spread
X20rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X20rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X20rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X20rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X20rL41_cSNV_pre_lib_cors = cor(log2(X20rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20rL41_tSNV_pre_lib_cors = cor(log2(X20rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20rL41_cSNV_post_lib_cors = cor(log2(X20rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X20rL41_tSNV_post_lib_cors = cor(log2(X20rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X20rL41_cSNV_post_pre_cors = cor(log2(X20rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20rL41_tSNV_post_pre_cors = cor(log2(X20rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X20rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20rL41_cSNV_rna_lib_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X20rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20rL41_tSNV_rna_lib_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X20rL41_cSNV_rna_pre_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X20rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20rL41_tSNV_rna_pre_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X20rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20rL41rL42_cSNV_pre_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X20rL41rL42_tSNV_pre_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X20rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X20rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X20rL41rL42_cSNV_post_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X20rL41rL42_tSNV_post_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X20rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X20rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X20rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X20rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X20rL41rL42_cSNV_rna_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X20rL41rL42_tSNV_rna_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X20rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X20rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X20rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X20rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X20rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X20rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X20rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X20rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X20rL41_cors <- c("X20rL41",X20rL41_cSNV_pre_lib_cors,X20rL41_tSNV_pre_lib_cors,X20rL41_cSNV_post_lib_cors,X20rL41_tSNV_post_lib_cors,X20rL41_cSNV_post_pre_cors,X20rL41_tSNV_post_pre_cors,X20rL41_cSNV_rna_lib_cors,X20rL41_tSNV_rna_lib_cors,X20rL41_cSNV_rna_pre_cors,X20rL41_tSNV_rna_pre_cors,X20rL41rL42_cSNV_pre_cors,X20rL41rL42_tSNV_pre_cors,X20rL41rL42_cSNV_pre_lib_ratio_cors,X20rL41rL42_tSNV_pre_lib_ratio_cors,X20rL41rL42_cSNV_post_cors,X20rL41rL42_tSNV_post_cors,X20rL41rL42_cSNV_post_lib_ratio_cors,X20rL41rL42_tSNV_post_lib_ratio_cors,X20rL41rL42_cSNV_post_pre_ratio_cors,X20rL41rL42_tSNV_post_pre_ratio_cors,X20rL41rL42_cSNV_rna_cors,X20rL41rL42_tSNV_rna_cors,X20rL41rL42_tSNV_rna_pre_ratio_cors,X20rL41_cSNV_pre_lib_ratio_cadd_cors,X20rL41_tSNV_pre_lib_ratio_cadd_cors,X20rL41_cSNV_post_lib_ratio_cadd_cors,X20rL41_tSNV_post_lib_ratio_cadd_cors,X20rL41_cSNV_post_pre_ratio_cadd_cors,X20rL41_tSNV_post_pre_ratio_cadd_cors,X20rL41_cSNV_post_pre_ratio_cadd_missense_cors,X20rL41_tSNV_post_pre_ratio_cadd_missense_cors,X20rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X20rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X20rL41_cSNV_post_pre_ratio_grantham_missense_cors,X20rL41_tSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X20rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X20rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X20rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X20rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X20rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X20rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X20rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X20rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X20rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X20rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X20rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X20rL42_cSNV_pre_lib_cors = cor(log2(X20rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20rL42_tSNV_pre_lib_cors = cor(log2(X20rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20rL42_cSNV_post_lib_cors = cor(log2(X20rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X20rL42_tSNV_post_lib_cors = cor(log2(X20rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X20rL42_cSNV_post_pre_cors = cor(log2(X20rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X20rL42_tSNV_post_pre_cors = cor(log2(X20rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X20rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X20rL42_cSNV_rna_lib_cors = cor(log2(X20rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X20rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20rL42_tSNV_rna_lib_cors = cor(log2(X20rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X20rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X20rL42_cSNV_rna_pre_cors = cor(log2(X20rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X20rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X20rL42_tSNV_rna_pre_cors = cor(log2(X20rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X20rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X20rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X20rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X20rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X20rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X20rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X20rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X20rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X20rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X20rL42_cors <- c("X20rL42",X20rL42_cSNV_pre_lib_cors,X20rL42_tSNV_pre_lib_cors,X20rL42_cSNV_post_lib_cors,X20rL42_tSNV_post_lib_cors,X20rL42_cSNV_post_pre_cors,X20rL42_tSNV_post_pre_cors,X20rL42_cSNV_rna_lib_cors,X20rL42_tSNV_rna_lib_cors,X20rL42_cSNV_rna_pre_cors,X20rL42_tSNV_rna_pre_cors,X20rL41rL42_cSNV_pre_cors,X20rL41rL42_tSNV_pre_cors,X20rL41rL42_cSNV_pre_lib_ratio_cors,X20rL41rL42_tSNV_pre_lib_ratio_cors,X20rL41rL42_cSNV_post_cors,X20rL41rL42_tSNV_post_cors,X20rL41rL42_cSNV_post_lib_ratio_cors,X20rL41rL42_tSNV_post_lib_ratio_cors,X20rL41rL42_cSNV_post_pre_ratio_cors,X20rL41rL42_tSNV_post_pre_ratio_cors,X20rL41rL42_cSNV_rna_cors,X20rL41rL42_tSNV_rna_cors,X20rL41rL42_tSNV_rna_pre_ratio_cors,X20rL42_cSNV_pre_lib_ratio_cadd_cors,X20rL42_tSNV_pre_lib_ratio_cadd_cors,X20rL42_cSNV_post_lib_ratio_cadd_cors,X20rL42_tSNV_post_lib_ratio_cadd_cors,X20rL42_cSNV_post_pre_ratio_cadd_cors,X20rL42_tSNV_post_pre_ratio_cadd_cors,X20rL42_cSNV_post_pre_ratio_cadd_missense_cors,X20rL42_tSNV_post_pre_ratio_cadd_missense_cors,X20rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X20rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X20rL42_cSNV_post_pre_ratio_grantham_missense_cors,X20rL42_tSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X20rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X20rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X20rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X20rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X20rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X20rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X20rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X20rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X20rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X20rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X20rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X20rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X20rL41)
rm(X20rL42)
gc()
X21rL41_file <- paste(experiment_dir_170731,'X21rL41','_annotated.txt',sep='')
X21rL42_file <- paste(experiment_dir_170731,'X21rL42','_annotated.txt',sep='')
X21rL41 <- read.table(X21rL41_file, header=TRUE, sep="\t")
X21rL42 <- read.table(X21rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X21 <- editing_info[which(editing_info$amplicon == 'X21'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X21_HDR_5_SNV = as.character(editing_info_X21$HDR_5_SNV)
X21_HDR_3_SNV = as.character(editing_info_X21$HDR_3_SNV)
#X21_cut_pos = as.character(editing_info_X21$cut_pos)
X21_cut_end = as.character(editing_info_X21$cut_end)
X21_mut_start = as.character(editing_info_X21$mut_start)
X21_mut_end = as.character(editing_info_X21$mut_end)
### Replicate 1
X21rL41_cSNV_all <- which(X21rL41[,'c_hdr_snv']=='True')
X21rL41_cSNV_all_df = X21rL41[X21rL41_cSNV_all,]
X21rL41_prog_var_all <- which(X21rL41[,'all_hdr_variant']=='True' & X21rL41[,'edit_string']!='-WT')
X21rL41_prog_var_all_df = X21rL41[X21rL41_prog_var_all,]
X21rL41_prog_map_all = which(X21rL41_prog_var_all_df[,'pos']!='REF')
X21rL41_prog_map_all_df = X21rL41_prog_var_all_df[X21rL41_prog_map_all,]
X21rL41_prog_map_exon_all = which(X21rL41_prog_map_all_df[,'cDNApos']!='REF' & X21rL41_prog_map_all_df[,'cDNApos']!='NA')
X21rL41_prog_map_exon_all_df = X21rL41_prog_map_all_df[X21rL41_prog_map_exon_all,]
X21rL41_prog_map_CADD = which(X21rL41_prog_map_all_df[,'CADD.phred']!='NA')
X21rL41_prog_map_CADD_df = X21rL41_prog_map_all_df[X21rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X21rL41_prog_var_thresh5 <- which(as.numeric(as.character(X21rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X21rL41_prog_var_thresh5_df = X21rL41_prog_var_all_df[X21rL41_prog_var_thresh5,]
X21rL41_prog_map_thresh5 <- which(as.numeric(as.character(X21rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X21rL41_prog_map_thresh5_df = X21rL41_prog_map_all_df[X21rL41_prog_map_thresh5,]
X21rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X21rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X21rL41_prog_map_exon_thresh5_df = X21rL41_prog_map_exon_all_df[X21rL41_prog_map_exon_thresh5,]
X21rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X21rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X21rL41_prog_map_CADD_thresh5_df = X21rL41_prog_map_CADD_df[X21rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X21rL41_prog_var_all_lib_count = length(X21rL41_prog_var_all_df$lib)
X21rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X21rL41_prog_var_all_min_lib_counts = min(X21rL41_prog_var_all_df$lib)
X21rL41_prog_var_all_min_lib_counts
X21rL41_prog_var_all_max_lib_counts = max(X21rL41_prog_var_all_df$lib)
X21rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X21rL41_prog_map_all_lib_count = length(X21rL41_prog_map_all_df$lib)
X21rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X21rL41_prog_map_all_min_lib_counts = min(X21rL41_prog_map_all_df$lib)
X21rL41_prog_map_all_min_lib_counts
X21rL41_prog_map_all_max_lib_counts = max(X21rL41_prog_map_all_df$lib)
X21rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X21rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X21rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X21rL41_prog_var_all_pre_count = length(X21rL41_prog_var_all_df$pre)
X21rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X21rL41_prog_var_all_min_pre_counts = min(X21rL41_prog_var_all_df$pre)
X21rL41_prog_var_all_min_pre_counts
X21rL41_prog_var_all_max_pre_counts = max(X21rL41_prog_var_all_df$pre)
X21rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X21rL41_prog_map_all_pre_count = length(X21rL41_prog_map_all_df$pre)
X21rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X21rL41_prog_map_all_min_pre_counts = min(X21rL41_prog_map_all_df$pre)
X21rL41_prog_map_all_min_pre_counts
X21rL41_prog_map_all_max_pre_counts = max(X21rL41_prog_map_all_df$pre)
X21rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X21rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X21rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X21rL41_prog_map_all_post_count = length(X21rL41_prog_map_all_df$post)
X21rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X21rL41_prog_map_all_min_post_counts = min(X21rL41_prog_map_all_df$post)
X21rL41_prog_map_all_min_post_counts
X21rL41_prog_map_all_max_post_counts = max(X21rL41_prog_map_all_df$post)
X21rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X21rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X21rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X21rL41_prog_map_all_syn_df <- X21rL41_prog_map_all_df[which(X21rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X21rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X21rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X21rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X21rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X21rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X21rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X21rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X21rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X21rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X21rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X21rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X21rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X21rL41_prog_map_all_min_rna_counts = min(X21rL41_prog_map_exon_all_df$tHDR_rna)
X21rL41_prog_map_all_min_rna_counts
X21rL41_prog_map_all_max_rna_counts = max(X21rL41_prog_map_exon_all_df$tHDR_rna)
X21rL41_prog_map_all_max_rna_counts
X21rL41_prog_map_all_min_rna_pseudo_freq = min(X21rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21rL41_prog_map_all_min_rna_pseudo_freq
X21rL41_prog_map_all_max_rna_pseudo_freq = max(X21rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21rL41_prog_map_all_max_rna_pseudo_freq
X21rL41_prog_map_all_min_rna_pre_ratio = min(X21rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21rL41_prog_map_all_min_rna_pre_ratio
X21rL41_prog_map_all_max_rna_pre_ratio = max(X21rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21rL41_prog_map_all_max_rna_pre_ratio
X21rL41_prog_map_all_min_rna_post_ratio = min(X21rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21rL41_prog_map_all_min_rna_post_ratio
X21rL41_prog_map_all_max_rna_post_ratio = max(X21rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X21rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X21rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X21rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X21rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X21rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X21rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X21rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X21rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X21rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X21rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X21rL41_prog_map_all_df$post_pre_ratio),log2(X21rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X21rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X21rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X21rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X21rL41_cSNV_all_corr_pre_count = length(X21rL41_cSNV_all_df$corr_pre)
X21rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X21rL41_cSNV_all_min_corr_pre_counts = min(X21rL41_cSNV_all_df$corr_pre)
X21rL41_cSNV_all_min_corr_pre_counts
X21rL41_cSNV_all_max_corr_pre_counts = max(X21rL41_cSNV_all_df$corr_pre)
X21rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X21rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X21rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X21rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X21rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X21rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_cSNV_all_corr_post_count = length(X21rL41_cSNV_all_df$corr_post)
X21rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X21rL41_cSNV_all_min_corr_post_counts = min(X21rL41_cSNV_all_df$corr_post)
X21rL41_cSNV_all_min_corr_post_counts
X21rL41_cSNV_all_max_corr_post_counts = max(X21rL41_cSNV_all_df$corr_post)
X21rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X21rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X21rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X21rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X21rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X21rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X21rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X21_p_hdr_snv = paste('p_hdr_',X21_cut_end,'_snv',sep='')
X21rL41_pSNV_all <- which(X21rL41[,X21_p_hdr_snv]=='True')
X21rL41_pSNV_all_df = X21rL41[X21rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_pSNV_all_lib_count = length(X21rL41_pSNV_all_df$lib)
X21rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X21rL41_pSNV_all_min_lib_counts = min(X21rL41_pSNV_all_df$lib)
X21rL41_pSNV_all_min_lib_counts
X21rL41_pSNV_all_max_lib_counts = max(X21rL41_pSNV_all_df$lib)
X21rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X21rL41_pSNV_all_pre_count = length(X21rL41_pSNV_all_df$pre)
X21rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X21rL41_pSNV_all_min_pre_counts = min(X21rL41_pSNV_all_df$pre)
X21rL41_pSNV_all_min_pre_counts
X21rL41_pSNV_all_max_pre_counts = max(X21rL41_pSNV_all_df$pre)
X21rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X21rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X21rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_pSNV_all_post_count = length(X21rL41_pSNV_all_df$post)
X21rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X21rL41_pSNV_all_min_post_counts = min(X21rL41_pSNV_all_df$post)
X21rL41_pSNV_all_min_post_counts
X21rL41_pSNV_all_max_post_counts = max(X21rL41_pSNV_all_df$post)
X21rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X21rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X21rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_prog_map_thresh5_lib_count = length(X21rL41_prog_map_thresh5_df$lib)
X21rL41_prog_map_thresh5_lib_count
X21rL41_prog_map_thresh5_min_lib_counts = min(X21rL41_prog_map_thresh5_df$lib)
X21rL41_prog_map_thresh5_min_lib_counts
X21rL41_prog_map_thresh5_max_lib_counts = max(X21rL41_prog_map_thresh5_df$lib)
X21rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X21rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X21rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_prog_map_thresh5_pre_count = length(X21rL41_prog_map_thresh5_df$pre)
X21rL41_prog_map_thresh5_pre_count
X21rL41_prog_map_thresh5_min_pre_counts = min(X21rL41_prog_map_thresh5_df$pre)
X21rL41_prog_map_thresh5_min_pre_counts
X21rL41_prog_map_thresh5_max_pre_counts = max(X21rL41_prog_map_thresh5_df$pre)
X21rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL41_prog_map_thresh5_post_count = length(X21rL41_prog_map_thresh5_df$post)
X21rL41_prog_map_thresh5_post_count
X21rL41_prog_map_thresh5_min_post_counts = min(X21rL41_prog_map_thresh5_df$post)
X21rL41_prog_map_thresh5_min_post_counts
X21rL41_prog_map_thresh5_max_post_counts = max(X21rL41_prog_map_thresh5_df$post)
X21rL41_prog_map_thresh5_max_post_counts
X21rL41_prog_map_thresh5_corr_post_count = length(X21rL41_cSNV_all_df$corr_post)
X21rL41_prog_map_thresh5_corr_post_count
X21rL41_prog_map_thresh5_min_corr_post_counts = min(X21rL41_cSNV_all_df$corr_post)
X21rL41_prog_map_thresh5_min_corr_post_counts
X21rL41_prog_map_thresh5_max_corr_post_counts = max(X21rL41_cSNV_all_df$corr_post)
X21rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X21rL41_pSNV_thresh5 <- which(X21rL41[,X21_p_hdr_snv]=='True' & as.numeric(as.character(X21rL41[,'pre_freq']))>=0.00001)
X21rL41_pSNV_thresh5_df = X21rL41[X21rL41_pSNV_thresh5,]
X21rL41_pSNV_thresh5_lib_count = length(X21rL41_pSNV_thresh5_df$lib)
X21rL41_pSNV_thresh5_lib_count
X21rL41_pSNV_thresh5_min_lib_counts = min(X21rL41_pSNV_thresh5_df$lib)
X21rL41_pSNV_thresh5_min_lib_counts
X21rL41_pSNV_thresh5_max_lib_counts = max(X21rL41_pSNV_thresh5_df$lib)
X21rL41_pSNV_thresh5_max_lib_counts
X21rL41_pSNV_thresh5_pre_count = length(X21rL41_pSNV_thresh5_df$pre)
X21rL41_pSNV_thresh5_pre_count
X21rL41_pSNV_thresh5_min_pre_counts = min(X21rL41_pSNV_thresh5_df$pre)
X21rL41_pSNV_thresh5_min_pre_counts
X21rL41_pSNV_thresh5_max_pre_counts = max(X21rL41_pSNV_thresh5_df$pre)
X21rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X21rL41_pSNV_thresh5_post_count = length(X21rL41_pSNV_thresh5_df$post)
X21rL41_pSNV_thresh5_post_count
X21rL41_pSNV_thresh5_min_post_counts = min(X21rL41_pSNV_thresh5_df$post)
X21rL41_pSNV_thresh5_min_post_counts
X21rL41_pSNV_thresh5_max_post_counts = max(X21rL41_pSNV_thresh5_df$post)
X21rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X21rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X21rL41_pSNV_thresh5_post_pos

### Replicate 2
X21rL42_cSNV_all <- which(X21rL42[,'c_hdr_snv']=='True')
X21rL42_cSNV_all_df = X21rL42[X21rL42_cSNV_all,]
X21rL42_prog_var_all <- which(X21rL42[,'all_hdr_variant']=='True' & X21rL42[,'edit_string']!='-WT')
X21rL42_prog_var_all_df = X21rL42[X21rL42_prog_var_all,]
X21rL42_prog_map_all = which(X21rL42_prog_var_all_df[,'pos']!='REF')
X21rL42_prog_map_all_df = X21rL42_prog_var_all_df[X21rL42_prog_map_all,]
X21rL42_prog_map_exon_all = which(X21rL42_prog_map_all_df[,'cDNApos']!='REF' & X21rL42_prog_map_all_df[,'cDNApos']!='NA')
X21rL42_prog_map_exon_all_df = X21rL42_prog_map_all_df[X21rL42_prog_map_exon_all,]
X21rL42_prog_map_CADD = which(X21rL42_prog_map_all_df[,'CADD.phred']!='NA')
X21rL42_prog_map_CADD_df = X21rL42_prog_map_all_df[X21rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X21rL42_prog_var_thresh5 <- which(as.numeric(as.character(X21rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X21rL42_prog_var_thresh5_df = X21rL42_prog_var_all_df[X21rL42_prog_var_thresh5,]
X21rL42_prog_map_thresh5 <- which(as.numeric(as.character(X21rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X21rL42_prog_map_thresh5_df = X21rL42_prog_map_all_df[X21rL42_prog_map_thresh5,]
X21rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X21rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X21rL42_prog_map_exon_thresh5_df = X21rL42_prog_map_exon_all_df[X21rL42_prog_map_exon_thresh5,]
X21rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X21rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X21rL42_prog_map_CADD_thresh5_df = X21rL42_prog_map_CADD_df[X21rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X21rL42_prog_var_all_lib_count = length(X21rL42_prog_var_all_df$lib)
X21rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X21rL42_prog_var_all_min_lib_counts = min(X21rL42_prog_var_all_df$lib)
X21rL42_prog_var_all_min_lib_counts
X21rL42_prog_var_all_max_lib_counts = max(X21rL42_prog_var_all_df$lib)
X21rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X21rL42_prog_map_all_lib_count = length(X21rL42_prog_map_all_df$lib)
X21rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X21rL42_prog_map_all_min_lib_counts = min(X21rL42_prog_map_all_df$lib)
X21rL42_prog_map_all_min_lib_counts
X21rL42_prog_map_all_max_lib_counts = max(X21rL42_prog_map_all_df$lib)
X21rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X21rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X21rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X21rL42_prog_var_all_pre_count = length(X21rL42_prog_var_all_df$pre)
X21rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X21rL42_prog_var_all_min_pre_counts = min(X21rL42_prog_var_all_df$pre)
X21rL42_prog_var_all_min_pre_counts
X21rL42_prog_var_all_max_pre_counts = max(X21rL42_prog_var_all_df$pre)
X21rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X21rL42_prog_map_all_pre_count = length(X21rL42_prog_map_all_df$pre)
X21rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X21rL42_prog_map_all_min_pre_counts = min(X21rL42_prog_map_all_df$pre)
X21rL42_prog_map_all_min_pre_counts
X21rL42_prog_map_all_max_pre_counts = max(X21rL42_prog_map_all_df$pre)
X21rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X21rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X21rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X21rL42_prog_map_all_post_count = length(X21rL42_prog_map_all_df$post)
X21rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X21rL42_prog_map_all_min_post_counts = min(X21rL42_prog_map_all_df$post)
X21rL42_prog_map_all_min_post_counts
X21rL42_prog_map_all_max_post_counts = max(X21rL42_prog_map_all_df$post)
X21rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X21rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X21rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X21rL42_prog_map_all_syn_df <- X21rL42_prog_map_all_df[which(X21rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X21rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X21rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X21rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X21rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X21rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X21rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X21rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X21rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X21rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X21rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X21rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X21rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X21rL42_prog_map_all_min_rna_counts = min(X21rL42_prog_map_exon_all_df$tHDR_rna)
X21rL42_prog_map_all_min_rna_counts
X21rL42_prog_map_all_max_rna_counts = max(X21rL42_prog_map_exon_all_df$tHDR_rna)
X21rL42_prog_map_all_max_rna_counts
X21rL42_prog_map_all_min_rna_pseudo_freq = min(X21rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21rL42_prog_map_all_min_rna_pseudo_freq
X21rL42_prog_map_all_max_rna_pseudo_freq = max(X21rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X21rL42_prog_map_all_max_rna_pseudo_freq
X21rL42_prog_map_all_min_rna_pre_ratio = min(X21rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21rL42_prog_map_all_min_rna_pre_ratio
X21rL42_prog_map_all_max_rna_pre_ratio = max(X21rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X21rL42_prog_map_all_max_rna_pre_ratio
X21rL42_prog_map_all_min_rna_post_ratio = min(X21rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21rL42_prog_map_all_min_rna_post_ratio
X21rL42_prog_map_all_max_rna_post_ratio = max(X21rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X21rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X21rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X21rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X21rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X21rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X21rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X21rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X21rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X21rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X21rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X21rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X21rL42_prog_map_all_df$post_pre_ratio),log2(X21rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X21rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X21rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X21rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X21rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X21rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X21rL42_cSNV_all_corr_pre_count = length(X21rL42_cSNV_all_df$corr_pre)
X21rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X21rL42_cSNV_all_min_corr_pre_counts = min(X21rL42_cSNV_all_df$corr_pre)
X21rL42_cSNV_all_min_corr_pre_counts
X21rL42_cSNV_all_max_corr_pre_counts = max(X21rL42_cSNV_all_df$corr_pre)
X21rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X21rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X21rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X21rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X21rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X21rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_cSNV_all_corr_post_count = length(X21rL42_cSNV_all_df$corr_post)
X21rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X21rL42_cSNV_all_min_corr_post_counts = min(X21rL42_cSNV_all_df$corr_post)
X21rL42_cSNV_all_min_corr_post_counts
X21rL42_cSNV_all_max_corr_post_counts = max(X21rL42_cSNV_all_df$corr_post)
X21rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X21rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X21rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X21rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X21rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X21rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X21rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X21_p_hdr_snv = paste('p_hdr_',X21_cut_end,'_snv',sep='')
X21rL42_pSNV_all <- which(X21rL42[,X21_p_hdr_snv]=='True')
X21rL42_pSNV_all_df = X21rL42[X21rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_pSNV_all_lib_count = length(X21rL42_pSNV_all_df$lib)
X21rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X21rL42_pSNV_all_min_lib_counts = min(X21rL42_pSNV_all_df$lib)
X21rL42_pSNV_all_min_lib_counts
X21rL42_pSNV_all_max_lib_counts = max(X21rL42_pSNV_all_df$lib)
X21rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X21rL42_pSNV_all_pre_count = length(X21rL42_pSNV_all_df$pre)
X21rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X21rL42_pSNV_all_min_pre_counts = min(X21rL42_pSNV_all_df$pre)
X21rL42_pSNV_all_min_pre_counts
X21rL42_pSNV_all_max_pre_counts = max(X21rL42_pSNV_all_df$pre)
X21rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X21rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X21rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_pSNV_all_post_count = length(X21rL42_pSNV_all_df$post)
X21rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X21rL42_pSNV_all_min_post_counts = min(X21rL42_pSNV_all_df$post)
X21rL42_pSNV_all_min_post_counts
X21rL42_pSNV_all_max_post_counts = max(X21rL42_pSNV_all_df$post)
X21rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X21rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X21rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_prog_map_thresh5_lib_count = length(X21rL42_prog_map_thresh5_df$lib)
X21rL42_prog_map_thresh5_lib_count
X21rL42_prog_map_thresh5_min_lib_counts = min(X21rL42_prog_map_thresh5_df$lib)
X21rL42_prog_map_thresh5_min_lib_counts
X21rL42_prog_map_thresh5_max_lib_counts = max(X21rL42_prog_map_thresh5_df$lib)
X21rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X21rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X21rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_prog_map_thresh5_pre_count = length(X21rL42_prog_map_thresh5_df$pre)
X21rL42_prog_map_thresh5_pre_count
X21rL42_prog_map_thresh5_min_pre_counts = min(X21rL42_prog_map_thresh5_df$pre)
X21rL42_prog_map_thresh5_min_pre_counts
X21rL42_prog_map_thresh5_max_pre_counts = max(X21rL42_prog_map_thresh5_df$pre)
X21rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X21 less than SGE region length x 3 due to PAM edits
X21rL42_prog_map_thresh5_post_count = length(X21rL42_prog_map_thresh5_df$post)
X21rL42_prog_map_thresh5_post_count
X21rL42_prog_map_thresh5_min_post_counts = min(X21rL42_prog_map_thresh5_df$post)
X21rL42_prog_map_thresh5_min_post_counts
X21rL42_prog_map_thresh5_max_post_counts = max(X21rL42_prog_map_thresh5_df$post)
X21rL42_prog_map_thresh5_max_post_counts
X21rL42_prog_map_thresh5_corr_post_count = length(X21rL42_prog_map_thresh5_df$corr_post)
X21rL42_prog_map_thresh5_corr_post_count
X21rL42_prog_map_thresh5_min_corr_post_counts = min(X21rL42_prog_map_thresh5_df$corr_post)
X21rL42_prog_map_thresh5_min_corr_post_counts
X21rL42_prog_map_thresh5_max_corr_post_counts = max(X21rL42_prog_map_thresh5_df$corr_post)
X21rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X21rL42_pSNV_thresh5 <- which(X21rL42[,X21_p_hdr_snv]=='True' & as.numeric(as.character(X21rL42[,'pre_freq']))>=0.00001)
X21rL42_pSNV_thresh5_df = X21rL42[X21rL42_pSNV_thresh5,]
X21rL42_pSNV_thresh5_lib_count = length(X21rL42_pSNV_thresh5_df$lib)
X21rL42_pSNV_thresh5_lib_count
X21rL42_pSNV_thresh5_min_lib_counts = min(X21rL42_pSNV_thresh5_df$lib)
X21rL42_pSNV_thresh5_min_lib_counts
X21rL42_pSNV_thresh5_max_lib_counts = max(X21rL42_pSNV_thresh5_df$lib)
X21rL42_pSNV_thresh5_max_lib_counts
X21rL42_pSNV_thresh5_pre_count = length(X21rL42_pSNV_thresh5_df$pre)
X21rL42_pSNV_thresh5_pre_count
X21rL42_pSNV_thresh5_min_pre_counts = min(X21rL42_pSNV_thresh5_df$pre)
X21rL42_pSNV_thresh5_min_pre_counts
X21rL42_pSNV_thresh5_max_pre_counts = max(X21rL42_pSNV_thresh5_df$pre)
X21rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X21rL42_pSNV_thresh5_post_count = length(X21rL42_pSNV_thresh5_df$post)
X21rL42_pSNV_thresh5_post_count
X21rL42_pSNV_thresh5_min_post_counts = min(X21rL42_pSNV_thresh5_df$post)
X21rL42_pSNV_thresh5_min_post_counts
X21rL42_pSNV_thresh5_max_post_counts = max(X21rL42_pSNV_thresh5_df$post)
X21rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X21rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X21rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X21rL41_prog_var_thresh5_df:
X21rL41_prog_var_thresh5_df_rL42_int <- X21rL41_prog_var_thresh5_df[which(X21rL41_prog_var_thresh5_df$variant %in% X21rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X21rL42_prog_var_thresh5_df:
X21rL42_prog_var_thresh5_df_rL41_int <- X21rL42_prog_var_thresh5_df[which(X21rL42_prog_var_thresh5_df$variant %in% X21rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X21rL41_prog_var_thresh5_df_rL42_int_ord <- X21rL41_prog_var_thresh5_df_rL42_int[order(X21rL41_prog_var_thresh5_df_rL42_int$variant),]
X21rL42_prog_var_thresh5_df_rL41_int_ord <- X21rL42_prog_var_thresh5_df_rL41_int[order(X21rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X21rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X21rL41rL42int_prog_var_thresh5_pre_count <- dim(X21rL41_prog_var_thresh5_df_rL42_int)[1] 
X21rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X21rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X21rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X21rL42_prog_var_thresh5_df_rL41_int_ord$lib
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X21rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X21rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X21rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X21rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X21rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X21rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X21rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X21rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X21rL41_cSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X21rL41_cSNV_missense_post_pre_med <- unname(X21rL41_cSNV_missense_post_pre_quarts[3])
X21rL41_cSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X21rL41_cSNV_syn_post_pre_med <- unname(X21rL41_cSNV_syn_post_pre_quarts[3])
X21rL41_cSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X21rL41_cSNV_nonsense_post_pre_med <- unname(X21rL41_cSNV_nonsense_post_pre_quarts[3])
X21rL41_cSNV_syn_to_non_post_pre_spread <- X21rL41_cSNV_syn_post_pre_med - X21rL41_cSNV_nonsense_post_pre_med

X21rL42_cSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X21rL42_cSNV_missense_post_pre_med <- unname(X21rL42_cSNV_missense_post_pre_quarts[3])
X21rL42_cSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X21rL42_cSNV_syn_post_pre_med <- unname(X21rL42_cSNV_syn_post_pre_quarts[3])
X21rL42_cSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X21rL42_cSNV_nonsense_post_pre_med <- unname(X21rL42_cSNV_nonsense_post_pre_quarts[3])
X21rL42_cSNV_syn_to_non_post_pre_spread <- X21rL42_cSNV_syn_post_pre_med - X21rL42_cSNV_nonsense_post_pre_med

X21rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_missense_post_pre_med <- unname(X21rL41rL42a_cSNV_missense_post_pre_quarts[3])
X21rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_syn_post_pre_med <- unname(X21rL41rL42a_cSNV_syn_post_pre_quarts[3])
X21rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X21rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X21rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X21rL41rL42a_cSNV_syn_post_pre_med - X21rL41rL42a_cSNV_nonsense_post_pre_med

X21rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_cSNV_missense_post_pre_med <- unname(X21rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X21rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_cSNV_syn_post_pre_med <- unname(X21rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X21rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X21rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X21rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X21rL41rL42pw_cSNV_syn_post_pre_med - X21rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X21rL41_tSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X21rL41_tSNV_missense_post_pre_med <- unname(X21rL41_tSNV_missense_post_pre_quarts[3])
X21rL41_tSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X21rL41_tSNV_syn_post_pre_med <- unname(X21rL41_tSNV_syn_post_pre_quarts[3])
X21rL41_tSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X21rL41_tSNV_nonsense_post_pre_med <- unname(X21rL41_tSNV_nonsense_post_pre_quarts[3])
X21rL41_tSNV_syn_to_non_post_pre_spread <- X21rL41_tSNV_syn_post_pre_med - X21rL41_tSNV_nonsense_post_pre_med

X21rL42_tSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X21rL42_tSNV_missense_post_pre_med <- unname(X21rL42_tSNV_missense_post_pre_quarts[3])
X21rL42_tSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X21rL42_tSNV_syn_post_pre_med <- unname(X21rL42_tSNV_syn_post_pre_quarts[3])
X21rL42_tSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X21rL42_tSNV_nonsense_post_pre_med <- unname(X21rL42_tSNV_nonsense_post_pre_quarts[3])
X21rL42_tSNV_syn_to_non_post_pre_spread <- X21rL42_tSNV_syn_post_pre_med - X21rL42_tSNV_nonsense_post_pre_med

X21rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_missense_post_pre_med <- unname(X21rL41rL42a_tSNV_missense_post_pre_quarts[3])
X21rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_syn_post_pre_med <- unname(X21rL41rL42a_tSNV_syn_post_pre_quarts[3])
X21rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X21rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X21rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X21rL41rL42a_tSNV_syn_post_pre_med - X21rL41rL42a_tSNV_nonsense_post_pre_med

X21rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_tSNV_missense_post_pre_med <- unname(X21rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X21rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_tSNV_syn_post_pre_med <- unname(X21rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X21rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X21rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X21rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X21rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X21rL41rL42pw_tSNV_syn_post_pre_med - X21rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X21rL41_cSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X21rL41_cSNV_missense_post_lib_med <- unname(X21rL41_cSNV_missense_post_lib_quarts[3])
X21rL41_cSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X21rL41_cSNV_syn_post_lib_med <- unname(X21rL41_cSNV_syn_post_lib_quarts[3])
X21rL41_cSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X21rL41_cSNV_nonsense_post_lib_med <- unname(X21rL41_cSNV_nonsense_post_lib_quarts[3])
X21rL41_cSNV_syn_to_non_post_lib_spread <- X21rL41_cSNV_syn_post_lib_med - X21rL41_cSNV_nonsense_post_lib_med

X21rL42_cSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X21rL42_cSNV_missense_post_lib_med <- unname(X21rL42_cSNV_missense_post_lib_quarts[3])
X21rL42_cSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X21rL42_cSNV_syn_post_lib_med <- unname(X21rL42_cSNV_syn_post_lib_quarts[3])
X21rL42_cSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X21rL42_cSNV_nonsense_post_lib_med <- unname(X21rL42_cSNV_nonsense_post_lib_quarts[3])
X21rL42_cSNV_syn_to_non_post_lib_spread <- X21rL42_cSNV_syn_post_lib_med - X21rL42_cSNV_nonsense_post_lib_med

X21rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_missense_post_lib_med <- unname(X21rL41rL42a_cSNV_missense_post_lib_quarts[3])
X21rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_syn_post_lib_med <- unname(X21rL41rL42a_cSNV_syn_post_lib_quarts[3])
X21rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X21rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X21rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X21rL41rL42a_cSNV_syn_post_lib_med - X21rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X21rL41_tSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X21rL41_tSNV_missense_post_lib_med <- unname(X21rL41_tSNV_missense_post_lib_quarts[3])
X21rL41_tSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X21rL41_tSNV_syn_post_lib_med <- unname(X21rL41_tSNV_syn_post_lib_quarts[3])
X21rL41_tSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X21rL41_tSNV_nonsense_post_lib_med <- unname(X21rL41_tSNV_nonsense_post_lib_quarts[3])
X21rL41_tSNV_syn_to_non_post_lib_spread <- X21rL41_tSNV_syn_post_lib_med - X21rL41_tSNV_nonsense_post_lib_med

X21rL42_tSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X21rL42_tSNV_missense_post_lib_med <- unname(X21rL42_tSNV_missense_post_lib_quarts[3])
X21rL42_tSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X21rL42_tSNV_syn_post_lib_med <- unname(X21rL42_tSNV_syn_post_lib_quarts[3])
X21rL42_tSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X21rL42_tSNV_nonsense_post_lib_med <- unname(X21rL42_tSNV_nonsense_post_lib_quarts[3])
X21rL42_tSNV_syn_to_non_post_lib_spread <- X21rL42_tSNV_syn_post_lib_med - X21rL42_tSNV_nonsense_post_lib_med

X21rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_missense_post_lib_med <- unname(X21rL41rL42a_tSNV_missense_post_lib_quarts[3])
X21rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_syn_post_lib_med <- unname(X21rL41rL42a_tSNV_syn_post_lib_quarts[3])
X21rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X21rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X21rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X21rL41rL42a_tSNV_syn_post_lib_med - X21rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X21rL41_cSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X21rL41_cSNV_missense_pre_lib_med <- unname(X21rL41_cSNV_missense_pre_lib_quarts[3])
X21rL41_cSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X21rL41_cSNV_syn_pre_lib_med <- unname(X21rL41_cSNV_syn_pre_lib_quarts[3])
X21rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X21rL41_cSNV_nonsense_pre_lib_med <- unname(X21rL41_cSNV_nonsense_pre_lib_quarts[3])
X21rL41_cSNV_syn_to_non_pre_lib_spread <- X21rL41_cSNV_syn_pre_lib_med - X21rL41_cSNV_nonsense_pre_lib_med

X21rL42_cSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X21rL42_cSNV_missense_pre_lib_med <- unname(X21rL42_cSNV_missense_pre_lib_quarts[3])
X21rL42_cSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X21rL42_cSNV_syn_pre_lib_med <- unname(X21rL42_cSNV_syn_pre_lib_quarts[3])
X21rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X21rL42_cSNV_nonsense_pre_lib_med <- unname(X21rL42_cSNV_nonsense_pre_lib_quarts[3])
X21rL42_cSNV_syn_to_non_pre_lib_spread <- X21rL42_cSNV_syn_pre_lib_med - X21rL42_cSNV_nonsense_pre_lib_med

X21rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_missense_pre_lib_med <- unname(X21rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X21rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_syn_pre_lib_med <- unname(X21rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X21rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X21rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X21rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X21rL41rL42a_cSNV_syn_pre_lib_med - X21rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X21rL41_tSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X21rL41_tSNV_missense_pre_lib_med <- unname(X21rL41_tSNV_missense_pre_lib_quarts[3])
X21rL41_tSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X21rL41_tSNV_syn_pre_lib_med <- unname(X21rL41_tSNV_syn_pre_lib_quarts[3])
X21rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X21rL41_tSNV_nonsense_pre_lib_med <- unname(X21rL41_tSNV_nonsense_pre_lib_quarts[3])
X21rL41_tSNV_syn_to_non_pre_lib_spread <- X21rL41_tSNV_syn_pre_lib_med - X21rL41_tSNV_nonsense_pre_lib_med

X21rL42_tSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X21rL42_tSNV_missense_pre_lib_med <- unname(X21rL42_tSNV_missense_pre_lib_quarts[3])
X21rL42_tSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X21rL42_tSNV_syn_pre_lib_med <- unname(X21rL42_tSNV_syn_pre_lib_quarts[3])
X21rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X21rL42_tSNV_nonsense_pre_lib_med <- unname(X21rL42_tSNV_nonsense_pre_lib_quarts[3])
X21rL42_tSNV_syn_to_non_pre_lib_spread <- X21rL42_tSNV_syn_pre_lib_med - X21rL42_tSNV_nonsense_pre_lib_med

X21rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_missense_pre_lib_med <- unname(X21rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X21rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_syn_pre_lib_med <- unname(X21rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X21rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X21rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X21rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X21rL41rL42a_tSNV_syn_pre_lib_med - X21rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X21rL41_tSNV_syn_rna_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X21rL41_tSNV_syn_rna_pre_med <- unname(X21rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X21rL41_tSNV_syn_rna_post_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X21rL41_tSNV_syn_rna_post_med <- unname(X21rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X21rL42_tSNV_syn_rna_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X21rL42_tSNV_syn_rna_pre_med <- unname(X21rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X21rL42_tSNV_syn_rna_post_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X21rL42_tSNV_syn_rna_post_med <- unname(X21rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X21rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_syn_rna_pre_med <- unname(X21rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X21rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X21rL41rL42a_tSNV_syn_rna_post_med <- unname(X21rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X21rL41_cSNV_syn_pre_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X21rL41_cSNV_syn_post_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X21rL41_cSNV_syn_post_lib_med
# tHDR
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X21rL41_tSNV_syn_pre_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X21rL41_tSNV_syn_post_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X21rL41_tSNV_syn_post_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X21rL41_tSNV_syn_rna_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X21rL41_tSNV_syn_rna_post_med

#rL42
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X21rL42_cSNV_syn_pre_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X21rL42_cSNV_syn_post_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X21rL42_cSNV_syn_post_lib_med
# tHDR
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X21rL42_tSNV_syn_pre_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X21rL42_tSNV_syn_post_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X21rL42_tSNV_syn_post_lib_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X21rL42_tSNV_syn_rna_pre_med
X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X21rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X21rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X21rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X21rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X21rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X21rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X21rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X21rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X21rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X21rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X21rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X21rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X21rL41_prog_var_thresh5_df_rL42_int_ord[which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X21rL41_prog_var_thresh5_df_rL42_int_ord
X21rL41_prog_map_thresh5_df_rL42_int_ord = which(X21rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X21rL41_prog_map_thresh5_df_rL42_int_ord_df = X21rL41_prog_var_thresh5_df_rL42_int_ord[X21rL41_prog_map_thresh5_df_rL42_int_ord,]
X21rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X21rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X21rL41_prog_map_thresh5_df_rL42_int_ord_df[X21rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X21rL41_prog_map_thresh5_df_rL42_int_ord_df[X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X21rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X21rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X21rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X21rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X21rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X21rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X21rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X21rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X21rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X21rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X21rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X21rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X21rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X21rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X21rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X21rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X21rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X21rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X21rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X21rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X21rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X21rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X21rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41_cSNV_post_pre_by_cadd_cor_s
#X21rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X21rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL42_cSNV_post_pre_by_cadd_cor_s

#X21rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X21rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41_cSNV_post_lib_by_cadd_cor_s
#X21rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X21rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X21rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X21rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41_tSNV_post_pre_by_cadd_cor_s
#X21rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X21rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL42_tSNV_post_pre_by_cadd_cor_s

#X21rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X21rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41_tSNV_post_lib_by_cadd_cor_s
#X21rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X21rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X21rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X21rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X21rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X21rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X21rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X21rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X21rL41_prog_var_all_lib_count
X21rL41_prog_var_all_pre_count
X21rL42_prog_var_all_pre_count
X21rL41_prog_map_thresh5_lib_count
X21rL41_prog_map_thresh5_pre_count
X21rL42_prog_map_thresh5_pre_count
X21rL41_prog_map_thresh5_post_count
X21rL42_prog_map_thresh5_post_count
X21rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X21rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X21rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X21rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X21rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X21rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X21rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X21rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X21rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X21rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X21rL41_cSNV_post_pre_by_cadd_cor_s
X21rL42_cSNV_post_pre_by_cadd_cor_s
X21rL41_cSNV_post_lib_by_cadd_cor_s
X21rL42_cSNV_post_lib_by_cadd_cor_s
X21rL41_tSNV_post_pre_by_cadd_cor_s
X21rL42_tSNV_post_pre_by_cadd_cor_s
X21rL41_tSNV_post_lib_by_cadd_cor_s
X21rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X21rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X21rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X21rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X21rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X21rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X21rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X21rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X21rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X21rL41_cSNV_syn_to_non_post_pre_spread
X21rL42_cSNV_syn_to_non_post_pre_spread
X21rL41rL42a_cSNV_syn_to_non_post_pre_spread
X21rL41_cSNV_syn_to_non_post_lib_spread
X21rL42_cSNV_syn_to_non_post_lib_spread
X21rL41rL42a_cSNV_syn_to_non_post_lib_spread
X21rL41_tSNV_syn_to_non_post_pre_spread
X21rL42_tSNV_syn_to_non_post_pre_spread
X21rL41rL42a_tSNV_syn_to_non_post_pre_spread
X21rL41_tSNV_syn_to_non_post_lib_spread
X21rL42_tSNV_syn_to_non_post_lib_spread
X21rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X21rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X21rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X21rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X21rL41_cSNV_pre_lib_cors = cor(log2(X21rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21rL41_tSNV_pre_lib_cors = cor(log2(X21rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21rL41_cSNV_post_lib_cors = cor(log2(X21rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X21rL41_tSNV_post_lib_cors = cor(log2(X21rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X21rL41_cSNV_post_pre_cors = cor(log2(X21rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21rL41_tSNV_post_pre_cors = cor(log2(X21rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X21rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21rL41_cSNV_rna_lib_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X21rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21rL41_tSNV_rna_lib_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X21rL41_cSNV_rna_pre_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X21rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21rL41_tSNV_rna_pre_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X21rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21rL41rL42_cSNV_pre_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X21rL41rL42_tSNV_pre_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X21rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X21rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X21rL41rL42_cSNV_post_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X21rL41rL42_tSNV_post_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X21rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X21rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X21rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X21rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X21rL41rL42_cSNV_rna_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X21rL41rL42_tSNV_rna_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X21rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X21rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X21rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X21rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X21rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X21rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X21rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X21rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X21rL41_cors <- c("X21rL41",X21rL41_cSNV_pre_lib_cors,X21rL41_tSNV_pre_lib_cors,X21rL41_cSNV_post_lib_cors,X21rL41_tSNV_post_lib_cors,X21rL41_cSNV_post_pre_cors,X21rL41_tSNV_post_pre_cors,X21rL41_cSNV_rna_lib_cors,X21rL41_tSNV_rna_lib_cors,X21rL41_cSNV_rna_pre_cors,X21rL41_tSNV_rna_pre_cors,X21rL41rL42_cSNV_pre_cors,X21rL41rL42_tSNV_pre_cors,X21rL41rL42_cSNV_pre_lib_ratio_cors,X21rL41rL42_tSNV_pre_lib_ratio_cors,X21rL41rL42_cSNV_post_cors,X21rL41rL42_tSNV_post_cors,X21rL41rL42_cSNV_post_lib_ratio_cors,X21rL41rL42_tSNV_post_lib_ratio_cors,X21rL41rL42_cSNV_post_pre_ratio_cors,X21rL41rL42_tSNV_post_pre_ratio_cors,X21rL41rL42_cSNV_rna_cors,X21rL41rL42_tSNV_rna_cors,X21rL41rL42_tSNV_rna_pre_ratio_cors,X21rL41_cSNV_pre_lib_ratio_cadd_cors,X21rL41_tSNV_pre_lib_ratio_cadd_cors,X21rL41_cSNV_post_lib_ratio_cadd_cors,X21rL41_tSNV_post_lib_ratio_cadd_cors,X21rL41_cSNV_post_pre_ratio_cadd_cors,X21rL41_tSNV_post_pre_ratio_cadd_cors,X21rL41_cSNV_post_pre_ratio_cadd_missense_cors,X21rL41_tSNV_post_pre_ratio_cadd_missense_cors,X21rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X21rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X21rL41_cSNV_post_pre_ratio_grantham_missense_cors,X21rL41_tSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X21rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X21rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X21rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X21rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X21rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X21rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X21rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X21rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X21rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X21rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X21rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X21rL42_cSNV_pre_lib_cors = cor(log2(X21rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21rL42_tSNV_pre_lib_cors = cor(log2(X21rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21rL42_cSNV_post_lib_cors = cor(log2(X21rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X21rL42_tSNV_post_lib_cors = cor(log2(X21rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X21rL42_cSNV_post_pre_cors = cor(log2(X21rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X21rL42_tSNV_post_pre_cors = cor(log2(X21rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X21rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X21rL42_cSNV_rna_lib_cors = cor(log2(X21rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X21rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21rL42_tSNV_rna_lib_cors = cor(log2(X21rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X21rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X21rL42_cSNV_rna_pre_cors = cor(log2(X21rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X21rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X21rL42_tSNV_rna_pre_cors = cor(log2(X21rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X21rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X21rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X21rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X21rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X21rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X21rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X21rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X21rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X21rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X21rL42_cors <- c("X21rL42",X21rL42_cSNV_pre_lib_cors,X21rL42_tSNV_pre_lib_cors,X21rL42_cSNV_post_lib_cors,X21rL42_tSNV_post_lib_cors,X21rL42_cSNV_post_pre_cors,X21rL42_tSNV_post_pre_cors,X21rL42_cSNV_rna_lib_cors,X21rL42_tSNV_rna_lib_cors,X21rL42_cSNV_rna_pre_cors,X21rL42_tSNV_rna_pre_cors,X21rL41rL42_cSNV_pre_cors,X21rL41rL42_tSNV_pre_cors,X21rL41rL42_cSNV_pre_lib_ratio_cors,X21rL41rL42_tSNV_pre_lib_ratio_cors,X21rL41rL42_cSNV_post_cors,X21rL41rL42_tSNV_post_cors,X21rL41rL42_cSNV_post_lib_ratio_cors,X21rL41rL42_tSNV_post_lib_ratio_cors,X21rL41rL42_cSNV_post_pre_ratio_cors,X21rL41rL42_tSNV_post_pre_ratio_cors,X21rL41rL42_cSNV_rna_cors,X21rL41rL42_tSNV_rna_cors,X21rL41rL42_tSNV_rna_pre_ratio_cors,X21rL42_cSNV_pre_lib_ratio_cadd_cors,X21rL42_tSNV_pre_lib_ratio_cadd_cors,X21rL42_cSNV_post_lib_ratio_cadd_cors,X21rL42_tSNV_post_lib_ratio_cadd_cors,X21rL42_cSNV_post_pre_ratio_cadd_cors,X21rL42_tSNV_post_pre_ratio_cadd_cors,X21rL42_cSNV_post_pre_ratio_cadd_missense_cors,X21rL42_tSNV_post_pre_ratio_cadd_missense_cors,X21rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X21rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X21rL42_cSNV_post_pre_ratio_grantham_missense_cors,X21rL42_tSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X21rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X21rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X21rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X21rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X21rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X21rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X21rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X21rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X21rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X21rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X21rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X21rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X21rL41)
rm(X21rL42)
gc()
X22rL41_file <- paste(experiment_dir_170731,'X22rL41','_annotated.txt',sep='')
X22rL42_file <- paste(experiment_dir_170731,'X22rL42','_annotated.txt',sep='')
X22rL41 <- read.table(X22rL41_file, header=TRUE, sep="\t")
X22rL42 <- read.table(X22rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X22 <- editing_info[which(editing_info$amplicon == 'X22'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X22_HDR_5_SNV = as.character(editing_info_X22$HDR_5_SNV)
X22_HDR_3_SNV = as.character(editing_info_X22$HDR_3_SNV)
#X22_cut_pos = as.character(editing_info_X22$cut_pos)
X22_cut_end = as.character(editing_info_X22$cut_end)
X22_mut_start = as.character(editing_info_X22$mut_start)
X22_mut_end = as.character(editing_info_X22$mut_end)
### Replicate 1
X22rL41_cSNV_all <- which(X22rL41[,'c_hdr_snv']=='True')
X22rL41_cSNV_all_df = X22rL41[X22rL41_cSNV_all,]
X22rL41_prog_var_all <- which(X22rL41[,'all_hdr_variant']=='True' & X22rL41[,'edit_string']!='-WT')
X22rL41_prog_var_all_df = X22rL41[X22rL41_prog_var_all,]
X22rL41_prog_map_all = which(X22rL41_prog_var_all_df[,'pos']!='REF')
X22rL41_prog_map_all_df = X22rL41_prog_var_all_df[X22rL41_prog_map_all,]
X22rL41_prog_map_exon_all = which(X22rL41_prog_map_all_df[,'cDNApos']!='REF' & X22rL41_prog_map_all_df[,'cDNApos']!='NA')
X22rL41_prog_map_exon_all_df = X22rL41_prog_map_all_df[X22rL41_prog_map_exon_all,]
X22rL41_prog_map_CADD = which(X22rL41_prog_map_all_df[,'CADD.phred']!='NA')
X22rL41_prog_map_CADD_df = X22rL41_prog_map_all_df[X22rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X22rL41_prog_var_thresh5 <- which(as.numeric(as.character(X22rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X22rL41_prog_var_thresh5_df = X22rL41_prog_var_all_df[X22rL41_prog_var_thresh5,]
X22rL41_prog_map_thresh5 <- which(as.numeric(as.character(X22rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X22rL41_prog_map_thresh5_df = X22rL41_prog_map_all_df[X22rL41_prog_map_thresh5,]
X22rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X22rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X22rL41_prog_map_exon_thresh5_df = X22rL41_prog_map_exon_all_df[X22rL41_prog_map_exon_thresh5,]
X22rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X22rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X22rL41_prog_map_CADD_thresh5_df = X22rL41_prog_map_CADD_df[X22rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X22rL41_prog_var_all_lib_count = length(X22rL41_prog_var_all_df$lib)
X22rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X22rL41_prog_var_all_min_lib_counts = min(X22rL41_prog_var_all_df$lib)
X22rL41_prog_var_all_min_lib_counts
X22rL41_prog_var_all_max_lib_counts = max(X22rL41_prog_var_all_df$lib)
X22rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X22rL41_prog_map_all_lib_count = length(X22rL41_prog_map_all_df$lib)
X22rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X22rL41_prog_map_all_min_lib_counts = min(X22rL41_prog_map_all_df$lib)
X22rL41_prog_map_all_min_lib_counts
X22rL41_prog_map_all_max_lib_counts = max(X22rL41_prog_map_all_df$lib)
X22rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X22rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X22rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X22rL41_prog_var_all_pre_count = length(X22rL41_prog_var_all_df$pre)
X22rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X22rL41_prog_var_all_min_pre_counts = min(X22rL41_prog_var_all_df$pre)
X22rL41_prog_var_all_min_pre_counts
X22rL41_prog_var_all_max_pre_counts = max(X22rL41_prog_var_all_df$pre)
X22rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X22rL41_prog_map_all_pre_count = length(X22rL41_prog_map_all_df$pre)
X22rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X22rL41_prog_map_all_min_pre_counts = min(X22rL41_prog_map_all_df$pre)
X22rL41_prog_map_all_min_pre_counts
X22rL41_prog_map_all_max_pre_counts = max(X22rL41_prog_map_all_df$pre)
X22rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X22rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X22rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X22rL41_prog_map_all_post_count = length(X22rL41_prog_map_all_df$post)
X22rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X22rL41_prog_map_all_min_post_counts = min(X22rL41_prog_map_all_df$post)
X22rL41_prog_map_all_min_post_counts
X22rL41_prog_map_all_max_post_counts = max(X22rL41_prog_map_all_df$post)
X22rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X22rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X22rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X22rL41_prog_map_all_syn_df <- X22rL41_prog_map_all_df[which(X22rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X22rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X22rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X22rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X22rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X22rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X22rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X22rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X22rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X22rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X22rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X22rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X22rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X22rL41_prog_map_all_min_rna_counts = min(X22rL41_prog_map_exon_all_df$tHDR_rna)
X22rL41_prog_map_all_min_rna_counts
X22rL41_prog_map_all_max_rna_counts = max(X22rL41_prog_map_exon_all_df$tHDR_rna)
X22rL41_prog_map_all_max_rna_counts
X22rL41_prog_map_all_min_rna_pseudo_freq = min(X22rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22rL41_prog_map_all_min_rna_pseudo_freq
X22rL41_prog_map_all_max_rna_pseudo_freq = max(X22rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22rL41_prog_map_all_max_rna_pseudo_freq
X22rL41_prog_map_all_min_rna_pre_ratio = min(X22rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22rL41_prog_map_all_min_rna_pre_ratio
X22rL41_prog_map_all_max_rna_pre_ratio = max(X22rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22rL41_prog_map_all_max_rna_pre_ratio
X22rL41_prog_map_all_min_rna_post_ratio = min(X22rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22rL41_prog_map_all_min_rna_post_ratio
X22rL41_prog_map_all_max_rna_post_ratio = max(X22rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X22rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X22rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X22rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X22rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X22rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X22rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X22rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X22rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X22rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X22rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X22rL41_prog_map_all_df$post_pre_ratio),log2(X22rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X22rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X22rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X22rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X22rL41_cSNV_all_corr_pre_count = length(X22rL41_cSNV_all_df$corr_pre)
X22rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X22rL41_cSNV_all_min_corr_pre_counts = min(X22rL41_cSNV_all_df$corr_pre)
X22rL41_cSNV_all_min_corr_pre_counts
X22rL41_cSNV_all_max_corr_pre_counts = max(X22rL41_cSNV_all_df$corr_pre)
X22rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X22rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X22rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X22rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X22rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X22rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_cSNV_all_corr_post_count = length(X22rL41_cSNV_all_df$corr_post)
X22rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X22rL41_cSNV_all_min_corr_post_counts = min(X22rL41_cSNV_all_df$corr_post)
X22rL41_cSNV_all_min_corr_post_counts
X22rL41_cSNV_all_max_corr_post_counts = max(X22rL41_cSNV_all_df$corr_post)
X22rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X22rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X22rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X22rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X22rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X22rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X22rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X22_p_hdr_snv = paste('p_hdr_',X22_cut_end,'_snv',sep='')
X22rL41_pSNV_all <- which(X22rL41[,X22_p_hdr_snv]=='True')
X22rL41_pSNV_all_df = X22rL41[X22rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_pSNV_all_lib_count = length(X22rL41_pSNV_all_df$lib)
X22rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X22rL41_pSNV_all_min_lib_counts = min(X22rL41_pSNV_all_df$lib)
X22rL41_pSNV_all_min_lib_counts
X22rL41_pSNV_all_max_lib_counts = max(X22rL41_pSNV_all_df$lib)
X22rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X22rL41_pSNV_all_pre_count = length(X22rL41_pSNV_all_df$pre)
X22rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X22rL41_pSNV_all_min_pre_counts = min(X22rL41_pSNV_all_df$pre)
X22rL41_pSNV_all_min_pre_counts
X22rL41_pSNV_all_max_pre_counts = max(X22rL41_pSNV_all_df$pre)
X22rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X22rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X22rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_pSNV_all_post_count = length(X22rL41_pSNV_all_df$post)
X22rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X22rL41_pSNV_all_min_post_counts = min(X22rL41_pSNV_all_df$post)
X22rL41_pSNV_all_min_post_counts
X22rL41_pSNV_all_max_post_counts = max(X22rL41_pSNV_all_df$post)
X22rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X22rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X22rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_prog_map_thresh5_lib_count = length(X22rL41_prog_map_thresh5_df$lib)
X22rL41_prog_map_thresh5_lib_count
X22rL41_prog_map_thresh5_min_lib_counts = min(X22rL41_prog_map_thresh5_df$lib)
X22rL41_prog_map_thresh5_min_lib_counts
X22rL41_prog_map_thresh5_max_lib_counts = max(X22rL41_prog_map_thresh5_df$lib)
X22rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X22rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X22rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_prog_map_thresh5_pre_count = length(X22rL41_prog_map_thresh5_df$pre)
X22rL41_prog_map_thresh5_pre_count
X22rL41_prog_map_thresh5_min_pre_counts = min(X22rL41_prog_map_thresh5_df$pre)
X22rL41_prog_map_thresh5_min_pre_counts
X22rL41_prog_map_thresh5_max_pre_counts = max(X22rL41_prog_map_thresh5_df$pre)
X22rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL41_prog_map_thresh5_post_count = length(X22rL41_prog_map_thresh5_df$post)
X22rL41_prog_map_thresh5_post_count
X22rL41_prog_map_thresh5_min_post_counts = min(X22rL41_prog_map_thresh5_df$post)
X22rL41_prog_map_thresh5_min_post_counts
X22rL41_prog_map_thresh5_max_post_counts = max(X22rL41_prog_map_thresh5_df$post)
X22rL41_prog_map_thresh5_max_post_counts
X22rL41_prog_map_thresh5_corr_post_count = length(X22rL41_cSNV_all_df$corr_post)
X22rL41_prog_map_thresh5_corr_post_count
X22rL41_prog_map_thresh5_min_corr_post_counts = min(X22rL41_cSNV_all_df$corr_post)
X22rL41_prog_map_thresh5_min_corr_post_counts
X22rL41_prog_map_thresh5_max_corr_post_counts = max(X22rL41_cSNV_all_df$corr_post)
X22rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X22rL41_pSNV_thresh5 <- which(X22rL41[,X22_p_hdr_snv]=='True' & as.numeric(as.character(X22rL41[,'pre_freq']))>=0.00001)
X22rL41_pSNV_thresh5_df = X22rL41[X22rL41_pSNV_thresh5,]
X22rL41_pSNV_thresh5_lib_count = length(X22rL41_pSNV_thresh5_df$lib)
X22rL41_pSNV_thresh5_lib_count
X22rL41_pSNV_thresh5_min_lib_counts = min(X22rL41_pSNV_thresh5_df$lib)
X22rL41_pSNV_thresh5_min_lib_counts
X22rL41_pSNV_thresh5_max_lib_counts = max(X22rL41_pSNV_thresh5_df$lib)
X22rL41_pSNV_thresh5_max_lib_counts
X22rL41_pSNV_thresh5_pre_count = length(X22rL41_pSNV_thresh5_df$pre)
X22rL41_pSNV_thresh5_pre_count
X22rL41_pSNV_thresh5_min_pre_counts = min(X22rL41_pSNV_thresh5_df$pre)
X22rL41_pSNV_thresh5_min_pre_counts
X22rL41_pSNV_thresh5_max_pre_counts = max(X22rL41_pSNV_thresh5_df$pre)
X22rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X22rL41_pSNV_thresh5_post_count = length(X22rL41_pSNV_thresh5_df$post)
X22rL41_pSNV_thresh5_post_count
X22rL41_pSNV_thresh5_min_post_counts = min(X22rL41_pSNV_thresh5_df$post)
X22rL41_pSNV_thresh5_min_post_counts
X22rL41_pSNV_thresh5_max_post_counts = max(X22rL41_pSNV_thresh5_df$post)
X22rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X22rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X22rL41_pSNV_thresh5_post_pos

### Replicate 2
X22rL42_cSNV_all <- which(X22rL42[,'c_hdr_snv']=='True')
X22rL42_cSNV_all_df = X22rL42[X22rL42_cSNV_all,]
X22rL42_prog_var_all <- which(X22rL42[,'all_hdr_variant']=='True' & X22rL42[,'edit_string']!='-WT')
X22rL42_prog_var_all_df = X22rL42[X22rL42_prog_var_all,]
X22rL42_prog_map_all = which(X22rL42_prog_var_all_df[,'pos']!='REF')
X22rL42_prog_map_all_df = X22rL42_prog_var_all_df[X22rL42_prog_map_all,]
X22rL42_prog_map_exon_all = which(X22rL42_prog_map_all_df[,'cDNApos']!='REF' & X22rL42_prog_map_all_df[,'cDNApos']!='NA')
X22rL42_prog_map_exon_all_df = X22rL42_prog_map_all_df[X22rL42_prog_map_exon_all,]
X22rL42_prog_map_CADD = which(X22rL42_prog_map_all_df[,'CADD.phred']!='NA')
X22rL42_prog_map_CADD_df = X22rL42_prog_map_all_df[X22rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X22rL42_prog_var_thresh5 <- which(as.numeric(as.character(X22rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X22rL42_prog_var_thresh5_df = X22rL42_prog_var_all_df[X22rL42_prog_var_thresh5,]
X22rL42_prog_map_thresh5 <- which(as.numeric(as.character(X22rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X22rL42_prog_map_thresh5_df = X22rL42_prog_map_all_df[X22rL42_prog_map_thresh5,]
X22rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X22rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X22rL42_prog_map_exon_thresh5_df = X22rL42_prog_map_exon_all_df[X22rL42_prog_map_exon_thresh5,]
X22rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X22rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X22rL42_prog_map_CADD_thresh5_df = X22rL42_prog_map_CADD_df[X22rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X22rL42_prog_var_all_lib_count = length(X22rL42_prog_var_all_df$lib)
X22rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X22rL42_prog_var_all_min_lib_counts = min(X22rL42_prog_var_all_df$lib)
X22rL42_prog_var_all_min_lib_counts
X22rL42_prog_var_all_max_lib_counts = max(X22rL42_prog_var_all_df$lib)
X22rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X22rL42_prog_map_all_lib_count = length(X22rL42_prog_map_all_df$lib)
X22rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X22rL42_prog_map_all_min_lib_counts = min(X22rL42_prog_map_all_df$lib)
X22rL42_prog_map_all_min_lib_counts
X22rL42_prog_map_all_max_lib_counts = max(X22rL42_prog_map_all_df$lib)
X22rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X22rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X22rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X22rL42_prog_var_all_pre_count = length(X22rL42_prog_var_all_df$pre)
X22rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X22rL42_prog_var_all_min_pre_counts = min(X22rL42_prog_var_all_df$pre)
X22rL42_prog_var_all_min_pre_counts
X22rL42_prog_var_all_max_pre_counts = max(X22rL42_prog_var_all_df$pre)
X22rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X22rL42_prog_map_all_pre_count = length(X22rL42_prog_map_all_df$pre)
X22rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X22rL42_prog_map_all_min_pre_counts = min(X22rL42_prog_map_all_df$pre)
X22rL42_prog_map_all_min_pre_counts
X22rL42_prog_map_all_max_pre_counts = max(X22rL42_prog_map_all_df$pre)
X22rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X22rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X22rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X22rL42_prog_map_all_post_count = length(X22rL42_prog_map_all_df$post)
X22rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X22rL42_prog_map_all_min_post_counts = min(X22rL42_prog_map_all_df$post)
X22rL42_prog_map_all_min_post_counts
X22rL42_prog_map_all_max_post_counts = max(X22rL42_prog_map_all_df$post)
X22rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X22rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X22rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X22rL42_prog_map_all_syn_df <- X22rL42_prog_map_all_df[which(X22rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X22rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X22rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X22rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X22rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X22rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X22rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X22rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X22rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X22rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X22rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X22rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X22rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X22rL42_prog_map_all_min_rna_counts = min(X22rL42_prog_map_exon_all_df$tHDR_rna)
X22rL42_prog_map_all_min_rna_counts
X22rL42_prog_map_all_max_rna_counts = max(X22rL42_prog_map_exon_all_df$tHDR_rna)
X22rL42_prog_map_all_max_rna_counts
X22rL42_prog_map_all_min_rna_pseudo_freq = min(X22rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22rL42_prog_map_all_min_rna_pseudo_freq
X22rL42_prog_map_all_max_rna_pseudo_freq = max(X22rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X22rL42_prog_map_all_max_rna_pseudo_freq
X22rL42_prog_map_all_min_rna_pre_ratio = min(X22rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22rL42_prog_map_all_min_rna_pre_ratio
X22rL42_prog_map_all_max_rna_pre_ratio = max(X22rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X22rL42_prog_map_all_max_rna_pre_ratio
X22rL42_prog_map_all_min_rna_post_ratio = min(X22rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22rL42_prog_map_all_min_rna_post_ratio
X22rL42_prog_map_all_max_rna_post_ratio = max(X22rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X22rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X22rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X22rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X22rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X22rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X22rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X22rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X22rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X22rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X22rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X22rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X22rL42_prog_map_all_df$post_pre_ratio),log2(X22rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X22rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X22rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X22rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X22rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X22rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X22rL42_cSNV_all_corr_pre_count = length(X22rL42_cSNV_all_df$corr_pre)
X22rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X22rL42_cSNV_all_min_corr_pre_counts = min(X22rL42_cSNV_all_df$corr_pre)
X22rL42_cSNV_all_min_corr_pre_counts
X22rL42_cSNV_all_max_corr_pre_counts = max(X22rL42_cSNV_all_df$corr_pre)
X22rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X22rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X22rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X22rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X22rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X22rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_cSNV_all_corr_post_count = length(X22rL42_cSNV_all_df$corr_post)
X22rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X22rL42_cSNV_all_min_corr_post_counts = min(X22rL42_cSNV_all_df$corr_post)
X22rL42_cSNV_all_min_corr_post_counts
X22rL42_cSNV_all_max_corr_post_counts = max(X22rL42_cSNV_all_df$corr_post)
X22rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X22rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X22rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X22rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X22rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X22rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X22rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X22_p_hdr_snv = paste('p_hdr_',X22_cut_end,'_snv',sep='')
X22rL42_pSNV_all <- which(X22rL42[,X22_p_hdr_snv]=='True')
X22rL42_pSNV_all_df = X22rL42[X22rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_pSNV_all_lib_count = length(X22rL42_pSNV_all_df$lib)
X22rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X22rL42_pSNV_all_min_lib_counts = min(X22rL42_pSNV_all_df$lib)
X22rL42_pSNV_all_min_lib_counts
X22rL42_pSNV_all_max_lib_counts = max(X22rL42_pSNV_all_df$lib)
X22rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X22rL42_pSNV_all_pre_count = length(X22rL42_pSNV_all_df$pre)
X22rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X22rL42_pSNV_all_min_pre_counts = min(X22rL42_pSNV_all_df$pre)
X22rL42_pSNV_all_min_pre_counts
X22rL42_pSNV_all_max_pre_counts = max(X22rL42_pSNV_all_df$pre)
X22rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X22rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X22rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_pSNV_all_post_count = length(X22rL42_pSNV_all_df$post)
X22rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X22rL42_pSNV_all_min_post_counts = min(X22rL42_pSNV_all_df$post)
X22rL42_pSNV_all_min_post_counts
X22rL42_pSNV_all_max_post_counts = max(X22rL42_pSNV_all_df$post)
X22rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X22rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X22rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_prog_map_thresh5_lib_count = length(X22rL42_prog_map_thresh5_df$lib)
X22rL42_prog_map_thresh5_lib_count
X22rL42_prog_map_thresh5_min_lib_counts = min(X22rL42_prog_map_thresh5_df$lib)
X22rL42_prog_map_thresh5_min_lib_counts
X22rL42_prog_map_thresh5_max_lib_counts = max(X22rL42_prog_map_thresh5_df$lib)
X22rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X22rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X22rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_prog_map_thresh5_pre_count = length(X22rL42_prog_map_thresh5_df$pre)
X22rL42_prog_map_thresh5_pre_count
X22rL42_prog_map_thresh5_min_pre_counts = min(X22rL42_prog_map_thresh5_df$pre)
X22rL42_prog_map_thresh5_min_pre_counts
X22rL42_prog_map_thresh5_max_pre_counts = max(X22rL42_prog_map_thresh5_df$pre)
X22rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X22 less than SGE region length x 3 due to PAM edits
X22rL42_prog_map_thresh5_post_count = length(X22rL42_prog_map_thresh5_df$post)
X22rL42_prog_map_thresh5_post_count
X22rL42_prog_map_thresh5_min_post_counts = min(X22rL42_prog_map_thresh5_df$post)
X22rL42_prog_map_thresh5_min_post_counts
X22rL42_prog_map_thresh5_max_post_counts = max(X22rL42_prog_map_thresh5_df$post)
X22rL42_prog_map_thresh5_max_post_counts
X22rL42_prog_map_thresh5_corr_post_count = length(X22rL42_prog_map_thresh5_df$corr_post)
X22rL42_prog_map_thresh5_corr_post_count
X22rL42_prog_map_thresh5_min_corr_post_counts = min(X22rL42_prog_map_thresh5_df$corr_post)
X22rL42_prog_map_thresh5_min_corr_post_counts
X22rL42_prog_map_thresh5_max_corr_post_counts = max(X22rL42_prog_map_thresh5_df$corr_post)
X22rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X22rL42_pSNV_thresh5 <- which(X22rL42[,X22_p_hdr_snv]=='True' & as.numeric(as.character(X22rL42[,'pre_freq']))>=0.00001)
X22rL42_pSNV_thresh5_df = X22rL42[X22rL42_pSNV_thresh5,]
X22rL42_pSNV_thresh5_lib_count = length(X22rL42_pSNV_thresh5_df$lib)
X22rL42_pSNV_thresh5_lib_count
X22rL42_pSNV_thresh5_min_lib_counts = min(X22rL42_pSNV_thresh5_df$lib)
X22rL42_pSNV_thresh5_min_lib_counts
X22rL42_pSNV_thresh5_max_lib_counts = max(X22rL42_pSNV_thresh5_df$lib)
X22rL42_pSNV_thresh5_max_lib_counts
X22rL42_pSNV_thresh5_pre_count = length(X22rL42_pSNV_thresh5_df$pre)
X22rL42_pSNV_thresh5_pre_count
X22rL42_pSNV_thresh5_min_pre_counts = min(X22rL42_pSNV_thresh5_df$pre)
X22rL42_pSNV_thresh5_min_pre_counts
X22rL42_pSNV_thresh5_max_pre_counts = max(X22rL42_pSNV_thresh5_df$pre)
X22rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X22rL42_pSNV_thresh5_post_count = length(X22rL42_pSNV_thresh5_df$post)
X22rL42_pSNV_thresh5_post_count
X22rL42_pSNV_thresh5_min_post_counts = min(X22rL42_pSNV_thresh5_df$post)
X22rL42_pSNV_thresh5_min_post_counts
X22rL42_pSNV_thresh5_max_post_counts = max(X22rL42_pSNV_thresh5_df$post)
X22rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X22rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X22rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X22rL41_prog_var_thresh5_df:
X22rL41_prog_var_thresh5_df_rL42_int <- X22rL41_prog_var_thresh5_df[which(X22rL41_prog_var_thresh5_df$variant %in% X22rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X22rL42_prog_var_thresh5_df:
X22rL42_prog_var_thresh5_df_rL41_int <- X22rL42_prog_var_thresh5_df[which(X22rL42_prog_var_thresh5_df$variant %in% X22rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X22rL41_prog_var_thresh5_df_rL42_int_ord <- X22rL41_prog_var_thresh5_df_rL42_int[order(X22rL41_prog_var_thresh5_df_rL42_int$variant),]
X22rL42_prog_var_thresh5_df_rL41_int_ord <- X22rL42_prog_var_thresh5_df_rL41_int[order(X22rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X22rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X22rL41rL42int_prog_var_thresh5_pre_count <- dim(X22rL41_prog_var_thresh5_df_rL42_int)[1] 
X22rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X22rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X22rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X22rL42_prog_var_thresh5_df_rL41_int_ord$lib
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X22rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X22rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X22rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X22rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X22rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X22rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X22rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X22rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X22rL41_cSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X22rL41_cSNV_missense_post_pre_med <- unname(X22rL41_cSNV_missense_post_pre_quarts[3])
X22rL41_cSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X22rL41_cSNV_syn_post_pre_med <- unname(X22rL41_cSNV_syn_post_pre_quarts[3])
X22rL41_cSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X22rL41_cSNV_nonsense_post_pre_med <- unname(X22rL41_cSNV_nonsense_post_pre_quarts[3])
X22rL41_cSNV_syn_to_non_post_pre_spread <- X22rL41_cSNV_syn_post_pre_med - X22rL41_cSNV_nonsense_post_pre_med

X22rL42_cSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X22rL42_cSNV_missense_post_pre_med <- unname(X22rL42_cSNV_missense_post_pre_quarts[3])
X22rL42_cSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X22rL42_cSNV_syn_post_pre_med <- unname(X22rL42_cSNV_syn_post_pre_quarts[3])
X22rL42_cSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X22rL42_cSNV_nonsense_post_pre_med <- unname(X22rL42_cSNV_nonsense_post_pre_quarts[3])
X22rL42_cSNV_syn_to_non_post_pre_spread <- X22rL42_cSNV_syn_post_pre_med - X22rL42_cSNV_nonsense_post_pre_med

X22rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_missense_post_pre_med <- unname(X22rL41rL42a_cSNV_missense_post_pre_quarts[3])
X22rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_syn_post_pre_med <- unname(X22rL41rL42a_cSNV_syn_post_pre_quarts[3])
X22rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X22rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X22rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X22rL41rL42a_cSNV_syn_post_pre_med - X22rL41rL42a_cSNV_nonsense_post_pre_med

X22rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_cSNV_missense_post_pre_med <- unname(X22rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X22rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_cSNV_syn_post_pre_med <- unname(X22rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X22rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X22rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X22rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X22rL41rL42pw_cSNV_syn_post_pre_med - X22rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X22rL41_tSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X22rL41_tSNV_missense_post_pre_med <- unname(X22rL41_tSNV_missense_post_pre_quarts[3])
X22rL41_tSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X22rL41_tSNV_syn_post_pre_med <- unname(X22rL41_tSNV_syn_post_pre_quarts[3])
X22rL41_tSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X22rL41_tSNV_nonsense_post_pre_med <- unname(X22rL41_tSNV_nonsense_post_pre_quarts[3])
X22rL41_tSNV_syn_to_non_post_pre_spread <- X22rL41_tSNV_syn_post_pre_med - X22rL41_tSNV_nonsense_post_pre_med

X22rL42_tSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X22rL42_tSNV_missense_post_pre_med <- unname(X22rL42_tSNV_missense_post_pre_quarts[3])
X22rL42_tSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X22rL42_tSNV_syn_post_pre_med <- unname(X22rL42_tSNV_syn_post_pre_quarts[3])
X22rL42_tSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X22rL42_tSNV_nonsense_post_pre_med <- unname(X22rL42_tSNV_nonsense_post_pre_quarts[3])
X22rL42_tSNV_syn_to_non_post_pre_spread <- X22rL42_tSNV_syn_post_pre_med - X22rL42_tSNV_nonsense_post_pre_med

X22rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_missense_post_pre_med <- unname(X22rL41rL42a_tSNV_missense_post_pre_quarts[3])
X22rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_syn_post_pre_med <- unname(X22rL41rL42a_tSNV_syn_post_pre_quarts[3])
X22rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X22rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X22rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X22rL41rL42a_tSNV_syn_post_pre_med - X22rL41rL42a_tSNV_nonsense_post_pre_med

X22rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_tSNV_missense_post_pre_med <- unname(X22rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X22rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_tSNV_syn_post_pre_med <- unname(X22rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X22rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X22rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X22rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X22rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X22rL41rL42pw_tSNV_syn_post_pre_med - X22rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X22rL41_cSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X22rL41_cSNV_missense_post_lib_med <- unname(X22rL41_cSNV_missense_post_lib_quarts[3])
X22rL41_cSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X22rL41_cSNV_syn_post_lib_med <- unname(X22rL41_cSNV_syn_post_lib_quarts[3])
X22rL41_cSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X22rL41_cSNV_nonsense_post_lib_med <- unname(X22rL41_cSNV_nonsense_post_lib_quarts[3])
X22rL41_cSNV_syn_to_non_post_lib_spread <- X22rL41_cSNV_syn_post_lib_med - X22rL41_cSNV_nonsense_post_lib_med

X22rL42_cSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X22rL42_cSNV_missense_post_lib_med <- unname(X22rL42_cSNV_missense_post_lib_quarts[3])
X22rL42_cSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X22rL42_cSNV_syn_post_lib_med <- unname(X22rL42_cSNV_syn_post_lib_quarts[3])
X22rL42_cSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X22rL42_cSNV_nonsense_post_lib_med <- unname(X22rL42_cSNV_nonsense_post_lib_quarts[3])
X22rL42_cSNV_syn_to_non_post_lib_spread <- X22rL42_cSNV_syn_post_lib_med - X22rL42_cSNV_nonsense_post_lib_med

X22rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_missense_post_lib_med <- unname(X22rL41rL42a_cSNV_missense_post_lib_quarts[3])
X22rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_syn_post_lib_med <- unname(X22rL41rL42a_cSNV_syn_post_lib_quarts[3])
X22rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X22rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X22rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X22rL41rL42a_cSNV_syn_post_lib_med - X22rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X22rL41_tSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X22rL41_tSNV_missense_post_lib_med <- unname(X22rL41_tSNV_missense_post_lib_quarts[3])
X22rL41_tSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X22rL41_tSNV_syn_post_lib_med <- unname(X22rL41_tSNV_syn_post_lib_quarts[3])
X22rL41_tSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X22rL41_tSNV_nonsense_post_lib_med <- unname(X22rL41_tSNV_nonsense_post_lib_quarts[3])
X22rL41_tSNV_syn_to_non_post_lib_spread <- X22rL41_tSNV_syn_post_lib_med - X22rL41_tSNV_nonsense_post_lib_med

X22rL42_tSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X22rL42_tSNV_missense_post_lib_med <- unname(X22rL42_tSNV_missense_post_lib_quarts[3])
X22rL42_tSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X22rL42_tSNV_syn_post_lib_med <- unname(X22rL42_tSNV_syn_post_lib_quarts[3])
X22rL42_tSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X22rL42_tSNV_nonsense_post_lib_med <- unname(X22rL42_tSNV_nonsense_post_lib_quarts[3])
X22rL42_tSNV_syn_to_non_post_lib_spread <- X22rL42_tSNV_syn_post_lib_med - X22rL42_tSNV_nonsense_post_lib_med

X22rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_missense_post_lib_med <- unname(X22rL41rL42a_tSNV_missense_post_lib_quarts[3])
X22rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_syn_post_lib_med <- unname(X22rL41rL42a_tSNV_syn_post_lib_quarts[3])
X22rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X22rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X22rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X22rL41rL42a_tSNV_syn_post_lib_med - X22rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X22rL41_cSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X22rL41_cSNV_missense_pre_lib_med <- unname(X22rL41_cSNV_missense_pre_lib_quarts[3])
X22rL41_cSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X22rL41_cSNV_syn_pre_lib_med <- unname(X22rL41_cSNV_syn_pre_lib_quarts[3])
X22rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X22rL41_cSNV_nonsense_pre_lib_med <- unname(X22rL41_cSNV_nonsense_pre_lib_quarts[3])
X22rL41_cSNV_syn_to_non_pre_lib_spread <- X22rL41_cSNV_syn_pre_lib_med - X22rL41_cSNV_nonsense_pre_lib_med

X22rL42_cSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X22rL42_cSNV_missense_pre_lib_med <- unname(X22rL42_cSNV_missense_pre_lib_quarts[3])
X22rL42_cSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X22rL42_cSNV_syn_pre_lib_med <- unname(X22rL42_cSNV_syn_pre_lib_quarts[3])
X22rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X22rL42_cSNV_nonsense_pre_lib_med <- unname(X22rL42_cSNV_nonsense_pre_lib_quarts[3])
X22rL42_cSNV_syn_to_non_pre_lib_spread <- X22rL42_cSNV_syn_pre_lib_med - X22rL42_cSNV_nonsense_pre_lib_med

X22rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_missense_pre_lib_med <- unname(X22rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X22rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_syn_pre_lib_med <- unname(X22rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X22rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X22rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X22rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X22rL41rL42a_cSNV_syn_pre_lib_med - X22rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X22rL41_tSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X22rL41_tSNV_missense_pre_lib_med <- unname(X22rL41_tSNV_missense_pre_lib_quarts[3])
X22rL41_tSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X22rL41_tSNV_syn_pre_lib_med <- unname(X22rL41_tSNV_syn_pre_lib_quarts[3])
X22rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X22rL41_tSNV_nonsense_pre_lib_med <- unname(X22rL41_tSNV_nonsense_pre_lib_quarts[3])
X22rL41_tSNV_syn_to_non_pre_lib_spread <- X22rL41_tSNV_syn_pre_lib_med - X22rL41_tSNV_nonsense_pre_lib_med

X22rL42_tSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X22rL42_tSNV_missense_pre_lib_med <- unname(X22rL42_tSNV_missense_pre_lib_quarts[3])
X22rL42_tSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X22rL42_tSNV_syn_pre_lib_med <- unname(X22rL42_tSNV_syn_pre_lib_quarts[3])
X22rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X22rL42_tSNV_nonsense_pre_lib_med <- unname(X22rL42_tSNV_nonsense_pre_lib_quarts[3])
X22rL42_tSNV_syn_to_non_pre_lib_spread <- X22rL42_tSNV_syn_pre_lib_med - X22rL42_tSNV_nonsense_pre_lib_med

X22rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_missense_pre_lib_med <- unname(X22rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X22rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_syn_pre_lib_med <- unname(X22rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X22rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X22rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X22rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X22rL41rL42a_tSNV_syn_pre_lib_med - X22rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X22rL41_tSNV_syn_rna_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X22rL41_tSNV_syn_rna_pre_med <- unname(X22rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X22rL41_tSNV_syn_rna_post_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X22rL41_tSNV_syn_rna_post_med <- unname(X22rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X22rL42_tSNV_syn_rna_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X22rL42_tSNV_syn_rna_pre_med <- unname(X22rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X22rL42_tSNV_syn_rna_post_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X22rL42_tSNV_syn_rna_post_med <- unname(X22rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X22rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_syn_rna_pre_med <- unname(X22rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X22rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X22rL41rL42a_tSNV_syn_rna_post_med <- unname(X22rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X22rL41_cSNV_syn_pre_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X22rL41_cSNV_syn_post_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X22rL41_cSNV_syn_post_lib_med
# tHDR
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X22rL41_tSNV_syn_pre_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X22rL41_tSNV_syn_post_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X22rL41_tSNV_syn_post_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X22rL41_tSNV_syn_rna_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X22rL41_tSNV_syn_rna_post_med

#rL42
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X22rL42_cSNV_syn_pre_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X22rL42_cSNV_syn_post_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X22rL42_cSNV_syn_post_lib_med
# tHDR
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X22rL42_tSNV_syn_pre_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X22rL42_tSNV_syn_post_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X22rL42_tSNV_syn_post_lib_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X22rL42_tSNV_syn_rna_pre_med
X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X22rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X22rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X22rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X22rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X22rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X22rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X22rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X22rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X22rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X22rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X22rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X22rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X22rL41_prog_var_thresh5_df_rL42_int_ord[which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X22rL41_prog_var_thresh5_df_rL42_int_ord
X22rL41_prog_map_thresh5_df_rL42_int_ord = which(X22rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X22rL41_prog_map_thresh5_df_rL42_int_ord_df = X22rL41_prog_var_thresh5_df_rL42_int_ord[X22rL41_prog_map_thresh5_df_rL42_int_ord,]
X22rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X22rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X22rL41_prog_map_thresh5_df_rL42_int_ord_df[X22rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X22rL41_prog_map_thresh5_df_rL42_int_ord_df[X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X22rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X22rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X22rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X22rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X22rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X22rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X22rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X22rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X22rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X22rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X22rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X22rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X22rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X22rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X22rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X22rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X22rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X22rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X22rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X22rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X22rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X22rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X22rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41_cSNV_post_pre_by_cadd_cor_s
#X22rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X22rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL42_cSNV_post_pre_by_cadd_cor_s

#X22rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X22rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41_cSNV_post_lib_by_cadd_cor_s
#X22rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X22rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X22rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X22rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41_tSNV_post_pre_by_cadd_cor_s
#X22rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X22rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL42_tSNV_post_pre_by_cadd_cor_s

#X22rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X22rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41_tSNV_post_lib_by_cadd_cor_s
#X22rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X22rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X22rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X22rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X22rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X22rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X22rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X22rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X22rL41_prog_var_all_lib_count
X22rL41_prog_var_all_pre_count
X22rL42_prog_var_all_pre_count
X22rL41_prog_map_thresh5_lib_count
X22rL41_prog_map_thresh5_pre_count
X22rL42_prog_map_thresh5_pre_count
X22rL41_prog_map_thresh5_post_count
X22rL42_prog_map_thresh5_post_count
X22rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X22rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X22rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X22rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X22rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X22rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X22rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X22rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X22rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X22rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X22rL41_cSNV_post_pre_by_cadd_cor_s
X22rL42_cSNV_post_pre_by_cadd_cor_s
X22rL41_cSNV_post_lib_by_cadd_cor_s
X22rL42_cSNV_post_lib_by_cadd_cor_s
X22rL41_tSNV_post_pre_by_cadd_cor_s
X22rL42_tSNV_post_pre_by_cadd_cor_s
X22rL41_tSNV_post_lib_by_cadd_cor_s
X22rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X22rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X22rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X22rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X22rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X22rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X22rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X22rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X22rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X22rL41_cSNV_syn_to_non_post_pre_spread
X22rL42_cSNV_syn_to_non_post_pre_spread
X22rL41rL42a_cSNV_syn_to_non_post_pre_spread
X22rL41_cSNV_syn_to_non_post_lib_spread
X22rL42_cSNV_syn_to_non_post_lib_spread
X22rL41rL42a_cSNV_syn_to_non_post_lib_spread
X22rL41_tSNV_syn_to_non_post_pre_spread
X22rL42_tSNV_syn_to_non_post_pre_spread
X22rL41rL42a_tSNV_syn_to_non_post_pre_spread
X22rL41_tSNV_syn_to_non_post_lib_spread
X22rL42_tSNV_syn_to_non_post_lib_spread
X22rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X22rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X22rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X22rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X22rL41_cSNV_pre_lib_cors = cor(log2(X22rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22rL41_tSNV_pre_lib_cors = cor(log2(X22rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22rL41_cSNV_post_lib_cors = cor(log2(X22rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X22rL41_tSNV_post_lib_cors = cor(log2(X22rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X22rL41_cSNV_post_pre_cors = cor(log2(X22rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22rL41_tSNV_post_pre_cors = cor(log2(X22rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X22rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22rL41_cSNV_rna_lib_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X22rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22rL41_tSNV_rna_lib_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X22rL41_cSNV_rna_pre_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X22rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22rL41_tSNV_rna_pre_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X22rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22rL41rL42_cSNV_pre_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X22rL41rL42_tSNV_pre_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X22rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X22rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X22rL41rL42_cSNV_post_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X22rL41rL42_tSNV_post_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X22rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X22rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X22rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X22rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X22rL41rL42_cSNV_rna_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X22rL41rL42_tSNV_rna_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X22rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X22rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X22rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X22rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X22rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X22rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X22rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X22rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X22rL41_cors <- c("X22rL41",X22rL41_cSNV_pre_lib_cors,X22rL41_tSNV_pre_lib_cors,X22rL41_cSNV_post_lib_cors,X22rL41_tSNV_post_lib_cors,X22rL41_cSNV_post_pre_cors,X22rL41_tSNV_post_pre_cors,X22rL41_cSNV_rna_lib_cors,X22rL41_tSNV_rna_lib_cors,X22rL41_cSNV_rna_pre_cors,X22rL41_tSNV_rna_pre_cors,X22rL41rL42_cSNV_pre_cors,X22rL41rL42_tSNV_pre_cors,X22rL41rL42_cSNV_pre_lib_ratio_cors,X22rL41rL42_tSNV_pre_lib_ratio_cors,X22rL41rL42_cSNV_post_cors,X22rL41rL42_tSNV_post_cors,X22rL41rL42_cSNV_post_lib_ratio_cors,X22rL41rL42_tSNV_post_lib_ratio_cors,X22rL41rL42_cSNV_post_pre_ratio_cors,X22rL41rL42_tSNV_post_pre_ratio_cors,X22rL41rL42_cSNV_rna_cors,X22rL41rL42_tSNV_rna_cors,X22rL41rL42_tSNV_rna_pre_ratio_cors,X22rL41_cSNV_pre_lib_ratio_cadd_cors,X22rL41_tSNV_pre_lib_ratio_cadd_cors,X22rL41_cSNV_post_lib_ratio_cadd_cors,X22rL41_tSNV_post_lib_ratio_cadd_cors,X22rL41_cSNV_post_pre_ratio_cadd_cors,X22rL41_tSNV_post_pre_ratio_cadd_cors,X22rL41_cSNV_post_pre_ratio_cadd_missense_cors,X22rL41_tSNV_post_pre_ratio_cadd_missense_cors,X22rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X22rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X22rL41_cSNV_post_pre_ratio_grantham_missense_cors,X22rL41_tSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X22rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X22rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X22rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X22rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X22rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X22rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X22rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X22rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X22rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X22rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X22rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X22rL42_cSNV_pre_lib_cors = cor(log2(X22rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22rL42_tSNV_pre_lib_cors = cor(log2(X22rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22rL42_cSNV_post_lib_cors = cor(log2(X22rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X22rL42_tSNV_post_lib_cors = cor(log2(X22rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X22rL42_cSNV_post_pre_cors = cor(log2(X22rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X22rL42_tSNV_post_pre_cors = cor(log2(X22rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X22rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X22rL42_cSNV_rna_lib_cors = cor(log2(X22rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X22rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22rL42_tSNV_rna_lib_cors = cor(log2(X22rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X22rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X22rL42_cSNV_rna_pre_cors = cor(log2(X22rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X22rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X22rL42_tSNV_rna_pre_cors = cor(log2(X22rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X22rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X22rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X22rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X22rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X22rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X22rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X22rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X22rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X22rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X22rL42_cors <- c("X22rL42",X22rL42_cSNV_pre_lib_cors,X22rL42_tSNV_pre_lib_cors,X22rL42_cSNV_post_lib_cors,X22rL42_tSNV_post_lib_cors,X22rL42_cSNV_post_pre_cors,X22rL42_tSNV_post_pre_cors,X22rL42_cSNV_rna_lib_cors,X22rL42_tSNV_rna_lib_cors,X22rL42_cSNV_rna_pre_cors,X22rL42_tSNV_rna_pre_cors,X22rL41rL42_cSNV_pre_cors,X22rL41rL42_tSNV_pre_cors,X22rL41rL42_cSNV_pre_lib_ratio_cors,X22rL41rL42_tSNV_pre_lib_ratio_cors,X22rL41rL42_cSNV_post_cors,X22rL41rL42_tSNV_post_cors,X22rL41rL42_cSNV_post_lib_ratio_cors,X22rL41rL42_tSNV_post_lib_ratio_cors,X22rL41rL42_cSNV_post_pre_ratio_cors,X22rL41rL42_tSNV_post_pre_ratio_cors,X22rL41rL42_cSNV_rna_cors,X22rL41rL42_tSNV_rna_cors,X22rL41rL42_tSNV_rna_pre_ratio_cors,X22rL42_cSNV_pre_lib_ratio_cadd_cors,X22rL42_tSNV_pre_lib_ratio_cadd_cors,X22rL42_cSNV_post_lib_ratio_cadd_cors,X22rL42_tSNV_post_lib_ratio_cadd_cors,X22rL42_cSNV_post_pre_ratio_cadd_cors,X22rL42_tSNV_post_pre_ratio_cadd_cors,X22rL42_cSNV_post_pre_ratio_cadd_missense_cors,X22rL42_tSNV_post_pre_ratio_cadd_missense_cors,X22rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X22rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X22rL42_cSNV_post_pre_ratio_grantham_missense_cors,X22rL42_tSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X22rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X22rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X22rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X22rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X22rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X22rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X22rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X22rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X22rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X22rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X22rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X22rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X22rL41)
rm(X22rL42)
gc()
X23rL41_file <- paste(experiment_dir_170731,'X23rL41','_annotated.txt',sep='')
X23rL42_file <- paste(experiment_dir_170731,'X23rL42','_annotated.txt',sep='')
X23rL41 <- read.table(X23rL41_file, header=TRUE, sep="\t")
X23rL42 <- read.table(X23rL42_file, header=TRUE, sep="\t")

#which p_hdr_read to use? get from editing info file
editing_info_X23 <- editing_info[which(editing_info$amplicon == 'X23'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
X23_HDR_5_SNV = as.character(editing_info_X23$HDR_5_SNV)
X23_HDR_3_SNV = as.character(editing_info_X23$HDR_3_SNV)
#X23_cut_pos = as.character(editing_info_X23$cut_pos)
X23_cut_end = as.character(editing_info_X23$cut_end)
X23_mut_start = as.character(editing_info_X23$mut_start)
X23_mut_end = as.character(editing_info_X23$mut_end)
### Replicate 1
X23rL41_cSNV_all <- which(X23rL41[,'c_hdr_snv']=='True')
X23rL41_cSNV_all_df = X23rL41[X23rL41_cSNV_all,]
X23rL41_prog_var_all <- which(X23rL41[,'all_hdr_variant']=='True' & X23rL41[,'edit_string']!='-WT')
X23rL41_prog_var_all_df = X23rL41[X23rL41_prog_var_all,]
X23rL41_prog_map_all = which(X23rL41_prog_var_all_df[,'pos']!='REF')
X23rL41_prog_map_all_df = X23rL41_prog_var_all_df[X23rL41_prog_map_all,]
X23rL41_prog_map_exon_all = which(X23rL41_prog_map_all_df[,'cDNApos']!='REF' & X23rL41_prog_map_all_df[,'cDNApos']!='NA')
X23rL41_prog_map_exon_all_df = X23rL41_prog_map_all_df[X23rL41_prog_map_exon_all,]
X23rL41_prog_map_CADD = which(X23rL41_prog_map_all_df[,'CADD.phred']!='NA')
X23rL41_prog_map_CADD_df = X23rL41_prog_map_all_df[X23rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X23rL41_prog_var_thresh5 <- which(as.numeric(as.character(X23rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
X23rL41_prog_var_thresh5_df = X23rL41_prog_var_all_df[X23rL41_prog_var_thresh5,]
X23rL41_prog_map_thresh5 <- which(as.numeric(as.character(X23rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
X23rL41_prog_map_thresh5_df = X23rL41_prog_map_all_df[X23rL41_prog_map_thresh5,]
X23rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(X23rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X23rL41_prog_map_exon_thresh5_df = X23rL41_prog_map_exon_all_df[X23rL41_prog_map_exon_thresh5,]
X23rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X23rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X23rL41_prog_map_CADD_thresh5_df = X23rL41_prog_map_CADD_df[X23rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X23rL41_prog_var_all_lib_count = length(X23rL41_prog_var_all_df$lib)
X23rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
X23rL41_prog_var_all_min_lib_counts = min(X23rL41_prog_var_all_df$lib)
X23rL41_prog_var_all_min_lib_counts
X23rL41_prog_var_all_max_lib_counts = max(X23rL41_prog_var_all_df$lib)
X23rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X23rL41_prog_map_all_lib_count = length(X23rL41_prog_map_all_df$lib)
X23rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
X23rL41_prog_map_all_min_lib_counts = min(X23rL41_prog_map_all_df$lib)
X23rL41_prog_map_all_min_lib_counts
X23rL41_prog_map_all_max_lib_counts = max(X23rL41_prog_map_all_df$lib)
X23rL41_prog_map_all_max_lib_counts

# r1 histograms of lib counts
X23rL41_prog_map_all_hist_lib
# r1 Position vs. lib SNV coverage
X23rL41_prog_map_all_lib_pos

# r1 Number of pre 'SNV variants' --> out of all programmed.
X23rL41_prog_var_all_pre_count = length(X23rL41_prog_var_all_df$pre)
X23rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
X23rL41_prog_var_all_min_pre_counts = min(X23rL41_prog_var_all_df$pre)
X23rL41_prog_var_all_min_pre_counts
X23rL41_prog_var_all_max_pre_counts = max(X23rL41_prog_var_all_df$pre)
X23rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X23rL41_prog_map_all_pre_count = length(X23rL41_prog_map_all_df$pre)
X23rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
X23rL41_prog_map_all_min_pre_counts = min(X23rL41_prog_map_all_df$pre)
X23rL41_prog_map_all_min_pre_counts
X23rL41_prog_map_all_max_pre_counts = max(X23rL41_prog_map_all_df$pre)
X23rL41_prog_map_all_max_pre_counts

# r1 histograms of pre counts prog_map
X23rL41_prog_map_all_hist_pre

# r1 Position vs. pre SNV coverage
X23rL41_prog_map_all_pre_pos

# r1 Number of post 'SNV variants'
X23rL41_prog_map_all_post_count = length(X23rL41_prog_map_all_df$post)
X23rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
X23rL41_prog_map_all_min_post_counts = min(X23rL41_prog_map_all_df$post)
X23rL41_prog_map_all_min_post_counts
X23rL41_prog_map_all_max_post_counts = max(X23rL41_prog_map_all_df$post)
X23rL41_prog_map_all_max_post_counts

# r1 histograms of post counts
X23rL41_prog_map_all_hist_post

# r1 Position vs. post SNV coverage
X23rL41_prog_map_all_post_pos

# r1 Now using tHDR frequencies instead (for RNA):
X23rL41_prog_map_all_syn_df <- X23rL41_prog_map_all_df[which(X23rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X23rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X23rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X23rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(X23rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X23rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X23rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
X23rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(X23rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 histograms of tHDR_pre_pseudo_freq counts prog_map
X23rL41_prog_map_all_hist_tHDR_pre_pseudo_freq
# r1 Position vs. tHDR_pre_pseudo_freq SNV coverage
X23rL41_prog_map_all_tHDR_pre_pseudo_freq_pos

# r1 histograms of tHDR_post_pseudo_freq counts
X23rL41_prog_map_all_hist_tHDR_post_pseudo_freq

# r1 Position vs. tHDR_post_pseudo_freq SNV coverage
X23rL41_prog_map_all_tHDR_post_pseudo_freq_pos

# r1 Max and min tHDR_rna reads for each prog_map
X23rL41_prog_map_all_min_rna_counts = min(X23rL41_prog_map_exon_all_df$tHDR_rna)
X23rL41_prog_map_all_min_rna_counts
X23rL41_prog_map_all_max_rna_counts = max(X23rL41_prog_map_exon_all_df$tHDR_rna)
X23rL41_prog_map_all_max_rna_counts
X23rL41_prog_map_all_min_rna_pseudo_freq = min(X23rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23rL41_prog_map_all_min_rna_pseudo_freq
X23rL41_prog_map_all_max_rna_pseudo_freq = max(X23rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23rL41_prog_map_all_max_rna_pseudo_freq
X23rL41_prog_map_all_min_rna_pre_ratio = min(X23rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23rL41_prog_map_all_min_rna_pre_ratio
X23rL41_prog_map_all_max_rna_pre_ratio = max(X23rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23rL41_prog_map_all_max_rna_pre_ratio
X23rL41_prog_map_all_min_rna_post_ratio = min(X23rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23rL41_prog_map_all_min_rna_post_ratio
X23rL41_prog_map_all_max_rna_post_ratio = max(X23rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23rL41_prog_map_all_max_rna_post_ratio

# r1 histograms of tHDR_rna_pseudo_freq counts
X23rL41_prog_map_all_hist_tHDR_rna_pseudo_freq

# r1 Position vs. tHDR_rna_pseudo_freq SNV coverage
X23rL41_prog_map_all_tHDR_rna_pseudo_freq_pos

# r1 histograms of tHDR_rna_pre_ratio
X23rL41_prog_map_all_hist_tHDR_rna_pre_ratio

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn.
X23rL41_prog_map_all_tHDR_rna_pre_ratio_pos

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size
X23rL41_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_pre_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 histograms of tHDR_rna_post_ratio
X23rL41_prog_map_all_hist_tHDR_rna_post_ratio

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn.
X23rL41_prog_map_all_tHDR_rna_post_ratio_pos
# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size
X23rL41_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with size and conseq line (alpha = 0.3)

# r1 Position vs. tHDR_rna_post_ratio SNV coverage # r1 normalized to median syn. with conseq line (alpha = 0.3)

# r1 tHDR_rna_freq vs. tHDR_pre_freq
# r1 tHDR_rna_freq vs. tHDR_post_freq

# r1 tHDR_rna_pre_ratio as a function of pre reads

# r1 tHDR_rna_post_ratio as a function of post reads

# r1 check correlation between different experimental samples:
cor(log2(X23rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_post_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X23rL41_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X23rL41_prog_map_all_df$post_pre_ratio),log2(X23rL41_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_post_pre_ratio),log2(X23rL41_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23rL41_prog_map_all_df$tHDR_post_lib_ratio),log2(X23rL41_prog_map_all_df$post_lib_ratio),method='spearman')

# r1 switching to the df with CADD scores to make correlations with CADD
cor(log2(X23rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X23rL41_cSNV_all_corr_pre_count = length(X23rL41_cSNV_all_df$corr_pre)
X23rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
X23rL41_cSNV_all_min_corr_pre_counts = min(X23rL41_cSNV_all_df$corr_pre)
X23rL41_cSNV_all_min_corr_pre_counts
X23rL41_cSNV_all_max_corr_pre_counts = max(X23rL41_cSNV_all_df$corr_pre)
X23rL41_cSNV_all_max_corr_pre_counts
# r1 pre counts vs. corr_pre counts:
X23rL41_cSNV_all_pre_corr_pre
# r1 histogram of corr_pre counts cSNV
X23rL41_cSNV_all_hist_corr_pre
# r1 position vs. corr_pre SNV coverage
X23rL41_cSNV_all_corr_pre_pos
# r1 pre minus corr_pre by position
X23rL41_cSNV_all_pre_corr_pre_diff_pos
# r1 pre minus corr_pre by position
X23rL41_cSNV_all_pre_corr_pre_diff_pos_w_size

# r1 Number of corr_post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_cSNV_all_corr_post_count = length(X23rL41_cSNV_all_df$corr_post)
X23rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
X23rL41_cSNV_all_min_corr_post_counts = min(X23rL41_cSNV_all_df$corr_post)
X23rL41_cSNV_all_min_corr_post_counts
X23rL41_cSNV_all_max_corr_post_counts = max(X23rL41_cSNV_all_df$corr_post)
X23rL41_cSNV_all_max_corr_post_counts

# r1 post counts vs. corr_post counts:
X23rL41_cSNV_all_post_corr_post
# r1 histogram of corr_post counts cSNV
X23rL41_cSNV_all_hist_corr_post
# r1 Position vs. corr_post SNV coverage
X23rL41_cSNV_all_corr_post_pos
# r1 post minus corr_post by position
X23rL41_cSNV_all_post_corr_post_diff_pos
# r1 post minus corr_post by position
X23rL41_cSNV_all_post_corr_post_diff_pos_w_size
# r1 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r1 looking for a dramatic drop here
X23rL41_cSNV_all_pre_corr_pre_zoom

# r1 repeat with pSNV variants (only cut end is edited!)
X23_p_hdr_snv = paste('p_hdr_',X23_cut_end,'_snv',sep='')
X23rL41_pSNV_all <- which(X23rL41[,X23_p_hdr_snv]=='True')
X23rL41_pSNV_all_df = X23rL41[X23rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_pSNV_all_lib_count = length(X23rL41_pSNV_all_df$lib)
X23rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
X23rL41_pSNV_all_min_lib_counts = min(X23rL41_pSNV_all_df$lib)
X23rL41_pSNV_all_min_lib_counts
X23rL41_pSNV_all_max_lib_counts = max(X23rL41_pSNV_all_df$lib)
X23rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
X23rL41_pSNV_all_pre_count = length(X23rL41_pSNV_all_df$pre)
X23rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
X23rL41_pSNV_all_min_pre_counts = min(X23rL41_pSNV_all_df$pre)
X23rL41_pSNV_all_min_pre_counts
X23rL41_pSNV_all_max_pre_counts = max(X23rL41_pSNV_all_df$pre)
X23rL41_pSNV_all_max_pre_counts
# r1 histograms of pre counts pSNV
X23rL41_pSNV_all_hist_pre
# r1 Position vs. pre SNV coverage
X23rL41_pSNV_all_pre_pos
# r1 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_pSNV_all_post_count = length(X23rL41_pSNV_all_df$post)
X23rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
X23rL41_pSNV_all_min_post_counts = min(X23rL41_pSNV_all_df$post)
X23rL41_pSNV_all_min_post_counts
X23rL41_pSNV_all_max_post_counts = max(X23rL41_pSNV_all_df$post)
X23rL41_pSNV_all_max_post_counts
# r1 histograms of post counts
X23rL41_pSNV_all_hist_post
# r1 Position vs. post SNV coverage
X23rL41_pSNV_all_post_pos

# r1 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r1 Number of 'cSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_prog_map_thresh5_lib_count = length(X23rL41_prog_map_thresh5_df$lib)
X23rL41_prog_map_thresh5_lib_count
X23rL41_prog_map_thresh5_min_lib_counts = min(X23rL41_prog_map_thresh5_df$lib)
X23rL41_prog_map_thresh5_min_lib_counts
X23rL41_prog_map_thresh5_max_lib_counts = max(X23rL41_prog_map_thresh5_df$lib)
X23rL41_prog_map_thresh5_max_lib_counts
# r1 histograms of lib counts
X23rL41_prog_map_thresh5_hist_lib
# r1 Position vs. lib SNV coverage
X23rL41_prog_map_thresh5_lib_pos
# r1 Number of pre 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_prog_map_thresh5_pre_count = length(X23rL41_prog_map_thresh5_df$pre)
X23rL41_prog_map_thresh5_pre_count
X23rL41_prog_map_thresh5_min_pre_counts = min(X23rL41_prog_map_thresh5_df$pre)
X23rL41_prog_map_thresh5_min_pre_counts
X23rL41_prog_map_thresh5_max_pre_counts = max(X23rL41_prog_map_thresh5_df$pre)
X23rL41_prog_map_thresh5_max_pre_counts
# r1 pre counts vs. corr_pre counts:
# r1 histogram of corr_pre counts prog_map
# r1 Position vs. pre SNV coverage
# r1 Position vs. corr_pre SNV coverage
# r1 pre minus corr_pre by position
# r1 pre minus corr_pre by position with size
# r1 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL41_prog_map_thresh5_post_count = length(X23rL41_prog_map_thresh5_df$post)
X23rL41_prog_map_thresh5_post_count
X23rL41_prog_map_thresh5_min_post_counts = min(X23rL41_prog_map_thresh5_df$post)
X23rL41_prog_map_thresh5_min_post_counts
X23rL41_prog_map_thresh5_max_post_counts = max(X23rL41_prog_map_thresh5_df$post)
X23rL41_prog_map_thresh5_max_post_counts
X23rL41_prog_map_thresh5_corr_post_count = length(X23rL41_cSNV_all_df$corr_post)
X23rL41_prog_map_thresh5_corr_post_count
X23rL41_prog_map_thresh5_min_corr_post_counts = min(X23rL41_cSNV_all_df$corr_post)
X23rL41_prog_map_thresh5_min_corr_post_counts
X23rL41_prog_map_thresh5_max_corr_post_counts = max(X23rL41_cSNV_all_df$corr_post)
X23rL41_prog_map_thresh5_max_corr_post_counts
# r1 post counts vs. corr_post counts:
# r1 histograms of post counts
# r1 histogram of corr_post counts prog_map
# r1 Position vs. post SNV coverage
# r1 Position vs. corr_post SNV coverage
# r1 post minus corr_post by position
# r1 post minus corr_post by position
# r1 looking for a dramatic drop here
X23rL41_pSNV_thresh5 <- which(X23rL41[,X23_p_hdr_snv]=='True' & as.numeric(as.character(X23rL41[,'pre_freq']))>=0.00001)
X23rL41_pSNV_thresh5_df = X23rL41[X23rL41_pSNV_thresh5,]
X23rL41_pSNV_thresh5_lib_count = length(X23rL41_pSNV_thresh5_df$lib)
X23rL41_pSNV_thresh5_lib_count
X23rL41_pSNV_thresh5_min_lib_counts = min(X23rL41_pSNV_thresh5_df$lib)
X23rL41_pSNV_thresh5_min_lib_counts
X23rL41_pSNV_thresh5_max_lib_counts = max(X23rL41_pSNV_thresh5_df$lib)
X23rL41_pSNV_thresh5_max_lib_counts
X23rL41_pSNV_thresh5_pre_count = length(X23rL41_pSNV_thresh5_df$pre)
X23rL41_pSNV_thresh5_pre_count
X23rL41_pSNV_thresh5_min_pre_counts = min(X23rL41_pSNV_thresh5_df$pre)
X23rL41_pSNV_thresh5_min_pre_counts
X23rL41_pSNV_thresh5_max_pre_counts = max(X23rL41_pSNV_thresh5_df$pre)
X23rL41_pSNV_thresh5_max_pre_counts
# r1 histograms of pre counts pSNV
# r1 Position vs. pre pSNV coverage
X23rL41_pSNV_thresh5_post_count = length(X23rL41_pSNV_thresh5_df$post)
X23rL41_pSNV_thresh5_post_count
X23rL41_pSNV_thresh5_min_post_counts = min(X23rL41_pSNV_thresh5_df$post)
X23rL41_pSNV_thresh5_min_post_counts
X23rL41_pSNV_thresh5_max_post_counts = max(X23rL41_pSNV_thresh5_df$post)
X23rL41_pSNV_thresh5_max_post_counts
# r1 histograms of post counts
X23rL41_pSNV_thresh5_hist_post
# r1 Position vs. post SNV coverage
X23rL41_pSNV_thresh5_post_pos

### Replicate 2
X23rL42_cSNV_all <- which(X23rL42[,'c_hdr_snv']=='True')
X23rL42_cSNV_all_df = X23rL42[X23rL42_cSNV_all,]
X23rL42_prog_var_all <- which(X23rL42[,'all_hdr_variant']=='True' & X23rL42[,'edit_string']!='-WT')
X23rL42_prog_var_all_df = X23rL42[X23rL42_prog_var_all,]
X23rL42_prog_map_all = which(X23rL42_prog_var_all_df[,'pos']!='REF')
X23rL42_prog_map_all_df = X23rL42_prog_var_all_df[X23rL42_prog_map_all,]
X23rL42_prog_map_exon_all = which(X23rL42_prog_map_all_df[,'cDNApos']!='REF' & X23rL42_prog_map_all_df[,'cDNApos']!='NA')
X23rL42_prog_map_exon_all_df = X23rL42_prog_map_all_df[X23rL42_prog_map_exon_all,]
X23rL42_prog_map_CADD = which(X23rL42_prog_map_all_df[,'CADD.phred']!='NA')
X23rL42_prog_map_CADD_df = X23rL42_prog_map_all_df[X23rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
X23rL42_prog_var_thresh5 <- which(as.numeric(as.character(X23rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
X23rL42_prog_var_thresh5_df = X23rL42_prog_var_all_df[X23rL42_prog_var_thresh5,]
X23rL42_prog_map_thresh5 <- which(as.numeric(as.character(X23rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
X23rL42_prog_map_thresh5_df = X23rL42_prog_map_all_df[X23rL42_prog_map_thresh5,]
X23rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(X23rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
X23rL42_prog_map_exon_thresh5_df = X23rL42_prog_map_exon_all_df[X23rL42_prog_map_exon_thresh5,]
X23rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(X23rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
X23rL42_prog_map_CADD_thresh5_df = X23rL42_prog_map_CADD_df[X23rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
X23rL42_prog_var_all_lib_count = length(X23rL42_prog_var_all_df$lib)
X23rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
X23rL42_prog_var_all_min_lib_counts = min(X23rL42_prog_var_all_df$lib)
X23rL42_prog_var_all_min_lib_counts
X23rL42_prog_var_all_max_lib_counts = max(X23rL42_prog_var_all_df$lib)
X23rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
X23rL42_prog_map_all_lib_count = length(X23rL42_prog_map_all_df$lib)
X23rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
X23rL42_prog_map_all_min_lib_counts = min(X23rL42_prog_map_all_df$lib)
X23rL42_prog_map_all_min_lib_counts
X23rL42_prog_map_all_max_lib_counts = max(X23rL42_prog_map_all_df$lib)
X23rL42_prog_map_all_max_lib_counts

# r2 histograms of lib counts
X23rL42_prog_map_all_hist_lib
# r2 Position vs. lib SNV coverage
X23rL42_prog_map_all_lib_pos

# r2 Number of pre 'SNV variants' --> out of all programmed.
X23rL42_prog_var_all_pre_count = length(X23rL42_prog_var_all_df$pre)
X23rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
X23rL42_prog_var_all_min_pre_counts = min(X23rL42_prog_var_all_df$pre)
X23rL42_prog_var_all_min_pre_counts
X23rL42_prog_var_all_max_pre_counts = max(X23rL42_prog_var_all_df$pre)
X23rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
X23rL42_prog_map_all_pre_count = length(X23rL42_prog_map_all_df$pre)
X23rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
X23rL42_prog_map_all_min_pre_counts = min(X23rL42_prog_map_all_df$pre)
X23rL42_prog_map_all_min_pre_counts
X23rL42_prog_map_all_max_pre_counts = max(X23rL42_prog_map_all_df$pre)
X23rL42_prog_map_all_max_pre_counts

# r2 histograms of pre counts prog_map
X23rL42_prog_map_all_hist_pre

# r2 Position vs. pre SNV coverage
X23rL42_prog_map_all_pre_pos

# r2 Number of post 'SNV variants'
X23rL42_prog_map_all_post_count = length(X23rL42_prog_map_all_df$post)
X23rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
X23rL42_prog_map_all_min_post_counts = min(X23rL42_prog_map_all_df$post)
X23rL42_prog_map_all_min_post_counts
X23rL42_prog_map_all_max_post_counts = max(X23rL42_prog_map_all_df$post)
X23rL42_prog_map_all_max_post_counts

# r2 histograms of post counts
X23rL42_prog_map_all_hist_post

# r2 Position vs. post SNV coverage
X23rL42_prog_map_all_post_pos

# r2 Now using tHDR frequencies instead (for RNA):
X23rL42_prog_map_all_syn_df <- X23rL42_prog_map_all_df[which(X23rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
X23rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(X23rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
X23rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(X23rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
X23rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(X23rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
X23rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(X23rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 histograms of tHDR_pre_pseudo_freq counts prog_map
X23rL42_prog_map_all_hist_tHDR_pre_pseudo_freq
# r2 Position vs. tHDR_pre_pseudo_freq SNV coverage
X23rL42_prog_map_all_tHDR_pre_pseudo_freq_pos

# r2 histograms of tHDR_post_pseudo_freq counts
X23rL42_prog_map_all_hist_tHDR_post_pseudo_freq

# r2 Position vs. tHDR_post_pseudo_freq SNV coverage
X23rL42_prog_map_all_tHDR_post_pseudo_freq_pos

# r2 Max and min tHDR_rna reads for each prog_map
X23rL42_prog_map_all_min_rna_counts = min(X23rL42_prog_map_exon_all_df$tHDR_rna)
X23rL42_prog_map_all_min_rna_counts
X23rL42_prog_map_all_max_rna_counts = max(X23rL42_prog_map_exon_all_df$tHDR_rna)
X23rL42_prog_map_all_max_rna_counts
X23rL42_prog_map_all_min_rna_pseudo_freq = min(X23rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23rL42_prog_map_all_min_rna_pseudo_freq
X23rL42_prog_map_all_max_rna_pseudo_freq = max(X23rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
X23rL42_prog_map_all_max_rna_pseudo_freq
X23rL42_prog_map_all_min_rna_pre_ratio = min(X23rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23rL42_prog_map_all_min_rna_pre_ratio
X23rL42_prog_map_all_max_rna_pre_ratio = max(X23rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
X23rL42_prog_map_all_max_rna_pre_ratio
X23rL42_prog_map_all_min_rna_post_ratio = min(X23rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23rL42_prog_map_all_min_rna_post_ratio
X23rL42_prog_map_all_max_rna_post_ratio = max(X23rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
X23rL42_prog_map_all_max_rna_post_ratio

# r2 histograms of tHDR_rna_pseudo_freq counts
X23rL42_prog_map_all_hist_tHDR_rna_pseudo_freq

# r2 Position vs. tHDR_rna_pseudo_freq SNV coverage
X23rL42_prog_map_all_tHDR_rna_pseudo_freq_pos

# r2 histograms of tHDR_rna_pre_ratio
X23rL42_prog_map_all_hist_tHDR_rna_pre_ratio

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn.
X23rL42_prog_map_all_tHDR_rna_pre_ratio_pos

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size
X23rL42_prog_map_all_tHDR_rna_pre_ratio_pos_w_size

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_pre_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 histograms of tHDR_rna_post_ratio
X23rL42_prog_map_all_hist_tHDR_rna_post_ratio

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn.
X23rL42_prog_map_all_tHDR_rna_post_ratio_pos
# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size
X23rL42_prog_map_all_tHDR_rna_post_ratio_pos_w_size

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with size and conseq line (alpha = 0.3)

# r2 Position vs. tHDR_rna_post_ratio SNV coverage # r2 normalized to median syn. with conseq line (alpha = 0.3)

# r2 tHDR_rna_freq vs. tHDR_pre_freq
# r2 tHDR_rna_freq vs. tHDR_post_freq

# r2 tHDR_rna_pre_ratio as a function of pre reads

# r2 tHDR_rna_post_ratio as a function of post reads

# r2 check correlation between different experimental samples:
cor(log2(X23rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_post_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_rna_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_pre_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_post_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_rna_pseudo_freq),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_all_df$tHDR_post_pre_ratio),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X23rL42_prog_map_all_df$tHDR_post_lib_ratio),method='spearman')
cor(log2(X23rL42_prog_map_all_df$post_pre_ratio),log2(X23rL42_prog_map_all_df$post_lib_ratio),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_post_pre_ratio),log2(X23rL42_prog_map_all_df$post_pre_ratio),method='spearman')
cor(log2(X23rL42_prog_map_all_df$tHDR_post_lib_ratio),log2(X23rL42_prog_map_all_df$post_lib_ratio),method='spearman')

# r2 switching to the df with CADD scores to make correlations with CADD
cor(log2(X23rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
cor(log2(X23rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')

# r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
X23rL42_cSNV_all_corr_pre_count = length(X23rL42_cSNV_all_df$corr_pre)
X23rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
X23rL42_cSNV_all_min_corr_pre_counts = min(X23rL42_cSNV_all_df$corr_pre)
X23rL42_cSNV_all_min_corr_pre_counts
X23rL42_cSNV_all_max_corr_pre_counts = max(X23rL42_cSNV_all_df$corr_pre)
X23rL42_cSNV_all_max_corr_pre_counts
# r2 pre counts vs. corr_pre counts:
X23rL42_cSNV_all_pre_corr_pre
# r2 histogram of corr_pre counts cSNV
X23rL42_cSNV_all_hist_corr_pre
# r2 position vs. corr_pre SNV coverage
X23rL42_cSNV_all_corr_pre_pos
# r2 pre minus corr_pre by position
X23rL42_cSNV_all_pre_corr_pre_diff_pos
# r2 pre minus corr_pre by position
X23rL42_cSNV_all_pre_corr_pre_diff_pos_w_size

# r2 Number of corr_post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_cSNV_all_corr_post_count = length(X23rL42_cSNV_all_df$corr_post)
X23rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
X23rL42_cSNV_all_min_corr_post_counts = min(X23rL42_cSNV_all_df$corr_post)
X23rL42_cSNV_all_min_corr_post_counts
X23rL42_cSNV_all_max_corr_post_counts = max(X23rL42_cSNV_all_df$corr_post)
X23rL42_cSNV_all_max_corr_post_counts

# r2 post counts vs. corr_post counts:
X23rL42_cSNV_all_post_corr_post
# r2 histogram of corr_post counts cSNV
X23rL42_cSNV_all_hist_corr_post
# r2 Position vs. corr_post SNV coverage
X23rL42_cSNV_all_corr_post_pos
# r2 post minus corr_post by position
X23rL42_cSNV_all_post_corr_post_diff_pos
# r2 post minus corr_post by position
X23rL42_cSNV_all_post_corr_post_diff_pos_w_size
# r2 apply threshold to determined by frequency OR somehow by error correction for low counts...
# r2 looking for a dramatic drop here
X23rL42_cSNV_all_pre_corr_pre_zoom

# r2 repeat with pSNV variants (only cut end is edited!)
X23_p_hdr_snv = paste('p_hdr_',X23_cut_end,'_snv',sep='')
X23rL42_pSNV_all <- which(X23rL42[,X23_p_hdr_snv]=='True')
X23rL42_pSNV_all_df = X23rL42[X23rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_pSNV_all_lib_count = length(X23rL42_pSNV_all_df$lib)
X23rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
X23rL42_pSNV_all_min_lib_counts = min(X23rL42_pSNV_all_df$lib)
X23rL42_pSNV_all_min_lib_counts
X23rL42_pSNV_all_max_lib_counts = max(X23rL42_pSNV_all_df$lib)
X23rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
X23rL42_pSNV_all_pre_count = length(X23rL42_pSNV_all_df$pre)
X23rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
X23rL42_pSNV_all_min_pre_counts = min(X23rL42_pSNV_all_df$pre)
X23rL42_pSNV_all_min_pre_counts
X23rL42_pSNV_all_max_pre_counts = max(X23rL42_pSNV_all_df$pre)
X23rL42_pSNV_all_max_pre_counts
# r2 histograms of pre counts pSNV
X23rL42_pSNV_all_hist_pre
# r2 Position vs. pre SNV coverage
X23rL42_pSNV_all_pre_pos
# r2 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_pSNV_all_post_count = length(X23rL42_pSNV_all_df$post)
X23rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
X23rL42_pSNV_all_min_post_counts = min(X23rL42_pSNV_all_df$post)
X23rL42_pSNV_all_min_post_counts
X23rL42_pSNV_all_max_post_counts = max(X23rL42_pSNV_all_df$post)
X23rL42_pSNV_all_max_post_counts
# r2 histograms of post counts
X23rL42_pSNV_all_hist_post
# r2 Position vs. post SNV coverage
X23rL42_pSNV_all_post_pos

# r2 Plots for thresholded data ('thresh5' indicates 1 in 1e5 or higher freq.):
# r2 Number of 'cSNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_prog_map_thresh5_lib_count = length(X23rL42_prog_map_thresh5_df$lib)
X23rL42_prog_map_thresh5_lib_count
X23rL42_prog_map_thresh5_min_lib_counts = min(X23rL42_prog_map_thresh5_df$lib)
X23rL42_prog_map_thresh5_min_lib_counts
X23rL42_prog_map_thresh5_max_lib_counts = max(X23rL42_prog_map_thresh5_df$lib)
X23rL42_prog_map_thresh5_max_lib_counts
# r2 histograms of lib counts
X23rL42_prog_map_thresh5_hist_lib
# r2 Position vs. lib SNV coverage
X23rL42_prog_map_thresh5_lib_pos
# r2 Number of pre 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_prog_map_thresh5_pre_count = length(X23rL42_prog_map_thresh5_df$pre)
X23rL42_prog_map_thresh5_pre_count
X23rL42_prog_map_thresh5_min_pre_counts = min(X23rL42_prog_map_thresh5_df$pre)
X23rL42_prog_map_thresh5_min_pre_counts
X23rL42_prog_map_thresh5_max_pre_counts = max(X23rL42_prog_map_thresh5_df$pre)
X23rL42_prog_map_thresh5_max_pre_counts
# r2 pre counts vs. corr_pre counts:
# r2 histogram of corr_pre counts prog_map
# r2 Position vs. pre SNV coverage
# r2 Position vs. corr_pre SNV coverage
# r2 pre minus corr_pre by position
# r2 pre minus corr_pre by position with size
# r2 Number of post 'SNV variants' --> will be 2X23 less than SGE region length x 3 due to PAM edits
X23rL42_prog_map_thresh5_post_count = length(X23rL42_prog_map_thresh5_df$post)
X23rL42_prog_map_thresh5_post_count
X23rL42_prog_map_thresh5_min_post_counts = min(X23rL42_prog_map_thresh5_df$post)
X23rL42_prog_map_thresh5_min_post_counts
X23rL42_prog_map_thresh5_max_post_counts = max(X23rL42_prog_map_thresh5_df$post)
X23rL42_prog_map_thresh5_max_post_counts
X23rL42_prog_map_thresh5_corr_post_count = length(X23rL42_prog_map_thresh5_df$corr_post)
X23rL42_prog_map_thresh5_corr_post_count
X23rL42_prog_map_thresh5_min_corr_post_counts = min(X23rL42_prog_map_thresh5_df$corr_post)
X23rL42_prog_map_thresh5_min_corr_post_counts
X23rL42_prog_map_thresh5_max_corr_post_counts = max(X23rL42_prog_map_thresh5_df$corr_post)
X23rL42_prog_map_thresh5_max_corr_post_counts
# r2 post counts vs. corr_post counts:
# r2 histograms of post counts
# r2 histogram of corr_post counts prog_map
# r2 Position vs. post SNV coverage
# r2 Position vs. corr_post SNV coverage
# r2 post minus corr_post by position
# r2 post minus corr_post by position
# r2 looking for a dramatic drop here
X23rL42_pSNV_thresh5 <- which(X23rL42[,X23_p_hdr_snv]=='True' & as.numeric(as.character(X23rL42[,'pre_freq']))>=0.00001)
X23rL42_pSNV_thresh5_df = X23rL42[X23rL42_pSNV_thresh5,]
X23rL42_pSNV_thresh5_lib_count = length(X23rL42_pSNV_thresh5_df$lib)
X23rL42_pSNV_thresh5_lib_count
X23rL42_pSNV_thresh5_min_lib_counts = min(X23rL42_pSNV_thresh5_df$lib)
X23rL42_pSNV_thresh5_min_lib_counts
X23rL42_pSNV_thresh5_max_lib_counts = max(X23rL42_pSNV_thresh5_df$lib)
X23rL42_pSNV_thresh5_max_lib_counts
X23rL42_pSNV_thresh5_pre_count = length(X23rL42_pSNV_thresh5_df$pre)
X23rL42_pSNV_thresh5_pre_count
X23rL42_pSNV_thresh5_min_pre_counts = min(X23rL42_pSNV_thresh5_df$pre)
X23rL42_pSNV_thresh5_min_pre_counts
X23rL42_pSNV_thresh5_max_pre_counts = max(X23rL42_pSNV_thresh5_df$pre)
X23rL42_pSNV_thresh5_max_pre_counts
# r2 histograms of pre counts pSNV
# r2 Position vs. pre pSNV coverage
X23rL42_pSNV_thresh5_post_count = length(X23rL42_pSNV_thresh5_df$post)
X23rL42_pSNV_thresh5_post_count
X23rL42_pSNV_thresh5_min_post_counts = min(X23rL42_pSNV_thresh5_df$post)
X23rL42_pSNV_thresh5_min_post_counts
X23rL42_pSNV_thresh5_max_post_counts = max(X23rL42_pSNV_thresh5_df$post)
X23rL42_pSNV_thresh5_max_post_counts
# r2 histograms of post counts
X23rL42_pSNV_thresh5_hist_post
# r2 Position vs. post SNV coverage
X23rL42_pSNV_thresh5_post_pos

#Replicate analysis
#define intersection based on most broad category that you care about, and then filter the others based on that intersection:

#Intersection variants of X23rL41_prog_var_thresh5_df:
X23rL41_prog_var_thresh5_df_rL42_int <- X23rL41_prog_var_thresh5_df[which(X23rL41_prog_var_thresh5_df$variant %in% X23rL42_prog_var_thresh5_df$variant),]
#Intersection variants of X23rL42_prog_var_thresh5_df:
X23rL42_prog_var_thresh5_df_rL41_int <- X23rL42_prog_var_thresh5_df[which(X23rL42_prog_var_thresh5_df$variant %in% X23rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
X23rL41_prog_var_thresh5_df_rL42_int_ord <- X23rL41_prog_var_thresh5_df_rL42_int[order(X23rL41_prog_var_thresh5_df_rL42_int$variant),]
X23rL42_prog_var_thresh5_df_rL41_int_ord <- X23rL42_prog_var_thresh5_df_rL41_int[order(X23rL42_prog_var_thresh5_df_rL41_int$variant),]

dim(X23rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
X23rL41rL42int_prog_var_thresh5_pre_count <- dim(X23rL41_prog_var_thresh5_df_rL42_int)[1] 
X23rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(X23rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(X23rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41
#Add the following columns from the from rL42 df to the rL41 df:
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- X23rL42_prog_var_thresh5_df_rL41_int_ord$lib
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- X23rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- X23rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- X23rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- X23rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- X23rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- X23rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
# tHDR entries pulled over to match...
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- X23rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
#compute new columns
#pre_lib_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)/2
#post_pre_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)/2
#post_lib_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)/2
#tHDR_pre_lib_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)/2
#tHDR_post_pre_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)/2
#tHDR_post_lib_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)/2
#tHDR_rna_pre_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)/2
#tHDR_rna_post_ratio_rL41rL42_mean
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)/2

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/X23rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)



```
Calculate quartiles and distributions for each functional class of variant:
```{r}
#filter these variants on only 3 categories to look for missense distribution.
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#quartiles: [0, 0.25, 0.50, 0.75, 1.0] (1-5 index), medians, and spread between calculation
#post_pre_ratio
X23rL41_cSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio)
X23rL41_cSNV_missense_post_pre_med <- unname(X23rL41_cSNV_missense_post_pre_quarts[3])
X23rL41_cSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio)
X23rL41_cSNV_syn_post_pre_med <- unname(X23rL41_cSNV_syn_post_pre_quarts[3])
X23rL41_cSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio)
X23rL41_cSNV_nonsense_post_pre_med <- unname(X23rL41_cSNV_nonsense_post_pre_quarts[3])
X23rL41_cSNV_syn_to_non_post_pre_spread <- X23rL41_cSNV_syn_post_pre_med - X23rL41_cSNV_nonsense_post_pre_med

X23rL42_cSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio)
X23rL42_cSNV_missense_post_pre_med <- unname(X23rL42_cSNV_missense_post_pre_quarts[3])
X23rL42_cSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_pre_ratio)
X23rL42_cSNV_syn_post_pre_med <- unname(X23rL42_cSNV_syn_post_pre_quarts[3])
X23rL42_cSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_pre_ratio)
X23rL42_cSNV_nonsense_post_pre_med <- unname(X23rL42_cSNV_nonsense_post_pre_quarts[3])
X23rL42_cSNV_syn_to_non_post_pre_spread <- X23rL42_cSNV_syn_post_pre_med - X23rL42_cSNV_nonsense_post_pre_med

X23rL41rL42a_cSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_missense_post_pre_med <- unname(X23rL41rL42a_cSNV_missense_post_pre_quarts[3])
X23rL41rL42a_cSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_syn_post_pre_med <- unname(X23rL41rL42a_cSNV_syn_post_pre_quarts[3])
X23rL41rL42a_cSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_nonsense_post_pre_med <- unname(X23rL41rL42a_cSNV_nonsense_post_pre_quarts[3])
X23rL41rL42a_cSNV_syn_to_non_post_pre_spread <- X23rL41rL42a_cSNV_syn_post_pre_med - X23rL41rL42a_cSNV_nonsense_post_pre_med

X23rL41rL42pw_cSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_cSNV_missense_post_pre_med <- unname(X23rL41rL42pw_cSNV_missense_post_pre_quarts[3])
X23rL41rL42pw_cSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_cSNV_syn_post_pre_med <- unname(X23rL41rL42pw_cSNV_syn_post_pre_quarts[3])
X23rL41rL42pw_cSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_cSNV_nonsense_post_pre_med <- unname(X23rL41rL42pw_cSNV_nonsense_post_pre_quarts[3])
X23rL41rL42pw_cSNV_syn_to_non_post_pre_spread <- X23rL41rL42pw_cSNV_syn_post_pre_med - X23rL41rL42pw_cSNV_nonsense_post_pre_med

#post_pre_ratio_tHDR
X23rL41_tSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio)
X23rL41_tSNV_missense_post_pre_med <- unname(X23rL41_tSNV_missense_post_pre_quarts[3])
X23rL41_tSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio)
X23rL41_tSNV_syn_post_pre_med <- unname(X23rL41_tSNV_syn_post_pre_quarts[3])
X23rL41_tSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio)
X23rL41_tSNV_nonsense_post_pre_med <- unname(X23rL41_tSNV_nonsense_post_pre_quarts[3])
X23rL41_tSNV_syn_to_non_post_pre_spread <- X23rL41_tSNV_syn_post_pre_med - X23rL41_tSNV_nonsense_post_pre_med

X23rL42_tSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio)
X23rL42_tSNV_missense_post_pre_med <- unname(X23rL42_tSNV_missense_post_pre_quarts[3])
X23rL42_tSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_pre_ratio)
X23rL42_tSNV_syn_post_pre_med <- unname(X23rL42_tSNV_syn_post_pre_quarts[3])
X23rL42_tSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_pre_ratio)
X23rL42_tSNV_nonsense_post_pre_med <- unname(X23rL42_tSNV_nonsense_post_pre_quarts[3])
X23rL42_tSNV_syn_to_non_post_pre_spread <- X23rL42_tSNV_syn_post_pre_med - X23rL42_tSNV_nonsense_post_pre_med

X23rL41rL42a_tSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_missense_post_pre_med <- unname(X23rL41rL42a_tSNV_missense_post_pre_quarts[3])
X23rL41rL42a_tSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_syn_post_pre_med <- unname(X23rL41rL42a_tSNV_syn_post_pre_quarts[3])
X23rL41rL42a_tSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_nonsense_post_pre_med <- unname(X23rL41rL42a_tSNV_nonsense_post_pre_quarts[3])
X23rL41rL42a_tSNV_syn_to_non_post_pre_spread <- X23rL41rL42a_tSNV_syn_post_pre_med - X23rL41rL42a_tSNV_nonsense_post_pre_med

X23rL41rL42pw_tSNV_missense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_tSNV_missense_post_pre_med <- unname(X23rL41rL42pw_tSNV_missense_post_pre_quarts[3])
X23rL41rL42pw_tSNV_syn_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_tSNV_syn_post_pre_med <- unname(X23rL41rL42pw_tSNV_syn_post_pre_quarts[3])
X23rL41rL42pw_tSNV_nonsense_post_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
X23rL41rL42pw_tSNV_nonsense_post_pre_med <- unname(X23rL41rL42pw_tSNV_nonsense_post_pre_quarts[3])
X23rL41rL42pw_tSNV_syn_to_non_post_pre_spread <- X23rL41rL42pw_tSNV_syn_post_pre_med - X23rL41rL42pw_tSNV_nonsense_post_pre_med

#post_lib_ratio
X23rL41_cSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio)
X23rL41_cSNV_missense_post_lib_med <- unname(X23rL41_cSNV_missense_post_lib_quarts[3])
X23rL41_cSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio)
X23rL41_cSNV_syn_post_lib_med <- unname(X23rL41_cSNV_syn_post_lib_quarts[3])
X23rL41_cSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio)
X23rL41_cSNV_nonsense_post_lib_med <- unname(X23rL41_cSNV_nonsense_post_lib_quarts[3])
X23rL41_cSNV_syn_to_non_post_lib_spread <- X23rL41_cSNV_syn_post_lib_med - X23rL41_cSNV_nonsense_post_lib_med

X23rL42_cSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_post_lib_ratio)
X23rL42_cSNV_missense_post_lib_med <- unname(X23rL42_cSNV_missense_post_lib_quarts[3])
X23rL42_cSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_post_lib_ratio)
X23rL42_cSNV_syn_post_lib_med <- unname(X23rL42_cSNV_syn_post_lib_quarts[3])
X23rL42_cSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_post_lib_ratio)
X23rL42_cSNV_nonsense_post_lib_med <- unname(X23rL42_cSNV_nonsense_post_lib_quarts[3])
X23rL42_cSNV_syn_to_non_post_lib_spread <- X23rL42_cSNV_syn_post_lib_med - X23rL42_cSNV_nonsense_post_lib_med

X23rL41rL42a_cSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_missense_post_lib_med <- unname(X23rL41rL42a_cSNV_missense_post_lib_quarts[3])
X23rL41rL42a_cSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_syn_post_lib_med <- unname(X23rL41rL42a_cSNV_syn_post_lib_quarts[3])
X23rL41rL42a_cSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_nonsense_post_lib_med <- unname(X23rL41rL42a_cSNV_nonsense_post_lib_quarts[3])
X23rL41rL42a_cSNV_syn_to_non_post_lib_spread <- X23rL41rL42a_cSNV_syn_post_lib_med - X23rL41rL42a_cSNV_nonsense_post_lib_med

#tHDR_post_lib_ratio
X23rL41_tSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio)
X23rL41_tSNV_missense_post_lib_med <- unname(X23rL41_tSNV_missense_post_lib_quarts[3])
X23rL41_tSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio)
X23rL41_tSNV_syn_post_lib_med <- unname(X23rL41_tSNV_syn_post_lib_quarts[3])
X23rL41_tSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio)
X23rL41_tSNV_nonsense_post_lib_med <- unname(X23rL41_tSNV_nonsense_post_lib_quarts[3])
X23rL41_tSNV_syn_to_non_post_lib_spread <- X23rL41_tSNV_syn_post_lib_med - X23rL41_tSNV_nonsense_post_lib_med

X23rL42_tSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_lib_ratio)
X23rL42_tSNV_missense_post_lib_med <- unname(X23rL42_tSNV_missense_post_lib_quarts[3])
X23rL42_tSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_post_lib_ratio)
X23rL42_tSNV_syn_post_lib_med <- unname(X23rL42_tSNV_syn_post_lib_quarts[3])
X23rL42_tSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_post_lib_ratio)
X23rL42_tSNV_nonsense_post_lib_med <- unname(X23rL42_tSNV_nonsense_post_lib_quarts[3])
X23rL42_tSNV_syn_to_non_post_lib_spread <- X23rL42_tSNV_syn_post_lib_med - X23rL42_tSNV_nonsense_post_lib_med

X23rL41rL42a_tSNV_missense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_missense_post_lib_med <- unname(X23rL41rL42a_tSNV_missense_post_lib_quarts[3])
X23rL41rL42a_tSNV_syn_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_syn_post_lib_med <- unname(X23rL41rL42a_tSNV_syn_post_lib_quarts[3])
X23rL41rL42a_tSNV_nonsense_post_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_post_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_nonsense_post_lib_med <- unname(X23rL41rL42a_tSNV_nonsense_post_lib_quarts[3])
X23rL41rL42a_tSNV_syn_to_non_post_lib_spread <- X23rL41rL42a_tSNV_syn_post_lib_med - X23rL41rL42a_tSNV_nonsense_post_lib_med

#pre_lib_ratio
X23rL41_cSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio)
X23rL41_cSNV_missense_pre_lib_med <- unname(X23rL41_cSNV_missense_pre_lib_quarts[3])
X23rL41_cSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio)
X23rL41_cSNV_syn_pre_lib_med <- unname(X23rL41_cSNV_syn_pre_lib_quarts[3])
X23rL41_cSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio)
X23rL41_cSNV_nonsense_pre_lib_med <- unname(X23rL41_cSNV_nonsense_pre_lib_quarts[3])
X23rL41_cSNV_syn_to_non_pre_lib_spread <- X23rL41_cSNV_syn_pre_lib_med - X23rL41_cSNV_nonsense_pre_lib_med

X23rL42_cSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_pre_lib_ratio)
X23rL42_cSNV_missense_pre_lib_med <- unname(X23rL42_cSNV_missense_pre_lib_quarts[3])
X23rL42_cSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_pre_lib_ratio)
X23rL42_cSNV_syn_pre_lib_med <- unname(X23rL42_cSNV_syn_pre_lib_quarts[3])
X23rL42_cSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_pre_lib_ratio)
X23rL42_cSNV_nonsense_pre_lib_med <- unname(X23rL42_cSNV_nonsense_pre_lib_quarts[3])
X23rL42_cSNV_syn_to_non_pre_lib_spread <- X23rL42_cSNV_syn_pre_lib_med - X23rL42_cSNV_nonsense_pre_lib_med

X23rL41rL42a_cSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_missense_pre_lib_med <- unname(X23rL41rL42a_cSNV_missense_pre_lib_quarts[3])
X23rL41rL42a_cSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_syn_pre_lib_med <- unname(X23rL41rL42a_cSNV_syn_pre_lib_quarts[3])
X23rL41rL42a_cSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_cSNV_nonsense_pre_lib_med <- unname(X23rL41rL42a_cSNV_nonsense_pre_lib_quarts[3])
X23rL41rL42a_cSNV_syn_to_non_pre_lib_spread <- X23rL41rL42a_cSNV_syn_pre_lib_med - X23rL41rL42a_cSNV_nonsense_pre_lib_med

#pre_lib_ratio_tHDR
X23rL41_tSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio)
X23rL41_tSNV_missense_pre_lib_med <- unname(X23rL41_tSNV_missense_pre_lib_quarts[3])
X23rL41_tSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio)
X23rL41_tSNV_syn_pre_lib_med <- unname(X23rL41_tSNV_syn_pre_lib_quarts[3])
X23rL41_tSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio)
X23rL41_tSNV_nonsense_pre_lib_med <- unname(X23rL41_tSNV_nonsense_pre_lib_quarts[3])
X23rL41_tSNV_syn_to_non_pre_lib_spread <- X23rL41_tSNV_syn_pre_lib_med - X23rL41_tSNV_nonsense_pre_lib_med

X23rL42_tSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_pre_lib_ratio)
X23rL42_tSNV_missense_pre_lib_med <- unname(X23rL42_tSNV_missense_pre_lib_quarts[3])
X23rL42_tSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_pre_lib_ratio)
X23rL42_tSNV_syn_pre_lib_med <- unname(X23rL42_tSNV_syn_pre_lib_quarts[3])
X23rL42_tSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$rL42_tHDR_pre_lib_ratio)
X23rL42_tSNV_nonsense_pre_lib_med <- unname(X23rL42_tSNV_nonsense_pre_lib_quarts[3])
X23rL42_tSNV_syn_to_non_pre_lib_spread <- X23rL42_tSNV_syn_pre_lib_med - X23rL42_tSNV_nonsense_pre_lib_med

X23rL41rL42a_tSNV_missense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense$tHDR_pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_missense_pre_lib_med <- unname(X23rL41rL42a_tSNV_missense_pre_lib_quarts[3])
X23rL41rL42a_tSNV_syn_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_syn_pre_lib_med <- unname(X23rL41rL42a_tSNV_syn_pre_lib_quarts[3])
X23rL41rL42a_tSNV_nonsense_pre_lib_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense$tHDR_pre_lib_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_nonsense_pre_lib_med <- unname(X23rL41rL42a_tSNV_nonsense_pre_lib_quarts[3])
X23rL41rL42a_tSNV_syn_to_non_pre_lib_spread <- X23rL41rL42a_tSNV_syn_pre_lib_med - X23rL41rL42a_tSNV_nonsense_pre_lib_med

#tHDR_rna_pre_ratio
X23rL41_tSNV_syn_rna_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio)
X23rL41_tSNV_syn_rna_pre_med <- unname(X23rL41_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X23rL41_tSNV_syn_rna_post_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio)
X23rL41_tSNV_syn_rna_post_med <- unname(X23rL41_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio
X23rL42_tSNV_syn_rna_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_pre_ratio)
X23rL42_tSNV_syn_rna_pre_med <- unname(X23rL42_tSNV_syn_rna_pre_quarts[3])
#tHDR_rna_post_ratio
X23rL42_tSNV_syn_rna_post_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$rL42_tHDR_rna_post_ratio)
X23rL42_tSNV_syn_rna_post_med <- unname(X23rL42_tSNV_syn_rna_post_quarts[3])

#tHDR_rna_pre_ratio_rL41rL42_mean
X23rL41rL42a_tSNV_syn_rna_pre_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_pre_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_syn_rna_pre_med <- unname(X23rL41rL42a_tSNV_syn_rna_pre_quarts[3])

#tHDR_rna_post_ratio_rL41rL42_mean
X23rL41rL42a_tSNV_syn_rna_post_quarts <- quantile(X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn$tHDR_rna_post_ratio_rL41rL42_mean)
X23rL41rL42a_tSNV_syn_rna_post_med <- unname(X23rL41rL42a_tSNV_syn_rna_post_quarts[3])


```

Create syn-normalized (synnorm) values
```{r}

#### COPIED LIST OF CATEGORIES NOW IN DF -  pick which ones to normalize to median synonymous variant:
#rL41
X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/X23rL41_cSNV_syn_pre_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/X23rL41_cSNV_syn_post_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/X23rL41_cSNV_syn_post_lib_med
# tHDR
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/X23rL41_tSNV_syn_pre_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/X23rL41_tSNV_syn_post_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/X23rL41_tSNV_syn_post_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/X23rL41_tSNV_syn_rna_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/X23rL41_tSNV_syn_rna_post_med

#rL42
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/X23rL42_cSNV_syn_pre_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/X23rL42_cSNV_syn_post_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/X23rL42_cSNV_syn_post_lib_med
# tHDR
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/X23rL42_tSNV_syn_pre_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/X23rL42_tSNV_syn_post_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/X23rL42_tSNV_syn_post_lib_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/X23rL42_tSNV_syn_rna_pre_med
X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/X23rL42_tSNV_syn_rna_post_med

###normalize the means next!!!

#pre_lib_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/X23rL41rL42a_cSNV_syn_pre_lib_med
#post_pre_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/X23rL41rL42a_cSNV_syn_post_pre_med
#post_lib_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/X23rL41rL42a_cSNV_syn_post_lib_med
#tHDR_pre_lib_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/X23rL41rL42a_tSNV_syn_pre_lib_med
#tHDR_post_pre_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/X23rL41rL42a_tSNV_syn_post_pre_med
#tHDR_post_lib_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/X23rL41rL42a_tSNV_syn_post_lib_med
#tHDR_rna_pre_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/X23rL41rL42a_tSNV_syn_rna_pre_med
#tHDR_rna_post_ratio_rL41rL42_mean_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/X23rL41rL42a_tSNV_syn_rna_post_med
#tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/X23rL41rL42pw_tSNV_syn_post_pre_med
#post_pre_ratio_rL41rL42_pre_weighted_synnorm
X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- X23rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/X23rL41rL42pw_cSNV_syn_post_pre_med

#filter these variants on only 3 categories to look for missense distribution.
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missynstop <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS' | X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS' | X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED' ),]
#filter only on missense, syn, or stop:
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_missense <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='NON_SYNONYMOUS'),]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_syn <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='SYNONYMOUS'),]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_nonsense <- X23rL41_prog_var_thresh5_df_rL42_int_ord[which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'conseq']=='STOP_GAINED'),]

#working intersection dictionary:  X23rL41_prog_var_thresh5_df_rL42_int_ord
X23rL41_prog_map_thresh5_df_rL42_int_ord = which(X23rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
X23rL41_prog_map_thresh5_df_rL42_int_ord_df = X23rL41_prog_var_thresh5_df_rL42_int_ord[X23rL41_prog_map_thresh5_df_rL42_int_ord,]
X23rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & X23rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = X23rL41_prog_map_thresh5_df_rL42_int_ord_df[X23rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = X23rL41_prog_map_thresh5_df_rL42_int_ord_df[X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]

###Replicate Plotting

#Plot comparing post_pre_ratio from each experiment:
#X23rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre_alpha <-
#X23rL41rL42_prog_map_rL41_post_pre_by_rL42_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X23rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X23rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
X23rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p

#Plot comparing tHDR_post_pre_ratio from each experiment:
#X23rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_alpha <-
#X23rL41rL42_prog_map_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
X23rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
X23rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p

#Plot comparing post_lib_ratio from each experiment with colors for mutation consequence:
#X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib <-
#correlation between intersection of replicates, log-2 normalized:
X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
X23rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p

#Plot comparing rna_pre_ratio from each experiment with colors for mutation consequence:
#X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_alpha <-
#Same plot comparing post_pseudo_freq/lib_pseudo_freq from each experiment, no alpha:
#X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre <-
#correlation between intersection of replicates, log-2 normalized:
X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
X23rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p

#Plot comparing pre_freq reads from each experiment
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre
#correlations between replicates, pre_freq reads:
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='pearson')
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_p

#Plot comparing post_freq reads from each experiment
#X23rL41rL42_cSNV_rL41_post_by_rL42_post <-
#correlations between replicates, post_freq reads:
X23rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X23rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X23rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='pearson')
X23rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p

#Plot comparing pre_lib_ratio across replicates
#X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib <- 
#correlations between replicates, pre_lib_ratio:
X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p

# pre_lib_ratio (average across replicates) by position
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_intercept = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope = coef(lm(log2(pre_lib_ratio_rL41rL42_mean_synnorm) ~ pos,data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pre_pos_effect_slope #decrease in editing efficiency per bp

#tHDR_pre_lib_ratio by pos using mean:
X23rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
#tHDR_post_lib_ratio by pos using mean:
X23rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
#tHDR_post_pre_ratio by pos using mean:
X23rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#tHDR_rna_pre_ratio by pos using mean:
X23rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s


# post_lib_ratio (mean_synnorm across reps) by position
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_intercept = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope = coef(lm(log2(post_lib_ratio_rL41rL42_mean_synnorm) ~ pos, data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_post_pos_effect_slope #decrease in editing efficiency per bp

#post_pre_ratio_rL41rL42_mean_synnorm by position
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_intercept = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[1]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope = coef(lm(log2(post_pre_ratio_rL41rL42_mean_synnorm) ~ pos,data=X23rL41_prog_map_thresh5_df_rL42_int_ord_df))[2]
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_pp_pos_effect_slope #decrease in editing efficiency per bp

#pre_lib_ratio by pos using pre weighted averages:
#post_pre_ratio by pos using weighted averages:
#tHDR_post_pre_ratio by pos using weighted averages:
#Post / lib ratio by pos using pre weighted averages:

#COMPARISONS TO CADD
#single replicate comparisons for post/lib and post/pre (only on variants passing thresh in both reps)
#X23rL41_cSNV_post_pre_ratio_synnorm_by_CADD <- 
#calculate post_pre_ratio_synnorm CADD correlation using rL41:
X23rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41_cSNV_post_pre_by_cadd_cor_s
#X23rL42_cSNV_post_pre_ratio_synnorm_by_CADD <-
#calculate post_pre_ratio_synnorm CADD correlation using rL42:
X23rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL42_cSNV_post_pre_by_cadd_cor_s

#X23rL41_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL41:
X23rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41_cSNV_post_lib_by_cadd_cor_s
#X23rL42_cSNV_post_lib_ratio_synnorm_by_CADD <- 
#calculate post_lib_ratio_synnorm CADD correlation using rL42:
X23rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL42_cSNV_post_lib_by_cadd_cor_s

#calculate individual replicate correlations to CADD with tHDR (i.e. tSNV)
#X23rL41_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL41:
X23rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41_tSNV_post_pre_by_cadd_cor_s
#X23rL42_tSNV_tHDR_post_pre_ratio_synnorm_by_CADD <-
#calculate tHDR_post_pre_ratio_synnorm CADD correlation using rL42:
X23rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL42_tSNV_post_pre_by_cadd_cor_s

#X23rL41_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL41:
X23rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41_tSNV_post_lib_by_cadd_cor_s
#X23rL42_tSNV_tHDR_post_lib_ratio_synnorm_by_CADD <- 
#calculate tHDR_post_lib_ratio_synnorm CADD correlation using rL42:
X23rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
#Average pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
#Weighted pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_cSNV_pre_lib_by_cadd_cor_s

#Average post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_pre_by_cadd_cor_s

#Weighted post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_cSNV_post_pre_by_cadd_cor_s

#Average post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_lib_by_cadd_cor_s
#Weighted post / lib ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_cSNV_post_lib_by_cadd_cor_s

#calculate average correlations with CADD for tSNV
#Average tHDR_pre_lib_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#Average tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_post_pre_by_cadd_cor_s

#Weighted tHDR_post_pre_ratio plotted vs. cadd
#calculate CADD correlation using weighted averages:
X23rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_tSNV_post_pre_by_cadd_cor_s

#Average tHDR_post_lib_ratio_synnorm plotted vs. cadd
#calculate CADD correlation using average:
X23rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plots for all SNVs
#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_pre_weighted_synnorm density plot for only missense

#post_pre_ratio_rL41rL42_mean_synnorm density plots based on mean
#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missynstop

#post_pre_ratio_rL41rL42_mean_synnorm density plot for only missense

#order the data frame by mutational consequence:
ordered_X23rL41_cSNV_thresh5_df_rL42_int_ord_missynstop <- X23rL41_cSNV_thresh5_df_rL42_int_ord_missynstop
ordered_X23rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq <- factor(ordered_X23rL41_cSNV_thresh5_df_rL42_int_ord_missynstop$conseq, levels = c('STOP_GAINED','SYNONYMOUS','NON_SYNONYMOUS'))

# hiding the missense variants (white)

#comparison of different scoring algorithms to missense variants tests -- add cons, grantham, exac...
#polyphen -- must filter missense mutations on CADD df because only those have been annotated.

X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[,'conseq']=='NON_SYNONYMOUS'),]
#pull out only missense from CADD dictionary...
cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
#CADD
cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')

#summary data

#########
### working update line.
  #   -- fix df references (think this is done, but names of variables elsewhere still use 'cSNV')
  #   -- fix plots to be synnorm
########
#variant coverage metrics:
X23rL41_prog_var_all_lib_count
X23rL41_prog_var_all_pre_count
X23rL42_prog_var_all_pre_count
X23rL41_prog_map_thresh5_lib_count
X23rL41_prog_map_thresh5_pre_count
X23rL42_prog_map_thresh5_pre_count
X23rL41_prog_map_thresh5_post_count
X23rL42_prog_map_thresh5_post_count
X23rL41rL42int_prog_var_thresh5_pre_count
#correlations between replicate frequencies (all psuedocounted, spearman rank)
X23rL41rL42_cSNV_rL41_pre_by_rL42_pre_cor_s
X23rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X23rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
X23rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X23rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
#add tSNV correlations...
X23rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
X23rL41rL42_tSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
X23rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
X23rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#correlations with CADD for single replicates
X23rL41_cSNV_post_pre_by_cadd_cor_s
X23rL42_cSNV_post_pre_by_cadd_cor_s
X23rL41_cSNV_post_lib_by_cadd_cor_s
X23rL42_cSNV_post_lib_by_cadd_cor_s
X23rL41_tSNV_post_pre_by_cadd_cor_s
X23rL42_tSNV_post_pre_by_cadd_cor_s
X23rL41_tSNV_post_lib_by_cadd_cor_s
X23rL42_tSNV_post_lib_by_cadd_cor_s
#correlations with CADD for weighted or non-weighted averages
X23rL41rL42a_cSNV_post_pre_by_cadd_cor_s
X23rL41rL42w_cSNV_post_pre_by_cadd_cor_s
X23rL41rL42a_cSNV_post_lib_by_cadd_cor_s
X23rL41rL42w_cSNV_post_lib_by_cadd_cor_s
X23rL41rL42a_tSNV_post_pre_by_cadd_cor_s
X23rL41rL42w_tSNV_post_pre_by_cadd_cor_s
X23rL41rL42a_tSNV_post_lib_by_cadd_cor_s
X23rL41rL42a_tSNV_pre_lib_by_cadd_cor_s

#synonymous to nonsense spreads
X23rL41_cSNV_syn_to_non_post_pre_spread
X23rL42_cSNV_syn_to_non_post_pre_spread
X23rL41rL42a_cSNV_syn_to_non_post_pre_spread
X23rL41_cSNV_syn_to_non_post_lib_spread
X23rL42_cSNV_syn_to_non_post_lib_spread
X23rL41rL42a_cSNV_syn_to_non_post_lib_spread
X23rL41_tSNV_syn_to_non_post_pre_spread
X23rL42_tSNV_syn_to_non_post_pre_spread
X23rL41rL42a_tSNV_syn_to_non_post_pre_spread
X23rL41_tSNV_syn_to_non_post_lib_spread
X23rL42_tSNV_syn_to_non_post_lib_spread
X23rL41rL42a_tSNV_syn_to_non_post_lib_spread
#lollipop plots
#post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_pre_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_pre_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_rna_pre_mean by CDSpos with consequence, letter, no legend

#instead post_lib_ratio:
#lollipop plots
#post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#tHDR_post_lib_mean by chr_pos with consequence, letter (genomic+), no legend.
#post_lib_mean by CDSpos with consequence, letter (coding), no legend
#tHDR_post_lib_mean by CDSpos with consequence, letter (coding), no legend
#Update code below with more specific df, synnorm measurements, tHDR plots where appropriate...

#Post_pre_ratio by position with clinvar line, conseq, and letter

#Clinvar pos without letter or legend:

#histograms of prog_map_cSNVs in lib, pre, post

#Density plots for missense, syn, nonsense, post_pre_ratio:
X23rL41_prog_map_thresh5_df_rL42_int_ord_df_synstop <- X23rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='SYNONYMOUS' | X23rL41_prog_map_thresh5_df_rL42_int_ord_df[,'conseq']=='STOP_GAINED' ),]
#Density plots for missense, syn, nonsense, post_lib_ratio:
#scores correlate to CADD
#same plot highlighting missense:
#same plot highlighting synonymous / intronic:

#Pos with consequence, no letter, no legend, only show syn.

#make all the ClinVar_consequences light gray





#how many 'absent' variants are depleted below -0.4:
length(which(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'absent'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Uncertain significance' variants are depleted below -0.4:
length(which(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Uncertain significance'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))
#how many 'Conflicting interpretations of pathogenicity' variants are depleted below -0.4:
length(which(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df[which(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$clinvar_simple == 'Conflicting interpretations of pathogenicity'),]$post_pre_ratio_rL41rL42_mean_synnorm) < -0.4))

#tHDR_pre_pseudo_freq vs. tHDR_rna_pseudo_freq

#CDSpos, RNA-freq by 

#gDNA pos vs. RNA freq w/ cut pos:
#CDSpos, RNA-freq by 

#final correlations to save as variables for heatmapping:
X23rL41_cSNV_pre_lib_cors = cor(log2(X23rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23rL41_tSNV_pre_lib_cors = cor(log2(X23rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23rL41_cSNV_post_lib_cors = cor(log2(X23rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X23rL41_tSNV_post_lib_cors = cor(log2(X23rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X23rL41_cSNV_post_pre_cors = cor(log2(X23rL41_prog_map_thresh5_df$post_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23rL41_tSNV_post_pre_cors = cor(log2(X23rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X23rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23rL41_cSNV_rna_lib_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X23rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23rL41_tSNV_rna_lib_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X23rL41_cSNV_rna_pre_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X23rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23rL41_tSNV_rna_pre_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X23rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23rL41rL42_cSNV_pre_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
X23rL41rL42_tSNV_pre_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
X23rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
X23rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
X23rL41rL42_cSNV_post_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
X23rL41rL42_tSNV_post_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
X23rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
X23rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
X23rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(X23rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
X23rL41rL42_cSNV_rna_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
X23rL41rL42_tSNV_rna_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
X23rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(X23rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
X23rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X23rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X23rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X23rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X23rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
X23rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

X23rL41_cors <- c("X23rL41",X23rL41_cSNV_pre_lib_cors,X23rL41_tSNV_pre_lib_cors,X23rL41_cSNV_post_lib_cors,X23rL41_tSNV_post_lib_cors,X23rL41_cSNV_post_pre_cors,X23rL41_tSNV_post_pre_cors,X23rL41_cSNV_rna_lib_cors,X23rL41_tSNV_rna_lib_cors,X23rL41_cSNV_rna_pre_cors,X23rL41_tSNV_rna_pre_cors,X23rL41rL42_cSNV_pre_cors,X23rL41rL42_tSNV_pre_cors,X23rL41rL42_cSNV_pre_lib_ratio_cors,X23rL41rL42_tSNV_pre_lib_ratio_cors,X23rL41rL42_cSNV_post_cors,X23rL41rL42_tSNV_post_cors,X23rL41rL42_cSNV_post_lib_ratio_cors,X23rL41rL42_tSNV_post_lib_ratio_cors,X23rL41rL42_cSNV_post_pre_ratio_cors,X23rL41rL42_tSNV_post_pre_ratio_cors,X23rL41rL42_cSNV_rna_cors,X23rL41rL42_tSNV_rna_cors,X23rL41rL42_tSNV_rna_pre_ratio_cors,X23rL41_cSNV_pre_lib_ratio_cadd_cors,X23rL41_tSNV_pre_lib_ratio_cadd_cors,X23rL41_cSNV_post_lib_ratio_cadd_cors,X23rL41_tSNV_post_lib_ratio_cadd_cors,X23rL41_cSNV_post_pre_ratio_cadd_cors,X23rL41_tSNV_post_pre_ratio_cadd_cors,X23rL41_cSNV_post_pre_ratio_cadd_missense_cors,X23rL41_tSNV_post_pre_ratio_cadd_missense_cors,X23rL41_cSNV_post_pre_ratio_polyphen_missense_cors,X23rL41_tSNV_post_pre_ratio_polyphen_missense_cors,X23rL41_cSNV_post_pre_ratio_grantham_missense_cors,X23rL41_tSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X23rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X23rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X23rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X23rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X23rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X23rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X23rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X23rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X23rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X23rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X23rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#replicate 2 assignments for rL42-specific scores...
X23rL42_cSNV_pre_lib_cors = cor(log2(X23rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23rL42_tSNV_pre_lib_cors = cor(log2(X23rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23rL42_cSNV_post_lib_cors = cor(log2(X23rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
X23rL42_tSNV_post_lib_cors = cor(log2(X23rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
X23rL42_cSNV_post_pre_cors = cor(log2(X23rL42_prog_map_thresh5_df$post_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
X23rL42_tSNV_post_pre_cors = cor(log2(X23rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(X23rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
X23rL42_cSNV_rna_lib_cors = cor(log2(X23rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(X23rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23rL42_tSNV_rna_lib_cors = cor(log2(X23rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(X23rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
X23rL42_cSNV_rna_pre_cors = cor(log2(X23rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(X23rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
X23rL42_tSNV_rna_pre_cors = cor(log2(X23rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(X23rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
# rL42 switching to the df with CADD scores to make correlations with CADD
X23rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(X23rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(X23rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
X23rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
X23rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
X23rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
X23rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(X23rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

X23rL42_cors <- c("X23rL42",X23rL42_cSNV_pre_lib_cors,X23rL42_tSNV_pre_lib_cors,X23rL42_cSNV_post_lib_cors,X23rL42_tSNV_post_lib_cors,X23rL42_cSNV_post_pre_cors,X23rL42_tSNV_post_pre_cors,X23rL42_cSNV_rna_lib_cors,X23rL42_tSNV_rna_lib_cors,X23rL42_cSNV_rna_pre_cors,X23rL42_tSNV_rna_pre_cors,X23rL41rL42_cSNV_pre_cors,X23rL41rL42_tSNV_pre_cors,X23rL41rL42_cSNV_pre_lib_ratio_cors,X23rL41rL42_tSNV_pre_lib_ratio_cors,X23rL41rL42_cSNV_post_cors,X23rL41rL42_tSNV_post_cors,X23rL41rL42_cSNV_post_lib_ratio_cors,X23rL41rL42_tSNV_post_lib_ratio_cors,X23rL41rL42_cSNV_post_pre_ratio_cors,X23rL41rL42_tSNV_post_pre_ratio_cors,X23rL41rL42_cSNV_rna_cors,X23rL41rL42_tSNV_rna_cors,X23rL41rL42_tSNV_rna_pre_ratio_cors,X23rL42_cSNV_pre_lib_ratio_cadd_cors,X23rL42_tSNV_pre_lib_ratio_cadd_cors,X23rL42_cSNV_post_lib_ratio_cadd_cors,X23rL42_tSNV_post_lib_ratio_cadd_cors,X23rL42_cSNV_post_pre_ratio_cadd_cors,X23rL42_tSNV_post_pre_ratio_cadd_cors,X23rL42_cSNV_post_pre_ratio_cadd_missense_cors,X23rL42_tSNV_post_pre_ratio_cadd_missense_cors,X23rL42_cSNV_post_pre_ratio_polyphen_missense_cors,X23rL42_tSNV_post_pre_ratio_polyphen_missense_cors,X23rL42_cSNV_post_pre_ratio_grantham_missense_cors,X23rL42_tSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,X23rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,X23rL41rL42a_cSNV_post_lib_ratio_cadd_cors,X23rL41rL42a_tSNV_post_lib_ratio_cadd_cors,X23rL41rL42a_cSNV_post_pre_ratio_cadd_cors,X23rL41rL42a_tSNV_post_pre_ratio_cadd_cors,X23rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,X23rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,X23rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,X23rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,X23rL41rL42w_cSNV_post_lib_ratio_cadd_cors,X23rL41rL42w_cSNV_post_pre_ratio_cadd_cors,X23rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(X23rL41)
rm(X23rL42)
gc()
